---
import { ExampleRunner } from './components/ExampleRunner';
import { ReactComponent as LoadingLogo } from '../../images/inline-svgs/ag-grid-logomark-loading.svg';
import { getExampleOptionsFromString } from './utils/getExampleOptionsFromString';
import { FRAMEWORK_PATH_INDEX, PAGE_NAME_PATH_INDEX } from '../../constants';

const { title, name, type, options } = Astro.props;

const pathSegments = Astro.url.pathname.split('/');
const framework = pathSegments[FRAMEWORK_PATH_INDEX];
const pageName = pathSegments[PAGE_NAME_PATH_INDEX];

let exampleOptions;
try {
    exampleOptions = getExampleOptionsFromString(options);
} catch (error) {
    throw new Error(`${error} - options: ${options}\n${JSON.stringify({ name, title, pageName, framework }, null, 2)}`);
}
---

<div class="container">
    <LoadingLogo class="loading-spinner" />
    <ExampleRunner
        client:load
        title={title}
        name={name}
        exampleType={type}
        options={exampleOptions}
        framework={framework}
        pageName={pageName}
    />
</div>

<style lang="scss">
    .container {
        position: relative;

        :global(.logomark) {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(2);
        }
    }
</style>
