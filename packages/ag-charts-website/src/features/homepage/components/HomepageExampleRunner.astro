---
import { InternalFramework } from '@ag-grid-types';
import { getExampleUrl } from '@features/docs/utils/urlPaths';
import HomepageChart from './HomepageChart.astro';
import { getGeneratedContents } from '@features/examples-generator/index';
import { getDarkModeSnippet } from '@components/site-header/getDarkModeSnippet';

interface Props {
    internalFramework: InternalFramework;
    pageName: string;
    exampleName: string;
}

const { internalFramework, pageName, exampleName } = Astro.props;

const exampleUrl = getExampleUrl({
    internalFramework,
    pageName,
    exampleName,
});
const generatedContents = await getGeneratedContents({
    type: 'docs',
    framework: internalFramework,
    pageName,
    exampleName,
    // Ignore dark mode and add on page manually
    ignoreDarkMode: true,
});
const { scriptFiles, styleFiles, files } = generatedContents!;
const indexFragment = files && files['index.html'];
const appLocation = exampleUrl;

const darkModeSnippet = `<script>
    ${getDarkModeSnippet('homepageHeroListener')}
</script>`;
---

<div class="container">
    <HomepageChart
        scriptFiles={scriptFiles}
        styleFiles={styleFiles}
        indexFragment={indexFragment!}
        appLocation={appLocation}
    />
</div>

<style lang="scss">
    .container {
        width: 100%;
        height: 100%;
        position: relative;

        :global(.logomark) {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(2);
        }
    }
</style>

<Fragment set:html={darkModeSnippet} />
