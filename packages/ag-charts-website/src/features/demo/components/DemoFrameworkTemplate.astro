---
import { getEntry } from 'astro:content';
import { getGeneratedDemoContents } from '../utils/examplesGenerator';
import { getExampleUrl } from '../utils/urlPaths';
import FrameworkTemplate from '../../example-runner/components/FrameworkTemplate.astro';
import { DEMO_INTERNAL_FRAMEWORK } from '../constants';
import { getChartTypeName, getExampleName } from '../utils/filesData';
import type { GeneratedContents } from '../../examples-generator/types';

interface Props {
    exampleName: string;
    /**
     * Whether to use relative paths for script files references
     */
    relativePath?: boolean;
    /**
     * Override to be used for generated contents
     */
    generatedContents?: GeneratedContents;
}

const { exampleName, relativePath, generatedContents: generatedContentsOverride } = Astro.props as Props;

const internalFramework = DEMO_INTERNAL_FRAMEWORK;
const generatedContents = generatedContentsOverride
    ? generatedContentsOverride
    : await getGeneratedDemoContents({
          exampleName,
      });

const exampleUrl = getExampleUrl({
    exampleName,
});

const demosEntry = await getEntry('demo', 'demos');
const chartTypeName = getChartTypeName({
    demos: demosEntry.data,
    exampleName,
});
const pageName = `${chartTypeName} Chart`;
const displayExampleName = getExampleName({
    demos: demosEntry.data,
    exampleName,
});
---

<FrameworkTemplate
    internalFramework={internalFramework}
    pageName={pageName!}
    exampleName={displayExampleName!}
    exampleUrl={exampleUrl}
    generatedContents={generatedContents!}
    relativePath={relativePath}
/>
