---
import { HeaderNav } from './HeaderNav';
import { getEntry } from 'astro:content';
import { FRAMEWORKS } from '@constants';
import styles from './SiteHeader.module.scss';
import { urlWithBaseUrl } from '@utils/pages';
import { SiteLogo } from './SiteLogo';

const { pathname } = Astro.url;
const { data: menuData } = await getEntry('menu', 'data');
const topNavItems = menuData.header.items;

const apiPaths = menuData.api.items.map(({ path }) => ({
    title: 'API',
    path: urlWithBaseUrl(path),
}));
const frameworkPaths = FRAMEWORKS.map((framework) => ({
    title: 'Docs',
    path: urlWithBaseUrl(framework),
}));
const allPaths = [
    ...topNavItems,
    // NOTE: Prioritise API paths over framework paths - for doc pages which are in
    //  the API section
    ...apiPaths,
    ...frameworkPaths,
];
---

<header class:list={[styles.header, 'site-header']}>
    <div class:list={[styles.headerInner, 'page-margin']}>
        <SiteLogo client:load />
        <HeaderNav currentPath={pathname} items={topNavItems} allPaths={allPaths} client:only />
    </div>
</header>
