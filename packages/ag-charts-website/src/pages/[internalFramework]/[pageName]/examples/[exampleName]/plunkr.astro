---
import { getCollection } from 'astro:content';
import JavascriptTemplate from '../../../../../features/example-runner/framework-templates/JavascriptTemplate.astro';
import { getDocExamplePages } from '../../../../../utils/pages';
import { getIsDev } from '../../../../../utils/env';
import { getGeneratedContents } from '../../../../../features/examples-generator/examplesGenerator';
import type { InternalFramework } from '../../../../../types/ag-grid';

export async function getStaticPaths() {
    const pages = await getCollection('docs');
    return getDocExamplePages({
        pages,
    });
}

const internalFramework = Astro.params.internalFramework! as InternalFramework;
const pageName = Astro.params.pageName!;
const exampleName = Astro.params.exampleName!;

const { files, scriptFiles, styleFiles, isEnterprise } =
    (await getGeneratedContents({
        internalFramework,
        pageName,
        exampleName,
    })) || {};
const indexFragment = files && files['index.html'];

const isDev = getIsDev();
---

<JavascriptTemplate
    isDev={isDev}
    pageName={pageName}
    exampleName={exampleName}
    modifiedTimeMs={Date.now()}
    isExecuting={true}
    options={{
        enterprise: isEnterprise,
    }}
    scriptFiles={scriptFiles}
    styleFiles={styleFiles}
    indexFragment={indexFragment!}
    appLocation="./"
/>
