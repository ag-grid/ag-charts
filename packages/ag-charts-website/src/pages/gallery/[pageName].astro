---
import { getEntry } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import { Icon } from '../../components/icon/Icon';
import GalleryExampleRunner from '../../features/gallery/components/GalleryExampleRunner.astro';
import { getGalleryPages } from '../../features/gallery/utils/pageData';
import { GalleryExampleLink } from '../../features/gallery/components/GalleryExampleLink';

export async function getStaticPaths() {
    const galleryEntry = await getEntry('gallery', 'data');

    const pages = getGalleryPages({ galleryData: galleryEntry.data });
    return pages;
}

const { page, prevExample, nextExample } = Astro.props;
---

<Layout>
    <div class="page-margin font-size-responsive font-size-medium">
        <h1>
            <span>
                {page.title}
                {
                    page.enterprise && (
                        <span class="enterpriseIcon">
                            <Icon client:only name="enterprise" />
                        </span>
                    )
                }
            </span>

            <a class="font-size-medium" href={page.docsUrl}>
                View {page.chartTypeTitle.toLowerCase()} charts documentation
            </a>
        </h1>

        <GalleryExampleRunner title={page.name} name={page.slug} />

        <p set:html={page.description} />

        <div class="moreExamples">
            <GalleryExampleLink
                client:load
                className="galleryExample"
                label={prevExample.title}
                exampleName={prevExample.name}
            />

            <GalleryExampleLink
                client:load
                className="galleryExample"
                label={nextExample.title}
                exampleName={nextExample.name}
            />
        </div>
    </div>
</Layout>

<style lang="scss">
    @use '../../design-system' as *;

    .galleryExample {
        width: 24rem;
    }

    .page-margin {
        padding-top: $size-5;
        padding-bottom: $size-9;
    }

    h1 {
        display: flex;
        align-items: flex-end;
        justify-content: space-between;
    }

    .enterpriseIcon {
        --text-color: red;
        --icon-size: 28px;
    }

    .moreExamples {
        display: flex;
        gap: $size-2;
        justify-content: space-between;
        margin-top: $size-9;
    }

    .prevExample,
    .nextExample {
        width: min(28rem, 50%);
    }

    .dummyImage {
        width: 100%;
        aspect-ratio: 16 / 10;
        background-color: #ddd;
        border-radius: var(--border-radius);
    }
</style>
