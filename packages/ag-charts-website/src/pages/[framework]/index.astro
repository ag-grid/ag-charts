---
import { getDocsFrameworkPages } from '@features/docs/utils/pageData';
import { DOCS_FRAMEWORK_REDIRECT_PAGE } from '@features/docs/constants';
import { urlWithPrefix } from '@utils/urlWithPrefix';

export async function getStaticPaths() {
    return getDocsFrameworkPages();
}

const frameworkOverride = Astro.params.framework;
console.log(frameworkOverride);
---

<div id="redirectUrl" data-framework-override={frameworkOverride} data-redirect-url={DOCS_FRAMEWORK_REDIRECT_PAGE}>
</div>
<script>
    import { $internalFramework } from '@stores/frameworkStore';
    import { getFrameworkFromInternalFramework } from '@utils/framework';
    import { urlWithPrefix } from '@utils/urlWithPrefix';

    const data = document.getElementById('redirectUrl')?.dataset;
    const dataAttrFrameworkOverride = data.frameworkOverride;
    const dataAttrUrl = data.redirectUrl;
    const framework = dataAttrFrameworkOverride ?? getFrameworkFromInternalFramework($internalFramework.get());
    const redirectUrl = urlWithPrefix({ framework, url: dataAttrUrl });

    window.location.replace(redirectUrl);
</script>
