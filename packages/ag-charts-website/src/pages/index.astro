---
import Layout from '@layouts/Layout.astro';
import styles from '@pages-styles/homepage.module.scss';

import InstallText from '@features/homepage/components/InstallText';
import IndexGalleryExampleRunner from '@features/homepage/components/IndexGalleryExampleRunner.astro';
import { Snippet } from '@ag-website-shared/components/snippet/Snippet';

import { TabControl } from '@features/homepage/components/TabControl';
import { getGalleryExamples } from '@features/gallery/utils/filesData';
import { getEntry } from 'astro:content';
import { Icon } from '@ag-website-shared/components/icon/Icon';
import fwLogos from '@ag-website-shared/images/fw-logos';

import { AutomatedIntegratedChartsWrapper } from '@ag-website-shared/components/automated-examples/AutomatedIntegratedChartsWrapper';
import Faqs from '../features/homepage/components/faqs/Faqs';
import DropdownButton from '../features/homepage/components/ctas/DropdownButton';

import IndexDocsExampleRunner from '@features/homepage/components/IndexDocsExampleRunner.astro';
const { data: whatsNewData } = await getEntry('versions', 'ag-charts-versions');

// Fetch gallery data
const galleryEntry = await getEntry('gallery', 'data');
const galleryExamples = getGalleryExamples({ galleryData: galleryEntry.data });

// Prepare examples data for IndexGalleryExampleRunner
const seriesExampleMap = {
    bar: 'stacked-horizontal-bar',
    line: 'multiple-line-series-large-data',
    area: 'stacked-area',
    scatter: 'scatter-with-large-data',
    bubble: 'bubble-with-categories',
    pie: 'pie-with-variable-radius',
    donut: 'donut-with-variable-radius',
    combination: 'radar-line-radar-area-nightingale-combination',
};

// Prepare examples data for IndexGalleryExampleRunner
const enterpriseSeriesExampleMap = {
    'range-bar': 'horizontal-range-bar-with-labels',
    'range-area': 'range-area-with-labels',
    waterfall: 'customised-waterfall',
    'box-plot': 'multiple-box-plots',
    candlestick: 'ohlc',
    'radar-line': 'reversed-radar-with-markers',
    nightingale: 'reversed-nightingale',
    'radial-column': 'reversed-radial-column',
    'radial-bar': 'reversed-radial-bar',
    sunburst: 'sunburst-with-nesting',
    treemap: 'simple-treemap',
    heatmap: 'simple-heatmap',
    sankey: 'sankey',
    chord: 'chord',
    'bullet-chart': 'simple-bullet',
};

const exampleData = galleryEntry.data.series
    .flatMap((seriesGroup) => seriesGroup)
    .filter((series) => series.seriesName in seriesExampleMap)
    .map((series) => {
        const exampleName = seriesExampleMap[series.seriesName];
        const example = series.examples.find((ex) => ex.name === exampleName);
        return {
            title: example.title,
            exampleName: example.name,
            buttonText: series.title,
            icon: series.icon,
        };
    });

const enterpriseExampleData = galleryEntry.data.series
    .flatMap((seriesGroup) => seriesGroup)
    .filter((series) => series.seriesName in enterpriseSeriesExampleMap)
    .map((series) => {
        const exampleName = enterpriseSeriesExampleMap[series.seriesName];
        const example = series.examples.find((ex) => ex.name === exampleName);
        return {
            title: example.title,
            exampleName: example.name,
            buttonText: series.title,
            icon: series.icon,
        };
    });

/**
 * Version of `ag-grid-charts-enterprise` to use
 *
 * NOTE: Fix version so we can upgrade outside of grid/charts releases
 */
const AG_GRID_CHARTS_VERSION = '32.1.0';
const AG_GRID_CHARTS_CDN_URL = `https://cdn.jsdelivr.net/npm/ag-grid-charts-enterprise@${AG_GRID_CHARTS_VERSION}/dist/ag-grid-charts-enterprise.min.js`;
---

<script is:inline src={AG_GRID_CHARTS_CDN_URL}></script>

<Layout
    title="JavaScript Charts | High-Performance & Feature-Rich Charting Library - AG Charts"
    description="Create beautiful, high-performance JavaScript charts quickly with AG Charts. Free forever; upgrade to enterprise for advanced features and dedicated support."
>
    <div class:list={[styles.container]}>
        <div class={styles.section}>
            <div class:list={[styles.heroSectionInner, 'layout-max-width-small']}>
                <div class={styles.whatsNewTagContainer}>
                    <span class={styles.whatsNewVersion}>v{whatsNewData[0].version}</span>
                    <span class={styles.whatsNewText}>
                        {whatsNewData[0].highlightSummary}
                    </span>
                    <Icon svgClasses={[styles.whatsNewArrow]} name="arrowRight" />
                </div>
                <div class={styles.headingContainer}>
                    <h1>JavaScript Charts</h1>
                    <h2>High Performance, Feature Rich JavaScript Charting Library</h2>
                    <h3>
                        AG Charts is a high-performance JavaScript charting library that lets you create stunning
                        visualizations, including <a>bar</a>, <a>line</a>, <a>pie</a>, and <a>map</a> charts, within
                        minutes. <a>Get started</a> for free with essential features or <a>upgrade to Enterprise</a> for
                        advanced features, series types and dedicated support.
                    </h3>
                </div>
                <div class={styles.ctaContainer}>
                    <button>Get Started</button>
                    <!-- <DropdownButton client:load /> -->
                    <div class={styles.installCta}>
                        <InstallText client:load />
                    </div>
                </div>
                <img
                    class={styles.heroImage}
                    src="charts/images/readme-assets/gallery.gif"
                    alt="AG Charts Examples - JavaScript Bar, Line, Pie, and Map Charts"
                />
                <a href="./gallery" class={styles.galleryCta}
                    >JavaScript Charts Gallery <Icon svgClasses={[styles.whatsNewArrow]} name="arrowRight" />
                </a>
            </div>
        </div>
        <div class={styles.section}>
            <div class:list={[styles.communityFeaturesSectionInner, 'layout-max-width-small']}>
                <div class={styles.sectionHeaderContainer}>
                    <h2>React, Angular and Vue JavaScript Charting Libraries</h2>
                    <h3>Support for React, Angular and Vue</h3>
                </div>
                <div class={styles.frameworkButtonsContainer}>
                    <button class={styles.frameworkButton}>
                        <img class={styles.frameworkLogo} src={fwLogos['react']} alt={'alt'} />
                    </button>
                    <button class={styles.frameworkButton}>
                        <img class={styles.frameworkLogo} src={fwLogos['angular']} alt={'alt'} />
                    </button>
                    <button class={styles.frameworkButton}>
                        <img class={styles.frameworkLogo} src={fwLogos['vue']} alt={'alt'} />
                    </button>
                </div>
            </div>
        </div>
        <div class={styles.section}>
            <div class:list={[styles.communityFeaturesSectionInner, 'layout-max-width-small']}>
                <div class={styles.sectionHeaderContainer}>
                    <h2>Free JavaScript Charting Library - Quick & Easy Setup</h2>
                    <h3>Build Beautiful Charts in Minutes, for Free</h3>
                    <h4>
                        AG Charts Community supports multiple series types, customizable axes, real-time updates, and
                        accessibility features. Use it to create dynamic visualizations for data analysis, financial
                        reporting, and interactive dashboards.
                    </h4>
                </div>
                <IndexGalleryExampleRunner examples={exampleData} pageName={'bar'} />
            </div>
        </div>
        <div class={styles.section}>
            <div class:list={[styles.enterpriseFeaturesSectionInner, 'layout-max-width-small']}>
                <div class={styles.sectionHeaderContainer}>
                    <h2>Enterprise JavaScript Charts - Advanced Features & Support</h2>
                    <h3>Upgrade for Advanced Features, Series Types and Dedicated Enterprise Support</h3>
                    <h4>
                        Enterprise features include advanced chart types such as candlestick and OHLC for financial
                        data, multi-layered map visualizations, and integrated cross-chart interactions. Enjoy dedicated
                        enterprise support and continuous updates.
                    </h4>
                </div>
                <div class={styles.enterpriseFeaturesContainer}>
                    <IndexGalleryExampleRunner examples={enterpriseExampleData} pageName={'range-bar'} />
                    <div class={styles.cardContainer}>
                        <div class={styles.card}>
                            <h4>Interactivity</h4>
                            <p>Animations, Context Menu, Cross Hairs, Navigator, Synchronization, Zoom</p>
                        </div>
                        <div class={styles.card}>
                            <h4>Layout & Styling</h4>
                            <p>Add Error Bars & Background Images</p>
                        </div>
                        <div class={styles.card}>
                            <h4>Dedicated Support</h4>
                            <p>Access to AG Charts experts for support & guidance via Zendesk</p>
                        </div>
                    </div>
                </div>
                <!-- <div>
                    <b>Advanced Features</b>
                    <p>
                        Leverage advanced features like interactive zooming, cross-chart interactions, and advanced
                        annotations to enhance your data analysis capabilities.
                    </p>
                    <IndexDocsExampleRunner name={'../../vanilla/context-menu/examples/context-menu'} />
                </div> -->

                <div class={styles.ctaButton}>
                    <button>View Pricing</button>
                </div>

                <!-- <div class={styles.cardContainer}>
                    <div class={styles.card}>
                        <h4>Advanced Features</h4>
                        <p>
                            Unlock powerful tools for data visualization and analysis, including advanced annotations,
                            interactive zooming, and cross-chart interactions.
                        </p>
                        <button class={styles.learnMoreBtn}>Learn More</button>
                    </div>
                    <div class={styles.card}>
                        <h4>Additional Series Types</h4>
                        <p>
                            Access a wider range of chart types, including candlestick, OHLC, and multi-layered map
                            visualizations for comprehensive data representation.
                        </p>
                        <button class={styles.learnMoreBtn}>Learn More</button>
                    </div>
                    <div class={styles.card}>
                        <h4>Dedicated Support</h4>
                        <p>
                            Get priority assistance from our expert team, ensuring quick resolution of issues and
                            guidance for optimal chart implementation.
                        </p>
                        <button class={styles.learnMoreBtn}>Learn More</button>
                    </div>
                </div> -->

                <!-- <div class="tabs">
                    <div class="tab active" data-tab="content1">Additional Series Types</div>
                    <div class="tab" data-tab="content2">Advanced Features</div>
                </div>
                <div id="content1" class="tab-content">
                    <IndexGalleryExampleRunner
                        examples={enterpriseExampleData}
                        pageName={galleryExamples[0].page.chartSeriesName}
                        format="side"
                    />
                </div>
                <div id="content2" class="tab-content hidden">
                    <IndexDocsExampleRunner name={'../../vanilla/financial-charts/examples/financial-charts-showcase'} />
                </div> -->

                <!-- <TabControl client:load /> -->
            </div>
        </div>
        <div class={styles.section}>
            <div class:list={[styles.financialChartsSectionInner, 'layout-max-width-small']}>
                <div class={styles.sectionHeaderContainer}>
                    <h2>JavaScript Financial Charts - Create Trading Views in Minutes</h2>
                    <h3>Flexible, Interactive Financial Charts for Trading and Analysis</h3>
                    <h4>
                        Build interactive financial charts featuring advanced annotations with minimal configuration -
                        just provide your data. Use the toolbar in the example below to add annotations, change the
                        Series type, and interact with the data in real-time.
                    </h4>
                </div>
                <div>
                    <IndexDocsExampleRunner
                        name={'../../vanilla/financial-charts/examples/financial-charts-showcase'}
                    />
                </div>
                <!-- <div class={styles.twoColumnContainer}>
                    <div class={styles.columnSmall}>
                        <div class={styles.financialChartsFeaturesContainer}>
                            <p>
                                <b>Start in Seconds</b>
                                <ul>
                                    <li>
                                        Financial Charts come pre-configured with built-in features, simply provide your
                                        JSON data, and create the chart
                                    </li>
                                </ul>
                            </p>
                            <p>
                                <b>Drawings and Annotations</b>
                                <ul>
                                    <li>Add Trend Lines and Text Annotations from the toolbar for data analysis.</li>
                                </ul>
                            </p>
                            <p>
                                <b>Interactive Charts</b>
                                <ul>
                                    <li>Easily navigate time periods with advanced zoom & Range buttons</li>
                                </ul>
                            </p>
                            <p>
                                <b>Financial Chart types</b>
                                <ul>
                                    <li>Choose from 6 chart types, including OHLC, Line, and Candlestick</li>
                                </ul>
                            </p>
                        </div>
                    </div>
                    <div class={styles.columnLarge}>
                        <IndexDocsExampleRunner
                            name={'../../vanilla/financial-charts/examples/financial-charts-showcase'}
                        />
                    </div>
                </div> -->
                <div class={styles.ctaButton}>
                    <button>Learn More</button>
                </div>
            </div>
        </div>
        <div class={styles.section}>
            <div class:list={[styles.financialChartsSectionInner, 'layout-max-width-small']}>
                <div class={styles.sectionHeaderContainer}>
                    <h2>JavaScript Map Charts - Easily Visualise Geographical Data</h2>
                    <h3>Turn GeoJSON Data into Interactive Maps</h3>
                    <h4>
                        Visualise Geographical Areas, Overlay Routes & Connections, Add Markers & Points Of Interest
                    </h4>
                </div>
                <div class={styles.cardContainer}>
                    <div class={styles.card}>
                        <h4>Geographic Areas</h4>
                        <p>
                            Visualise data representing geographic areas such as countries, using colours to denote
                            distinct series or the magnitude of the values.
                        </p>
                        <IndexDocsExampleRunner name={'../../vanilla/map-shapes/examples/multiple-series/'} />
                    </div>
                    <div class={styles.card}>
                        <h4>Routes & Connections</h4>
                        <p>
                            Draw geographic lines, such as roads or flight paths, with the ability to vary width and
                            colour to represent data values.
                        </p>
                        <IndexDocsExampleRunner name={'../../vanilla/map-lines/examples/heatmap/'} />
                    </div>
                    <div class={styles.card}>
                        <h4>Makers & POIs</h4>
                        <p>
                            Add markers data for geographic points, with the ability to vary the size to represent data
                            values.
                        </p>
                        <IndexDocsExampleRunner name={'../../vanilla/map-markers/examples/marker-size/'} />
                    </div>
                </div>
                <div class={styles.ctaButton}>
                    <button>Learn More</button>
                </div>
            </div>
        </div>
        <div class={styles.section}>
            <div class:list={[styles.benchmarkSectionInner, 'layout-max-width-small']}>
                <div class={styles.sectionHeaderContainer}>
                    <h2>JavaScript Chart Performance Benchmarks - AG Charts vs. Competitors</h2>
                    <h3>Unbeatable Features, Uncompromised Performance</h3>
                    <h4>
                        AG Charts delivers unbeatable performance and unmatched features, outperforming competitors in
                        speed, efficiency & reliability.
                    </h4>
                </div>
                <span>TODO: Benchmark charts w/ Highcharts, etc...</span>
                <div class={styles.ctaButton}>
                    <button>Learn More</button>
                </div>
            </div>
        </div>
        <div class={styles.section}>
            <div class:list={[styles.benchmarkSectionInner, 'layout-max-width-small']}>
                <div class={styles.sectionHeaderContainer}>
                    <h2>Integrated JavaScript Charts</h2>
                    <h3>AG Grid Integrated Charts, powered by AG Charts</h3>
                    <h4>
                        AG Charts is powers the Integrated Charts feature in AG Grid - our market leading data grid
                        library which is used by 90% of the Fortune 500. Purchase an Enterprise Bundle License to access
                        all of the enterprise features in both AG Grid and AG Charts.
                    </h4>
                </div>
                <AutomatedIntegratedChartsWrapper client:visible />
            </div>
        </div>
        <div class={styles.section}>
            <div class:list={[styles.faqSectionInner, 'layout-max-width-small']}>
                <div class={styles.sectionHeaderContainer}>
                    <h2>FAQs</h2>
                    <h3>FAQs</h3>
                    <h4>Common questions...</h4>
                </div>
                <div>
                    <Faqs client:load />
                </div>
            </div>
        </div>
    </div>
</Layout>

<script>
    function switchTab(event, tabId) {
        const tabs = document.querySelectorAll('.tab');
        const contents = document.querySelectorAll('.tab-content');

        tabs.forEach((tab) => tab.classList.remove('active'));
        contents.forEach((content) => content.classList.add('hidden'));

        event.target.classList.add('active');
        document.getElementById(tabId).classList.remove('hidden');
    }

    document.querySelectorAll('.tab').forEach((tab) => {
        tab.addEventListener('click', (event) => {
            switchTab(event, event.target.dataset.tab);
        });
    });
</script>

<style>
    .tabs {
        display: flex;
        cursor: pointer;
        justify-content: center;
        margin-top: 2rem;
    }

    .tab {
        flex: 1;
        padding: 10px 20px;
        border: 1px solid #ddd;
        border-radius: 5px 5px 0 0;
        border-bottom: none;
        background-color: var(--color-bg-disabled_subtle);
        transition: background-color 0.3s;
        text-align: center;
    }

    .tab.active {
        background-color: white;
        border-bottom: 1px solid white;
        font-weight: bold;
        color: var(--color-brand-400);
    }

    .tab-content {
        border: 1px solid #ddd;
        border-top: none;
        padding: 20px;
        background-color: white;
        margin-bottom: 2rem;
    }

    .hidden {
        display: none;
    }
</style>
