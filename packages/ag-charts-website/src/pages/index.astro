---
import { getEntry } from 'astro:content';
import Layout from '@layouts/Layout.astro';
import { FrameworkSelector } from '../components/framework-selector/FrameworkSelector';
import { Icon } from '@components/icon/Icon';
import type { GalleryData } from '@ag-grid-types';
import { GalleryExampleImage } from '@features/gallery/components/GalleryExampleImage';
import { pathJoin } from '@utils/pathJoin';
import { SITE_BASE_URL } from '@constants';
import { getCacheBustingUrl, getChartEnterpriseScriptPath, getChartScriptPath } from '@utils/chartLibraryPaths';
import { urlWithPrefix } from '@utils/urlWithPrefix';
import styles from './homepage.module.scss';
import { ReactComponent as GridLogoType } from '@images/inline-svgs/ag-grid-logotype.svg';
import { ReactComponent as GridLogoMark } from '@images/inline-svgs/ag-grid-logomark.svg';

const frameworksData = [
    {
        name: 'react',
        url: urlWithPrefix({
            framework: 'react',
            url: './',
        }),
    },
    {
        name: 'angular',
        url: urlWithPrefix({
            framework: 'angular',
            url: './',
        }),
    },
    {
        name: 'vue',
        url: urlWithPrefix({
            framework: 'vue',
            url: './',
        }),
    },
    {
        name: 'javascript',
        url: urlWithPrefix({
            framework: 'javascript',
            url: './',
        }),
    },
];

const galleryDataEntry = await getEntry('gallery', 'data');
const galleryData: GalleryData = galleryDataEntry?.data;
const series = galleryData.series.flat();

const modifiedTimeMs = Date.now();
const siteUrl = Astro.site ? pathJoin(Astro.site, SITE_BASE_URL) : '/';
const chartScriptPath = getCacheBustingUrl(getChartScriptPath(siteUrl), modifiedTimeMs);
const chartScriptEnterprisePath = getCacheBustingUrl(getChartEnterpriseScriptPath(siteUrl), modifiedTimeMs);

const isEnterprise = true;
---

<Layout>
    <script src={chartScriptPath}></script>
    {isEnterprise && <script src={chartScriptEnterprisePath} />}

    <div class={styles.homepageHero}>
        <div class:list={[styles.heroInner, 'page-margin']}>
            <div class={styles.heroHeadings}>
                <h1 class="font-size-extra-large">The Best JavaScript Charts in the World</h1>
                <h2 class="font-size-medium normal-weight-text">
                    The professional choice for developers building enterprise applications
                </h2>
                <a href="/gallery" class="button">See the charts <Icon name="chevronRight" /></a>
            </div>

            <div class={styles.galleryScroller}></div>
        </div>
    </div>

    <div class={styles.homepageFrameworks}>
        <div class:list={[styles.frameworksInner, 'page-margin']}>
            <span class:list={[styles.frameworksLabel, 'text-secondary']}>Get&nbsp;started</span>
            <FrameworkSelector data={frameworksData} isFullWidth />
        </div>
    </div>

    <div class={styles.homepageBenefits}>
        <div class:list={[styles.benefitsInner, 'page-margin']}>
            <video src="videos/chart-features.mp4" muted autoplay loop></video>
            <div class={styles.benefitsCopy}>
                <h2>Charts Charts Charts</h2>
                <p class="font-size-large">
                    Atque voluptatem odio molestiae aut possimus quis eum nam. Et qui ipsam reprehenderit est sed itaque
                    accusamus est. Optio est ipsa pariatur et libero earum debitis dicta dolores. Facere quia dolorum ut
                    officiis ea libero nesciunt cumque et. Autem sit totam et nihil sequi incidunt et. Voluptas
                    reiciendis eos recusandae quam provident quae molestiae.
                </p>
            </div>
        </div>
    </div>

    <div class={styles.homepageGrid}>
        <div class:list={[styles.gridInner, 'page-margin']}>
            <div class={styles.gridCopy}>
                <div class={styles.agGridLogo}>
                    <GridLogoType />
                    <GridLogoMark />
                </div>
                <!-- Dummy copy, to be reviewed -->
                <p class="font-size-large">
                    See how <a href="https://ag-grid.com/"><b>AG Grid</b></a> uses <b>AG Charts</b> to provide a seamless
                    <a href="https://ag-grid.com/javascript-data-grid/integrated-charts/">Integrated Charting</a>
                    experience from within the grid.
                </p>
            </div>
            <div class={styles.gridExample}>
                <img
                    class={styles.gridExampleLight}
                    src="images/integrated-charts-light.png"
                    alt="AG Charts & AG Grid - integrated charts"
                />
                <img
                    class={styles.gridExampleDark}
                    src="images/integrated-charts-dark.png"
                    alt="AG Charts & AG Grid - integrated charts"
                />
            </div>
        </div>
    </div>
</Layout>
