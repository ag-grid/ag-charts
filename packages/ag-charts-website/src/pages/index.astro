---
import Layout from '@layouts/Layout.astro';
import styles from '@pages-styles/homepage.module.scss';

import InstallText from '@features/homepage/components/InstallText';
import IndexGalleryExampleRunner from '@features/homepage/components/IndexGalleryExampleRunner.astro';

import GalleryExampleRunner from '@features/gallery/components/GalleryExampleRunner.astro';
import { getGalleryExamples } from '@features/gallery/utils/filesData';
import { getEntry } from 'astro:content';
import { Icon } from '@ag-website-shared/components/icon/Icon';
import { AutomatedIntegratedChartsWrapper } from '@ag-website-shared/components/automated-examples/AutomatedIntegratedChartsWrapper';

import { FreeChartsExamples } from '@features/homepage/components/FreeChartsExamples';
import { DocsExampleRunner } from '@features/docs/components/DocsExampleRunner';
const { data: whatsNewData } = await getEntry('versions', 'ag-charts-versions');

// Fetch gallery data
const galleryEntry = await getEntry('gallery', 'data');
const galleryExamples = getGalleryExamples({ galleryData: galleryEntry.data });

// Prepare examples data for IndexGalleryExampleRunner
const seriesExampleMap = {
    bar: 'stacked-horizontal-bar',
    line: 'multiple-line-series-large-data',
    area: 'stacked-area',
    scatter: 'scatter-with-large-data',
    bubble: 'bubble-with-categories',
    pie: 'pie-with-variable-radius',
    donut: 'donut-with-variable-radius',
};

const exampleData = galleryEntry.data.series
    .flatMap((seriesGroup) => seriesGroup)
    .filter((series) => series.seriesName in seriesExampleMap)
    .map((series) => {
        const exampleName = seriesExampleMap[series.seriesName];
        const example = series.examples.find((ex) => ex.name === exampleName);
        return {
            title: example.title,
            exampleName: example.name,
            buttonText: series.title,
        };
    });

/**
 * Version of `ag-grid-charts-enterprise` to use
 *
 * NOTE: Fix version so we can upgrade outside of grid/charts releases
 */
const AG_GRID_CHARTS_VERSION = '32.1.0';
const AG_GRID_CHARTS_CDN_URL = `https://cdn.jsdelivr.net/npm/ag-grid-charts-enterprise@${AG_GRID_CHARTS_VERSION}/dist/ag-grid-charts-enterprise.min.js`;
---

<script is:inline src={AG_GRID_CHARTS_CDN_URL}></script>

<Layout
    title="JavaScript Charts | High-Performance & Feature-Rich Charting Library - AG Charts"
    description="Create beautiful, high-performance JavaScript charts quickly with AG Charts. Free forever; upgrade to enterprise for advanced features and dedicated support."
>
    <div class:list={[styles.container]}>
        <div class={styles.section}>
            <div class:list={[styles.heroSectionInner, 'layout-max-width-small']}>
                <div class={styles.whatsNewTagContainer}>
                    <span class={styles.whatsNewVersion}>v10.1.0</span>
                    <span class={styles.whatsNewText}>
                        {whatsNewData[0].highlightSummary}
                    </span>
                    <Icon svgClasses={[styles.whatsNewArrow]} name="arrowRight" />
                </div>
                <div class={styles.headingContainer}>
                    <h1>JavaScript Charts</h1>
                    <h2>High Performance, Feature Rich JavaScript Charting Library</h2>
                    <h3>
                        AG Charts is a high-performance JavaScript charting library that lets you create stunning
                        visualizations, including <a>bar</a>, <a>line</a>, <a>pie</a>, and <a>map</a> charts, within
                        minutes. <a>Get started</a> for free with essential features or <a>upgrade to Enterprise</a> for
                        advanced features, series types and dedicated support.
                    </h3>
                </div>
                <div class={styles.ctaContainer}>
                    <button aria-label="Get Started with Free JavaScript Charts">Get Started</button>
                    <div class={styles.installCta}>
                        <InstallText client:load />
                    </div>
                </div>
                <img
                    class={styles.heroImage}
                    src="charts/images/readme-assets/gallery.gif"
                    alt="AG Charts Examples - JavaScript Bar, Line, Pie, and Map Charts"
                />
                <a href="./gallery" class={styles.galleryCta}
                    >JavaScript Charts Gallery <Icon svgClasses={[styles.whatsNewArrow]} name="arrowRight" />
                </a>
            </div>
        </div>
        <div class={styles.section}>
            <div class:list={[styles.communityFeaturesSectionInner, 'layout-max-width-small']}>
                <div class={styles.sectionHeaderContainer}>
                    <h2>Free JavaScript Charting Library - Quick & Easy Setup</h2>
                    <h3>Build Beautiful Charts in Minutes, for Free</h3>
                    <h4>
                        AG Charts Community supports multiple series types, customizable axes, real-time updates, and
                        accessibility features. Use it to create dynamic visualizations for data analysis, financial
                        reporting, and interactive dashboards.
                    </h4>
                </div>
                <IndexGalleryExampleRunner examples={exampleData} pageName={galleryExamples[0].page.chartSeriesName} />
            </div>
        </div>
        <div class={styles.section}>
            <div class:list={[styles.enterpriseFeaturesSectionInner, 'layout-max-width-small']}>
                <div class={styles.sectionHeaderContainer}>
                    <h2>Enterprise JavaScript Charts - Advanced Features & Support</h2>
                    <h3>Upgrade for Advanced Features, Series Types and Dedicated Enterprise Support</h3>
                    <h4>
                        Enterprise features include advanced chart types such as candlestick and OHLC for financial
                        data, multi-layered map visualizations, and integrated cross-chart interactions. Enjoy dedicated
                        enterprise support and continuous updates.
                    </h4>
                </div>
                <div class={styles.twoColumnContainer}>
                    <div class={styles.column}>
                        <h4>Financial JavaScript Charts</h4>
                        <h5>
                            Build interactive financial charts featuring advanced annotations with minimal
                            configuration.
                        </h5>
                    </div>
                    <div class={styles.column}>
                        <DocsExampleRunner
                            client:only="react"
                            title={'Financial Charts Showcase'}
                            name={'financial-charts-showcase'}
                            exampleType={'generated'}
                            framework={'react'}
                            pageName={'financial-charts'}
                        />
                    </div>
                </div>
                <div class={styles.twoColumnContainer}>
                    <div class={styles.column}>
                        <DocsExampleRunner
                            client:only="react"
                            title={'World Map with Colour Scale'}
                            name={'world-colour-map'}
                            exampleType={'generated'}
                            framework={'react'}
                            pageName={'maps'}
                        />
                    </div>
                    <div class={styles.column}>
                        <h4>JavaScript Map Charts</h4>
                        <h5>Visualise geographic data...</h5>
                    </div>
                </div>
            </div>
        </div>
        <div class={styles.section}>
            <div class:list={[styles.benchmarkSectionInner, 'layout-max-width-small']}>
                <div class={styles.sectionHeaderContainer}>
                    <h2>JavaScript Chart Performance Benchmarks - AG Charts vs. Competitors</h2>
                    <h3>Unbeatable Features, Uncompromised Performance</h3>
                    <h4>
                        AG Charts delivers unbeatable performance and unmatched features, outperforming competitors in
                        speed, efficiency & reliability.
                    </h4>
                </div>
                <span>TODO: Benchmark charts w/ Highcharts, etc...</span>
            </div>
        </div>
        <div class={styles.section}>
            <div class:list={[styles.benchmarkSectionInner, 'layout-max-width-small']}>
                <div class={styles.sectionHeaderContainer}>
                    <h2>Integrated JavaScript Charts</h2>
                    <h3>AG Grid Integrated Charts, powered by AG Charts</h3>
                    <h4>AG Charts powers integrated charts...</h4>
                </div>
                <AutomatedIntegratedChartsWrapper client:visible />
            </div>
        </div>
    </div>
</Layout>
