var my=Object.defineProperty,fy=Object.getOwnPropertyDescriptor,d=(t,e,i,o)=>{for(var s=o>1?void 0:o?fy(e,i):e,a=t.length-1,n;a>=0;a--)(n=t[a])&&(s=(o?n(e,i,s):n(s))||s);return o&&s&&my(e,i,s),s};import{AgCharts as xy,time as Sy}from"ag-charts-community";import{_ModuleSupport as gs}from"ag-charts-community";import{_ModuleSupport as My,_Scale as by,_Util as Dy}from"ag-charts-community";function nn(t,e,i){const o=(a,n,r,l)=>{let c=t[0];for(let h=a;r>0?h<=n:h>n;h+=r){const p=t[h];if(l(c,p))return!0;c=p}return!1},s=Math.floor(t.length/2);return o(e,s,e,i)?!0:o(t.length-e,s,-e,i)}import{_ModuleSupport as Ny}from"ag-charts-community";var{OR:vy,POSITIVE_NUMBER:Iy,NAN:Ay,AxisInterval:Ty,Validate:ky}=Ny,rn=class extends Ty{constructor(){super(...arguments),this.minSpacing=NaN}};d([ky(vy(Iy,Ay))],rn.prototype,"minSpacing",2);import{_ModuleSupport as ln,_Scene as fc,_Util as Oy}from"ag-charts-community";import{_ModuleSupport as Ly,_Scale as xc,_Scene as Ey,_Util as Ry}from"ag-charts-community";import{_ModuleSupport as _y,_Scene as Cy,_Util as wy}from"ag-charts-community";var{ChartAxisDirection:Py,Layers:cn,ARRAY:By,BOOLEAN:hn,COLOR_STRING:dn,FONT_STYLE:zy,FONT_WEIGHT:Vy,LINE_DASH:Fy,NUMBER:Sc,POSITIVE_NUMBER:Uy,RATIO:Mc,STRING:bc,UNION:Hy,AND:Ky,Validate:xt,MATCHING_CROSSLINE_TYPE:Dc}=_y,{Group:Nc}=Cy,{createId:Gy}=wy,le=class{constructor(){this.enabled=void 0,this.text=void 0,this.fontStyle=void 0,this.fontWeight=void 0,this.fontSize=14,this.fontFamily="Verdana, sans-serif",this.padding=5,this.color="rgba(87, 87, 87, 1)",this.parallel=void 0}};d([xt(hn,{optional:!0})],le.prototype,"enabled",2),d([xt(bc,{optional:!0})],le.prototype,"text",2),d([xt(zy,{optional:!0})],le.prototype,"fontStyle",2),d([xt(Vy,{optional:!0})],le.prototype,"fontWeight",2),d([xt(Uy)],le.prototype,"fontSize",2),d([xt(bc)],le.prototype,"fontFamily",2),d([xt(Sc)],le.prototype,"padding",2),d([xt(dn,{optional:!0})],le.prototype,"color",2),d([xt(hn,{optional:!0})],le.prototype,"parallel",2);var Wt=class pc{constructor(){this.id=Gy(this),this.enabled=void 0,this.type=void 0,this.range=void 0,this.value=void 0,this.fill=void 0,this.fillOpacity=void 0,this.stroke=void 0,this.strokeWidth=void 0,this.strokeOpacity=void 0,this.lineDash=void 0,this.shape="polygon",this.label=new le,this.scale=void 0,this.clippedRange=[-1/0,1/0],this.gridLength=0,this.sideFlag=-1,this.parallelFlipRotation=0,this.regularFlipRotation=0,this.direction=Py.X,this.axisInnerRadius=0,this.axisOuterRadius=0,this.group=new Nc({name:`${this.id}`,layer:!0,zIndex:pc.LINE_LAYER_ZINDEX}),this.labelGroup=new Nc({name:`${this.id}`,layer:!0,zIndex:pc.LABEL_LAYER_ZINDEX})}setSectorNodeProps(e){e.fill=this.fill,e.fillOpacity=this.fillOpacity??1,e.stroke=this.stroke,e.strokeOpacity=this.strokeOpacity??1,e.strokeWidth=this.strokeWidth??1,e.lineDash=this.lineDash}setLabelNodeProps(e,i,o,s,a){const{label:n}=this;e.x=i,e.y=o,e.text=n.text,e.textAlign="center",e.textBaseline=s,e.rotation=a,e.rotationCenterX=i,e.rotationCenterY=o,e.fill=n.color,e.fontFamily=n.fontFamily,e.fontSize=n.fontSize,e.fontStyle=n.fontStyle,e.visible=!0}calculateLayout(e){}};Wt.LINE_LAYER_ZINDEX=cn.SERIES_CROSSLINE_LINE_ZINDEX,Wt.RANGE_LAYER_ZINDEX=cn.SERIES_CROSSLINE_RANGE_ZINDEX,Wt.LABEL_LAYER_ZINDEX=cn.SERIES_LABEL_ZINDEX,d([xt(hn,{optional:!0})],Wt.prototype,"enabled",2),d([xt(Hy(["range","line"],"a crossLine type"),{optional:!0})],Wt.prototype,"type",2),d([xt(Ky(Dc("range"),By.restrict({length:2})),{optional:!0})],Wt.prototype,"range",2),d([xt(Dc("value"),{optional:!0})],Wt.prototype,"value",2),d([xt(dn,{optional:!0})],Wt.prototype,"fill",2),d([xt(Mc,{optional:!0})],Wt.prototype,"fillOpacity",2),d([xt(dn,{optional:!0})],Wt.prototype,"stroke",2),d([xt(Sc,{optional:!0})],Wt.prototype,"strokeWidth",2),d([xt(Mc,{optional:!0})],Wt.prototype,"strokeOpacity",2),d([xt(Fy,{optional:!0})],Wt.prototype,"lineDash",2);var vc=Wt,{ChartAxisDirection:Wy,validateCrossLineValues:jy}=Ly,{Path:Ic,Sector:Yy,Text:Xy}=Ey,{normalizeAngle360:pn,isNumberEqual:Ac}=Ry,Tc=class sn extends vc{constructor(){super(),this.direction=Wy.X,this.polygonNode=new Ic,this.sectorNode=new Yy,this.lineNode=new Ic,this.labelNode=new Xy,this.group.append(this.polygonNode),this.group.append(this.sectorNode),this.group.append(this.lineNode),this.labelGroup.append(this.labelNode)}update(e){const{scale:i,shape:o,type:s,value:a,range:n}=this;if(!i||!s||!jy(s,a,n,i)){this.group.visible=!1,this.labelGroup.visible=!1;return}this.group.visible=e,this.labelGroup.visible=e,s==="line"&&o==="circle"&&i instanceof xc.BandScale&&(this.type="range",this.range=[a,a]),this.updateLineNode(e),this.updatePolygonNode(e),this.updateSectorNode(e),this.updateLabelNode(e)}updateLineNode(e){const{scale:i,type:o,value:s,lineNode:a}=this;let n;if(!e||o!=="line"||!i||isNaN(n=i.convert(s))){a.visible=!1;return}const{axisInnerRadius:r,axisOuterRadius:l}=this;a.visible=!0,a.stroke=this.stroke,a.strokeOpacity=this.strokeOpacity??1,a.strokeWidth=this.strokeWidth??1,a.fill=void 0,a.lineDash=this.lineDash;const c=l*Math.cos(n),h=l*Math.sin(n),p=r*Math.cos(n),u=r*Math.sin(n);a.path.clear(!0),a.path.moveTo(p,u),a.path.lineTo(c,h),this.group.zIndex=sn.LINE_LAYER_ZINDEX}updatePolygonNode(e){const{polygonNode:i,range:o,scale:s,shape:a,type:n}=this;let r;if(!e||n!=="range"||a!=="polygon"||!s||!o||!(r=s.ticks?.())){i.visible=!1;return}const{axisInnerRadius:l,axisOuterRadius:c}=this,h=r.indexOf(o[0]),p=r.indexOf(o[1]),m=(h<=p?r.slice(h,p+1):r.slice(h).concat(r.slice(0,p+1))).map(y=>s.convert(y));i.visible=!0,this.setSectorNodeProps(i);const{path:g}=i;g.clear(!0),m.forEach((y,f)=>{const M=c*Math.cos(y),b=c*Math.sin(y);f===0?g.moveTo(M,b):g.lineTo(M,b)}),l===0?g.lineTo(0,0):m.slice().reverse().forEach(y=>{const f=l*Math.cos(y),M=l*Math.sin(y);g.lineTo(f,M)}),i.path.closePath(),this.group.zIndex=sn.RANGE_LAYER_ZINDEX}updateSectorNode(e){const{sectorNode:i,range:o,scale:s,shape:a,type:n}=this;if(!e||n!=="range"||a!=="circle"||!s||!o){i.visible=!1;return}const{axisInnerRadius:r,axisOuterRadius:l}=this,c=o.map(u=>s.convert(u)),h=s.step??0,p=s instanceof xc.BandScale?h/2:0;i.visible=!0,this.setSectorNodeProps(i),i.centerX=0,i.centerY=0,i.innerRadius=r,i.outerRadius=l,i.startAngle=c[0]-p,i.endAngle=c[1]+p,this.group.zIndex=sn.RANGE_LAYER_ZINDEX}updateLabelNode(e){const{label:i,labelNode:o,range:s,scale:a,type:n}=this;if(!e||i.enabled===!1||!i.text||!a||n==="range"&&!s){o.visible=!0;return}const{axisInnerRadius:r,axisOuterRadius:l}=this;let c,h,p,u;if(n==="line"){const m=pn(a.convert(this.value)),g=1.5*Math.PI,y=Ac(m,g)||m>g||m<Math.PI/2,f=(r+l)/2*Math.cos(m),M=(r+l)/2*Math.sin(m);c=f+i.padding*Math.cos(m+Math.PI/2),h=M+i.padding*Math.sin(m+Math.PI/2),u=y?"top":"bottom",p=y?m:m-Math.PI}else{const[m,g]=s.map(S=>pn(a.convert(S)));let y=(m+g)/2;m>g&&(y-=Math.PI),y=pn(y);const f=(Ac(y,0)||y>0)&&y<Math.PI;let M;const b=a.ticks?.()??[];this.shape==="circle"||b.length<3?M=l-i.padding:M=l*Math.cos(Math.PI/b.length)-i.padding,c=M*Math.cos(y),h=M*Math.sin(y),u=f?"bottom":"top",p=f?y-Math.PI/2:y+Math.PI/2}this.setLabelNodeProps(o,c,h,u,p)}};Tc.className="AngleCrossLine";var kc=Tc,{AND:Zy,assignJsonApplyConstructedArray:Qy,ChartAxisDirection:$y,GREATER_THAN:qy,NUMBER:Oc,UNION:Jy,ProxyOnWrite:tm,Validate:un}=ln,{Path:em,Text:Lc}=fc,{angleBetween:im,isNumberEqual:$i,toRadians:gn,normalizeAngle360:qi}=Oy,yn=class extends ln.AxisLabel{constructor(){super(...arguments),this.orientation="fixed"}};d([un(Jy(["fixed","parallel","perpendicular"],"a label orientation"))],yn.prototype,"orientation",2);var ys=class extends ln.PolarAxis{constructor(t,e){super(t,e),this.startAngle=0,this.endAngle=void 0,this.labelData=[],this.tickData=[],this.radiusLine=this.axisGroup.appendChild(new em),this.computeRange=()=>{const i=qi(-Math.PI/2+gn(this.startAngle));let o=this.endAngle==null?i+Math.PI*2:-Math.PI/2+gn(this.endAngle);o<i&&(o+=2*Math.PI),this.range=[i,o]},this.includeInvisibleDomains=!0}get direction(){return $y.X}assignCrossLineArrayConstructor(t){Qy(t,kc)}createLabel(){return new yn}update(){return this.updateScale(),this.updatePosition(),this.updateGridLines(),this.updateTickLines(),this.updateLabels(),this.updateRadiusLine(),this.updateCrossLines(),this.tickData.length}calculateAvailableRange(){const{range:t,gridLength:e}=this;return im(t[0],t[1])*e}updatePosition(){const{translation:t,axisGroup:e,gridGroup:i,crossLineGroup:o}=this,s=Math.floor(t.x),a=Math.floor(t.y);e.translationX=s,e.translationY=a,i.translationX=s,i.translationY=a,o.translationX=s,o.translationY=a}updateRadiusLine(){const t=this.radiusLine,{path:e}=t;e.clear(!0);const{points:i,closePath:o}=this.getAxisLinePoints();i.forEach(({x:s,y:a,moveTo:n,arc:r,radius:l=0,startAngle:c=0,endAngle:h=0})=>{r?e.arc(s,a,l,c,h):n?e.moveTo(s,a):e.lineTo(s,a)}),o&&e.closePath(),t.visible=this.line.enabled,t.stroke=this.line.stroke,t.strokeWidth=this.line.width,t.fill=void 0}getAxisLinePoints(){const{scale:t,shape:e,gridLength:i}=this,[o,s]=this.range,a=$i(s-o,2*Math.PI),n=[];if(e==="circle")a?(n.push({x:i,y:0,moveTo:!0}),n.push({x:0,y:0,radius:i,startAngle:0,endAngle:2*Math.PI,arc:!0,moveTo:!1})):(n.push({x:i*Math.cos(o),y:i*Math.sin(o),moveTo:!0}),n.push({x:0,y:0,radius:i,startAngle:qi(o),endAngle:qi(s),arc:!0,moveTo:!1}));else if(e==="polygon"){const r=(t.ticks?.()??[]).map(l=>t.convert(l));r.length>2&&r.forEach((l,c)=>{const h=i*Math.cos(l),p=i*Math.sin(l),u=c===0;n.push({x:h,y:p,moveTo:u})})}return{points:n,closePath:a}}updateGridLines(){const{scale:t,gridLength:e,gridLine:{enabled:i,style:o,width:s},innerRadiusRatio:a}=this;if(!(o&&e>0))return;const n=this.tickData,r=e*a,l=o.length,c=h=>h.value;this.gridLineGroupSelection.update(i?n:[],void 0,c).each((h,p,u)=>{const{value:m}=p,{stroke:g,lineDash:y}=o[u%l],f=t.convert(m);h.x1=r*Math.cos(f),h.y1=r*Math.sin(f),h.x2=e*Math.cos(f),h.y2=e*Math.sin(f),h.stroke=g,h.strokeWidth=s,h.lineDash=y,h.fill=void 0}),this.gridLineGroupSelection.cleanup()}updateLabels(){const{label:t,tickLabelGroupSelection:e}=this,i=this.tickData;e.update(t.enabled?i:[]).each((o,s,a)=>{const n=this.labelData[a];if(!n||n.hidden){o.visible=!1;return}o.text=n.text,o.setFont(t),o.fill=t.color,o.x=n.x,o.y=n.y,o.textAlign=n.textAlign,o.textBaseline=n.textBaseline,o.visible=!0,n.rotation?(o.rotation=n.rotation,o.rotationCenterX=n.x,o.rotationCenterY=n.y):o.rotation=0})}updateTickLines(){const{scale:t,gridLength:e,tick:i,tickLineGroupSelection:o}=this,s=this.tickData;o.update(i.enabled?s:[]).each((a,n)=>{const{value:r}=n,l=t.convert(r),c=Math.cos(l),h=Math.sin(l);a.x1=e*c,a.y1=e*h,a.x2=(e+i.size)*c,a.y2=(e+i.size)*h,a.stroke=i.stroke,a.strokeWidth=i.width})}createLabelNodeData(t,e,i){const{label:o,gridLength:s,scale:a,tick:n}=this;if(!o.enabled)return[];const r=new Lc,l=i.x-this.translation.x,c=i.x+i.width-this.translation.x,h=t.map((p,u)=>{const{value:m}=p,g=s+o.padding+n.size,y=a.convert(m),f=Math.cos(y),M=Math.sin(y),b=g*f,S=g*M,{textAlign:x,textBaseline:N}=this.getLabelAlign(y),v=u===t.length-1&&m!==t[0]&&$i(qi(y),qi(a.convert(t[0]))),D=this.getLabelRotation(y);let I=String(m);if(o.formatter){const{callbackCache:k}=this.moduleCtx;I=k.call(o.formatter,{value:m,index:u})??""}r.text=I,r.x=b,r.y=S,r.setFont(o),r.textAlign=x,r.textBaseline=N,r.rotation=D,D&&(r.rotationCenterX=b,r.rotationCenterY=S);let A=D?r.computeTransformedBBox():r.computeBBox();if(A&&e.hideWhenNecessary&&!D){const k=l-A.x,L=A.x+A.width-c,O=1;if(k>O||L>O){const T=A.width-Math.max(k,L);I=Lc.wrap(I,T,1/0,o,"never"),I==="\u2026"&&(I=""),r.text=I,A=r.computeBBox()}}return{text:I,x:b,y:S,textAlign:x,textBaseline:N,hidden:I===""||p.hidden||v,rotation:D,box:A}});return o.avoidCollisions&&this.avoidLabelCollisions(h),h}computeLabelsBBox(t,e){this.tickData=this.generateAngleTicks(),this.labelData=this.createLabelNodeData(this.tickData,t,e);const i=this.labelData.map(({box:o})=>o).filter(o=>o!=null);return!this.label.enabled||i.length===0?null:fc.BBox.merge(i)}getLabelOrientation(){const{label:t}=this;return t instanceof yn?t.orientation:"fixed"}getLabelRotation(t){let e=gn(this.label.rotation??0);t=qi(t);const i=this.getLabelOrientation();return i==="parallel"?(e+=t,t>=0&&t<Math.PI?e-=Math.PI/2:e+=Math.PI/2):i==="perpendicular"&&(e+=t,t>=Math.PI/2&&t<1.5*Math.PI&&(e+=Math.PI)),e}getLabelAlign(t){const e=Math.cos(t),i=Math.sin(t);let o,s;const a=this.getLabelOrientation(),n=$i(e,0),r=$i(i,0),l=$i(e,1),c=$i(i,-1),h=e>0&&!n,p=i>0&&!r;return a==="parallel"?(o="center",s=l&&r||p?"top":"bottom"):a==="perpendicular"?(o=c||h?"left":"right",s="middle"):(o="right",n?o="center":h&&(o="left"),s="bottom",r?s="middle":p&&(s="top")),{textAlign:o,textBaseline:s}}updateCrossLines(){this.crossLines?.forEach(t=>{if(t instanceof kc){const{shape:e,gridLength:i,innerRadiusRatio:o}=this;t.shape=e,t.axisOuterRadius=i,t.axisInnerRadius=i*o}}),super.updateCrossLines({rotation:0,parallelFlipRotation:0,regularFlipRotation:0})}};d([tm("rotation"),un(Oc.restrict({min:0,max:360}))],ys.prototype,"startAngle",2),d([un(Zy(Oc.restrict({min:0,max:720}),qy("startAngle")),{optional:!0})],ys.prototype,"endAngle",2);var{RATIO:Ec,OBJECT:om,Validate:mn}=My,{BandScale:sm}=by,{isNumberEqual:Rc}=Dy,xi=class extends ys{constructor(t){super(t,new sm),this.groupPaddingInner=0,this.paddingInner=0,this.interval=new rn}generateAngleTicks(){const{scale:t,gridLength:e}=this,{values:i,minSpacing:o}=this.interval,s=i??t.ticks()??[];if(s.length<2||isNaN(o))return s.map(c=>({value:c,visible:!0}));const a=s[0],n=t.convert(a),r=e*Math.cos(n),l=e*Math.sin(n);for(let c=1;c<s.length-1;c++){const h=s[c],p=t.convert(h);if(p-n>Math.PI)break;const u=e*Math.cos(p),m=e*Math.sin(p);if(Math.sqrt((u-r)**2+(m-l)**2)>o){const y=new Set([a]);return nn(s,c,(f,M)=>{y.add(M)}),s.map(f=>{const M=y.has(f);return{value:f,visible:M}})}}return[{value:a,visible:!0}]}avoidLabelCollisions(t){let{minSpacing:e}=this.label;if(Number.isFinite(e)||(e=0),t.length<3)return;const i=(l,c)=>{if(l.hidden||c.hidden)return!1;const h=l.box.clone().grow(e/2),p=c.box.clone().grow(e/2);return h.collidesBBox(p)},o=t[0],s=t.at(-1),a=new Set([o]),n=Rc(o.x,s.x)&&Rc(o.y,s.y),r=Math.floor(t.length/2);for(let l=1;l<=r;l++){const c=n?t.slice(0,-1):t;if(!nn(c,l,i)){nn(c,l,(p,u)=>{a.add(u)});break}}t.forEach(l=>{a.has(l)||(l.hidden=!0,l.box=void 0)})}};xi.className="AngleCategoryAxis",xi.type="angle-category",d([mn(Ec)],xi.prototype,"groupPaddingInner",2),d([mn(Ec)],xi.prototype,"paddingInner",2),d([mn(om)],xi.prototype,"interval",2);var am={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"angle-category",instanceConstructor:xi};import{_ModuleSupport as nm,_Util as rm}from"ag-charts-community";import{_Scale as lm,_Util as cm}from"ag-charts-community";var{LinearScale:hm,Invalidating:dm}=lm,{isNumberEqual:pm,range:_c,isDenseInterval:um}=cm,Cc=class extends hm{constructor(){super(...arguments),this.arcLength=0,this.niceTickStep=0}ticks(){if(!this.domain||this.domain.length<2||this.domain.some(s=>!isFinite(s))||this.arcLength<=0)return[];this.refresh();const{interval:t}=this,[e,i]=this.getDomain();if(t){const s=Math.abs(t),a=this.getPixelRange();if(!um((i-e)/s,a))return _c(e,i,s)}const o=this.nice&&this.niceTickStep?this.niceTickStep:this.getTickStep(e,i);return _c(e,i,o)}hasNiceRange(){const t=this.range.slice().sort((i,o)=>i-o);return[Math.PI,2*Math.PI].some(i=>pm(i,t[1]-t[0]))}getNiceStepAndTickCount(){const[t,e]=this.niceDomain;let i=this.getTickStep(t,e);const o=isNaN(this.maxTickCount)?1/0:this.maxTickCount,s=Math.abs(e-t)/i;let a=Math.pow(2,Math.ceil(Math.log(s)/Math.log(2)));return a>o&&(a/=2,i*=2),{count:a,step:i}}updateNiceDomain(){if(super.updateNiceDomain(),!this.hasNiceRange())return;const t=this.niceDomain[0]>this.niceDomain[1],e=t?this.niceDomain[1]:this.niceDomain[0],{step:i,count:o}=this.getNiceStepAndTickCount(),s=1/i,a=i>=1?Math.ceil(e/i+o)*i:Math.ceil((e+o*i)*s)/s;this.niceDomain=t?[a,e]:[e,a],this.niceTickStep=i}getPixelRange(){return this.arcLength}};d([dm],Cc.prototype,"arcLength",2);var{AND:wc,Default:Pc,GREATER_THAN:gm,LESS_THAN:ym,NUMBER_OR_NAN:Bc,OBJECT:mm,Validate:fn}=nm,{angleBetween:fm,isNumberEqual:zc,normalisedExtentWithMetadata:xm}=rm,Ji=class extends ys{constructor(t){super(t,new Cc),this.shape="circle",this.min=NaN,this.max=NaN,this.interval=new rn}normaliseDataDomain(t){const{min:e,max:i}=this,{extent:o,clipped:s}=xm(t,e,i);return{domain:o,clipped:s}}getRangeArcLength(){const{range:t}=this,e=Math.min(...t),i=Math.max(...t),o=fm(e,i)||2*Math.PI,s=this.gridLength;return o*s}generateAngleTicks(){const t=this.getRangeArcLength(),{scale:e,range:i}=this,{values:o,minSpacing:s,maxSpacing:a}=this.interval,n=a?Math.floor(t/a):1,r=s?Math.floor(t/s):1/0,l=Math.floor(4/Math.PI*Math.abs(i[0]-i[1]));return e.tickCount=Math.max(n,Math.min(r,l)),e.minTickCount=n,e.maxTickCount=r,e.arcLength=t,(o??e.ticks()).map(h=>({value:h,visible:!0}))}avoidLabelCollisions(t){let{minSpacing:e}=this.label;Number.isFinite(e)||(e=0);const i=(a,n)=>{if(a.hidden||n.hidden)return!1;const r=a.box.clone().grow(e/2),l=n.box.clone().grow(e/2);return r.collidesBBox(l)},o=t[0],s=t.at(-1);o!==s&&zc(o.x,s.x)&&zc(o.y,s.y)&&(s.hidden=!0);for(let a=1;a<t.length;a*=2){let n=!1;for(let r=a;r<t.length;r+=a){const l=t[r],c=t[r-a];if(i(c,l)){n=!0;break}}if(!n){t.forEach((r,l)=>{l%a>0&&(r.hidden=!0,r.box=void 0)});return}}t.forEach((a,n)=>{n>0&&(a.hidden=!0,a.box=void 0)})}};Ji.className="AngleNumberAxis",Ji.type="angle-number",d([fn(wc(Bc,ym("max"))),Pc(NaN)],Ji.prototype,"min",2),d([fn(wc(Bc,gm("min"))),Pc(NaN)],Ji.prototype,"max",2),d([fn(mm)],Ji.prototype,"interval",2);var Sm={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"angle-number",instanceConstructor:Ji};import{_ModuleSupport as Vc,_Scale as Mm}from"ag-charts-community";var{OrdinalTimeScale:bm}=Mm,{dateToNumber:xn}=Vc,Sn=class extends Vc.CategoryAxis{constructor(t){super(t,new bm)}normaliseDataDomain(t){const e=[],i=new Set;for(let o of t){typeof o=="number"&&(o=new Date(o));const s=xn(o);i.has(s)||(i.add(s),e.push(o))}return e.sort((o,s)=>xn(o)-xn(s)),{domain:e,clipped:!1}}onFormatChange(t,e,i,o){o?super.onFormatChange(t,e,i,o):this.labelFormatter=this.scale.tickFormat({ticks:t,domain:i})}};Sn.className="OrdinalTimeAxis",Sn.type="ordinal-time";var Dm={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"ordinal-time",instanceConstructor:Sn};import{_ModuleSupport as Nm,_Scale as vm}from"ag-charts-community";import{_ModuleSupport as Mn,_Scene as Im,_Util as Am}from"ag-charts-community";import{_ModuleSupport as Tm,_Scale as Fc,_Scene as km,_Util as bn}from"ag-charts-community";var{ChartAxisDirection:Om,Validate:Lm,DEGREE:Em,validateCrossLineValues:Rm}=Tm,{Path:_m,Sector:Cm,Text:wm}=km,{normalizeAngle360:Pm,toRadians:Bm,isNumberEqual:zm}=bn,Uc=class extends le{constructor(){super(...arguments),this.positionAngle=void 0}};d([Lm(Em,{optional:!0})],Uc.prototype,"positionAngle",2);var Hc=class uc extends vc{constructor(){super(),this.direction=Om.Y,this.label=new Uc,this.polygonNode=new _m,this.sectorNode=new Cm,this.labelNode=new wm,this.outerRadius=0,this.innerRadius=0,this.group.append(this.polygonNode),this.group.append(this.sectorNode),this.labelGroup.append(this.labelNode)}update(e){const{scale:i,type:o,value:s,range:a}=this;if(!i||!o||!Rm(o,s,a,i)){this.group.visible=!1,this.labelGroup.visible=!1;return}o==="line"&&i instanceof Fc.BandScale&&(this.type="range",this.range=[s,s]),this.updateRadii();const{innerRadius:n,outerRadius:r}=this;e&&(e=n>=this.axisInnerRadius&&r<=this.axisOuterRadius),this.group.visible=e,this.labelGroup.visible=e,this.updatePolygonNode(e),this.updateSectorNode(e),this.updateLabelNode(e),this.group.zIndex=this.type==="line"?uc.LINE_LAYER_ZINDEX:uc.RANGE_LAYER_ZINDEX}updateRadii(){const{range:e,scale:i,type:o,axisInnerRadius:s,axisOuterRadius:a}=this;if(!i)return{innerRadius:0,outerRadius:0};const n=c=>a+s-c;let r=0,l=0;if(o==="line")r=n(i.convert(this.value)),l=r;else{const c=Math.abs(i?.bandwidth??0),h=e.map(p=>i.convert(p));r=n(Math.max(...h)),l=n(Math.min(...h))+c}this.outerRadius=r,this.innerRadius=l}drawPolygon(e,i,o){i.forEach((s,a)=>{const n=e*Math.cos(s),r=e*Math.sin(s);a===0?o.path.moveTo(n,r):o.path.lineTo(n,r)}),o.path.closePath()}updatePolygonNode(e){const{gridAngles:i,polygonNode:o,scale:s,shape:a,type:n,innerRadius:r,outerRadius:l}=this;if(!e||a!=="polygon"||!s||!i){o.visible=!1;return}o.visible=!0;const c=this.getPadding();o.path.clear(!0),this.drawPolygon(l-c,i,o);const h=i.slice().reverse(),p=n==="line"?l-c:r+c;this.drawPolygon(p,h,o),this.setSectorNodeProps(o)}updateSectorNode(e){const{axisInnerRadius:i,axisOuterRadius:o,scale:s,sectorNode:a,shape:n,innerRadius:r,outerRadius:l}=this;if(!e||n!=="circle"||!s){a.visible=!1;return}a.visible=!0,a.startAngle=0,a.endAngle=2*Math.PI;const c=this.getPadding();a.innerRadius=bn.clamp(i,r+c,o),a.outerRadius=bn.clamp(i,l-c,o),this.setSectorNodeProps(a)}updateLabelNode(e){const{innerRadius:i,label:o,labelNode:s,scale:a,shape:n,type:r}=this;if(!e||o.enabled===!1||!o.text||!a){s.visible=!1;return}const l=Pm(Bm((o.positionAngle??0)-90)),c=(zm(l,0)||l>0)&&l<Math.PI,h=c?l-Math.PI/2:l+Math.PI/2;let p=0;const u=this.gridAngles??[];r==="line"?p=i+o.padding:n==="circle"||u.length<3?p=i-o.padding:p=i*Math.cos(Math.PI/u.length)-o.padding;const m=p*Math.cos(l),g=p*Math.sin(l);let y;r==="line"?y=c?"top":"bottom":y=c?"bottom":"top",this.setLabelNodeProps(s,m,g,y,h)}getPadding(){const{scale:e}=this;if(!e)return 0;const i=Math.abs(e.bandwidth??0),o=Math.abs(e.step??0);return e instanceof Fc.BandScale?(o-i)/2:0}};Hc.className="RadiusCrossLine";var Kc=Hc,{assignJsonApplyConstructedArray:Vm,ChartAxisDirection:Fm,Default:Um,Layers:Hm,DEGREE:Gc,BOOLEAN:Km,Validate:Dn}=Mn,{Caption:Gm,Group:Wm,Path:jm,Selection:Ym}=Im,{isNumberEqual:Xm,normalizeAngle360:Wc,toRadians:Zm}=Am,Nn=class extends Mn.AxisLabel{constructor(){super(...arguments),this.autoRotateAngle=335}};d([Dn(Km,{optional:!0})],Nn.prototype,"autoRotate",2),d([Dn(Gc)],Nn.prototype,"autoRotateAngle",2);var vn=class extends Mn.PolarAxis{constructor(t,e){super(t,e),this.positionAngle=0,this.gridPathGroup=this.gridGroup.appendChild(new Wm({name:`${this.id}-gridPaths`,zIndex:Hm.AXIS_GRID_ZINDEX})),this.gridPathSelection=Ym.select(this.gridPathGroup,jm)}get direction(){return Fm.Y}assignCrossLineArrayConstructor(t){Vm(t,Kc)}getAxisTransform(){const t=this.scale.range[0],{translation:e,positionAngle:i,innerRadiusRatio:o}=this,s=t*o,a=Zm(i);return{translationX:e.x,translationY:e.y-t-s,rotation:a,rotationCenterX:0,rotationCenterY:t+s}}updateSelections(t,e,i){super.updateSelections(t,e,i);const{gridLine:{enabled:o,style:s,width:a},shape:n}=this;if(!s)return;const r=this.prepareTickData(e),l=s.length,c=(y,f)=>{const{stroke:M,lineDash:b}=s[f%l];y.stroke=M,y.strokeWidth=a,y.lineDash=b,y.fill=void 0},[h,p]=this.gridRange??[0,2*Math.PI],u=Xm(p-h,2*Math.PI),m=(y,f)=>{const{path:M}=y;M.clear(!0);const b=this.getTickRadius(f);u?(M.moveTo(b,0),M.arc(0,0,b,0,2*Math.PI)):(M.moveTo(b*Math.cos(h),b*Math.sin(h)),M.arc(0,0,b,Wc(h),Wc(p))),u&&M.closePath()},g=(y,f)=>{const{path:M}=y,b=this.gridAngles;if(M.clear(!0),!b||b.length<3)return;const S=this.getTickRadius(f);b.forEach((x,N)=>{const v=S*Math.cos(x),D=S*Math.sin(x);N===0?M.moveTo(v,D):M.lineTo(v,D),b.forEach((I,A)=>{const k=S*Math.cos(I),L=S*Math.sin(I);A===0?M.moveTo(k,L):M.lineTo(k,L)}),M.closePath()}),M.closePath()};this.gridPathSelection.update(o?r:[]).each((y,f,M)=>{c(y,M),n==="circle"?m(y,f):g(y,f)})}updateTitle(){const t=l=>l.defaultValue,{title:e,_titleCaption:i,range:o,moduleCtx:{callbackCache:s}}=this,{formatter:a=t}=this.title??{};if(!e){i.enabled=!1;return}i.enabled=e.enabled,i.fontFamily=e.fontFamily,i.fontSize=e.fontSize,i.fontStyle=e.fontStyle,i.fontWeight=e.fontWeight,i.color=e.color,i.wrapping=e.wrapping;let n=!1;const r=i.node;e.enabled&&(n=!0,r.rotation=Math.PI/2,r.x=Math.floor((o[0]+o[1])/2),r.y=-Gm.SMALL_PADDING,r.textAlign="center",r.textBaseline="bottom",r.text=s.call(a,this.getTitleFormatterParams())),r.visible=n}updateCrossLines(){this.crossLines?.forEach(t=>{if(t instanceof Kc){const{shape:e,gridAngles:i,range:o,innerRadiusRatio:s}=this,a=o[0];t.shape=e,t.gridAngles=i,t.axisOuterRadius=a,t.axisInnerRadius=a*s}}),super.updateCrossLines({rotation:0,parallelFlipRotation:0,regularFlipRotation:0})}createLabel(){return new Nn}};d([Dn(Gc),Um(0)],vn.prototype,"positionAngle",2);var{RATIO:In,ProxyPropertyOnWrite:jc,Validate:An}=Nm,{BandScale:Yc}=vm,Si=class extends vn{constructor(t){super(t,new Yc),this.shape="circle",this.groupPaddingInner=0,this.paddingInner=0,this.paddingOuter=0}prepareTickData(t){return t.slice().reverse()}getTickRadius(t){const{scale:e,innerRadiusRatio:i}=this,o=e.range[0],s=o*i;if(e instanceof Yc){const a=e.ticks(),n=a.length-1-a.indexOf(t.tickId);return n===0?s:e.inset+e.step*(n-.5)+e.bandwidth/2}else{const a=(o-s)/e.domain.length;return o-t.translationY+s-a/2}}};Si.className="RadiusCategoryAxis",Si.type="radius-category",d([An(In)],Si.prototype,"groupPaddingInner",2),d([jc("scale","paddingInner"),An(In)],Si.prototype,"paddingInner",2),d([jc("scale","paddingOuter"),An(In)],Si.prototype,"paddingOuter",2);var Qm={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radius-category",instanceConstructor:Si};import{_ModuleSupport as $m,_Scale as qm,_Util as Jm}from"ag-charts-community";var{AND:Xc,Default:Zc,GREATER_THAN:tf,LESS_THAN:ef,NUMBER_OR_NAN:Qc,Validate:$c}=$m,{LinearScale:of}=qm,{normalisedExtentWithMetadata:sf}=Jm,_o=class extends vn{constructor(t){super(t,new of),this.shape="polygon",this.min=NaN,this.max=NaN}prepareTickData(t){const{scale:e}=this,i=e.getDomain?.()[1];return t.filter(({tick:o})=>o!==i).sort((o,s)=>s.tick-o.tick)}getTickRadius(t){const{scale:e}=this,i=e.range[0],o=i*this.innerRadiusRatio;return i-t.translationY+o}normaliseDataDomain(t){const{min:e,max:i}=this,{extent:o,clipped:s}=sf(t,e,i);return{domain:o,clipped:s}}};_o.className="RadiusNumberAxis",_o.type="radius-number",d([$c(Xc(Qc,ef("max"))),Zc(NaN)],_o.prototype,"min",2),d([$c(Xc(Qc,tf("min"))),Zc(NaN)],_o.prototype,"max",2);var af={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radius-number",instanceConstructor:_o};import{_ModuleSupport as qc}from"ag-charts-community";var{BOOLEAN:nf,POSITIVE_NUMBER:rf,ObserveChanges:Jc,Validate:th}=qc,Tn=class extends qc.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!0,t.animationManager.skip(!1)}};d([Jc((t,e)=>{t.ctx.animationManager.skip(!e)}),th(nf)],Tn.prototype,"enabled",2),d([Jc((t,e)=>{t.ctx.animationManager.defaultDuration=e}),th(rf,{optional:!0})],Tn.prototype,"duration",2);var lf={type:"root",optionsKey:"animation",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion"],instanceConstructor:Tn,themeTemplate:{animation:{enabled:!0}}};import{_Theme as Rt}from"ag-charts-community";import{_ModuleSupport as ms,_Scene as kn,_Util as On}from"ag-charts-community";import{_ModuleSupport as cf}from"ag-charts-community";var{ChartAxisDirection:hf}=cf;function df({x:t,y:e,labelBBox:i,bounds:o,axisPosition:s,axisDirection:a,padding:n}){let r;if(a===hf.X){const c=-i.width/2,h=s==="bottom"?-4:-i.height+4,p=s==="bottom"?o.y+o.height+n:o.y-n;r={x:t+c,y:p+h}}else{const c=-i.height/2,h=s==="right"?-8:-i.width+8;r={x:(s==="right"?o.x+o.width+n:o.x-n)+h,y:e+c}}return r}function eh(t,e,i){const o=t.clone();return o.x+=e==="left"?-i:0,o.y+=e==="top"?-i:0,o.width+=e==="left"||e==="right"?i:0,o.height+=e==="top"||e==="bottom"?i:0,o}import{_ModuleSupport as ih,_Util as pf}from"ag-charts-community";var uf=`.ag-charts-color-picker{position:absolute;display:flex;flex-direction:column;width:190px;padding:8px;border:var(--ag-charts-toolbar-border);color:var(--ag-charts-toolbar-foreground-color);background:var(--ag-charts-toolbar-background-color);border-radius:4px;z-index:99999;--h:0;--s:0;--v:0;--a:0;--color:#000;--color-a:#000;--thumb-size:18px;--inner-width:172px;--track-height:12px;--palette-height:136px;--checker:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="4" height="4"><rect x="0" y="0" width="4" height="4" fill="%23fff"/><path d="M0 0H2V4H4V2H0Z" fill="%23b2b2b2"/></svg>')}.ag-charts-color-picker__palette{position:relative;width:100%;height:var(--palette-height);margin-bottom:8px;background:linear-gradient(to bottom,#0000,#000),linear-gradient(to right,#fff,#fff0) hsl(var(--h),100%,50%);border-radius:6px;box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__palette::after{content:'';position:absolute;display:block;top:calc(var(--thumb-size) * -0.5 + (1 - var(--v)) * 100%);left:calc(var(--thumb-size) * -0.5 + var(--s) * 100%);background:var(--color);width:var(--thumb-size);height:var(--thumb-size);border-radius:99px;box-shadow:var(--box-shadow);--box-shadow:inset 0 0 0 3px white,inset 0 0 1px 3px #0006,0 0 5px #00000038}.ag-charts-color-picker__palette:focus-visible::after{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),0 0 0 2px #fff8,var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__hue-input,
.ag-charts-color-picker__alpha-input{-webkit-appearance:none;display:block;position:relative;padding:0;margin:0 calc(var(--inset) * -1);border:0;height:var(--thumb-size);width:auto;background:transparent;--inset:calc((var(--thumb-size) - var(--track-height)) / 2)}.ag-charts-color-picker__hue-input::-webkit-slider-thumb,
.ag-charts-color-picker__alpha-input::-webkit-slider-thumb{-webkit-appearance:none;width:var(--thumb-size);height:var(--thumb-size);border-radius:99px;box-shadow:var(--box-shadow);--box-shadow:inset 0 0 0 3px white,inset 0 0 1px 3px #0006,0 0 5px #00000038;transform:translate3d(0,0,0)}.ag-charts-color-picker__hue-input::-webkit-slider-thumb{background:hsl(var(--h),100%,50%)}.ag-charts-color-picker__alpha-input::-webkit-slider-thumb{background:transparent}.ag-charts-color-picker__alpha-input--opaque::-webkit-slider-thumb{background:var(--color)}.ag-charts-color-picker__hue-input:focus-visible::-webkit-slider-thumb,
.ag-charts-color-picker__alpha-input:focus-visible::-webkit-slider-thumb{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__hue-input::before,
.ag-charts-color-picker__alpha-input::before{position:absolute;content:'';display:block;top:calc(50% - var(--track-height) / 2);left:var(--inset);right:var(--inset);height:var(--track-height);border-radius:99px;box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__hue-input{margin-bottom:4px}.ag-charts-color-picker__hue-input::before{background:linear-gradient(to right,#f00,#f00 calc((100% - var(--track-height)) * 0 / 6 + var(--track-height) / 2),#ff0 calc((100% - var(--track-height)) * 1 / 6 + var(--track-height) / 2),#0f0 calc((100% - var(--track-height)) * 2 / 6 + var(--track-height) / 2),#0ff calc((100% - var(--track-height)) * 3 / 6 + var(--track-height) / 2),#00f calc((100% - var(--track-height)) * 4 / 6 + var(--track-height) / 2),#f0f calc((100% - var(--track-height)) * 5 / 6 + var(--track-height) / 2),#f00 calc((100% - var(--track-height)) * 6 / 6 + var(--track-height) / 2))}.ag-charts-color-picker__alpha-input{margin-bottom:7px}.ag-charts-color-picker__alpha-input::before{background:linear-gradient(to right,transparent,var(--color)),var(--checker) top left /4px 4px}.ag-charts-color-picker__color-field{display:flex;border:var(--ag-charts-border);background:var(--ag-charts-background-color);border-radius:4px;overflow:hidden}.ag-charts-color-picker__color-field:has(:focus-visible){border-color:var(--ag-charts-active-color);box-shadow:var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__color-label{width:16px;height:16px;margin:7px 0px 7px 7px;color:transparent;background:linear-gradient(to right,var(--color-a),var(--color-a)),var(--checker) top left /4px 4px;border-radius:2px;box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__color-input{flex:1;min-width:0;padding:7px 7px 7px 8px;border:0;margin:0;color:inherit;background:transparent;font-variant:tabular-nums}.ag-charts-color-picker__color-input:focus-visible{border:none;outline:none}`,gf='<div class="ag-charts-color-picker"><div class="ag-charts-color-picker__palette" tabindex="0"></div><input class="ag-charts-color-picker__hue-input" tabindex="0" type="range" min="0" max="360" value="0"> <input class="ag-charts-color-picker__alpha-input" tabindex="0" type="range" min="0" max="1" value="1" step="0.01"> <label class="ag-charts-color-picker__color-field"><span class="ag-charts-color-picker__color-label">Color</span> <input class="ag-charts-color-picker__color-input" tabindex="0" value="#000"></label></div>',{clamp:fs,createElement:yf}=ih,{Color:oh}=pf,xs="color-picker",Ln="canvas-overlay",sh=t=>{try{const e=oh.fromString(t),[i,o,s]=e.toHSB();return[i,o,s,e.a]}catch{return}},mf=class extends ih.BaseModuleInstance{constructor(t){super(),this.ctx=t,t.domManager.addStyles(xs,uf),this.element=t.domManager.addChild(Ln,xs),this.destroyFns.push(()=>t.domManager.removeChild(Ln,xs))}show(t){let[e,i,o,s]=sh(t.color??"#f00")??[0,1,.5,1];const a=yf("div");a.innerHTML=gf,this.element.replaceChildren(a);const n=a.firstElementChild,r=n.querySelector(".ag-charts-color-picker__palette"),l=n.querySelector(".ag-charts-color-picker__hue-input"),c=n.querySelector(".ag-charts-color-picker__alpha-input"),h=n.querySelector(".ag-charts-color-picker__color-input");this.anchor&&this.setAnchor(this.anchor,this.fallbackAnchor);const p=()=>{const g=oh.fromHSB(e,i,o,s).toHexString();n.style.setProperty("--h",`${e}`),n.style.setProperty("--s",`${i}`),n.style.setProperty("--v",`${o}`),n.style.setProperty("--a",`${s}`),n.style.setProperty("--color",g.slice(0,7)),n.style.setProperty("--color-a",g),l.value=`${e}`,c.value=`${s}`,c.classList.toggle("ag-charts-color-picker__alpha-input--opaque",s===1),document.activeElement!==h&&(h.value=g.toUpperCase()),t.onChange?.(g)};p();const u=m=>{m.preventDefault();const g=m.currentTarget;g.focus();const y=g.getBoundingClientRect(),f=({pageX:M,pageY:b})=>{i=Math.min(Math.max((M-y.left)/y.width,0),1),o=1-Math.min(Math.max((b-y.top)/y.height,0),1),p()};f(m),window.addEventListener("mousemove",f),window.addEventListener("mouseup",()=>window.removeEventListener("mousemove",f),{once:!0})};n.addEventListener("mousedown",m=>{m.stopPropagation()}),n.addEventListener("keydown",m=>{switch(m.stopPropagation(),m.key){case"Enter":case"Escape":t.onClose?.();break;default:return}m.preventDefault()}),r.addEventListener("mousedown",u),r.addEventListener("keydown",m=>{if(m.key==="ArrowLeft")i=Math.min(Math.max(i-.01),1);else if(m.key==="ArrowRight")i=Math.min(Math.max(i+.01),1);else if(m.key==="ArrowUp")o=Math.min(Math.max(o+.01),1);else if(m.key==="ArrowDown")o=Math.min(Math.max(o-.01),1);else return;m.preventDefault(),p()}),l.addEventListener("input",m=>{e=m.currentTarget.valueAsNumber??0,p()}),c.addEventListener("input",m=>{s=m.currentTarget.valueAsNumber??0,p()}),h.addEventListener("input",m=>{const g=sh(m.currentTarget.value);g!=null&&([e,i,o,s]=g,p())}),h.addEventListener("blur",()=>p()),h.addEventListener("keydown",m=>{m.key==="Enter"&&(m.currentTarget.blur(),p())})}setAnchor(t,e){this.anchor=t,this.fallbackAnchor=e;const i=this.element.firstElementChild?.firstElementChild;i&&(this.updatePosition(i,t.x,t.y),this.repositionWithinBounds(i,t,e))}hide(){this.element.replaceChildren()}isChildElement(t){return this.ctx.domManager.isManagedChildDOMElement(t,Ln,xs)}updatePosition(t,e,i){t.style.setProperty("top","unset"),t.style.setProperty("bottom","unset"),t.style.setProperty("left",`${e}px`),t.style.setProperty("top",`${i}px`)}repositionWithinBounds(t,e,i){const o=this.ctx.domManager.getBoundingClientRect(),{offsetWidth:s,offsetHeight:a}=t;let n=fs(0,e.x,o.width-s),r=fs(0,e.y,o.height-a);n!==e.x&&i?.x!=null&&(n=fs(0,i.x-s,o.width-s)),r!==e.y&&i?.y!=null&&(r=fs(0,i.y-a,o.height-a)),this.updatePosition(t,n,r)}};import"ag-charts-community";var ah=(t=>(t.Line="line",t.DisjointChannel="disjoint-channel",t.ParallelChannel="parallel-channel",t.HorizontalLine="horizontal-line",t.VerticalLine="vertical-line",t))(ah||{}),l2=Object.values(ah),En=["line","disjoint-channel","parallel-channel","horizontal-line","vertical-line"];function ff(t){switch(t){case"line":return"line";case"horizontal-line":return"horizontal-line";case"vertical-line":return"vertical-line";case"disjoint-channel":return"disjoint-channel";case"parallel-channel":return"parallel-channel"}}import{_Util as xf}from"ag-charts-community";var{Logger:Rn}=xf;function Co(t,e,i){let o=!0;return o&&(o=xe(t,e.start,i&&`${i}[start] `)),o&&(o=xe(t,e.end,i&&`${i}[end] `)),o}function nh(t,e,i){const o=e.direction==="horizontal"?t.yAxis:t.xAxis,s=_n(e.value,o);return!s&&i&&Rn.warnOnce(`${i}is outside the axis domain, ignoring. - value: [${e.value}]]`),s}function xe(t,e,i){if(e.x==null||e.y==null)return i&&Rn.warnOnce(`${i}requires both an [x] and [y] property, ignoring.`),!1;const o=_n(e.x,t.xAxis),s=_n(e.y,t.yAxis);if(!o||!s){let a="x & y domains";return o&&(a="y domain"),s&&(a="x domain"),i&&Rn.warnOnce(`${i}is outside the ${a}, ignoring. - x: [${e.x}], y: ${e.y}]`),!1}return!0}function _n(t,e){const i=e.scaleDomain();return i&&e.continuous?t>=i[0]&&t<=i.at(-1):!0}function Cn(t,e){if(t.start==null||t.end==null)return;const i=Se(t.start,e),o=Se(t.end,e);if(!(i==null||o==null))return{x1:i.x,y1:i.y,x2:o.x,y2:o.y}}function Se(t,e){const i=to(t.x,e.xAxis),o=to(t.y,e.yAxis);return{x:i,y:o}}function to(t,e){if(t==null)return 0;const i=(e.scaleBandwidth()??0)/2;return e.scaleConvert(t)+i}function ce(t,e){const i=Ss(t.x,e.xAxis),o=Ss(t.y,e.yAxis);return{x:i,y:o}}function Ss(t,e){const i=(e.scaleBandwidth()??0)/2;return e.continuous?e.scaleInvert(t-i):e.scaleInvertNearest(t-i)}function wn(t){return t.gridPadding+t.seriesAreaPadding+t.tickSize+t.label.padding}import{_ModuleSupport as rh}from"ag-charts-community";var{BaseModuleInstance:Sf,InteractionState:lh,Validate:Mf,BOOLEAN:bf,createElement:Df,REGIONS:Nf,ChartAxisDirection:vf}=rh,Ze="ag-charts-annotations__axis-button",ch=class extends Sf{constructor(t,e,i,o){super(),this.ctx=t,this.axisCtx=e,this.onButtonClick=i,this.seriesRect=o,this.enabled=!0,this.snap=!1,this.padding=0;const{button:s,wrapper:a}=this.setup();this.wrapper=a,this.button=s,this.toggleVisibility(!1),this.updateButtonElement(),this.snap=e.scaleBandwidth()>0;const n=this.ctx.regionManager.getRegion(Nf.SERIES),r=lh.Default|lh.Annotations;this.destroyFns.push(n.addListener("hover",l=>this.onMouseMove(l),r),n.addListener("drag",l=>this.onMouseMove(l),r),n.addListener("leave",()=>this.onLeave()),()=>this.destroyElements(),()=>this.wrapper.remove(),()=>this.button.remove())}update(t,e){this.seriesRect=t,this.padding=e}setup(){const t=this.ctx.domManager.addChild("canvas-overlay",`${Ze}-${this.axisCtx.axisId}`);t.classList.add(`${Ze}-wrapper`);const e=Df("button");return e.classList.add(Ze),t.appendChild(e),{wrapper:t,button:e}}destroyElements(){this.ctx.domManager.removeChild("canvas-overlay",Ze)}onMouseMove(t){if(!this.enabled)return;this.toggleVisibility(!0);const e=this.getButtonCoordinates({x:t.offsetX,y:t.offsetY});this.coords=this.getAxisCoordinates(e),this.updatePosition(e)}onLeave(){this.toggleVisibility(!1)}getButtonCoordinates({x:t,y:e}){const{axisCtx:{direction:i,position:o},seriesRect:s,snap:a,axisCtx:n,padding:r}=this,{clientWidth:l,clientHeight:c}=this.button,[h,p]=[s.y,s.y+s.height],[u,m]=[s.x,s.x+s.width];if(a&&(t=to(Ss(t-s.x,n),n)+s.x,e=to(Ss(e-s.y,n),n)+s.y),i===vf.X){const y=c-Math.max(0,r-5);t=t-l/2,e=o==="top"?h-c+y:p-y}else{const y=l-Math.max(0,r-9);t=o==="left"?u-l+y:m-y,e=e-c/2}return{x:t,y:e}}getAxisCoordinates(t){const{seriesRect:e}=this,{clientWidth:i,clientHeight:o}=this.button,s=t.x-e.x+i/2,a=t.y-e.y+o/2;return{x:s,y:a}}toggleVisibility(t){const{button:e}=this;if(e==null)return;const i=this.enabled&&t;this.toggleClass("-hidden",!i)}toggleClass(t,e){this.wrapper.classList.toggle(`${Ze}-wrapper-${t}`,e)}updatePosition({x:t,y:e}){this.wrapper.style.transform=`translate(${Math.round(t)}px, ${Math.round(e)}px)`}updateButtonElement(){const{button:t}=this;t.onclick=rh.makeAccessibleClickListener(t,()=>this.onButtonClick(this.coords)),t.innerHTML=`<span class="ag-charts-icon-crossline-add-line ${Ze}-icon"></span>`}};d([Mf(bf)],ch.prototype,"enabled",2);var If=".ag-charts-annotations__axis-button-wrapper{position:absolute;left:0px;top:0px;user-select:none;font:16px Verdana,sans-serif;overflow:hidden;white-space:nowrap;z-index:var(--ag-charts-layer-annotations);box-sizing:border-box}.ag-charts-annotations__axis-button-wrapper--hidden{display:none}.ag-charts-annotations__axis-button{cursor:pointer;padding:2px;border:none;border-radius:2px;line-height:16px;background-color:var(--ag-charts-axis-label-background-color);color:var(--ag-charts-axis-label-color)}.ag-charts-annotations__axis-button-icon{height:1.2em;width:1.2em}.ag-charts-annotations__axis-button:hover{opacity:0.8;color:var(--ag-charts-axis-label-color)}";import{_ModuleSupport as Af}from"ag-charts-community";import{_ModuleSupport as Tf,_Util as kf}from"ag-charts-community";var{BOOLEAN:wo,COLOR_STRING:Pn,DATE:hh,LINE_DASH:Of,NUMBER:Po,RATIO:dh,STRING:Bn,OBJECT:Bo,FUNCTION:Lf,TEXT_ALIGN:Ef,FONT_STYLE:Rf,FONT_WEIGHT:_f,POSITIVE_NUMBER:zn,OR:ph,UNION:uh,BaseProperties:zo,Validate:Z}=Tf,Ms=class extends zo{};d([Z(ph(Bn,Po,hh))],Ms.prototype,"x",2),d([Z(Po)],Ms.prototype,"y",2);var Cf=class extends Hn(zo){},wf=class extends Qe($e(xh(zo))){},Pf=class extends Qe($e(Hn(zo))){},Vn=class extends Qe($e(Hn(zf(zo)))){constructor(){super(...arguments),this.cornerRadius=2}};d([Z(wo)],Vn.prototype,"enabled",2),d([Z(zn)],Vn.prototype,"cornerRadius",2);function Vo(t,e){class i extends Bf(xh(e)){constructor(){super(...arguments),this.id=kf.uuid()}isValidWithContext(s,a){return super.isValid(a)}}return i}function Fn(t){class e extends t{constructor(){super(...arguments),this.start=new Ms,this.end=new Ms}}return d([Z(Bo)],e.prototype,"start",2),d([Z(Bo)],e.prototype,"end",2),e}function gh(t){class e extends t{}return d([Z(ph(Bn,Po,hh))],e.prototype,"value",2),e}function yh(t){class e extends t{constructor(){super(...arguments),this.background=new Cf}}return d([Z(Bo,{optional:!0})],e.prototype,"background",2),e}function Fo(t){class e extends t{constructor(){super(...arguments),this.handle=new Pf}}return d([Z(Bo,{optional:!0})],e.prototype,"handle",2),e}function mh(t){class e extends t{constructor(){super(...arguments),this.axisLabel=new Vn}}return d([Z(Bo,{optional:!0})],e.prototype,"axisLabel",2),e}function Un(t){class e extends t{}return d([Z(uh(["arrow","circle"]),{optional:!0})],e.prototype,"startCap",2),d([Z(uh(["arrow","circle"]),{optional:!0})],e.prototype,"endCap",2),e}function fh(t){class e extends t{}return d([Z(wo,{optional:!0})],e.prototype,"extendLeft",2),d([Z(wo,{optional:!0})],e.prototype,"extendRight",2),e}function Bf(t){class e extends t{}return d([Z(wo,{optional:!0})],e.prototype,"locked",2),e}function xh(t){class e extends t{}return d([Z(wo,{optional:!0})],e.prototype,"visible",2),e}function Hn(t){class e extends t{}return d([Z(Pn,{optional:!0})],e.prototype,"fill",2),d([Z(dh,{optional:!0})],e.prototype,"fillOpacity",2),e}function Qe(t){class e extends t{}return d([Z(Pn,{optional:!0})],e.prototype,"stroke",2),d([Z(dh,{optional:!0})],e.prototype,"strokeOpacity",2),d([Z(Po,{optional:!0})],e.prototype,"strokeWidth",2),e}function zf(t){class e extends t{constructor(){super(...arguments),this.textAlign="center",this.fontSize=12,this.fontFamily="Verdana, sans-serif"}}return d([Z(zn,{optional:!0})],e.prototype,"padding",2),d([Z(Ef,{optional:!0})],e.prototype,"textAlign",2),d([Z(Rf,{optional:!0})],e.prototype,"fontStyle",2),d([Z(_f,{optional:!0})],e.prototype,"fontWeight",2),d([Z(zn)],e.prototype,"fontSize",2),d([Z(Bn)],e.prototype,"fontFamily",2),d([Z(Pn,{optional:!0})],e.prototype,"color",2),d([Z(Lf,{optional:!0})],e.prototype,"formatter",2),e}function $e(t){class e extends t{}return d([Z(Of,{optional:!0})],e.prototype,"lineDash",2),d([Z(Po,{optional:!0})],e.prototype,"lineDashOffset",2),e}var{STRING:Sh,BaseProperties:Mh,Validate:bh,isObject:Dh}=Af,Me=class extends Vo("horizontal-line",gh(Fo(mh(Un(Qe($e(Mh))))))){constructor(){super(...arguments),this.direction="horizontal",this.type="horizontal-line"}static is(t){return Dh(t)&&t.type==="horizontal-line"}isValidWithContext(t,e){return super.isValid(e)&&nh(t,this,e)}};d([bh(Sh)],Me.prototype,"type",2);var eo=class extends Vo("vertical-line",gh(Fo(mh(Un(Qe($e(Mh))))))){constructor(){super(...arguments),this.direction="vertical",this.type="vertical-line"}static is(t){return Dh(t)&&t.type==="vertical-line"}isValidWithContext(t,e){return super.isValid(e)&&nh(t,this,e)}};d([bh(Sh)],eo.prototype,"type",2);import{_ModuleSupport as Vf,_Util as Ff}from"ag-charts-community";import{_ModuleSupport as Uf,_Scene as Kn}from"ag-charts-community";import{_Scene as Mi}from"ag-charts-community";var Nh=class py extends Mi.Group{constructor(){super(...arguments),this.active=!1,this.locked=!1,this.visible=!1}drag(e){const{handle:i,locked:o}=this;return o?{point:{x:i.x,y:i.y},offset:{x:0,y:0}}:{point:e,offset:{x:e.x-i.x,y:e.y-i.y}}}toggleActive(e){this.active=e,e||(this.handle.strokeWidth=py.INACTIVE_STROKE_WIDTH)}toggleHovered(e){this.glow.visible=!this.locked&&e,this.glow.dirtyPath=!0}toggleDragging(e){this.locked||(this.handle.visible=!e,this.glow.visible=this.glow.visible&&!e,this.handle.dirtyPath=!0,this.glow.dirtyPath=!0)}toggleLocked(e){this.locked=e}getCursor(){return"default"}containsPoint(e,i){return this.handle.containsPoint(e,i)}};Nh.INACTIVE_STROKE_WIDTH=1;var qe=Nh,Gn=class uy extends qe{constructor(){super(),this.handle=new Mi.Circle,this.glow=new Mi.Circle,this.append([this.handle]),this.handle.size=uy.HANDLE_SIZE,this.handle.strokeWidth=qe.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2}update(e){this.handle.setProperties({...e,strokeWidth:qe.INACTIVE_STROKE_WIDTH})}drag(e){return{point:e,offset:{x:0,y:0}}}};Gn.HANDLE_SIZE=7,Gn.GLOW_SIZE=9;var Je=Gn,bs=class Yt extends qe{constructor(){super(),this.handle=new Mi.Rect,this.glow=new Mi.Rect,this.gradient="horizontal",this.append([this.glow,this.handle]),this.handle.cornerRadius=Yt.CORNER_RADIUS,this.handle.width=Yt.HANDLE_SIZE,this.handle.height=Yt.HANDLE_SIZE,this.handle.strokeWidth=qe.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2,this.glow.cornerRadius=Yt.CORNER_RADIUS,this.glow.width=Yt.GLOW_SIZE,this.glow.height=Yt.GLOW_SIZE,this.glow.strokeWidth=0,this.glow.fillOpacity=.2,this.glow.zIndex=1,this.glow.visible=!1}toggleLocked(e){if(super.toggleLocked(e),e){const i=(Yt.HANDLE_SIZE-Je.HANDLE_SIZE)/2;this.handle.cornerRadius=1,this.handle.fill=this.handle.stroke,this.handle.strokeWidth=0,this.handle.x+=i,this.handle.y+=i,this.handle.width=Je.HANDLE_SIZE,this.handle.height=Je.HANDLE_SIZE,this.glow.width=Je.GLOW_SIZE,this.glow.height=Je.GLOW_SIZE}else this.handle.cornerRadius=Yt.CORNER_RADIUS,this.handle.width=Yt.HANDLE_SIZE,this.handle.height=Yt.HANDLE_SIZE,this.glow.width=Yt.GLOW_SIZE,this.glow.height=Yt.GLOW_SIZE,this.cachedStyles&&this.handle.setProperties(this.cachedStyles)}update(e){if(this.cachedStyles={...e},this.active||delete e.strokeWidth,this.locked){delete e.fill,delete e.strokeWidth;const i=(Yt.HANDLE_SIZE-Je.HANDLE_SIZE)/2;e.x-=i,e.y-=i,this.cachedStyles.x-=i,this.cachedStyles.y-=i}this.handle.setProperties(e),this.glow.setProperties({...e,x:(e.x??this.glow.x)-2,y:(e.y??this.glow.y)-2,strokeWidth:0,fill:e.stroke})}drag(e){return this.locked?{point:e,offset:{x:0,y:0}}:this.gradient==="vertical"?{point:{x:e.x,y:this.handle.y},offset:{x:e.x-this.handle.x,y:0}}:{point:{x:this.handle.x,y:e.y},offset:{x:0,y:e.y-this.handle.y}}}getCursor(){return this.locked?"default":this.gradient==="vertical"?"col-resize":"row-resize"}};bs.HANDLE_SIZE=12,bs.GLOW_SIZE=16,bs.CORNER_RADIUS=4;var io=bs,Wn=class ps extends qe{constructor(){super(),this.handle=new Mi.Circle,this.glow=new Mi.Circle,this.append([this.glow,this.handle]),this.handle.size=ps.HANDLE_SIZE,this.handle.strokeWidth=qe.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2,this.glow.size=ps.GLOW_SIZE,this.glow.strokeWidth=0,this.glow.fillOpacity=.2,this.glow.zIndex=1,this.glow.visible=!1}toggleLocked(e){super.toggleLocked(e),e?(this.handle.fill=this.handle.stroke,this.handle.strokeWidth=0,this.handle.size=Je.HANDLE_SIZE,this.glow.size=Je.GLOW_SIZE):(this.handle.size=ps.HANDLE_SIZE,this.glow.size=ps.GLOW_SIZE,this.cachedStyles&&this.handle.setProperties(this.cachedStyles))}update(e){this.cachedStyles={...e},this.active||delete e.strokeWidth,this.locked&&(delete e.fill,delete e.strokeWidth),this.handle.setProperties(e),this.glow.setProperties({...e,strokeWidth:0,fill:e.stroke})}};Wn.HANDLE_SIZE=11,Wn.GLOW_SIZE=17;var _e=Wn,{isObject:Hf}=Uf,oo=class extends Kn.Group{constructor(){super(...arguments),this.locked=!1}static isCheck(t,e){return Hf(t)&&Object.hasOwn(t,"type")&&t.type===e}getCachedBBoxWithoutHandles(){return this.cachedBBoxWithoutHandles??Kn.BBox.zero}computeBBoxWithoutHandles(){return this.computeTransformMatrix(),Kn.Group.computeBBox(this.children.filter(t=>!(t instanceof qe)))}render(t){super.render(t),this.cachedBBoxWithoutHandles=this.computeBBoxWithoutHandles()}};import{_ModuleSupport as Kf,_Scene as jn}from"ag-charts-community";var{calculateLabelTranslation:Gf,ChartAxisDirection:Wf}=Kf,vh=class extends jn.Group{constructor(){super({name:"AnnotationAxisLabelGroup"}),this.label=new jn.Text({zIndex:1}),this.rect=new jn.Rect;const{label:t}=this;t.fontSize=12,t.fontFamily="Verdana, sans-serif",t.fill="black",t.textBaseline="middle",t.textAlign="center",this.append([this.rect,this.label])}update(t){this.updateLabel(t),this.updateRect(t),this.updatePosition(t)}updateLabel({value:t,styles:e,context:i}){const{label:o}=this,{fontWeight:s,fontSize:a,fontStyle:n,fontFamily:r,textAlign:l,color:c="white",formatter:h}=e;o.setProperties({fontWeight:s,fontSize:a,fontStyle:n,fontFamily:r,textAlign:l,fill:c}),o.text=this.getFormattedValue(t,h??i.scaleValueFormatter())}updateRect({styles:t}){const{rect:e}=this,{cornerRadius:i,fill:o,fillOpacity:s,stroke:a,strokeOpacity:n}=t;e.setProperties({cornerRadius:i,fill:o,fillOpacity:s,stroke:a,strokeOpacity:n})}updatePosition({x:t,y:e,context:i,styles:{padding:o}}){const{label:s,rect:a}=this,n=s.computeBBox(),r=8,l=5;n.grow(o??r,"horizontal"),n.grow(o??l,"vertical");const c=i.direction===Wf.X?l/2:r,{xTranslation:h,yTranslation:p}=Gf({yDirection:!0,padding:i.labelPadding-c,position:i.position??"left",bbox:n}),u=t+h,m=e+p;s.translationX=u,s.translationY=m,a.x=u-n.width/2,a.y=m-n.height/2,a.height=n.height,a.width=n.width}getFormattedValue(t,e){return e?.(t)??String(t)}};vh.className="AxisLabel";import{_Scene as Ih,_Util as jf}from"ag-charts-community";var{Vec2:be}=jf,Ds=class extends Ih.Line{constructor(){super(...arguments),this.growCollisionBox=9}updateCollisionBBox(){const{growCollisionBox:t,strokeWidth:e,x1:i,y1:o,x2:s,y2:a}=this;let n=e+t;n%2===0&&(n+=1);const r=be.from(i,o-Math.floor(n/2)),l=be.from(s,a),c=be.distance(r,l);this.collisionBBox=new Ih.BBox(r.x,r.y,c,n)}isPointInPath(t,e){const{collisionBBox:i,x1:o,y1:s,x2:a,y2:n}=this;if(!i)return!1;const r=be.from(o,s),l=be.from(a,n),c=be.sub(be.from(t,e),r),h=be.sub(l,r),p=be.rotate(c,be.angle(c,h),r);return i.containsPoint(p.x,p.y)??!1}},{Vec2:Ah}=Ff,{ChartAxisDirection:Yf}=Vf,Uo=class extends oo{constructor(){super(),this.type="cross-line",this.line=new Ds,this.middle=new io,this.isHorizontal=!1,this.append([this.line,this.middle])}static is(t){return oo.isCheck(t,"cross-line")}update(t,e){const{line:i,middle:o}=this,{locked:s,visible:a,lineDash:n,lineDashOffset:r,stroke:l,strokeWidth:c,strokeOpacity:h}=t,{seriesRect:p}=e;this.locked=s??!1,this.seriesRect=p,this.isHorizontal=Me.is(t);const u=this.isHorizontal?e.yAxis:e.xAxis,m=this.convertCrossLine(t,u);if(m==null){this.visible=!1;return}else this.visible=a??!0;const{x1:g,y1:y,x2:f,y2:M}=m;i.setProperties({x1:g,y1:y,x2:f,y2:M,lineDash:n,lineDashOffset:r,stroke:l,strokeWidth:c,strokeOpacity:h,fillOpacity:0}),i.updateCollisionBBox();const b={fill:t.handle.fill,stroke:t.handle.stroke??l,strokeOpacity:t.handle.strokeOpacity??h,strokeWidth:t.handle.strokeWidth??c},S=g+(f-g)/2,x=y+(M-y)/2,{width:N,height:v}=o.handle;o.gradient=this.isHorizontal?"horizontal":"vertical",o.update({...b,x:S-N/2,y:x-v/2}),o.toggleLocked(this.locked),this.updateAxisLabel(t,u,m)}createAxisLabel(t){const e=new vh;return t.attachLabel(e),e}updateAxisLabel(t,e,{x1:i,y1:o,x2:s,y2:a}){this.axisLabel||(this.axisLabel=this.createAxisLabel(e));const{axisLabel:n,seriesRect:r}=this;if(t.axisLabel.enabled){n.visible=this.visible;const[l,c]=e.position==="left"||e.position==="top"?[i,o]:[s,a],h=e.direction===Yf.X?l:c;if(!e.inRange(h)){n.visible=!1;return}n.update({x:l+(r?.x??0),y:c+(r?.y??0),value:t.value,styles:t.axisLabel,context:e})}else n.visible=!1}toggleHandles(t){this.middle.visible=t,this.middle.toggleHovered(this.activeHandle==="middle")}destroy(){super.destroy(),this.axisLabel?.destroy()}toggleActive(t){this.toggleHandles(t),this.middle.toggleActive(t)}dragStart(t,e,i){const o=Me.is(t)?{x:e.x,y:to(t.value,i.yAxis)}:{x:to(t.value,i.xAxis),y:e.y};this.dragState={offset:e,middle:o}}drag(t,e,i,o){const{activeHandle:s,dragState:a,locked:n}=this;if(n)return;let r;if(s)this[s].toggleDragging(!0),r=this[s].drag(e).point;else if(a)r=Ah.add(a.middle,Ah.sub(e,a.offset));else return;const l=ce(r,i);if(!xe(i,l)){o();return}const c=Me.is(t);t.set({value:c?l.y:l.x})}stopDragging(){this.middle.toggleDragging(!1)}getCursor(){return this.activeHandle==null?"pointer":this[this.activeHandle].getCursor()}containsPoint(t,e){const{middle:i,seriesRect:o,line:s}=this;return this.activeHandle=void 0,i.containsPoint(t,e)?(this.activeHandle="middle",!0):(t-=o?.x??0,e-=o?.y??0,s.isPointInPath(t,e))}getAnchor(){let t=this.getCachedBBoxWithoutHandles();return t.width===0&&t.height===0&&(t=this.computeBBoxWithoutHandles()),this.isHorizontal?{x:t.x+t.width/2,y:t.y}:{x:t.x+t.width,y:t.y+t.height/2,position:"above"}}convertCrossLine(t,e){if(t.value==null)return;let i=0,o=0,s=0,a=0;const{bounds:n,scaleConvert:r,scaleBandwidth:l}=e,c=(l()??0)/2;if(Me.is(t)){const h=r(t.value)+c;o=n.width,s=h,a=h}else{const h=r(t.value)+c;i=h,o=h,a=n.height}return{x1:i,y1:s,x2:o,y2:a}}};import{_ModuleSupport as Xf,_Util as Zf}from"ag-charts-community";var Th=class extends Xf.StateMachine{constructor(t,e,i){const o=({point:s})=>{const a=t==="horizontal",n=a?new Me:new eo;n.set({value:a?s.y:s.x}),e(n)};super("start",{start:{click:{target:"__parent",action:o},cancel:"__parent",onExit:i}}),this.debug=Zf.Debug.create(!0,"annotations")}};import{_ModuleSupport as Qf,_Util as $f}from"ag-charts-community";var{NUMBER:kh,STRING:qf,BaseProperties:Jf,Validate:Yn,isObject:tx}=Qf,ti=class extends Vo("disjoint-channel",yh(Fn(Fo(Qe($e(Jf)))))){constructor(){super(...arguments),this.type="disjoint-channel"}static is(t){return tx(t)&&t.type==="disjoint-channel"}get bottom(){const t={start:{x:this.start.x,y:this.start.y},end:{x:this.end.x,y:this.end.y}};return typeof t.start.y=="number"&&typeof t.end.y=="number"?(t.start.y-=this.startHeight,t.end.y-=this.endHeight):$f.Logger.warnOnce(`Annotation [${this.type}] can only be used with a numeric y-axis.`),t}isValidWithContext(t,e){return super.isValid(e)&&Co(t,this,e)&&Co(t,this.bottom,e)}};d([Yn(qf)],ti.prototype,"type",2),d([Yn(kh)],ti.prototype,"startHeight",2),d([Yn(kh)],ti.prototype,"endHeight",2);import{_Util as ex}from"ag-charts-community";import{_Scene as ix}from"ag-charts-community";import{_Util as ox}from"ag-charts-community";var{Vec2:Ns}=ox,Oh=class extends oo{dragStart(t,e,i){this.dragState={offset:e,start:Se(t.start,i),end:Se(t.end,i)}}drag(t,e,i,o){t.locked||(this.activeHandle?this.dragHandle(t,e,i,o):this.dragAll(t,e,i))}dragAll(t,e,i){const{dragState:o}=this;if(!o)return;const{xAxis:s,yAxis:a}=i,n=Ns.add(o.start,Ns.sub(e,o.offset)),r=Ns.add(o.end,Ns.sub(e,o.offset)),l=ce(n,i),c=ce(r,i),h=(u,m,g)=>m>=u&&m<=g,p=[n,r].concat(...this.getOtherCoords(t,n,r,i));p.every(u=>h(s.bounds.x,u.x,s.bounds.x+s.bounds.width))&&(t.start.x=l.x,t.end.x=c.x),p.every(u=>h(a.bounds.y,u.y,a.bounds.y+a.bounds.height))&&(t.start.y=l.y,t.end.y=c.y)}getOtherCoords(t,e,i,o){return[]}},Lh=class extends Oh{constructor(){super(...arguments),this.handles={},this.topLine=new Ds,this.bottomLine=new Ds,this.background=new ix.Path({zIndex:-1})}update(t,e){const{locked:i,visible:o}=t;this.locked=i??!1,this.seriesRect=e.seriesRect;const s=Cn(t,e),a=Cn(t.bottom,e);if(s==null||a==null){this.visible=!1;return}else this.visible=o??!0;this.updateLines(t,s,a),this.updateHandles(t,s,a),this.updateBackground(t,s,a);for(const n of Object.values(this.handles))n.toggleLocked(this.locked)}toggleActive(t){this.toggleHandles(t);for(const e of Object.values(this.handles))e.toggleActive(t)}stopDragging(){const{activeHandle:t,handles:e}=this;t!=null&&e[t].toggleDragging(!1)}getAnchor(){const t=this.getCachedBBoxWithoutHandles();return{x:t.x+t.width/2,y:t.y}}getCursor(){return this.activeHandle==null?"pointer":this.handles[this.activeHandle].getCursor()}containsPoint(t,e){const{handles:i,seriesRect:o,topLine:s,bottomLine:a}=this;this.activeHandle=void 0;for(const[n,r]of Object.entries(i))if(r.containsPoint(t,e))return this.activeHandle=n,!0;return t-=o?.x??0,e-=o?.y??0,s.containsPoint(t,e)||a.containsPoint(t,e)}updateBackground(t,e,i){const{background:o}=this;o.path.clear(),o.path.moveTo(e.x1,e.y1),o.path.lineTo(e.x2,e.y2),o.path.lineTo(i.x2,i.y2),o.path.lineTo(i.x1,i.y1),o.path.closePath(),o.checkPathDirty(),o.setProperties({fill:t.background.fill,fillOpacity:t.background.fillOpacity})}},{Vec2:vs}=ex,Is=class extends Lh{constructor(){super(),this.type="disjoint-channel",this.handles={topLeft:new _e,topRight:new _e,bottomLeft:new _e,bottomRight:new io},this.append([this.background,this.topLine,this.bottomLine,...Object.values(this.handles)])}static is(t){return oo.isCheck(t,"disjoint-channel")}toggleHandles(t){typeof t=="boolean"&&(t={topLeft:t,topRight:t,bottomLeft:t,bottomRight:t});for(const[e,i]of Object.entries(this.handles))i.visible=t[e]??!0,i.toggleHovered(this.activeHandle===e)}toggleActive(t){this.toggleHandles(t);for(const e of Object.values(this.handles))e.toggleActive(t)}dragHandle(t,e,i,o){const{activeHandle:s,handles:a}=this;if(s==null)return;const{offset:n}=a[s].drag(e);a[s].toggleDragging(!0);const r=c=>ce(c,i),l=t.toJson();switch(s){case"topLeft":case"bottomLeft":{const c=s==="topLeft"?1:-1,h=r({x:a.topLeft.handle.x+n.x,y:a.topLeft.handle.y+n.y*c}),p=r({x:a.bottomLeft.handle.x+n.x,y:a.bottomLeft.handle.y+n.y*-c});if(!h||!p||t.start.y==null)return;const u=t.startHeight+(h.y-t.start.y)*2;t.start.x=h.x,t.start.y=h.y,t.startHeight=u;break}case"topRight":{const c=r({x:a.topRight.handle.x+n.x,y:a.topRight.handle.y+n.y});if(!c||t.end.y==null)return;const h=t.endHeight+(c.y-t.end.y)*2;t.end.x=c.x,t.end.y=c.y,t.endHeight=h;break}case"bottomRight":{const c=r({x:a.bottomLeft.handle.x+n.x,y:a.bottomLeft.handle.y+n.y}),h=r({x:a.bottomRight.handle.x+n.x,y:a.bottomRight.handle.y+n.y});if(!c||!h||t.start.y==null||t.end.y==null)return;const p=t.end.y-h.y,u=t.startHeight-(t.endHeight-p);t.startHeight=u,t.endHeight=p}}t.isValidWithContext(i)||(t.set(l),o())}getOtherCoords(t,e,i,o){const{dragState:s}=this;if(!s)return[];const a=Se(t.bottom.start,o).y-Se(t.start,o).y,n=Se(t.bottom.end,o).y-Se(t.end,o).y,r=vs.add(e,vs.from(0,a)),l=vs.add(i,vs.from(0,n));return[r,l]}updateLines(t,e,i){const{topLine:o,bottomLine:s}=this,{lineDash:a,lineDashOffset:n,stroke:r,strokeOpacity:l,strokeWidth:c}=t,h={lineDash:a,lineDashOffset:n,stroke:r,strokeOpacity:l,strokeWidth:c};o.setProperties({x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,...h}),s.setProperties({x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,...h}),o.updateCollisionBBox(),s.updateCollisionBBox()}updateHandles(t,e,i){const{handles:{topLeft:o,topRight:s,bottomLeft:a,bottomRight:n}}=this,r={fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth};o.update({...r,x:e.x1,y:e.y1}),s.update({...r,x:e.x2,y:e.y2}),a.update({...r,x:i.x1,y:i.y1}),n.update({...r,x:i.x2-n.handle.width/2,y:i.y2-n.handle.height/2})}};import{_ModuleSupport as sx,_Util as ax}from"ag-charts-community";var nx=class extends sx.StateMachine{constructor(t,e){const i=({point:r})=>{const l=new ti;l.set({start:r,end:r,startHeight:0,endHeight:0}),t(l)},o=({datum:r,node:l,point:c})=>{r?.set({end:c}),l?.toggleHandles({topRight:!1,bottomLeft:!1,bottomRight:!1})},s=({datum:r,point:l})=>{r?.set({end:l})},a=({datum:r,node:l,point:c})=>{if(r.start.y==null||r.end.y==null)return;const h=r.end.y-c.y,p=(r.start.y-r.end.y)*2+h,u={x:r.start.x,y:r.start.y-p},m={x:r.end.x,y:c.y};l.toggleHandles({bottomLeft:!1}),!(!e(u)||!e(m))&&r.set({startHeight:p,endHeight:h})},n=({datum:r,node:l,point:c})=>{if(!r||!l||r.start.y==null||r.end.y==null)return;const h=r.end.y-c.y,p=(r.start.y-r.end.y)*2+h,u={x:r.start.x,y:r.start.y-h},m={x:r.end.x,y:c.y};l.toggleHandles(!0),e(u)&&e(m)&&r.set({startHeight:p,endHeight:h})};super("start",{start:{click:{target:"end",action:i},drag:{target:"end",action:i},cancel:"__parent"},end:{hover:o,click:{target:"height",action:s},drag:o,cancel:"__parent"},height:{hover:a,click:{target:"__parent",action:n},cancel:"__parent"}}),this.debug=ax.Debug.create(!0,"annotations")}};import{_ModuleSupport as rx}from"ag-charts-community";var{STRING:lx,BaseProperties:cx,Validate:hx,isObject:dx}=rx,so=class extends Vo("line",Fn(Fo(Un(fh(Qe($e(cx))))))){constructor(){super(...arguments),this.type="line"}static is(t){return dx(t)&&t.type==="line"}isValidWithContext(t,e){return super.isValid(e)&&Co(t,this,e)}};d([hx(lx)],so.prototype,"type",2);import"ag-charts-community";var As=class extends Oh{constructor(){super(),this.type="line",this.line=new Ds,this.start=new _e,this.end=new _e,this.append([this.line,this.start,this.end])}static is(t){return oo.isCheck(t,"line")}update(t,e){const{line:i,start:o,end:s}=this,{locked:a,visible:n,lineDash:r,lineDashOffset:l,stroke:c,strokeWidth:h,strokeOpacity:p}=t;this.locked=a??!1,this.seriesRect=e.seriesRect;const u=Cn(t,e);if(u==null){this.visible=!1;return}else this.visible=n??!0;const{x1:m,y1:g,x2:y,y2:f}=u;i.setProperties({x1:m,y1:g,x2:y,y2:f,lineDash:r,lineDashOffset:l,stroke:c,strokeWidth:h,strokeOpacity:p,fillOpacity:0}),i.updateCollisionBBox();const M={fill:t.handle.fill,stroke:t.handle.stroke??c,strokeOpacity:t.handle.strokeOpacity??p,strokeWidth:t.handle.strokeWidth??h};o.update({...M,x:m,y:g}),s.update({...M,x:y,y:f}),o.toggleLocked(this.locked),s.toggleLocked(this.locked)}toggleHandles(t){typeof t=="boolean"&&(t={start:t,end:t}),this.start.visible=t.start??!0,this.end.visible=t.end??!0,this.start.toggleHovered(this.activeHandle==="start"),this.end.toggleHovered(this.activeHandle==="end")}toggleActive(t){this.toggleHandles(t),this.start.toggleActive(t),this.end.toggleActive(t)}dragHandle(t,e,i,o){const{activeHandle:s}=this;if(!s)return;this[s].toggleDragging(!0);const a=ce(this[s].drag(e).point,i);if(!xe(i,a)){o();return}t[s].x=a.x,t[s].y=a.y}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1)}getAnchor(){const t=this.getCachedBBoxWithoutHandles();return{x:t.x+t.width/2,y:t.y}}getCursor(){return this.activeHandle==null?"pointer":"default"}containsPoint(t,e){const{start:i,end:o,seriesRect:s,line:a}=this;return this.activeHandle=void 0,i.containsPoint(t,e)?(this.activeHandle="start",!0):o.containsPoint(t,e)?(this.activeHandle="end",!0):(t-=s?.x??0,e-=s?.y??0,a.isPointInPath(t,e))}};import{_ModuleSupport as px,_Util as ux}from"ag-charts-community";var gx=class extends px.StateMachine{constructor(t){const e=({point:s})=>{const a=new so;a.set({start:s,end:s}),t(a)},i=({datum:s,node:a,point:n})=>{s?.set({end:n}),a?.toggleHandles({end:!1})},o=({datum:s,node:a,point:n})=>{s?.set({end:n}),a?.toggleHandles(!0)};super("start",{start:{click:{target:"end",action:e},drag:{target:"end",action:e},cancel:"__parent"},end:{hover:i,click:{target:"__parent",action:o},drag:i,cancel:"__parent"}}),this.debug=ux.Debug.create(!0,"annotations")}};import{_ModuleSupport as yx,_Util as mx}from"ag-charts-community";var{NUMBER:fx,STRING:xx,OBJECT:Sx,BaseProperties:Mx,Validate:Xn,isObject:bx}=yx,ei=class extends Vo("parallel-channel",yh(Fn(Fo(fh(Qe($e(Mx))))))){constructor(){super(...arguments),this.type="parallel-channel",this.middle=new wf}static is(t){return bx(t)&&t.type==="parallel-channel"}get bottom(){const t={start:{x:this.start.x,y:this.start.y},end:{x:this.end.x,y:this.end.y}};return typeof t.start.y=="number"&&typeof t.end.y=="number"?(t.start.y-=this.height,t.end.y-=this.height):mx.Logger.warnOnce(`Annotation [${this.type}] can only be used with a numeric y-axis.`),t}isValidWithContext(t,e){return super.isValid(e)&&Co(t,this,e)&&Co(t,this.bottom,e)}};d([Xn(xx)],ei.prototype,"type",2),d([Xn(fx)],ei.prototype,"height",2),d([Xn(Sx,{optional:!0})],ei.prototype,"middle",2);import{_Scene as Dx,_Util as Nx}from"ag-charts-community";var{Vec2:ao}=Nx,Ts=class extends Lh{constructor(){super(),this.type="parallel-channel",this.handles={topLeft:new _e,topMiddle:new io,topRight:new _e,bottomLeft:new _e,bottomMiddle:new io,bottomRight:new _e},this.middleLine=new Dx.Line,this.append([this.background,this.topLine,this.middleLine,this.bottomLine,...Object.values(this.handles)])}static is(t){return oo.isCheck(t,"parallel-channel")}toggleHandles(t){typeof t=="boolean"&&(t={topLeft:t,topMiddle:t,topRight:t,bottomLeft:t,bottomMiddle:t,bottomRight:t});for(const[e,i]of Object.entries(this.handles))i.visible=t[e]??!0,i.toggleHovered(this.activeHandle===e)}toggleActive(t){this.toggleHandles(t);for(const e of Object.values(this.handles))e.toggleActive(t)}dragHandle(t,e,i,o){const{activeHandle:s,handles:a}=this;if(s==null)return;const{offset:n}=a[s].drag(e);a[s].toggleDragging(!0);const r=t.toJson();let l=[];switch(s){case"topLeft":case"bottomLeft":l=["topLeft","bottomLeft"];break;case"topMiddle":l=["topLeft","topRight"],n.y-=io.HANDLE_SIZE/2;break;case"topRight":case"bottomRight":l=["topRight","bottomRight"];break;case"bottomMiddle":l=["bottomLeft","bottomRight"],n.y-=io.HANDLE_SIZE/2;break}const c=l.map(h=>ce(ao.add(a[h].handle,n),i));if(c.some(h=>!xe(i,h))){o();return}if((s==="topMiddle"||s==="bottomMiddle")&&t.start.y!=null){const h=ce(ao.add(a.topLeft.handle,n),i);xe(i,h)&&(s==="topMiddle"?t.height+=h.y-t.start.y:t.height-=h.y-t.start.y)}for(const[h,p]of c.entries())switch(l[h]){case"topLeft":t.start.x=p.x,t.start.y=p.y;break;case"topRight":t.end.x=p.x,t.end.y=p.y;break}t.isValidWithContext(i)||(t.set(r),o())}getOtherCoords(t,e,i,o){const{dragState:s}=this;if(!s)return[];const a=Se(t.bottom.start,o).y-Se(t.start,o).y,n=ao.add(e,ao.from(0,a)),r=ao.add(i,ao.from(0,a));return[n,r]}updateLines(t,e,i){const{topLine:o,middleLine:s,bottomLine:a}=this,{lineDash:n,lineDashOffset:r,stroke:l,strokeOpacity:c,strokeWidth:h}=t,p={lineDash:n,lineDashOffset:r,stroke:l,strokeOpacity:c,strokeWidth:h};o.setProperties({x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,...p}),a.setProperties({x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,...p}),o.updateCollisionBBox(),a.updateCollisionBBox(),s.setProperties({x1:e.x1,y1:i.y1+(e.y1-i.y1)/2,x2:e.x2,y2:i.y2+(e.y2-i.y2)/2,lineDash:t.middle.lineDash??n,lineDashOffset:t.middle.lineDashOffset??r,stroke:t.middle.stroke??l,strokeOpacity:t.middle.strokeOpacity??c,strokeWidth:t.middle.strokeWidth??h,visible:t.middle.visible??!0})}updateHandles(t,e,i){const{handles:{topLeft:o,topMiddle:s,topRight:a,bottomLeft:n,bottomMiddle:r,bottomRight:l}}=this,c={fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth};o.update({...c,x:e.x1,y:e.y1}),a.update({...c,x:e.x2,y:e.y2}),n.update({...c,x:i.x1,y:i.y1}),l.update({...c,x:i.x2,y:i.y2}),s.update({...c,x:e.x1+(e.x2-e.x1)/2-s.handle.width/2,y:e.y1+(e.y2-e.y1)/2-s.handle.height/2}),r.update({...c,x:i.x1+(i.x2-i.x1)/2-r.handle.width/2,y:i.y1+(i.y2-i.y1)/2-r.handle.height/2})}};import{_ModuleSupport as vx,_Util as Ix}from"ag-charts-community";var Ax=class extends vx.StateMachine{constructor(t,e){const i=({point:r})=>{const l=new ei;l.set({start:r,end:r,height:0}),t(l)},o=({datum:r,node:l,point:c})=>{r?.set({end:c,height:0}),l?.toggleHandles({topMiddle:!1,topRight:!1,bottomLeft:!1,bottomMiddle:!1,bottomRight:!1})},s=({datum:r,node:l,point:c})=>{r?.set({end:c}),l?.toggleHandles({topMiddle:!1,bottomMiddle:!1})},a=({datum:r,node:l,point:c})=>{if(r.start.y==null||r.end.y==null)return;const h=r.end.y-c.y,p=r.start.y-h;l.toggleHandles({topMiddle:!1,bottomMiddle:!1}),!(!e({x:r.start.x,y:p})||!e({x:r.end.x,y:c.y}))&&r.set({height:h})},n=({datum:r,node:l,point:c})=>{if(!r||!l||r.start.y==null||r.end.y==null)return;const h=r.end.y-c.y,p=r.start.y-h;l.toggleHandles(!0),e({x:r.start.x,y:p})&&e({x:r.end.x,y:c.y})&&r.set({height:h})};super("start",{start:{click:{target:"end",action:i},drag:{target:"end",action:i},cancel:"__parent"},end:{hover:o,click:{target:"height",action:s},drag:o,cancel:"__parent"},height:{hover:a,click:{target:"__parent",action:n},cancel:"__parent"}}),this.debug=Ix.Debug.create(!0,"annotations")}},{BOOLEAN:Eh,ChartUpdateType:Tx,Cursor:Zn,InteractionState:bi,PropertiesArray:kx,StateMachine:Ox,ToolbarManager:ks,Validate:Qn,REGIONS:Os,UNION:Lx,ChartAxisDirection:Ex}=ms,{Vec2:Dt}=On,$n={line:so,"horizontal-line":Me,"vertical-line":eo,"parallel-channel":ei,"disjoint-channel":ti},Rx={line:As,"horizontal-line":Uo,"vertical-line":Uo,"disjoint-channel":Is,"parallel-channel":Ts},_x=class extends Ox{constructor(t,e,i,o){super("idle",{idle:{onEnter:()=>t(),line:new gx(s=>e("line",s)),"horizontal-line":new Th("horizontal",s=>e("horizontal-line",s),i),"vertical-line":new Th("vertical",s=>e("vertical-line",s),i),"disjoint-channel":new nx(s=>e("disjoint-channel",s),o),"parallel-channel":new Ax(s=>e("parallel-channel",s),o)}}),this.debug=On.Debug.create(!0,"annotations")}},Cx=Lx(["x","y","xy"],"an axis type"),qn=class{constructor(){this.enabled=!0,this.axes="y"}};d([Qn(Eh)],qn.prototype,"enabled",2),d([Qn(Cx,{optional:!0})],qn.prototype,"axes",2);var Rh=class extends ms.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.__hackWasDisabled=!1,this.enabled=!0,this.axesButtons=new qn,this.annotationData=new kx(this.createAnnotationDatum),this.container=new kn.Group({name:"static-annotations"}),this.annotations=new kn.Selection(this.container,this.createAnnotationScene.bind(this)),this.colorPicker=new mf(this.ctx),this.state=new _x(()=>{t.cursorManager.updateCursor("annotations"),t.interactionManager.popState(bi.Annotations),t.toolbarManager.toggleGroup("annotations","annotationOptions",this.active!=null),t.tooltipManager.unsuppressTooltip("annotations");for(const r of En)t.toolbarManager.toggleButton("annotations",r,{active:!1});this.toggleAnnotationOptionsButtons()},this.appendDatum.bind(this),()=>{this.active=this.annotationData.length-1},this.validateChildStateDatumPoint.bind(this));const{All:e,Default:i,Annotations:o,ZoomDrag:s}=bi,a=t.regionManager.getRegion(Os.SERIES),n=Object.values(Os).filter(r=>![Os.SERIES,Os.NAVIGATOR].includes(r)).map(r=>t.regionManager.getRegion(r));t.domManager.addStyles(Ze,If),this.destroyFns.push(t.annotationManager.attachNode(this.container),()=>this.colorPicker.destroy(),a.addListener("hover",r=>this.onHover(r),e),a.addListener("click",r=>this.onClick(r),e),a.addListener("drag-start",this.onDragStart.bind(this),i|s|o),a.addListener("drag",this.onDrag.bind(this),i|s|o),a.addListener("drag-end",this.onDragEnd.bind(this),e),a.addListener("cancel",this.onCancel.bind(this),e),a.addListener("delete",this.onDelete.bind(this),e),...n.map(r=>r.addListener("click",this.onCancel.bind(this),e)),t.annotationManager.addListener("restore-annotations",this.onRestoreAnnotations.bind(this)),t.toolbarManager.addListener("button-pressed",this.onToolbarButtonPress.bind(this)),t.toolbarManager.addListener("button-moved",this.onToolbarButtonMoved.bind(this)),t.toolbarManager.addListener("cancelled",this.onToolbarCancelled.bind(this)),t.layoutService.addListener("layout-complete",this.onLayoutComplete.bind(this)),()=>t.domManager.removeStyles(Ze))}createAnnotationScene(t){return new Rx[t.type]}createAnnotationDatum(t){if(t.type in $n)return new $n[t.type]().set(t);throw new Error(`AG Charts - Cannot set property of unknown type [${t.type}], expected one of [${Object.keys($n)}], ignoring.`)}appendDatum(t,e){this.annotationData.push(e);const i=this.ctx.annotationManager.getAnnotationTypeStyles(t);i&&e.set(i),this.defaultColor&&this.colorDatum(e,this.defaultColor)}onRestoreAnnotations(t){this.enabled&&(this.clear(),this.annotationData.set(t.annotations),this.update())}onToolbarButtonPress(t){const{state:e,ctx:{interactionManager:i,toolbarManager:o,tooltipManager:s}}=this;if(ks.isGroup("annotationOptions",t)){this.onToolbarAnnotationOptionButtonPress(t);return}if(!ks.isGroup("annotations",t)){this.reset(),this.update();return}if(t.value==="clear"){this.clear(),this.update();return}s.suppressTooltip("annotations");const a=ff(t.value);if(!a){On.Logger.errorOnce(`Can not create unknown annotation type [${t.value}], ignoring.`),this.update();return}e.is("idle")||this.cancel(),i.pushState(bi.Annotations);for(const n of En)o.toggleButton("annotations",n,{active:n===t.value});e.transition(a),this.reset(),this.update()}onToolbarAnnotationOptionButtonPress(t){if(!ks.isGroup("annotationOptions",t))return;const{active:e,annotationData:i}=this;if(e!=null){switch(t.value){case"line-color":this.colorPicker.show({color:this.getTypedDatum(i[e])?.stroke,onChange:this.onColorPickerChange.bind(this),onClose:this.onColorPickerClose.bind(this)});break;case"delete":i.splice(e,1),this.reset();break;case"lock":i[e].locked=!0,this.toggleAnnotationOptionsButtons(),this.colorPicker.hide();break;case"unlock":i[e].locked=!1,this.toggleAnnotationOptionsButtons();break}this.update()}}onToolbarButtonMoved(t){const{rect:e}=t,i=Dt.add(e,Dt.from(0,e.height+4)),o={y:e.y-4};this.colorPicker.setAnchor(i,o)}onColorPickerChange(t){const{active:e,annotationData:i}=this;e!=null&&(this.colorDatum(i[e],t),this.defaultColor=t,this.update())}onColorPickerClose(){this.colorPicker.hide()}onToolbarCancelled(t){if(t.group==="annotations"){this.onCancel();for(const e of En)this.ctx.toolbarManager.toggleButton("annotations",e,{active:!1})}}onLayoutComplete(t){const e=t.series.paddedRect;this.seriesRect=e;for(const i of t.axes??[])i.direction===ms.ChartAxisDirection.X?this.xAxis=this.getAxis(i,e,this.xAxis?.button):this.yAxis=this.getAxis(i,e,this.yAxis?.button);this.updateAnnotations()}getAxis(t,e,i){const o=this.ctx.axisManager.getAxisContext(t.direction)[0],{position:s="bottom",direction:a}=o,n=t.gridPadding+t.seriesAreaPadding,r=eh(new kn.BBox(0,0,e.width,e.height),s,n),l=o.direction===Ex.X?"vertical":"horizontal",{axesButtons:c}=this;if(this.enabled&&c.enabled&&(c.axes==="xy"||c.axes===a)){i??(i=new ch(this.ctx,o,u=>this.onAxisButtonClick(u,l),e));const p=wn(t);i.update(e,p)}else i?.destroy(),i=void 0;return{layout:t,context:o,bounds:r,button:i}}updateAnnotations(){const{active:t,seriesRect:e,annotationData:i,annotations:o,ctx:{annotationManager:s,toolbarManager:a}}=this,n=this.getAnnotationContext();!e||!n||(s.updateData(i.toJson()),o.update(i??[],void 0,r=>r.id).each((r,l,c)=>{if(!this.validateDatum(l)){r.visible=!1;return}so.is(l)&&As.is(r)&&r.update(l,n),ti.is(l)&&Is.is(r)&&r.update(l,n),(Me.is(l)||eo.is(l))&&Uo.is(r)&&r.update(l,n),ei.is(l)&&Ts.is(r)&&r.update(l,n),t===c&&a.changeFloatingAnchor("annotationOptions",r.getAnchor())}))}validateDatum(t){const e=this.getAnnotationContext();return e?t.isValidWithContext(e,`Annotation [${t.type}] `):!0}validateChildStateDatumPoint(t){const e=this.getAnnotationContext(),i=e?xe(e,t):!0;return i||this.ctx.cursorManager.updateCursor("annotations",Zn.NotAllowed),i}getAnnotationContext(){const{seriesRect:t,xAxis:e,yAxis:i}=this;if(t&&e&&i)return{seriesRect:t,xAxis:{...e.context,bounds:e.bounds,labelPadding:wn(e.layout)},yAxis:{...i.context,bounds:i.bounds,labelPadding:wn(e.layout)}}}onHover(t){this.state.is("idle")?this.onHoverSelecting(t):this.onHoverAdding(t)}onHoverSelecting(t){const{active:e,annotations:i,ctx:{cursorManager:o}}=this;this.hovered=void 0,i.each((s,a,n)=>{const r=s.containsPoint(t.offsetX,t.offsetY);r&&(this.hovered??(this.hovered=n)),s.toggleHandles(r||e===n)}),o.updateCursor("annotations",this.hovered==null?void 0:i.nodes()[this.hovered].getCursor())}onHoverAdding(t){const{annotationData:e,annotations:i,seriesRect:o,state:s,ctx:{cursorManager:a}}=this,n=this.getAnnotationContext();if(!n)return;const r=Dt.sub(Dt.fromOffset(t),Dt.required(o)),l=ce(r,n),c=xe(n,l);if(a.updateCursor("annotations",c?void 0:Zn.NotAllowed),!c||s.is("start"))return;const h=e.at(-1);this.active=e.length-1;const p=i.nodes()[this.active];if(!h||!p)return;p.toggleActive(!0);const u={datum:h,node:p,point:l};this.state.transition("hover",u),this.update()}onClick(t){const{dragOffset:e,state:i}=this;if(i.is("end")&&e&&e.x===t.offsetX&&e.y===t.offsetY){this.dragOffset=void 0;return}i.is("idle")?this.onClickSelecting():this.onClickAdding(t)}onAxisButtonClick(t,e){this.onCancel();const i=this.getAnnotationContext();if(!this.annotationData||!i)return;const{state:o,ctx:{toolbarManager:s,interactionManager:a}}=this;a.pushState(bi.Annotations);const n=e==="horizontal";if(o.transition(n?"horizontal-line":"vertical-line"),s.toggleGroup("annotations","annotationOptions",!1),!t)return;const r=ce(t,i);if(!xe(i,r))return;const l={point:r};o.transition("click",l),this.update()}onClickSelecting(){const{annotations:t,colorPicker:e,hovered:i,ctx:{toolbarManager:o,tooltipManager:s}}=this;e.hide(),this.active!=null&&t.nodes()[this.active].toggleActive(!1),this.active=i,o.toggleGroup("annotations","annotationOptions",this.active!=null),this.active==null?s.unsuppressTooltip("annotations"):(t.nodes()[this.active].toggleActive(!0),s.suppressTooltip("annotations"),this.toggleAnnotationOptionsButtons()),this.update()}onClickAdding(t){const{active:e,annotationData:i,annotations:o,seriesRect:s,state:a,ctx:{toolbarManager:n}}=this;n.toggleGroup("annotations","annotationOptions",!1);const r=this.getAnnotationContext();if(!r)return;const l=i.at(-1),c=Dt.sub(Dt.fromOffset(t),Dt.required(s)),h=ce(c,r),p=e!=null?o.nodes()[e]:void 0;if(!xe(r,h))return;const u={datum:l,node:p,point:h};a.transition("click",u),this.update()}onDragStart(t){const{annotationData:e,annotations:i,hovered:o,seriesRect:s}=this;if(this.isOtherElement(t))return;const a=this.getAnnotationContext();if(o==null||e==null||!this.state.is("idle")||a==null)return;const n=e[o],r=i.nodes()[o],l=Dt.sub(Dt.fromOffset(t),Dt.required(s));As.is(r)&&r.dragStart(n,l,a),Uo.is(r)&&r.dragStart(n,l,a),Is.is(r)&&r.dragStart(n,l,a),Ts.is(r)&&r.dragStart(n,l,a)}onDrag(t){const{state:e}=this;this.isOtherElement(t)||(e.is("start")&&(this.dragOffset=Dt.fromOffset(t)),e.is("idle")?(this.onClickSelecting(),this.onDragAnnotation(t)):this.onDragAdding(t))}onDragAnnotation(t){const{annotationData:e,annotations:i,hovered:o,seriesRect:s,ctx:{cursorManager:a,interactionManager:n}}=this,r=this.getAnnotationContext();if(o==null||e==null||!this.state.is("idle")||r==null)return;n.pushState(bi.Annotations);const l=e[o],c=i.nodes()[o],h=Dt.sub(Dt.fromOffset(t),Dt.required(s));a.updateCursor("annotations");const p=()=>a.updateCursor("annotations",Zn.NotAllowed);so.is(l)&&As.is(c)&&c.drag(l,h,r,p),(Me.is(l)||eo.is(l))&&Uo.is(c)&&c.drag(l,h,r,p),ti.is(l)&&Is.is(c)&&c.drag(l,h,r,p),ei.is(l)&&Ts.is(c)&&c.drag(l,h,r,p),this.update()}onDragAdding(t){const{active:e,annotationData:i,annotations:o,seriesRect:s,state:a,ctx:{interactionManager:n}}=this,r=this.getAnnotationContext();if(i==null||r==null)return;const l=e!=null?i[e]:void 0,c=e!=null?o.nodes()[e]:void 0,h=Dt.sub(Dt.fromOffset(t),Dt.required(s));n.pushState(bi.Annotations);const p=ce(h,r),u={datum:l,node:c,point:p};a.transition("drag",u),this.active=i.length-1,this.update()}onDragEnd(t){const{active:e,annotations:i,ctx:{cursorManager:o,interactionManager:s}}=this;this.state.is("idle")&&(s.popState(bi.Annotations),o.updateCursor("annotations"),e!=null&&(i.nodes()[e].stopDragging(),this.update()))}onCancel(){this.state.is("idle")||this.cancel(),this.reset(),this.update()}onDelete(){const{active:t,annotationData:e,state:i}=this;t!=null&&(i.is("idle")||i.transition("cancel"),e.splice(t,1),this.reset(),this.update())}toggleAnnotationOptionsButtons(){const{active:t,annotationData:e,ctx:{toolbarManager:i}}=this;if(t==null)return;const o=e.at(t)?.locked??!1;i.toggleButton("annotationOptions","line-color",{enabled:!o}),i.toggleButton("annotationOptions","delete",{enabled:!o}),i.toggleButton("annotationOptions","lock",{visible:!o}),i.toggleButton("annotationOptions","unlock",{visible:o})}getTypedDatum(t){if(so.is(t)||Me.is(t)||eo.is(t)||ti.is(t)||ei.is(t))return t}colorDatum(t,e){t.stroke=e,"axisLabel"in t&&(t.axisLabel.fill=e,t.axisLabel.stroke=e),"background"in t&&(t.background.fill=e)}isOtherElement({targetElement:t}){const{colorPicker:e,ctx:{domManager:i}}=this;return t?ks.isChildElement(i,t)||e.isChildElement(t):!1}clear(){this.annotationData.splice(0,this.annotationData.length),this.reset()}reset(){this.active!=null&&this.annotations.nodes().at(this.active)?.toggleActive(!1),this.hovered=void 0,this.active=void 0,this.ctx.toolbarManager.toggleGroup("annotations","annotationOptions",!1),this.colorPicker.hide()}cancel(){const{active:t,annotationData:e,state:i}=this;i.transition("cancel"),t!=null&&e&&e.splice(t,1)}update(){this.ctx.updateService.update(Tx.PERFORM_LAYOUT,{skipAnimations:!0})}};d([ms.ObserveChanges((t,e)=>{const{ctx:{annotationManager:i,stateManager:o,toolbarManager:s}}=t;s.toggleGroup("annotations","annotations",!!e),t.__hackWasDisabled&&e?(o.restoreState(i),t.__hackWasDisabled=!1):e===!1&&(t.__hackWasDisabled=!0,t.clear())}),Qn(Eh)],Rh.prototype,"enabled",2);var wx={type:"root",optionsKey:"annotations",packageType:"enterprise",chartTypes:["cartesian"],dependencies:["toolbar"],instanceConstructor:Rh,themeTemplate:{annotations:{line:{stroke:Rt.DEFAULT_ANNOTATION_STROKE,strokeWidth:2,strokeOpacity:1,handle:{fill:Rt.DEFAULT_ANNOTATION_HANDLE_FILL}},"horizontal-line":{stroke:Rt.DEFAULT_ANNOTATION_STROKE,strokeWidth:2,strokeOpacity:1,handle:{fill:Rt.DEFAULT_ANNOTATION_HANDLE_FILL},axisLabel:{enabled:!0,color:"white",fill:Rt.DEFAULT_ANNOTATION_STROKE,fontSize:12,fontFamily:Rt.DEFAULT_FONT_FAMILY}},"vertical-line":{stroke:Rt.DEFAULT_ANNOTATION_STROKE,strokeWidth:2,strokeOpacity:1,handle:{fill:Rt.DEFAULT_ANNOTATION_HANDLE_FILL},axisLabel:{enabled:!0,color:"white",fill:Rt.DEFAULT_ANNOTATION_STROKE,fontSize:12,fontFamily:Rt.DEFAULT_FONT_FAMILY}},"disjoint-channel":{stroke:Rt.DEFAULT_ANNOTATION_STROKE,strokeWidth:2,strokeOpacity:1,background:{fill:Rt.DEFAULT_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2},handle:{fill:Rt.DEFAULT_ANNOTATION_HANDLE_FILL}},"parallel-channel":{stroke:Rt.DEFAULT_ANNOTATION_STROKE,strokeWidth:2,strokeOpacity:1,middle:{lineDash:[6,5],strokeWidth:1},background:{fill:Rt.DEFAULT_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2},handle:{fill:Rt.DEFAULT_ANNOTATION_HANDLE_FILL}}}}};import{_ModuleSupport as Jn}from"ag-charts-community";import{_ModuleSupport as Px,_Scene as Bx}from"ag-charts-community";var{Image:zx}=Bx,{BaseProperties:Vx,ObserveChanges:Fx,ProxyProperty:Ux,Validate:Di,NUMBER:Ls,POSITIVE_NUMBER:_h,RATIO:Hx,createElement:Kx,calculatePlacement:Gx}=Px,Ce=class extends Vx{constructor(){super(),this.opacity=1,this.loadedSynchronously=!0,this.containerWidth=0,this.containerHeight=0,this.onLoad=void 0,this.onImageLoad=()=>{this.loadedSynchronously||(this.node.visible=!1,this.performLayout(this.containerWidth,this.containerHeight),this.onLoad?.())},this.imageElement=Kx("img"),this.imageElement.onload=this.onImageLoad,this.node=new zx(this.imageElement)}get complete(){return this.imageElement.width>0&&this.imageElement.height>0}performLayout(t,e){this.containerWidth=t,this.containerHeight=e,this.node.setProperties(this.complete?{visible:!0,opacity:this.opacity,...Gx(this.imageElement.width,this.imageElement.height,this.containerWidth,this.containerHeight,this)}:{visible:!1})}};d([Di(Ls,{optional:!0})],Ce.prototype,"top",2),d([Di(Ls,{optional:!0})],Ce.prototype,"right",2),d([Di(Ls,{optional:!0})],Ce.prototype,"bottom",2),d([Di(Ls,{optional:!0})],Ce.prototype,"left",2),d([Di(_h,{optional:!0})],Ce.prototype,"width",2),d([Di(_h,{optional:!0})],Ce.prototype,"height",2),d([Di(Hx)],Ce.prototype,"opacity",2),d([Ux("imageElement.src"),Fx(t=>t.loadedSynchronously=t.complete)],Ce.prototype,"url",2);var{ActionOnSet:Wx,OBJECT:jx,Validate:Yx}=Jn,Ch=class extends Jn.Background{constructor(t){super(t),this.ctx=t,this.image=new Ce}onLayoutComplete(t){if(super.onLayoutComplete(t),this.image){const{width:e,height:i}=t.chart;this.image.performLayout(e,i)}}onImageLoad(){this.ctx.updateService.update(Jn.ChartUpdateType.SCENE_RENDER)}};d([Yx(jx,{optional:!0}),Wx({newValue(t){this.node.appendChild(t.node),t.onLoad=()=>this.onImageLoad()},oldValue(t){this.node.removeChild(t.node),t.onLoad=void 0}})],Ch.prototype,"image",2);var Xx={type:"root",optionsKey:"background",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion"],instanceConstructor:Ch};import{_Theme as Zx}from"ag-charts-community";import{_ModuleSupport as Ni,_Util as Qx}from"ag-charts-community";var $x=".ag-chart-context-menu{background:rgb(248,248,248);border:1px solid #babfc7;border-radius:5px;box-shadow:0 1px 4px 1px rgba(186,191,199,0.4);color:rgb(24,29,31);font:13px Verdana,sans-serif;transition:transform 0.1s ease;white-space:nowrap;z-index:var(--ag-charts-layer-context-menu)}.ag-chart-context-menu.ag-charts-dark-context-menu{color:white;background:#15181c}.ag-chart-context-menu__cover{position:fixed;left:0px;top:0px}.ag-chart-context-menu__menu{display:flex;flex-direction:column;padding:0.5em 0}.ag-chart-context-menu__menu:focus{outline:none}.ag-chart-context-menu__item{background:none;border:none;box-sizing:border-box;font:inherit;padding:0.5em 1em;text-align:left;-webkit-appearance:none;-moz-appearance:none}.ag-chart-context-menu__item.ag-charts-dark-context-menu{color:white}.ag-chart-context-menu__item:hover{background:rgb(33,150,243,0.1)}.ag-chart-context-menu__item:hover.ag-charts-dark-context-menu{background:rgb(33,150,243,0.1)}.ag-chart-context-menu__item:active{background:rgb(33,150,243,0.2)}.ag-chart-context-menu__item:active.ag-charts-dark-context-menu{background:rgb(33,150,243,0.1)}.ag-chart-context-menu__item[aria-disabled='true']{border:none;opacity:0.5;text-align:left}.ag-chart-context-menu__item[aria-disabled='true']:hover{background:inherit;cursor:inherit}.ag-chart-context-menu__divider{margin:5px 0;background:#babfc7;height:1px}.ag-chart-context-menu__divider.ag-charts-dark-context-menu{background:rgb(33,150,243,0.1)}",Es="ag-chart-context-menu",Rs="ag-charts-dark-context-menu",{BOOLEAN:wh,Validate:Ph,createElement:tr,initMenuKeyNav:qx,makeAccessibleClickListener:Jx,ContextMenuRegistry:_s}=Ni,Cs="context-menu";function tS(t,e){const{children:i}=t??{};if(!i)return[];const o=[];for(let s=0;s<i.length;s++){const a=i[s];a instanceof e&&o.push(a)}return o}var er=class extends Ni.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!0,this.darkTheme=!1,this.extraActions=[],this.extraNodeActions=[],this.extraLegendItemActions=[],this.x=0,this.y=0,this.menuElementDestroyFns=[],this.interactionManager=t.interactionManager,this.registry=t.contextMenuRegistry,this.scene=t.scene;const{All:e}=Ni.InteractionState;if(this.destroyFns.push(t.regionManager.listenAll("click",i=>this.onClick(),e)),this.groups={default:[],extra:[],extraSeries:[],extraNode:[],extraLegendItem:[]},this.element=t.domManager.addChild("canvas-overlay",Cs),this.element.classList.add(Es),this.element.addEventListener("contextmenu",i=>i.preventDefault()),this.destroyFns.push(()=>this.element.parentNode?.removeChild(this.element)),this.hide(),this.destroyFns.push(t.domManager.addListener("hidden",()=>this.hide())),typeof MutationObserver<"u"){const i=new MutationObserver(()=>{this.menuElement&&this.element.contains(this.menuElement)&&this.reposition()});i.observe(this.element,{childList:!0}),this.mutationObserver=i,this.destroyFns.push(()=>i.disconnect())}t.domManager.addStyles(Cs,$x),this.registry.registerDefaultAction({id:"download",type:"all",label:"contextMenuDownload",action:()=>{const i=t.chartService.title;let o="image";i?.enabled&&i?.text!==void 0&&(o=i.text),this.scene.download(o)}}),this.destroyFns.push(this.registry.addListener(i=>this.onContext(i)))}isShown(){return this.menuElement!==void 0}onClick(){this.isShown()&&this.hide()}onContext(t){if(!this.enabled)return;t.preventDefault(),this.showEvent=t.sourceEvent,this.x=t.x,this.y=t.y,this.groups.default=this.registry.filterActions(t.type),this.pickedNode=void 0,this.pickedLegendItem=void 0,this.groups.extra=this.extraActions.map(({label:n,action:r})=>({type:"all",label:n,action:r})),_s.check("series",t)&&(this.pickedNode=t.context.pickedNode,this.pickedNode&&(this.groups.extraNode=this.extraNodeActions.map(({label:n,action:r})=>({type:"node",label:n,action:r})))),_s.check("legend",t)&&(this.pickedLegendItem=t.context.legendItem,this.pickedLegendItem&&(this.groups.extraLegendItem=this.extraLegendItemActions.map(({label:n,action:r})=>({type:"legend",label:n,action:r}))));const{default:e,extra:i,extraNode:o,extraLegendItem:s}=this.groups;[e,i,o,s].reduce((n,r)=>r.length+n,0)!==0&&(this.lastFocus=this.getLastFocus(t),this.show())}getLastFocus(t){if(t.sourceEvent.target instanceof HTMLElement&&"tabindex"in t.sourceEvent.target.attributes)return t.sourceEvent.target}show(){this.interactionManager.pushState(Ni.InteractionState.ContextMenu),this.element.classList.toggle(Rs,this.darkTheme);const t=this.renderMenu();this.menuElement?(this.element.replaceChild(t,this.menuElement),this.menuElementDestroyFns.forEach(i=>i())):this.element.appendChild(t),this.menuElement=t,this.element.style.display="block";const e=tS(t,HTMLButtonElement);this.menuElementDestroyFns=qx({menu:t,buttons:e,orientation:"vertical",onEscape:()=>this.hide()}),t.focus()}hide(){this.interactionManager.popState(Ni.InteractionState.ContextMenu),this.menuElement&&(this.element.removeChild(this.menuElement),this.menuElement=void 0,this.menuElementDestroyFns.forEach(t=>t()),this.menuElementDestroyFns.length=0),this.element.style.display="none",this.lastFocus?.focus(),this.lastFocus=void 0}renderMenu(){const t=tr("div");return t.classList.add(`${Es}__menu`),t.classList.toggle(Rs,this.darkTheme),t.role="menu",this.appendMenuGroup(t,this.groups.default,!1),this.appendMenuGroup(t,this.groups.extra),this.pickedNode&&this.appendMenuGroup(t,this.groups.extraNode),this.pickedLegendItem&&this.appendMenuGroup(t,this.groups.extraLegendItem),t}appendMenuGroup(t,e,i=!0){e.length!==0&&(i&&t.appendChild(this.createDividerElement()),e.forEach(o=>{const s=this.renderItem(o);s&&t.appendChild(s)}))}renderItem(t){if(t&&typeof t=="object"&&t.constructor===Object)return this.createActionElement(t)}createDividerElement(){const t=tr("div");return t.classList.add(`${Es}__divider`),t.classList.toggle(Rs,this.darkTheme),t.role="separator",t}createActionElement({id:t,label:e,type:i,action:o}){const s=!!(t&&this.registry.isDisabled(t));return this.createButtonElement(i,e,o,s)}createButtonOnClick(t,e){return _s.checkCallback("legend",t,e)?()=>{if(this.pickedLegendItem){const{seriesId:i,itemId:o,enabled:s}=this.pickedLegendItem;e({type:"contextmenu",seriesId:i,itemId:o,enabled:s}),this.hide()}}:_s.checkCallback("node",t,e)?()=>{const{pickedNode:i,showEvent:o}=this,s=i?.series.createNodeContextMenuActionEvent(o,i);s?e(s):Qx.Logger.error("series node not found"),this.hide()}:()=>{e({type:"contextMenuEvent",event:this.showEvent}),this.hide()}}createButtonElement(t,e,i,o){const s=tr("button");return s.classList.add(`${Es}__item`),s.classList.toggle(Rs,this.darkTheme),s.ariaDisabled=o.toString(),s.textContent=this.ctx.localeManager.t(e),s.role="menuitem",s.onclick=Jx(s,this.createButtonOnClick(t,i)),s}reposition(){let{x:t,y:e}=this;this.element.style.top="unset",this.element.style.bottom="unset";const i=this.ctx.domManager.getBoundingClientRect(),{offsetWidth:o,offsetHeight:s}=this.element;t=Ni.clamp(0,t,i.width-o),e=Ni.clamp(0,e,i.height-s),this.element.style.left=`${t}px`,this.element.style.top=`calc(${e}px - 0.5em)`}destroy(){super.destroy(),this.mutationObserver?.disconnect(),this.ctx.domManager.removeStyles(Cs),this.ctx.domManager.removeChild("canvas-overlay",Cs)}};d([Ph(wh)],er.prototype,"enabled",2),d([Ph(wh)],er.prototype,"darkTheme",2);var eS={type:"root",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion"],optionsKey:"contextMenu",instanceConstructor:er,themeTemplate:{contextMenu:{enabled:!0,darkTheme:Zx.IS_DARK_THEME}}};import{_ModuleSupport as Bh,_Scene as zh,_Util as iS}from"ag-charts-community";import{_ModuleSupport as oS,_Scene as Vh,_Util as Fh}from"ag-charts-community";var sS=".ag-crosshair-label{position:absolute;left:0px;top:0px;user-select:none;pointer-events:none;font:12px Verdana,sans-serif;overflow:hidden;white-space:nowrap;z-index:var(--ag-charts-layer-crosshair);box-sizing:border-box}.ag-crosshair-label-content{padding:0 8px;border-radius:2px;line-height:20px;background-color:var(--ag-charts-axis-label-background-color);color:var(--ag-charts-axis-label-color)}.ag-crosshair-label-hidden{top:-10000px!important}",{ActionOnSet:aS,BaseProperties:nS,BOOLEAN:Uh,FUNCTION:Hh,NUMBER:ws,STRING:Ps,Validate:Jt}=oS,{setAttribute:rS}=Fh,lS="ag-crosshair-label",vi=class extends Vh.ChangeDetectableProperties{constructor(){super(...arguments),this.enabled=!0,this.xOffset=0,this.yOffset=0,this.format=void 0,this.renderer=void 0}};d([Jt(Uh)],vi.prototype,"enabled",2),d([Jt(Ps,{optional:!0})],vi.prototype,"className",2),d([Jt(ws)],vi.prototype,"xOffset",2),d([Jt(ws)],vi.prototype,"yOffset",2),d([Jt(Ps,{optional:!0})],vi.prototype,"format",2),d([Jt(Hh,{optional:!0})],vi.prototype,"renderer",2);var Ii=class extends nS{constructor(t){super(),this.domManager=t,this.id=Fh.createId(this),this.enabled=!0,this.xOffset=0,this.yOffset=0,this.renderer=void 0,this.element=t.addChild("canvas-overlay",`crosshair-label-${this.id}`),this.element.classList.add(lS),rS(this.element,"aria-hidden",!0),this.domManager.addStyles("crosshair-labels",sS)}show(t){const{element:e}=this,i=t.x+this.xOffset,o=t.y+this.yOffset;e.style.top=`${Math.round(o)}px`,e.style.left=`${Math.round(i)}px`,this.toggle(!0)}setLabelHtml(t){t!==void 0&&(this.element.innerHTML=t)}computeBBox(){const{element:t}=this;return new Vh.BBox(t.clientLeft,t.clientTop,t.clientWidth,t.clientHeight)}toggle(t){this.element.classList.toggle("ag-crosshair-label-hidden",!t)}destroy(){this.domManager.removeChild("canvas-overlay",`crosshair-label-${this.id}`)}toLabelHtml(t,e){if(typeof t=="string")return t;e=e??{};const{text:i=e.text??"",color:o=e.color,backgroundColor:s=e.backgroundColor,opacity:a=e.opacity??1}=t;return`<div class="ag-crosshair-label-content" style="${`opacity: ${a}; background-color: ${s?.toLowerCase()}; color: ${o}`}">
                    <span>${i}</span>
                </div>`}};d([Jt(Uh)],Ii.prototype,"enabled",2),d([Jt(Ps,{optional:!0}),aS({changeValue(t,e){t!==e&&(e&&this.element.classList.remove(e),t&&this.element.classList.add(t))}})],Ii.prototype,"className",2),d([Jt(ws)],Ii.prototype,"xOffset",2),d([Jt(ws)],Ii.prototype,"yOffset",2),d([Jt(Ps,{optional:!0})],Ii.prototype,"format",2),d([Jt(Hh,{optional:!0})],Ii.prototype,"renderer",2);var{Group:Kh,Line:Gh,BBox:ir}=zh,{createId:cS}=iS,{POSITIVE_NUMBER:Wh,RATIO:hS,BOOLEAN:jh,COLOR_STRING:dS,LINE_DASH:pS,OBJECT:uS,InteractionState:Yh,Validate:ii,Layers:Xh}=Bh,we=class extends Bh.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.id=cS(this),this.enabled=!1,this.stroke="rgb(195, 195, 195)",this.lineDash=[6,3],this.lineDashOffset=0,this.strokeWidth=1,this.strokeOpacity=1,this.snap=!0,this.label=new vi,this.seriesRect=new ir(0,0,0,0),this.hoverRect=new ir(0,0,0,0),this.bounds=new ir(0,0,0,0),this.visible=!1,this.crosshairGroup=new Kh({layer:!0,zIndex:Xh.SERIES_CROSSHAIR_ZINDEX}),this.lineGroup=this.crosshairGroup.appendChild(new Kh({name:`${this.id}-crosshair-lines`,zIndex:Xh.SERIES_CROSSHAIR_ZINDEX})),this.lineGroupSelection=zh.Selection.select(this.lineGroup,Gh,!1),this.activeHighlight=void 0,this.axisCtx=t.parent,this.crosshairGroup.visible=!1,this.labels={};const e=t.regionManager.getRegion("series"),i=Yh.Default|Yh.Annotations;this.destroyFns.push(t.scene.attachNode(this.crosshairGroup),e.addListener("hover",o=>this.onMouseMove(o),i),e.addListener("drag",o=>this.onMouseMove(o),i),e.addListener("leave",()=>this.onMouseOut(),i),t.highlightManager.addListener("highlight-change",o=>this.onHighlightChange(o)),t.layoutService.addListener("layout-complete",o=>this.layout(o)),()=>Object.entries(this.labels).forEach(([o,s])=>s.destroy()))}layout({series:{rect:t,paddedRect:e,visible:i},axes:o}){if(!(i&&o&&this.enabled)){this.visible=!1;return}this.visible=!0,this.seriesRect=t,this.hoverRect=e;const{position:s="left",axisId:a}=this.axisCtx,n=o.find(p=>p.id===a);if(!n)return;this.axisLayout=n;const r=n.gridPadding+n.seriesAreaPadding;this.bounds=eh(t,s,r);const{crosshairGroup:l,bounds:c}=this;l.translationX=Math.round(c.x),l.translationY=Math.round(c.y);const h=["pointer",...this.axisCtx.seriesKeyProperties()];this.updateSelections(h),this.updateLines(),this.updateLabels(h)}updateSelections(t){this.lineGroupSelection.update(t,e=>e.append(new Gh),e=>e)}updateLabels(t){const{labels:e,ctx:i}=this;t.forEach(o=>{e[o]??(e[o]=new Ii(i.domManager)),this.updateLabel(e[o])}),this.labelFormatter=this.axisCtx.scaleValueFormatter(this.label.format)}updateLabel(t){const{enabled:e,className:i,xOffset:o,yOffset:s,format:a,renderer:n}=this.label;t.enabled=e,t.className=i,t.xOffset=o,t.yOffset=s,t.format=a,t.renderer=n}updateLines(){const{lineGroupSelection:t,bounds:e,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,axisLayout:r}=this;if(!r)return;const l=this.isVertical();t.each(c=>{c.stroke=i,c.strokeWidth=o,c.strokeOpacity=s,c.lineDash=a,c.lineDashOffset=n,c.y1=0,c.y2=l?e.height:0,c.x1=0,c.x2=l?0:e.width})}isVertical(){return this.axisCtx.direction==="x"}formatValue(t){const{labelFormatter:e,axisLayout:i,ctx:{callbackCache:o}}=this;if(e){const n=o.call(e,t);if(n!==void 0)return n}const s=t%1===0,a=(i?.label.fractionDigits??0)+(s?0:1);return typeof t=="number"?t.toFixed(a):String(t)}onMouseMove(t){if(!this.enabled||this.snap)return;const{crosshairGroup:e,hoverRect:i}=this,{offsetX:o,offsetY:s}=t;if(this.visible&&i.containsPoint(o,s)){e.visible=!0;const a=this.getData(t);this.updatePositions(a)}else this.hideCrosshairs()}onMouseOut(){this.hideCrosshairs()}onHighlightChange(t){if(!this.enabled)return;const{crosshairGroup:e,axisCtx:i}=this,{datum:o,series:s}=t.currentHighlight??{},a=o&&(s?.axes.x?.id===i.axisId||s?.axes.y?.id===i.axisId);if(this.activeHighlight=a?t.currentHighlight:void 0,this.snap){if(!this.visible||!this.activeHighlight){this.hideCrosshairs();return}const n=this.getActiveHighlightData(this.activeHighlight);this.updatePositions(n),e.visible=!0}}updatePositions(t){const{seriesRect:e,lineGroupSelection:i}=this;i.each((o,s)=>{const a=t[s];if(!a){o.visible=!1;return}o.visible=!0;const{value:n,position:r}=a;let l=0,c=0;this.isVertical()?(l=r,o.translationX=Math.round(l)):(c=r,o.translationY=Math.round(c)),this.label.enabled?this.showLabel(l+e.x,c+e.y,n,s):this.hideLabel(s)})}getData(t){const{seriesRect:e,axisCtx:i}=this,o="pointer",{datum:s,xKey:a="",yKey:n=""}=this.activeHighlight??{},{offsetX:r,offsetY:l}=t,c=r-e.x,h=l-e.y,p=this.isVertical(),u=p?c:h;return{[o]:{position:u,value:i.continuous?i.scaleInvert(u):s?.[p?a:n]??""}}}getActiveHighlightData(t){const{axisCtx:e}=this,{datum:i,series:o,xKey:s="",aggregatedValue:a,cumulativeValue:n,midPoint:r}=t,l=o.getKeyProperties(e.direction),c=e.scaleBandwidth()/2,h=o.axes[e.direction]?.id===e.axisId,p=l.indexOf("yKey")>-1&&h,u=l.indexOf("xKey")>-1&&h;if(p&&a!==void 0)return{yKey:{value:a,position:e.scaleConvert(a)+c}};if(p&&n!==void 0)return{yKey:{value:n,position:e.scaleConvert(n)+c}};if(u){const g=(this.isVertical()?r?.x:r?.y)??0;return{xKey:{value:e.continuous?e.scaleInvert(g):i[s],position:g}}}const m={};return l.forEach(g=>{const y=o.properties[g],f=i[y],M=e.scaleConvert(f)+c;m[g]={value:f,position:M}}),m}getLabelHtml(t,e){const{label:{renderer:i},axisLayout:{label:{fractionDigits:o=0}={}}={}}=this,s={text:this.formatValue(t)};if(i){const a={value:t,fractionDigits:o};return e.toLabelHtml(i(a),s)}return e.toLabelHtml(s)}showLabel(t,e,i,o){const{axisCtx:{position:s,direction:a},bounds:n,axisLayout:r}=this;if(!r)return;const{label:{padding:l},tickSize:c}=r,h=l+c,p=this.labels[o],u=this.getLabelHtml(i,p);p.setLabelHtml(u);const m=p.computeBBox(),g=df({x:t,y:e,labelBBox:m,bounds:n,axisPosition:s,axisDirection:a,padding:h});p.show(g)}hideCrosshairs(){this.crosshairGroup.visible=!1;for(const t in this.labels)this.hideLabel(t)}hideLabel(t){this.labels[t].toggle(!1)}};d([ii(jh)],we.prototype,"enabled",2),d([ii(dS,{optional:!0})],we.prototype,"stroke",2),d([ii(pS,{optional:!0})],we.prototype,"lineDash",2),d([ii(Wh)],we.prototype,"lineDashOffset",2),d([ii(Wh)],we.prototype,"strokeWidth",2),d([ii(hS)],we.prototype,"strokeOpacity",2),d([ii(jh)],we.prototype,"snap",2),d([ii(uS)],we.prototype,"label",2);import{_Theme as Zh}from"ag-charts-community";var gS={crosshair:{enabled:!0,snap:!0,stroke:Zh.DEFAULT_MUTED_LABEL_COLOUR,strokeWidth:1,strokeOpacity:1,lineDash:[5,6],lineDashOffset:0,label:{enabled:!0}},category:{crosshair:{enabled:!1,snap:!0,stroke:Zh.DEFAULT_MUTED_LABEL_COLOUR,strokeWidth:1,strokeOpacity:1,lineDash:[5,6],lineDashOffset:0,label:{enabled:!0}}}},yS={type:"axis-option",optionsKey:"crosshair",packageType:"enterprise",chartTypes:["cartesian"],axisTypes:["category","ordinal-time","number","log","time"],instanceConstructor:we,themeTemplate:gS};import{_ModuleSupport as Qh}from"ag-charts-community";var{BOOLEAN:mS,FUNCTION:fS,ActionOnSet:Ho,Validate:$h}=Qh,no=class extends Qh.BaseModuleInstance{constructor(t){super(),this.enabled=!1,this.getData=()=>Promise.resolve(),this.dataService=t.dataService}updateCallback(t,e){this.dataService&&(t&&e!=null?this.dataService.updateCallback(e):this.dataService.clearCallback())}};d([Ho({newValue(t){this.updateCallback(t,this.getData)}}),$h(mS)],no.prototype,"enabled",2),d([Ho({newValue(t){this.updateCallback(this.enabled,t)}}),$h(fS)],no.prototype,"getData",2),d([Ho({newValue(t){this.dataService.requestThrottle=t}})],no.prototype,"requestThrottle",2),d([Ho({newValue(t){this.dataService.dispatchThrottle=t}})],no.prototype,"updateThrottle",2),d([Ho({newValue(t){this.dataService.dispatchOnlyLatest=!t}})],no.prototype,"updateDuringInteraction",2);var xS={type:"root",optionsKey:"dataSource",packageType:"enterprise",chartTypes:["cartesian","hierarchy","polar","topology","flow-proportion"],instanceConstructor:no,themeTemplate:{dataSource:{enabled:!1}}};import{AgErrorBarSupportedSeriesTypes as SS}from"ag-charts-community";import{AgErrorBarSupportedSeriesTypes as qh,_ModuleSupport as or,_Scene as MS,_Util as bS}from"ag-charts-community";import{_ModuleSupport as DS,_Scene as Ko}from"ag-charts-community";var{nearestSquaredInContainer:NS,partialAssign:vS,mergeDefaults:Jh}=DS,{BBox:Pe}=Ko,IS=class{constructor(t){this.components=t,this.union=Pe.merge(t)}containsPoint(t,e){if(!this.union.containsPoint(t,e))return!1;for(const i of this.components)if(i.containsPoint(t,e))return!0;return!1}},AS=class extends Ko.Group{constructor(){super(),this.capLength=NaN,this._datum=void 0,this.whiskerPath=new Ko.Path,this.capsPath=new Ko.Path,this.bboxes=new IS([]),this.append([this.whiskerPath,this.capsPath])}get datum(){return this._datum}set datum(t){this._datum=t}calculateCapLength(t,e){const{lengthRatio:i=1,length:o}=t,{lengthRatioMultiplier:s,lengthMax:a}=e,n=o??i*s;return Math.min(n,a)}getItemStylerParams(t,e,i){const{datum:o}=this;if(o==null||t.itemStyler==null)return;const{xLowerKey:s,xUpperKey:a,yLowerKey:n,yUpperKey:r}=t;return{...e,datum:o.datum,seriesId:o.datum.seriesId,xKey:o.xKey,yKey:o.yKey,xLowerKey:s,xUpperKey:a,yLowerKey:n,yUpperKey:r,highlighted:i}}formatStyles(t,e,i){let{cap:o,...s}=t;const a=this.getItemStylerParams(e,t,i);if(a!=null&&e.itemStyler!=null){const n=e.itemStyler(a);s=Jh(n,s),o=Jh(n?.cap,n,o)}return{whiskerStyle:s,capsStyle:o}}applyStyling(t,e){vS(["visible","stroke","strokeWidth","strokeOpacity","lineDash","lineDashOffset"],t,e)}update(t,e,i){if(this.datum===void 0)return;const{whiskerStyle:o,capsStyle:s}=this.formatStyles(t,e,i),{xBar:a,yBar:n,capDefaults:r}=this.datum,l=this.whiskerPath;this.applyStyling(l,o),l.path.clear(),n!==void 0&&(l.path.moveTo(n.lowerPoint.x,n.lowerPoint.y),l.path.lineTo(n.upperPoint.x,n.upperPoint.y)),a!==void 0&&(l.path.moveTo(a.lowerPoint.x,a.lowerPoint.y),l.path.lineTo(a.upperPoint.x,a.upperPoint.y)),l.path.closePath(),l.markDirtyTransform(),this.capLength=this.calculateCapLength(s??{},r);const c=this.capLength/2,h=this.capsPath;this.applyStyling(h,s),h.path.clear(),n!==void 0&&(h.path.moveTo(n.lowerPoint.x-c,n.lowerPoint.y),h.path.lineTo(n.lowerPoint.x+c,n.lowerPoint.y),h.path.moveTo(n.upperPoint.x-c,n.upperPoint.y),h.path.lineTo(n.upperPoint.x+c,n.upperPoint.y)),a!==void 0&&(h.path.moveTo(a.lowerPoint.x,a.lowerPoint.y-c),h.path.lineTo(a.lowerPoint.x,a.lowerPoint.y+c),h.path.moveTo(a.upperPoint.x,a.upperPoint.y-c),h.path.lineTo(a.upperPoint.x,a.upperPoint.y+c)),h.path.closePath(),h.markDirtyTransform()}updateBBoxes(){const{capLength:t,whiskerPath:e,capsPath:i}=this,{yBar:o,xBar:s}=this.datum??{},a=t/2,n=[];if(o!==void 0){const r=o.lowerPoint.y-o.upperPoint.y;n.push(new Pe(o.lowerPoint.x,o.upperPoint.y,e.strokeWidth,r),new Pe(o.lowerPoint.x-a,o.lowerPoint.y,t,i.strokeWidth),new Pe(o.upperPoint.x-a,o.upperPoint.y,t,i.strokeWidth))}if(s!==void 0){const r=s.upperPoint.x-s.lowerPoint.x;n.push(new Pe(s.lowerPoint.x,s.upperPoint.y,r,e.strokeWidth),new Pe(s.lowerPoint.x,s.lowerPoint.y-a,i.strokeWidth,t),new Pe(s.upperPoint.x,s.upperPoint.y-a,i.strokeWidth,t))}this.bboxes.components=n,this.bboxes.union=Pe.merge(n)}containsPoint(t,e){return this.bboxes.containsPoint(t,e)}pickNode(t,e){return this.containsPoint(t,e)?this:void 0}nearestSquared(t,e,i){const{bboxes:o}=this;if(o.union.distanceSquared(t,e)>i)return{nearest:void 0,distanceSquared:1/0};const{distanceSquared:s}=Pe.nearestBox(t,e,o.components);return{nearest:this,distanceSquared:s}}},TS=class extends Ko.Group{get children(){return super.children}nearestSquared(t,e){const{nearest:i,distanceSquared:o}=NS(t,e,this);if(i!==void 0&&!isNaN(o))return{datum:i.datum,distanceSquared:o}}};import{_ModuleSupport as kS}from"ag-charts-community";var{BaseProperties:td,Validate:at,BOOLEAN:ed,COLOR_STRING:id,FUNCTION:OS,LINE_DASH:od,NUMBER:LS,OBJECT:ES,POSITIVE_NUMBER:Bs,RATIO:sr,STRING:oi}=kS,Be=class extends td{};d([at(ed,{optional:!0})],Be.prototype,"visible",2),d([at(id,{optional:!0})],Be.prototype,"stroke",2),d([at(Bs,{optional:!0})],Be.prototype,"strokeWidth",2),d([at(sr,{optional:!0})],Be.prototype,"strokeOpacity",2),d([at(od,{optional:!0})],Be.prototype,"lineDash",2),d([at(Bs,{optional:!0})],Be.prototype,"lineDashOffset",2),d([at(LS,{optional:!0})],Be.prototype,"length",2),d([at(sr,{optional:!0})],Be.prototype,"lengthRatio",2);var kt=class extends td{constructor(){super(...arguments),this.visible=!0,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.cap=new Be}};d([at(oi,{optional:!0})],kt.prototype,"yLowerKey",2),d([at(oi,{optional:!0})],kt.prototype,"yLowerName",2),d([at(oi,{optional:!0})],kt.prototype,"yUpperKey",2),d([at(oi,{optional:!0})],kt.prototype,"yUpperName",2),d([at(oi,{optional:!0})],kt.prototype,"xLowerKey",2),d([at(oi,{optional:!0})],kt.prototype,"xLowerName",2),d([at(oi,{optional:!0})],kt.prototype,"xUpperKey",2),d([at(oi,{optional:!0})],kt.prototype,"xUpperName",2),d([at(ed,{optional:!0})],kt.prototype,"visible",2),d([at(id,{optional:!0})],kt.prototype,"stroke",2),d([at(Bs,{optional:!0})],kt.prototype,"strokeWidth",2),d([at(sr,{optional:!0})],kt.prototype,"strokeOpacity",2),d([at(od,{optional:!0})],kt.prototype,"lineDash",2),d([at(Bs,{optional:!0})],kt.prototype,"lineDashOffset",2),d([at(OS,{optional:!0})],kt.prototype,"itemStyler",2),d([at(ES)],kt.prototype,"cap",2);var{fixNumericExtent:RS,groupAccumulativeValueProperty:_S,isDefined:jt,mergeDefaults:CS,valueProperty:zs,ChartAxisDirection:ar}=or;function wS(t){for(const e of qh)if(e===t.series.type)return t.series;throw new Error(`AG Charts - unsupported series type '${t.series.type}', error bars supported series types: ${qh.join(", ")}`)}var PS=class us extends or.BaseModuleInstance{constructor(e){super(),this.properties=new kt;const i=wS(e),{annotationGroup:o,annotationSelections:s}=i;this.cartesianSeries=i,this.groupNode=new TS({name:`${o.id}-errorBars`,zIndex:or.Layers.SERIES_LAYER_ZINDEX,zIndexSubOrder:i.getGroupZIndexSubOrder("annotation")}),o.appendChild(this.groupNode),this.selection=MS.Selection.select(this.groupNode,()=>this.errorBarFactory()),s.add(this.selection),this.destroyFns.push(i.addListener("data-processed",a=>this.onDataProcessed(a)),i.addListener("data-update",a=>this.onDataUpdate(a)),i.addListener("visibility-changed",a=>this.onToggleSeriesItem(a)),e.highlightManager.addListener("highlight-change",a=>this.onHighlightChange(a)),()=>o.removeChild(this.groupNode),()=>s.delete(this.selection))}hasErrorBars(){const{xLowerKey:e,xUpperKey:i,yLowerKey:o,yUpperKey:s}=this.properties;return jt(e)&&jt(i)||jt(o)&&jt(s)}isStacked(){const e=this.cartesianSeries.seriesGrouping?.stackCount;return e==null?!1:e>0}getUnstackPropertyDefinition(e){const i=[],{xLowerKey:o,xUpperKey:s,yLowerKey:a,yUpperKey:n,xErrorsID:r,yErrorsID:l}=this.getMaybeFlippedKeys(),{xScaleType:c,yScaleType:h}=e;return a!=null&&n!=null&&i.push(zs(a,h,{id:`${l}-lower`}),zs(n,h,{id:`${l}-upper`})),o!=null&&s!=null&&i.push(zs(o,c,{id:`${r}-lower`}),zs(s,c,{id:`${r}-upper`})),i}getStackPropertyDefinition(e){const i=[],{cartesianSeries:o}=this,{xLowerKey:s,xUpperKey:a,yLowerKey:n,yUpperKey:r,xErrorsID:l,yErrorsID:c}=this.getMaybeFlippedKeys(),{xScaleType:h,yScaleType:p}=e,u=o.seriesGrouping?.groupIndex??o.id,m={invalidValue:null,missingValue:0,separateNegative:!0,...o.visible?{}:{forceValue:0}},g=(f,M,b,S)=>_S(f,"normal","current",{id:`${M}-${b}`,groupId:`errorGroup-${u}-${b}`,...m},S),y=(f,M,b,S)=>{i.push(...g(f,b,"lower",S),...g(M,b,"upper",S))};return n!=null&&r!=null&&y(n,r,c,p),s!=null&&a!=null&&y(s,a,l,h),i}getPropertyDefinitions(e){return this.isStacked()?this.getStackPropertyDefinition(e):this.getUnstackPropertyDefinition(e)}onDataProcessed(e){this.dataModel=e.dataModel,this.processedData=e.processedData}getDomain(e){const{xLowerKey:i,xUpperKey:o,xErrorsID:s,yLowerKey:a,yUpperKey:n,yErrorsID:r}=this.getMaybeFlippedKeys();if(e===ar.X?jt(i)&&jt(o):jt(a)&&jt(n)){const{dataModel:c,processedData:h,cartesianSeries:p}=this;if(c!=null&&h!=null){const u=p.axes[e],m={x:s,y:r}[e],g=c.getDomain(p,`${m}-lower`,"value",h),y=c.getDomain(p,`${m}-upper`,"value",h),f=[Math.min(...g,...y),Math.max(...g,...y)];return RS(f,u)}}return[]}onDataUpdate(e){this.dataModel=e.dataModel,this.processedData=e.processedData,jt(e.dataModel)&&jt(e.processedData)&&(this.createNodeData(),this.update())}getNodeData(){return this.cartesianSeries.contextNodeData?.nodeData}createNodeData(){const e=this.getNodeData(),i=this.cartesianSeries.axes[ar.X]?.scale,o=this.cartesianSeries.axes[ar.Y]?.scale;if(!(!this.hasErrorBars()||!i||!o||!e))for(let s=0;s<e.length;s++){const{midPoint:a,xLower:n,xUpper:r,yLower:l,yUpper:c}=this.getDatum(e,s);if(a!=null){let h,p;jt(n)&&jt(r)&&(h={lowerPoint:{x:this.convert(i,n),y:a.y},upperPoint:{x:this.convert(i,r),y:a.y}}),jt(l)&&jt(c)&&(p={lowerPoint:{x:a.x,y:this.convert(o,l)},upperPoint:{x:a.x,y:this.convert(o,c)}}),e[s].xBar=h,e[s].yBar=p}}}getMaybeFlippedKeys(){let{xLowerKey:e,xUpperKey:i,yLowerKey:o,yUpperKey:s}=this.properties,[a,n]=["xValue-errors","yValue-errors"];return this.cartesianSeries.shouldFlipXY()&&([e,o]=[o,e],[i,s]=[s,i],[a,n]=[n,a]),{xLowerKey:e,xUpperKey:i,xErrorsID:a,yLowerKey:o,yUpperKey:s,yErrorsID:n}}static getDatumKey(e,i,o){if(i==null)return;const s=e.datum[i];if(s!=null){if(typeof s!="number"){bS.Logger.warnOnce(`Found [${i}] error value of type ${typeof s}. Expected number type`);return}return s+o}}getDatum(e,i){const{xLowerKey:o,xUpperKey:s,yLowerKey:a,yUpperKey:n}=this.getMaybeFlippedKeys(),r=e[i],l=r.cumulativeValue==null||!this.isStacked()?0:r.cumulativeValue-r.yValue,[c,h]=this.cartesianSeries.shouldFlipXY()?[l,0]:[0,l];return{midPoint:r.midPoint,xLower:us.getDatumKey(r,o,c),xUpper:us.getDatumKey(r,s,c),yLower:us.getDatumKey(r,a,h),yUpper:us.getDatumKey(r,n,h)}}convert(e,i){const o=(e.bandwidth??0)/2;return e.convert(i)+o}update(){const e=this.getNodeData();e!=null&&(this.selection.update(e),this.selection.each((i,o,s)=>this.updateNode(i,o,s)))}updateNode(e,i,o){e.datum=i,e.update(this.getDefaultStyle(),this.properties,!1),e.updateBBoxes()}pickNodeExact(e){const{x:i,y:o}=this.groupNode.transformPoint(e.x,e.y),s=this.groupNode.pickNode(i,o);if(s!=null)return{datum:s.datum,distanceSquared:0}}pickNodeNearest(e){return this.groupNode.nearestSquared(e.x,e.y)}pickNodeMainAxisFirst(e){return this.groupNode.nearestSquared(e.x,e.y)}getTooltipParams(){const{xLowerKey:e,xUpperKey:i,yLowerKey:o,yUpperKey:s,xLowerName:a=e,xUpperName:n=i,yLowerName:r=o,yUpperName:l=s}=this.properties;return{xLowerKey:e,xLowerName:a,xUpperKey:i,xUpperName:n,yLowerKey:o,yLowerName:r,yUpperKey:s,yUpperName:l}}onToggleSeriesItem(e){this.groupNode.visible=e.enabled}makeStyle(e){return{visible:e.visible,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,stroke:e.stroke,strokeWidth:e.strokeWidth,strokeOpacity:e.strokeOpacity,cap:CS(this.properties.cap,e)}}getDefaultStyle(){return this.makeStyle(this.getWhiskerProperties())}getHighlightStyle(){return this.makeStyle(this.getWhiskerProperties())}restyleHighlightChange(e,i,o){const s=this.getNodeData();if(s!=null){for(let a=0;a<s.length;a++)if(e===s[a]){this.selection.nodes()[a].update(i,this.properties,o);break}}}onHighlightChange(e){const{previousHighlight:i,currentHighlight:o}=e;o?.series===this.cartesianSeries&&this.restyleHighlightChange(o,this.getHighlightStyle(),!0),i?.series===this.cartesianSeries&&this.restyleHighlightChange(i,this.getDefaultStyle(),!1),this.groupNode.opacity=this.cartesianSeries.getOpacity()}errorBarFactory(){return new AS}getWhiskerProperties(){const{stroke:e,strokeWidth:i,visible:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}=this.properties;return{stroke:e,strokeWidth:i,visible:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}}};import{_Theme as BS}from"ag-charts-community";var zS={series:{errorBar:{visible:!0,stroke:BS.DEFAULT_LABEL_COLOUR,strokeWidth:1,strokeOpacity:1,cap:{length:void 0,lengthRatio:void 0}}}},VS={type:"series-option",identifier:"error-bars",optionsKey:"errorBar",packageType:"enterprise",chartTypes:["cartesian"],seriesTypes:SS,instanceConstructor:PS,themeTemplate:zS};import{_ModuleSupport as sd,_Theme as ad}from"ag-charts-community";import{_ModuleSupport as nd}from"ag-charts-community";import{_ModuleSupport as rd,_Scene as FS,_Util as US}from"ag-charts-community";var{Validate:nr,BOOLEAN:HS,POSITIVE_NUMBER:ld,Layers:rr,ActionOnSet:cd,CategoryAxis:KS,GroupedCategoryAxis:GS}=rd,{Padding:WS,Logger:hd}=US,{Text:jS,Group:Vs,BBox:dd}=FS,lr=class{constructor(){this.top=0,this.bottom=0}};d([nr(ld)],lr.prototype,"top",2),d([nr(ld)],lr.prototype,"bottom",2);var Fs=class extends rd.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.padding=new lr,this.root=new Vs({name:"root"}),this.seriesRoot=this.root.appendChild(new Vs({name:"Series-root",layer:!0,zIndex:rr.SERIES_LAYER_ZINDEX})),this.axisGridGroup=this.root.appendChild(new Vs({name:"Axes-Grids",layer:!0,zIndex:rr.AXIS_GRID_ZINDEX})),this.axisGroup=this.root.appendChild(new Vs({name:"Axes-Grids",layer:!0,zIndex:rr.AXIS_GRID_ZINDEX})),this.data=[],this._destroyed=!1,this.miniChartAnimationPhase="initial",this.axes=[],this.series=[]}destroy(){this._destroyed||(this.destroySeries(this.series),this.axes.forEach(t=>t.destroy()),this.axes=[],this._destroyed=!0)}onSeriesChange(t,e){const i=e?.filter(o=>!t.includes(o))??[];this.destroySeries(i);for(const o of t){if(e?.includes(o))continue;o.rootGroup.parent==null&&this.seriesRoot.appendChild(o.rootGroup);const s=this;o.chart={get mode(){return"standalone"},get isMiniChart(){return!0},get seriesRect(){return s.seriesRect},placeLabels(){return new Map}},o.resetAnimation(this.miniChartAnimationPhase==="initial"?"initial":"disabled")}}destroySeries(t){t?.forEach(e=>{e.destroy(),e.rootGroup!=null&&this.seriesRoot.removeChild(e.rootGroup),e.chart=void 0})}assignSeriesToAxes(){this.axes.forEach(t=>{t.boundSeries=this.series.filter(e=>e.axes[t.direction]===t)})}assignAxesToSeries(){const t={};this.axes.forEach(e=>{const i=e.direction;(t[i]??(t[i]=[])).push(e)}),this.series.forEach(e=>{e.directions.forEach(i=>{const o=t[i];if(!o){hd.warnOnce(`no available axis for direction [${i}]; check series and axes configuration.`);return}const s=e.getKeys(i),a=this.findMatchingAxis(o,s);if(!a){hd.warnOnce(`no matching axis for direction [${i}] and keys [${s}]; check series and axes configuration.`);return}e.axes[i]=a})})}findMatchingAxis(t,e){for(const i of t){if(!i.keys.length)return i;if(e){for(const o of e)if(i.keys.includes(o))return i}}}async updateData(t){this.series.forEach(e=>e.setChartData(t.data)),this.miniChartAnimationPhase==="initial"&&this.ctx.animationManager.onBatchStop(()=>{this.miniChartAnimationPhase="ready",this.series.forEach(e=>e.resetAnimation("disabled"))})}async processData(t){this.series.some(i=>i.canHaveAxes)&&(this.assignAxesToSeries(),this.assignSeriesToAxes());const e=this.series.map(i=>i.processData(t.dataController));await Promise.all(e)}computeAxisPadding(){const t=new WS;return this.enabled&&this.axes.forEach(e=>{const{position:i,thickness:o=0,line:s,label:a}=e;if(i==null)return;let n;o>0?n=o:n=(s.enabled?s.width:0)+(a.enabled?(a.fontSize??0)*jS.defaultLineHeightRatio+a.padding:0),t[i]=Math.ceil(n)}),t}async layout(t,e){const{padding:i}=this,o=this.seriesRect!=null,s=new dd(0,0,t,e-(i.top+i.bottom));this.seriesRect=s,this.seriesRoot.translationY=i.top,this.seriesRoot.setClipRectInGroupCoordinateSpace(this.seriesRoot.inverseTransformBBox(new dd(0,-i.top,t,e)));const a=n=>n instanceof KS||n instanceof GS?[0,s.height]:[s.height,0];this.axes.forEach(n=>{const{position:r="left"}=n;switch(r){case"top":case"bottom":n.range=[0,s.width],n.gridLength=s.height;break;case"right":case"left":n.range=a(n),n.gridLength=s.width;break}switch(r){case"top":case"left":n.translation.x=0,n.translation.y=0;break;case"bottom":n.translation.x=0,n.translation.y=e;break;case"right":n.translation.x=t,n.translation.y=0;break}n.gridPadding=0,n.calculateLayout(),n.updatePosition(),n.update(void 0,o)}),await Promise.all(this.series.map(n=>n.update({seriesRect:s})))}};d([nr(HS)],Fs.prototype,"enabled",2),d([cd({changeValue(t,e=[]){for(const i of e)t.includes(i)||(i.detachAxis(this.axisGroup,this.axisGridGroup),i.destroy());for(const i of t)e?.includes(i)||i.attachAxis(this.axisGroup,this.axisGridGroup)}})],Fs.prototype,"axes",2),d([cd({changeValue(t,e){this.onSeriesChange(t,e)}})],Fs.prototype,"series",2);var{ObserveChanges:YS}=nd,pd=class extends nd.Navigator{constructor(t){super(t),this.miniChart=new Fs(t)}async updateData(t){await this.miniChart.updateData(t)}async processData(t){await this.miniChart.processData(t)}async performLayout(t){const{shrinkRect:e}=await super.performLayout(t);if(this.enabled){const{top:i,bottom:o}=this.miniChart.computeAxisPadding();e.shrink(i+o,"bottom"),this.y-=o}return{...t,shrinkRect:e}}async performCartesianLayout(t){await super.performCartesianLayout(t),await this.miniChart.layout(this.width,this.height)}};d([YS((t,e,i)=>{t.updateBackground(i?.root,e?.root)})],pd.prototype,"miniChart",2);var XS={type:"root",optionsKey:"navigator",packageType:"enterprise",chartTypes:["cartesian"],instanceConstructor:pd,themeTemplate:{...sd.NavigatorModule.themeTemplate,navigator:{...sd.NavigatorModule.themeTemplate?.navigator,miniChart:{enabled:!1,label:{color:ad.DEFAULT_LABEL_COLOUR,fontStyle:void 0,fontWeight:void 0,fontSize:10,fontFamily:ad.DEFAULT_FONT_FAMILY,formatter:void 0,padding:0},padding:{top:0,bottom:0}}}}};import{_Theme as Us}from"ag-charts-community";import{_ModuleSupport as ud,_Scene as ZS}from"ag-charts-community";var{Validate:De,OBJECT:cr,BOOLEAN:QS,STRING:ro,valueProperty:$S}=ud,{Label:qS,Text:_t,Group:JS}=ZS,hr=class extends qS{},he=class extends ud.BaseModuleInstance{constructor(t){super(),this.enabled=!1,this.openKey=void 0,this.highKey=void 0,this.lowKey=void 0,this.closeKey=void 0,this.volumeKey=void 0,this.title=new hr,this.positive=new hr,this.negative=new hr,this.layoutStyle="block",this.id="status-bar",this.data=void 0,this.labelGroup=new JS({name:"StatusBar"}),this.labels=[{label:"O",title:this.labelGroup.appendChild(new _t),value:this.labelGroup.appendChild(new _t),id:"openValue",key:"openKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"H",title:this.labelGroup.appendChild(new _t),value:this.labelGroup.appendChild(new _t),id:"highValue",key:"highKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"L",title:this.labelGroup.appendChild(new _t),value:this.labelGroup.appendChild(new _t),id:"lowValue",key:"lowKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"C",title:this.labelGroup.appendChild(new _t),value:this.labelGroup.appendChild(new _t),id:"closeValue",key:"closeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"Vol",title:this.labelGroup.appendChild(new _t),value:this.labelGroup.appendChild(new _t),id:"volumeValue",key:"volumeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2})}],this.highlightManager=t.highlightManager,this.labelGroup.visible=!1,this.destroyFns.push(t.scene.attachNode(this.labelGroup,"titles"),t.layoutService.addListener("before-series",e=>this.startPerformLayout(e)),t.highlightManager.addListener("highlight-change",()=>this.updateHighlight()))}async processData(t){if(!this.enabled)return;const e=[];for(const a of this.labels){const{id:n,key:r}=a,l=this[r];l==null?a.domain=void 0:e.push($S(l,"number",{id:n}))}if(e.length===0||this.data==null)return;const{dataController:i}=t,{processedData:o,dataModel:s}=await i.request(this.id,this.data,{props:e});for(const a of this.labels){const{id:n,key:r}=a;this[r]!=null&&(a.domain=s.getDomain(this,n,"value",o))}}startPerformLayout(t){const{shrinkRect:e}=t,i=4,o=12,s=0,a=8;if(this.labelGroup.translationX=0,this.labelGroup.translationY=0,!this.enabled)return{...t,shrinkRect:e};this.labelGroup.translationY=e.y+s;const n=Math.max(this.title.fontSize,this.positive.fontSize,this.negative.fontSize),r=n*_t.defaultLineHeightRatio;let l=0,c=0,h="alphabetic";if(this.layoutStyle==="block")e.shrink(s+r+a,"top"),c=n+(r-n)/2;else{const{title:p}=t.positions,{title:u=0}=t.padding;l=(p?.x??0)+(p?.width??0)+(p?o:u),h="top",c=s+u}for(const{label:p,title:u,value:m,domain:g,formatter:y}of this.labels){if(g==null){u.visible=!1,m.visible=!1;continue}const f=Math.max(_t.measureText(y.format(g[0]),this.positive.getFont(),h,"left").width,_t.measureText(y.format(g[1]),this.positive.getFont(),h,"left").width,_t.measureText(y.format(g[0]),this.negative.getFont(),h,"left").width,_t.measureText(y.format(g[1]),this.negative.getFont(),h,"left").width);u.visible=!0,m.visible=!0;const M=_t.measureText(p,this.title.getFont(),h,"left");u.setFont(this.title),u.fill=this.title.color,u.text=p,u.textBaseline=h,u.translationY=c,u.translationX=l,l+=M.width+i,m.textBaseline=h,m.translationY=c,m.translationX=l,l+=f+o}return{...t,shrinkRect:e}}async performCartesianLayout(t){this.labelGroup.translationX=t.seriesRect.x}updateHighlight(){if(!this.enabled)return;const t=this.highlightManager.getActiveHighlight();if(t==null){this.labelGroup.visible=!1;return}this.labelGroup.visible=!0;const e=t.datum,i=t.itemId==="up"?this.positive:this.negative;for(const{domain:o,value:s,key:a,formatter:n}of this.labels){if(o==null)continue;const r=this[a],l=r!=null?e?.[r]:void 0;s.setFont(i),s.fill=i.color,s.text=typeof l=="number"?n.format(l):""}}};d([De(QS)],he.prototype,"enabled",2),d([De(ro,{optional:!0})],he.prototype,"openKey",2),d([De(ro,{optional:!0})],he.prototype,"highKey",2),d([De(ro,{optional:!0})],he.prototype,"lowKey",2),d([De(ro,{optional:!0})],he.prototype,"closeKey",2),d([De(ro,{optional:!0})],he.prototype,"volumeKey",2),d([De(cr)],he.prototype,"title",2),d([De(cr)],he.prototype,"positive",2),d([De(cr)],he.prototype,"negative",2),d([De(ro)],he.prototype,"layoutStyle",2);var tM={type:"root",identifier:"status-bar",optionsKey:"statusBar",packageType:"enterprise",chartTypes:["cartesian"],instanceConstructor:he,themeTemplate:{statusBar:{enabled:!1,openKey:void 0,highKey:void 0,lowKey:void 0,closeKey:void 0,volumeKey:void 0,layoutStyle:Us.DEFAULT_CAPTION_LAYOUT_STYLE,title:{color:Us.DEFAULT_LABEL_COLOUR},positive:{color:Us.PALETTE_UP_STROKE},negative:{color:Us.PALETTE_DOWN_STROKE}}}};import{_ModuleSupport as eM,_Util as iM}from"ag-charts-community";var{BOOLEAN:dr,STRING:oM,UNION:sM,BaseProperties:aM,CartesianAxis:gd,ChartUpdateType:yd,arraysEqual:nM,isDate:rM,isDefined:lM,isFiniteNumber:Hs,ObserveChanges:Go,TooltipManager:cM,Validate:Wo}=eM,{Logger:md}=iM,Ai=class extends aM{constructor(t){super(),this.moduleContext=t,this.enabled=!1,this.axes="x",this.nodeInteraction=!0,this.zoom=!0}updateChart(t,e=yd.UPDATE_DATA){t.ctx.updateService.update(e,{skipSync:!0})}updateSiblings(t){const{syncManager:e}=this.moduleContext;(async()=>{for(const o of e.getGroupSiblings(t))await o.waitForDataProcess(120),this.updateChart(o)})().catch(o=>{md.warnOnce("Error updating sibling chart",o)})}enabledZoomSync(){const{syncManager:t,zoomManager:e}=this.moduleContext;this.disableZoomSync=e.addListener("zoom-change",()=>{for(const i of t.getGroupSiblings(this.groupId))i.modulesManager.getModule("sync")?.zoom&&i.ctx.zoomManager.updateZoom("sync",this.mergeZoom(i))})}enabledNodeInteractionSync(){const{highlightManager:t,syncManager:e}=this.moduleContext;this.disableNodeInteractionSync=t.addListener("highlight-change",i=>{for(const o of e.getGroupSiblings(this.groupId))if(o.modulesManager.getModule("sync")?.nodeInteraction){if(!i.currentHighlight?.datum){o.ctx.highlightManager.updateHighlight(o.id),o.ctx.tooltipManager.removeTooltip(o.id);continue}for(const s of o.axes){const a=this.axes==="xy"?"x":this.axes;if(!gd.is(s)||s.direction!==a)continue;const n=o.series.map(r=>{const l=r.getKeys(s.direction);if(s.keys.length&&!s.keys.some(g=>l.includes(g)))return;const{nodeData:c}=r.contextNodeData;if(!c?.length)return;const h=c[0][`${s.direction}Key`];let p=i.currentHighlight.datum[h];const u=rM(p);u&&(p=p.getTime());const m=c.find(g=>{const y=g.datum[h];return u?y.getTime()===p:y===p});return m?{series:r,nodeDatum:m}:null}).filter(lM);if(n.length<2&&n[0]?.nodeDatum!==o.ctx.highlightManager.getActiveHighlight()){const{series:r,nodeDatum:l}=n[0]??{};if(o.ctx.highlightManager.updateHighlight(o.id,l),l){const c=l.midPoint?.x??l.point?.x??0,h=l.midPoint?.y??l.point?.y??0,p=cM.makeTooltipMeta({type:"hover",offsetX:c,offsetY:h},l);delete p.lastPointerEvent,o.ctx.tooltipManager.updateTooltip(o.id,p,r.getTooltipHtml(l))}else o.ctx.tooltipManager.removeTooltip(o.id);this.updateChart(o,yd.SERIES_UPDATE)}}}})}syncAxes(t=!1){const{syncManager:e}=this.moduleContext,i=e.getChart(),o=e.getGroup(this.groupId),s=o.flatMap(r=>r.series),a=o[0].axes;let n=!1;i.axes.forEach(r=>{if(!gd.is(r)||this.axes!=="xy"&&this.axes!==r.direction){r.boundSeries=i.series.filter(g=>g.axes[r.direction]===r);return}const{direction:l,min:c,max:h,nice:p,reverse:u}=r;for(const g of a)if(l===g.direction&&(p!==g.nice||u!==g.reverse||c!==g.min&&(Hs(c)||Hs(g.min))||h!==g.max&&(Hs(h)||Hs(g.max)))){md.warnOnce("To allow synchronization, ensure that all charts have matching min, max, nice, and reverse properties on the synchronized axes."),r.boundSeries=i.series.filter(y=>y.axes[r.direction]===r),this.enabled=!1;return}const m=s.filter(g=>{if(g.visible){const y=g.getKeys(r.direction);return r.keys.length?r.keys.some(f=>y.includes(f)):!0}});nM(r.boundSeries,m)||(r.boundSeries=m,n=!0)}),n&&!t&&this.updateSiblings(this.groupId)}mergeZoom(t){const{zoomManager:e}=this.moduleContext;if(this.axes==="xy")return e.getZoom();const i=t.zoomManager.getZoom()??{};return i[this.axes]=e.getZoom()?.[this.axes],i}onEnabledChange(){const{syncManager:t}=this.moduleContext;this.enabled?t.subscribe(this.groupId):t.unsubscribe(this.groupId),this.updateSiblings(this.groupId),this.onNodeInteractionChange(),this.onZoomChange()}onGroupIdChange(t,e){if(!this.enabled||t===e)return;const{syncManager:i}=this.moduleContext;i.unsubscribe(e),i.subscribe(t),this.updateSiblings(e),this.updateSiblings(t)}onAxesChange(){if(!this.enabled)return;const{syncManager:t}=this.moduleContext;this.updateChart(t.getChart())}onNodeInteractionChange(){this.enabled&&this.nodeInteraction?this.enabledNodeInteractionSync():this.disableNodeInteractionSync?.()}onZoomChange(){this.enabled&&this.zoom?this.enabledZoomSync():this.disableZoomSync?.()}destroy(){const{syncManager:t}=this.moduleContext;t.unsubscribe(this.groupId),this.updateSiblings(this.groupId),this.disableZoomSync?.()}};Ai.className="Sync",d([Wo(dr),Go(t=>t.onEnabledChange())],Ai.prototype,"enabled",2),d([Wo(oM,{optional:!0}),Go((t,e,i)=>t.onGroupIdChange(e,i))],Ai.prototype,"groupId",2),d([Wo(sM(["x","y","xy"],"an axis")),Go(t=>t.onAxesChange())],Ai.prototype,"axes",2),d([Wo(dr),Go(t=>t.onNodeInteractionChange())],Ai.prototype,"nodeInteraction",2),d([Wo(dr),Go(t=>t.onZoomChange())],Ai.prototype,"zoom",2);var hM={type:"root",optionsKey:"sync",packageType:"enterprise",chartTypes:["cartesian"],instanceConstructor:Ai,themeTemplate:{sync:{enabled:!1}}};import{_ModuleSupport as Ne,_Util as dM}from"ag-charts-community";import{_ModuleSupport as pM,_Scene as uM}from"ag-charts-community";var{COLOR_STRING:gM,RATIO:yM,Validate:fd}=pM,Ks=class extends uM.Rect{constructor(){super(...arguments),this.fill="rgb(33, 150, 243)",this.fillOpacity=.2}};Ks.className="ZoomRect",d([fd(gM)],Ks.prototype,"fill",2),d([fd(yM)],Ks.prototype,"fillOpacity",2);import{_ModuleSupport as pr}from"ag-charts-community";import{_ModuleSupport as mM}from"ag-charts-community";var{clamp:fM,isEqual:Gs,round:xd}=mM,$={min:0,max:1},ur="end",gr="middle",Ws=(t,e=$.min,i=$.max)=>fM(e,t,i);function yr(){return{x:{...$},y:{...$}}}function Nt(t){return t.x.max-t.x.min}function te(t){return t.y.max-t.y.min}function mr(t,e,i=1e-10){return Gs(t.x.min,e.x.min,i)&&Gs(t.x.max,e.x.max,i)&&Gs(t.y.min,e.y.min,i)&&Gs(t.y.max,e.y.max,i)}function fr(t,e,i){const o=xd(Nt(t),10)<=e,s=xd(te(t),10)<=i;return o||s}function Ot(t){return{x:{min:t?.x?.min??$.min,max:t?.x?.max??$.max},y:{min:t?.y?.min??$.min,max:t?.y?.max??$.max}}}function ve(t,e,i){if(!t)return{x:0,y:0};const o=Ws(e-t.x,0,t.x+t.width),s=Ws(i-t.y,0,t.y+t.height),a=1/t.width*o,n=1-1/t.height*s;return{x:Ws(a),y:Ws(n)}}function Ti(t,e,i){return{x:{min:t.x.min+e,max:t.x.max+e},y:{min:t.y.min+i,max:t.y.max+i}}}function Sd(t,e,i){return{x:{min:t.x.min,max:t.x.min+Nt(t)*e},y:{min:t.y.min,max:t.y.min+te(t)*i}}}function Md(t,e,i){const o=Nt(t),s=te(t),a=t.x.min+o/2,n=t.y.min+s/2;return{x:{min:a-o*e/2,max:a+o*e/2},y:{min:n-s*i/2,max:n+s*i/2}}}function de(t,e,i,o){const{min:s,max:a}=e,n=s+(a-s)/2,r=t.max-t.min;switch(i){case"start":return{min:s,max:e.min+r};case"end":return{min:e.max-r,max:a};case"middle":return{min:n-r/2,max:n+r/2};case"pointer":return xr(t,e,o??n);default:return{min:s,max:a}}}function xr(t,e,i){const o=t.max-t.min,s=e.max-e.min,a=i*(1-(s-o)),n=i-a,r=t.min+n,l=t.max+n;return{min:r,max:l}}function xM(t,e,i){return{x:{min:t.x.min*e,max:t.x.max*e},y:{min:t.y.min*i,max:t.y.max*i}}}function Ht(t){const e=yr();return e.x=js(t.x),e.y=js(t.y),e}function js(t){const e=t.max-t.min;let i=t.max>$.max?$.max-e:t.min,o=t.min<$.min?e:t.max;return i=Math.max($.min,i),o=Math.min($.max,o),{min:i,max:o}}function bd({min:t,max:e},i,o){if(e===i.max)t=e-o;else if(t===i.min)e=t+o;else{const s=i.min+(i.max-i.min)/2;t=s-o/2,e=s+o/2}return{min:t,max:e}}var SM=class{update(t,e,i,o,s,a){return this.oldZoom??(this.oldZoom=Ot(e===pr.ChartAxisDirection.X?{...s,x:a}:{...s,y:a})),this.updateCoords(t.offsetX,t.offsetY),this.updateZoom(e,i,o)}stop(){this.coords=void 0,this.oldZoom=void 0}updateCoords(t,e){this.coords?(this.coords.x2=t,this.coords.y2=e):this.coords={x1:t,y1:e,x2:t,y2:e}}updateZoom(t,e,i){const{coords:o,oldZoom:s}=this;let a=Ot(s);if(!o||!s)return t===pr.ChartAxisDirection.X?a.x:a.y;const n=ve(i,o.x1,o.y1),r=ve(i,o.x2,o.y2);if(t===pr.ChartAxisDirection.X){const c=(r.x-n.x)*Nt(s);return a.x.max+=c,a.x=de(a.x,s.x,e,n.x),a=Ht(a),a.x}const l=(r.y-n.y)*te(s);return a.y.max-=l,a.y=de(a.y,s.y,e,n.y),a=Ht(a),a.y}},Sr="zoom-action",Mr="pan-action",MM=class{constructor(t,e,i){this.contextMenuRegistry=t,this.zoomManager=e,this.updateZoom=i}registerActions(t,e,i){if(!t)return;const{contextMenuRegistry:o}=this;o.registerDefaultAction({id:Sr,type:"series",label:"contextMenuZoomToCursor",action:s=>this.onZoomToHere(s,i)}),o.registerDefaultAction({id:Mr,type:"series",label:"contextMenuPanToCursor",action:s=>this.onPanToHere(s,i)}),this.toggleActions(e,i)}toggleActions(t,e){const{contextMenuRegistry:i}=this;fr(t,e.minRatioX,e.minRatioY)?i.disableAction(Sr):i.enableAction(Sr),mr(t,yr())?i.disableAction(Mr):i.enableAction(Mr)}onZoomToHere({event:t},e){const{rect:i}=this,{enabled:o,isScalingX:s,isScalingY:a,minRatioX:n,minRatioY:r}=e;if(!o||!i||!t||!t.target||!(t instanceof MouseEvent))return;const l=Ot(this.zoomManager.getZoom()),c=ve(i,t.clientX,t.clientY),h=c.x*Nt(l),p=c.y*te(l),u=$.max-$.min,m=u/2;let g={x:{min:c.x-m,max:c.x+m},y:{min:c.y-m,max:c.y+m}};g=Md(g,s?n:u,a?r:u),g=Ti(g,l.x.min-c.x+h,l.y.min-c.y+p),this.updateZoom(Ht(g))}onPanToHere({event:t},e){const{rect:i}=this,{enabled:o}=e;if(!o||!i||!t||!t.target||!(t instanceof MouseEvent))return;const s=Ot(this.zoomManager.getZoom()),a=ve(i,t.clientX,t.clientY),n=Nt(s),r=te(s),l=a.x*n,c=a.y*r,h=($.max-$.min)/2;let p={x:{min:a.x-h,max:a.x+h},y:{min:a.y-h,max:a.y+h}};p=Md(p,n,r),p=Ti(p,s.x.min-a.x+l,s.y.min-a.y+c),this.updateZoom(Ht(p))}};import{_ModuleSupport as Dd}from"ag-charts-community";var Nd=16,bM={off:1,short:.01,long:.002},DM=class{constructor(){this.deceleration=1,this.zoomCoordsHistoryIndex=0,this.coordsHistory=[]}get decelerationValue(){const{deceleration:t}=this;return Math.max(typeof t=="number"?t:bM[t]??1,1e-4)}addListener(t,e){return this.onUpdate=e,()=>{this.onUpdate=void 0}}stopInteractions(){this.inertiaHandle!=null&&(cancelAnimationFrame(this.inertiaHandle),this.inertiaHandle=void 0)}update(t){this.updateCoords(t.offsetX,t.offsetY);const{x1:e=0,y1:i=0,x2:o=0,y2:s=0}=this.coords??{};this.onUpdate?.({type:"update",deltaX:e-o,deltaY:i-s})}start(){this.coordsMonitorTimeout=setInterval(this.recordCurrentZoomCoords.bind(this),16)}stop(){const{coordsHistory:t}=this;let e=0,i=0,o=0;if(t.length>0){const s=this.zoomCoordsHistoryIndex%Nd;let a=s-1;a<0&&(a=t.length-1);let n=s;n>=t.length&&(n=0);const r=t[a],l=t[n];e=r.x-l.x,i=r.y-l.y,o=r.t-l.t}if(this.coords=void 0,clearInterval(this.coordsMonitorTimeout),this.coordsMonitorTimeout=void 0,this.zoomCoordsHistoryIndex=0,this.coordsHistory.length=0,o>0&&this.decelerationValue<1){const s=e/o,a=i/o,n=Math.hypot(s,a),r=Math.atan2(a,s),l=performance.now();this.inertiaHandle=requestAnimationFrame(c=>{this.animateInertia(c,c,l,n,r)})}}recordCurrentZoomCoords(){const{coords:t,coordsHistory:e,zoomCoordsHistoryIndex:i}=this;if(!t)return;const{x2:o,y2:s}=t,a=Date.now();e[i%Nd]={x:o,y:s,t:a},this.zoomCoordsHistoryIndex+=1}animateInertia(t,e,i,o,s){const a=1-this.decelerationValue,n=-o/Math.log(a),r=o*(a**(e-i)-1)/Math.log(a),l=o*(a**(t-i)-1)/Math.log(a);this.onUpdate?.({type:"update",deltaX:-Math.cos(s)*(l-r),deltaY:-Math.sin(s)*(l-r)}),!(l>=n-1)&&(this.inertiaHandle=requestAnimationFrame(c=>{this.animateInertia(c,t,i,o,s)}))}updateCoords(t,e){this.coords?this.coords={x1:this.coords.x2,y1:this.coords.y2,x2:t,y2:e}:this.coords={x1:t,y1:e,x2:t,y2:e}}translateZooms(t,e,i,o){const s=ve(t,t.x+Math.abs(i),t.y+t.height-Math.abs(o)),a=Math.sign(i)*s.x,n=-Math.sign(o)*s.y,r={};for(const[l,{direction:c,zoom:h}]of Object.entries(e)){let p;c===Dd.ChartAxisDirection.X?p=Ot({x:h}):p=Ot({y:h}),p=Ht(Ti(p,a*Nt(p),n*te(p))),c===Dd.ChartAxisDirection.X?r[l]={direction:c,zoom:p.x}:r[l]={direction:c,zoom:p.y}}return r}};import{_ModuleSupport as NM,_Util as vM}from"ag-charts-community";var{AND:vd,DATE:Id,NUMBER:Ad,OR:Td,ActionOnSet:kd,isFiniteNumber:Od,isValidDate:Ld,Validate:Ed}=NM,Ys=class{constructor(t){this.onChange=t}getRange(){return this.getRangeWithValues(this.start,this.end)}getInitialRange(){return this.getRangeWithValues(this.initialStart,this.initialEnd)}extendToEnd(t){return this.extendWith(e=>Number(e)-t)}extendWith(t){if(!this.domain)return;const[,e]=this.domain;if(e==null)return;const i=t(e),o=this.start!==i||this.end!==e;this.end=e,this.start=i,o||this.onChange?.(this.getRange())}updateWith(t){if(!this.domain)return;let[e,i]=this.domain;[e,i]=t(e,i);const o=this.start!==e||this.end!==i;this.end=i,this.start=e,o||this.onChange?.(this.getRange())}extendAll(){if(!this.domain)return;const[t,e]=this.domain,i=this.start!==t||this.end!==e;this.start=t,this.end=e,i||this.onChange?.(this.getRange())}updateAxis(t){const e=t.find(({domain:s})=>{const a=!Od(s[0])||!Od(s.at(-1)),n=!Ld(s[0])||!Ld(s.at(-1));return a||n});if(!e)return this.domain!=null;let i=e.domain;i!=null&&(i=[i[0],i.at(-1)],i[0]instanceof Date&&i[1]instanceof Date&&(i=[i[0].getTime(),i[1].getTime()]));const o=this.domain==null||!vM.areArrayItemsStrictlyEqual(this.domain,i);return o&&(this.domain=i),o}getRangeWithValues(t,e){let[i,o]=this.domain??[];if(t==null&&e==null||i==null||o==null)return;i=Number(i),o=Number(o);let s=0,a=1;return t!=null&&(s=(Number(t)-i)/(o-i)),e!=null&&(a=(Number(e)-i)/(o-i)),{min:s,max:a}}};d([kd({changeValue(t){this.initialStart??(this.initialStart=t),this.onChange?.(this.getRangeWithValues(t,this.end))}}),Ed(vd(Td(Id,Ad)),{optional:!0})],Ys.prototype,"start",2),d([kd({changeValue(t){this.initialEnd??(this.initialEnd=t),this.onChange?.(this.getRangeWithValues(this.start,t))}}),Ed(vd(Td(Id,Ad)),{optional:!0})],Ys.prototype,"end",2);import{_ModuleSupport as IM}from"ag-charts-community";var{AND:Rd,GREATER_THAN:AM,LESS_THAN:TM,RATIO:_d,ActionOnSet:Cd,Validate:wd}=IM,Xs=class{constructor(t){this.onChange=t}getRatio(){return this.getRatioWithValues(this.start,this.end)}getInitialRatio(){return this.getRatioWithValues(this.initialStart,this.initialEnd)}getRatioWithValues(t,e){if(!(t==null&&e==null))return{min:t??$.min,max:e??$.max}}};d([Cd({changeValue(t){this.initialStart??(this.initialStart=t),this.onChange?.(this.getRatioWithValues(t,this.end))}}),wd(Rd(_d,TM("end")),{optional:!0})],Xs.prototype,"start",2),d([Cd({changeValue(t){this.initialEnd??(this.initialEnd=t),this.onChange?.(this.getRatioWithValues(this.start,t))}}),wd(Rd(_d,AM("start")),{optional:!0})],Xs.prototype,"end",2);import{_ModuleSupport as kM}from"ag-charts-community";var OM=200,LM=class{update(t,e,i,o){const s=t.deltaX*e*OM;return this.translateZooms(i,o,s)}translateZooms(t,e,i){const o={},s=ve(t,t.x+Math.abs(i),0),a=i<0?-s.x:s.x;for(const[n,{direction:r,zoom:l}]of Object.entries(e)){if(r!==kM.ChartAxisDirection.X)continue;let c=Ot({x:l});c=Ht(Ti(c,a*Nt(c),0)),o[n]={direction:r,zoom:c.x}}return o}};import{_ModuleSupport as Pd}from"ag-charts-community";var EM=class{updateAxes(t,e,i,o){const s=t.sourceEvent,a={},{anchorPointX:n,anchorPointY:r,isScalingX:l,isScalingY:c,scrollingStep:h}=e,p=ve(i,s.offsetX??s.clientX,s.offsetY??s.clientY);for(const[u,{direction:m,zoom:g}]of Object.entries(o)){if(g==null)continue;let y={...g};const f=h*t.deltaY*(g.max-g.min);if(m===Pd.ChartAxisDirection.X&&l)y.max+=f,y=de(y,g,n,p.x);else if(m===Pd.ChartAxisDirection.Y&&c)y.max+=f,y=de(y,g,r,p.y);else continue;a[u]={direction:m,zoom:js(y)}}return a}update(t,e,i,o){const s=t.sourceEvent,{anchorPointX:a,anchorPointY:n,isScalingX:r,isScalingY:l,scrollingStep:c}=e,h=ve(i,s.offsetX??s.clientX,s.offsetY??s.clientY),p=t.deltaY;let u=Ot(o);return u.x.max+=r?c*p*Nt(o):0,u.y.max+=l?c*p*te(o):0,r&&(u.x=de(u.x,o.x,a,h.x)),l&&(u.y=de(u.y,o.y,n,h.y)),u=Ht(u),u}updateDelta(t,e,i){const{anchorPointX:o,anchorPointY:s,isScalingX:a,isScalingY:n,scrollingStep:r}=e;let l=Ot(i);return l.x.max+=a?r*-t*Nt(i):0,l.y.max+=n?r*-t*te(i):0,a&&(l.x=de(l.x,i.x,o)),n&&(l.y=de(l.y,i.y,s)),l=Ht(l),l}},RM=class{constructor(t){this.rect=t,this.rect.visible=!1}update(t,e,i,o){this.rect.visible=!0,this.updateCoords(t.offsetX,t.offsetY,e,i,o),this.updateRect(i)}stop(t,e,i){let o=Ot();if(!t||!e)return o;this.coords&&(o=this.createZoomFromCoords(e,i));const s=e.width/t.width,a=e.height/t.height;return o=Ht(xM(o,s,a)),this.reset(),o}reset(){this.coords=void 0,this.rect.visible=!1}didUpdate(){return this.rect.visible}updateCoords(t,e,i,o,s){if(!this.coords){this.coords={x1:t,y1:e,x2:t,y2:e};return}if(this.coords.x2=t,this.coords.y2=e,!o)return;const{isScalingX:a,isScalingY:n,minRatioX:r,minRatioY:l}=i,c=Ot(s),h=this.getNormalisedDimensions(),p=o.width/o.height,u=c.x.max-c.x.min,m=c.y.max-c.y.min,g=r/u,y=l/m;h.width/o.width<g&&(this.coords.x2<this.coords.x1?this.coords.x2=this.coords.x1-o.width*g:this.coords.x2=this.coords.x1+o.width*g),n&&!a?h.height/o.height<y&&(this.coords.y2<this.coords.y1?this.coords.y2=this.coords.y1-o.width*g:this.coords.y2=this.coords.y1+o.height*y):this.coords.y2<this.coords.y1?this.coords.y2=Math.min(this.coords.y1-h.width/p,this.coords.y1-o.height*y):this.coords.y2=Math.max(this.coords.y1+h.width/p,this.coords.y1+o.height*y),a||(this.coords.x1=o.x,this.coords.x2=o.x+o.width),n||(this.coords.y1=o.y,this.coords.y2=o.y+o.height)}updateRect(t){if(!t)return;const{rect:e}=this,i=this.getNormalisedDimensions(),{width:o,height:s}=i;let{x:a,y:n}=i;a=Math.max(a,t.x),a-=Math.max(0,a+o-(t.x+t.width)),n=Math.max(n,t.y),n-=Math.max(0,n+s-(t.y+t.height)),e.x=a,e.y=n,e.width=o,e.height=s}createZoomFromCoords(t,e){const i=Ot(e),o=this.getNormalisedDimensions(),s=ve(t,o.x,o.y+o.height),a=o.width/t.width,n=o.height/t.height;let r=Sd(i,a,n);const l=s.x*(i.x.max-i.x.min),c=s.y*(i.y.max-i.y.min);return r=Ti(r,l,c),r=Ht(r),r}getNormalisedDimensions(){const{x1:t=0,y1:e=0,x2:i=0,y2:o=0}=this.coords??{},s=t<=i?t:i,a=e<=o?e:o,n=t<=i?i-t:t-i,r=e<=o?o-e:e-o;return{x:s,y:a,width:n,height:r}}};import{_ModuleSupport as _M}from"ag-charts-community";var{ChartAxisDirection:CM,ToolbarManager:Zs}=_M,wM=class{constructor(t,e,i,o,s){this.toolbarManager=t,this.zoomManager=e,this.getResetZoom=i,this.updateZoom=o,this.updateAxisZoom=s}toggle(t,e,i){this.toggleGroups(t),t&&this.toggleButtons(e,i)}toggleButtons(t,e){const{toolbarManager:i}=this,o=mr(t,yr()),s=fr(t,e.minRatioX,e.minRatioY),a=mr(t,this.getResetZoom());i.toggleButton("zoom","pan-start",{enabled:t.x.min>$.min}),i.toggleButton("zoom","pan-end",{enabled:t.x.max<$.max}),i.toggleButton("zoom","pan-left",{enabled:t.x.min>$.min}),i.toggleButton("zoom","pan-right",{enabled:t.x.max<$.max}),i.toggleButton("zoom","zoom-out",{enabled:!o}),i.toggleButton("zoom","zoom-in",{enabled:!s}),i.toggleButton("zoom","reset",{enabled:!a})}onButtonPress(t,e){this.onButtonPressRanges(t,e),this.onButtonPressZoom(t,e)}toggleGroups(t){this.toolbarManager?.toggleGroup("zoom","ranges",!!t),this.toolbarManager?.toggleGroup("zoom","zoom",!!t)}onButtonPressRanges(t,e){if(!Zs.isGroup("ranges",t))return;const{rangeX:i}=e,o=t.value;typeof o=="number"?i.extendToEnd(o):Array.isArray(o)?i.updateWith(()=>o):typeof o=="function"&&i.updateWith(o)}onButtonPressZoom(t,e){if(Zs.isGroup("zoom",t))if(e.independentAxes&&t.value!=="reset"){const i=this.zoomManager.getAxisZooms();for(const[o,{direction:s,zoom:a}]of Object.entries(i))a!=null&&this.onButtonPressZoomAxis(t,e,o,s,a)}else this.onButtonPressZoomUnified(t,e)}onButtonPressZoomAxis(t,e,i,o,s){if(!Zs.isGroup("zoom",t))return;const{anchorPointX:a,anchorPointY:n,isScalingX:r,isScalingY:l,scrollingStep:c}=e;let h={...s};const p=s.max-s.min;switch(t.value){case"pan-start":h.max=p,h.min=0;break;case"pan-end":h.min=h.max-p,h.max=$.max;break;case"pan-left":h.min-=p*c,h.max-=p*c;break;case"pan-right":h.min+=p*c,h.max+=p*c;break;case"zoom-in":case"zoom-out":{const u=o===CM.X,m=u&&r||!u&&l;let g=t.value==="zoom-in"?1-c:1+c;m||(g=1);const M=u?a==="pointer"?ur:a:n==="pointer"?gr:n;h.max=h.min+(h.max-h.min)*g,h=de(h,s,M);break}}this.updateAxisZoom(i,o,js(h))}onButtonPressZoomUnified(t,e){if(!Zs.isGroup("zoom",t))return;const{anchorPointX:i,anchorPointY:o,isScalingX:s,isScalingY:a,scrollingStep:n}=e,r=Ot(this.zoomManager.getZoom());let l=Ot(r);switch(t.value){case"reset":l=this.getResetZoom();break;case"pan-start":l.x.max=Nt(l),l.x.min=0;break;case"pan-end":l.x.min=$.max-Nt(l),l.x.max=$.max;break;case"pan-left":l=Ti(l,-Nt(l)*n,0);break;case"pan-right":l=Ti(l,Nt(l)*n,0);break;case"zoom-in":case"zoom-out":{const c=t.value==="zoom-in"?1-n:1+n,h=i==="pointer"?ur:i,p=o==="pointer"?gr:o;l=Sd(l,s?c:1,a?c:1),l.x=de(l.x,r.x,h),l.y=de(l.y,r.y,p);break}}this.updateZoom(Ht(l))}},{ARRAY:PM,BOOLEAN:si,NUMBER:Bd,RATIO:zd,STRING:br,UNION:Qs,OR:BM,ActionOnSet:zM,ChartAxisDirection:ze,ChartUpdateType:Vd,Validate:yt,ProxyProperty:VM,round:FM,REGIONS:Dr}=Ne,Fd=t=>FM(t,10),Ud=Qs(["pointer","start","middle","end"],"an anchor cord"),$s="zoom-cursor",Nr="zoom-tooltip",lo=class extends Ne.BaseProperties{constructor(t){super(),this.onChange=t,this.enabled=!1,this.position="floating-bottom",this.size="small",this.align="center"}};d([Ne.ObserveChanges(t=>{t.onChange()}),yt(si)],lo.prototype,"enabled",2),d([Ne.ObserveChanges(t=>{t.onChange()}),yt(PM,{optional:!0})],lo.prototype,"buttons",2),d([yt(br)],lo.prototype,"position",2),d([yt(br)],lo.prototype,"size",2),d([yt(br)],lo.prototype,"align",2);var Ct=class extends Ne.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.enableAxisDragging=!0,this.buttons=new lo(()=>this.onZoomButtonsChange(this.enabled)),this.enableDoubleClickToReset=!0,this.enablePanning=!0,this.enableScrolling=!0,this.enableSelecting=!1,this.panKey="alt",this.axes="x",this.scrollingStep=($.max-$.min)/10,this.minVisibleItemsX=2,this.minVisibleItemsY=2,this.anchorPointX=ur,this.anchorPointY=gr,this.rangeX=new Ys(this.onRangeChange.bind(this,ze.X)),this.rangeY=new Ys(this.onRangeChange.bind(this,ze.Y)),this.ratioX=new Xs(this.onRatioChange.bind(this,ze.X)),this.ratioY=new Xs(this.onRatioChange.bind(this,ze.Y)),this.axisDragger=new SM,this.panner=new DM,this.scroller=new EM,this.scrollPanner=new LM,this.deceleration="short",this.dragState=0,this.minRatioX=0,this.minRatioY=0;const e=new Ks;this.selector=new RM(e),this.contextMenu=new MM(t.contextMenuRegistry,t.zoomManager,this.updateZoom.bind(this)),this.toolbar=new wM(t.toolbarManager,t.zoomManager,this.getResetZoom.bind(this),this.updateZoom.bind(this),this.updateAxisZoom.bind(this));const{Default:i,ZoomDrag:o,Animation:s}=Ne.InteractionState,a=i|s|o,n=i|s,r=t.regionManager.getRegion(Dr.SERIES),l=t.regionManager.getRegion(Dr.HORIZONTAL_AXES),c=t.regionManager.getRegion(Dr.VERTICAL_AXES),h="drag-start";this.destroyFns.push(t.scene.attachNode(e),t.regionManager.listenAll("dblclick",p=>this.onDoubleClick(p),n),t.regionManager.listenAll("nav-zoom",p=>this.onNavZoom(p)),r.addListener("drag",p=>this.onDrag(p),a),r.addListener(h,p=>this.onDragStart(p),a),r.addListener("drag-end",p=>this.onDragEnd(p),a),c.addListener("drag",p=>this.onDrag(p),a),c.addListener(h,p=>this.onDragStart(p),a),c.addListener("drag-end",p=>this.onDragEnd(p),a),c.addListener("leave",()=>this.onAxisLeave(),n),l.addListener("drag",p=>this.onDrag(p),a),l.addListener(h,p=>this.onDragStart(p),a),l.addListener("drag-end",p=>this.onDragEnd(p),a),l.addListener("leave",()=>this.onAxisLeave(),n),r.addListener("wheel",p=>this.onWheel(p),n),t.chartEventManager.addListener("axis-hover",p=>this.onAxisHover(p)),t.gestureDetector.addListener("pinch-move",p=>this.onPinchMove(p)),t.toolbarManager.addListener("button-pressed",p=>this.toolbar.onButtonPress(p,this.getModuleProperties())),t.layoutService.addListener("layout-complete",p=>this.onLayoutComplete(p)),t.updateService.addListener("update-complete",p=>this.onUpdateComplete(p)),t.zoomManager.addListener("zoom-change",p=>this.onZoomChange(p)),t.zoomManager.addListener("zoom-pan-start",p=>this.onZoomPanStart(p)),this.panner.addListener("update",p=>this.onPanUpdate(p)))}onEnabledChange(t){if(!this.contextMenu||!this.toolbar)return;const e=this.getZoom(),i=this.getModuleProperties({enabled:t});this.contextMenu.registerActions(t,e,i),this.onZoomButtonsChange(t),this.toolbar.toggle(t,e,i)}onZoomButtonsChange(t){if(!this.buttons)return;const e=this.buttons.toJson();e.enabled&&(e.enabled=t),this.ctx.toolbarManager.proxyGroupOptions("zoom","zoom",e)}onRangeChange(t,e){if(!e)return;const i=this.getZoom();i[t]=e,this.updateZoom(Ht(i))}onRatioChange(t,e){if(!e)return;let i=this.ratioX.getRatio(),o=this.ratioY.getRatio();t===ze.X?i=e:o=e;const s=Ht(Ot({x:i,y:o}));this.updateZoom(s)}onDoubleClick(t){const{enabled:e,enableDoubleClickToReset:i,hoveredAxis:o,paddedRect:s}=this;if(!e||!i)return;const{x:a,y:n}=this.getResetZoom();if(o){const{id:r,direction:l}=o,c=l===ze.X?a:n;this.updateAxisZoom(r,l,c)}else s?.containsPoint(t.offsetX,t.offsetY)&&!t.preventZoomDblClick&&this.updateZoom({x:a,y:n})}onDragStart(t){const{enabled:e,enableAxisDragging:i,enablePanning:o,enableSelecting:s,hoveredAxis:a,paddedRect:n,ctx:{cursorManager:r,zoomManager:l}}=this;if(!e||!n)return;this.panner.stopInteractions();let c=0;if(i&&a)c=1;else if(n.containsPoint(t.offsetX,t.offsetY)){const h=this.isPanningKeyPressed(t.sourceEvent);o&&(!s||h)?(r.updateCursor($s,"grabbing"),c=2,this.panner.start()):s&&!this.isMinZoom(this.getZoom())&&!h&&(c=3)}(this.dragState=c)!==0&&l.fireZoomPanStartEvent("zoom")}onDrag(t){const{anchorPointX:e,anchorPointY:i,axisDragger:o,dragState:s,enabled:a,paddedRect:n,panner:r,selector:l,seriesRect:c,hoveredAxis:h,ctx:{interactionManager:p,tooltipManager:u,updateService:m,zoomManager:g}}=this;if(!a||!n||!c)return;p.pushState(Ne.InteractionState.ZoomDrag);const y=this.getZoom();switch(s){case 1:if(!h)break;const{id:f,direction:M}=h,b=M===Ne.ChartAxisDirection.X?e:i,S=g.getAxisZoom(f),x=o.update(t,M,b,c,y,S);this.updateAxisZoom(f,M,x);break;case 2:r.update(t);break;case 3:l.update(t,this.getModuleProperties(),n,y);break;case 0:return}u.updateTooltip(Nr),m.update(Vd.PERFORM_LAYOUT,{skipAnimations:!0})}onDragEnd(t){const{axisDragger:e,dragState:i,enabled:o,panner:s,selector:a,ctx:{cursorManager:n,interactionManager:r,tooltipManager:l}}=this;if(r.popState(Ne.InteractionState.ZoomDrag),!(!o||i===0)){switch(i){case 1:e.stop();break;case 2:s.stop();break;case 3:if(!a.didUpdate())break;const c=this.getZoom();if(this.isMinZoom(c))break;const h=a.stop(this.seriesRect,this.paddedRect,c);this.updateZoom(h);break}this.dragState=0,n.updateCursor($s),l.removeTooltip(Nr)}}onNavZoom(t){const{enabled:e,enableScrolling:i,scroller:o}=this;!e||!i||(t.preventDefault(),this.updateZoom(o.updateDelta(t.delta,this.getModuleProperties(),this.getZoom())))}onWheel(t){const{enabled:e,enableAxisDragging:i,enablePanning:o,enableScrolling:s,hoveredAxis:a,paddedRect:n}=this;if(!e||!s||!n)return;const r=n.containsPoint(t.offsetX,t.offsetY),l=i&&a!=null,c=t.sourceEvent,{deltaX:h,deltaY:p}=c,u=h!=null&&p!=null&&Math.abs(h)>Math.abs(p);o&&u?this.onWheelPanning(t):(r||l)&&this.onWheelScrolling(t)}onWheelPanning(t){const{scrollingStep:e,scrollPanner:i,seriesRect:o,ctx:{zoomManager:s}}=this;if(!o)return;t.preventDefault();const a=i.update(t,e,o,s.getAxisZooms());for(const[n,{direction:r,zoom:l}]of Object.entries(a))this.updateAxisZoom(n,r,l)}onWheelScrolling(t){const{enableAxisDragging:e,enableIndependentAxes:i,hoveredAxis:o,scroller:s,seriesRect:a,ctx:{zoomManager:n}}=this;if(!a)return;t.preventDefault();const r=e&&o!=null;let l=this.isScalingX(),c=this.isScalingY();r&&(l=o.direction===Ne.ChartAxisDirection.X,c=!l);const h=this.getModuleProperties({isScalingX:l,isScalingY:c});if(i===!0){const p=s.updateAxes(t,h,a,n.getAxisZooms());for(const[u,{direction:m,zoom:g}]of Object.entries(p))r&&o.id!==u||this.updateAxisZoom(u,m,g)}else{const p=s.update(t,h,a,this.getZoom());this.updateZoom(p)}}onAxisLeave(){const{enabled:t,ctx:{cursorManager:e}}=this;t&&(this.hoveredAxis=void 0,e.updateCursor($s))}onAxisHover(t){const{enabled:e,enableAxisDragging:i,ctx:{cursorManager:o}}=this;e&&(this.hoveredAxis={id:t.axisId,direction:t.direction},i&&o.updateCursor($s,t.direction===ze.X?"ew-resize":"ns-resize"))}onPinchMove(t){const{enabled:e,enableScrolling:i,paddedRect:o,seriesRect:s}=this;if(!e||!i||!o||!s)return;const a=this.getZoom(),n=this.getZoom(),r=t.deltaDistance*-.01,l=ve(s,t.origin.x,t.origin.y);this.isScalingX()&&(n.x.max+=r*Nt(a),n.x=xr(n.x,a.x,l.x)),this.isScalingY()&&(n.y.max+=r*(a.y.max-a.y.min),n.y=xr(n.y,a.y,l.y)),this.updateZoom(Ht(n)),t.preventDefault()}onLayoutComplete(t){const{enabled:e,rangeX:i,rangeY:o}=this;if(!e)return;const{series:{rect:s,paddedRect:a,shouldFlipXY:n},axes:r}=t;if(this.seriesRect=s,this.paddedRect=a,this.contextMenu.rect=a,this.shouldFlipXY=n,!r)return;const[l,c]=dM.bifurcate(m=>m.direction===ze.X,r),h=i.updateAxis(l),p=o.updateAxis(c);if(!h&&!p)return;const u={};u.x=i.getRange(),u.y=o.getRange(),(u.x!=null||u.y!=null)&&this.updateZoom(Ht(Ot(u)))}onUpdateComplete({minRect:t,minVisibleRect:e}){const{enabled:i,minVisibleItemsX:o,minVisibleItemsY:s,paddedRect:a,shouldFlipXY:n}=this;if(!i||!a||!t||!e)return;const r=this.getZoom(),l=n?s:o,c=n?o:s,h=e.width*l/a.width,p=e.height*c/a.height,u=Fd(h*Nt(r)),m=Fd(p*te(r));this.isScalingX()&&(this.minRatioX=Math.min(1,u)),this.isScalingY()&&(this.minRatioY=Math.min(1,m)),this.minRatioX||(this.minRatioX=this.minRatioY||0),this.minRatioY||(this.minRatioY=this.minRatioX||0)}onZoomChange(t){t.callerId!=="zoom"&&this.panner.stopInteractions();const e=this.getZoom(),i=this.getModuleProperties();this.contextMenu.toggleActions(e,i),this.toolbar.toggleButtons(e,i)}onZoomPanStart(t){t.callerId==="zoom"&&this.panner.stopInteractions()}onPanUpdate(t){const{panner:e,seriesRect:i,ctx:{tooltipManager:o,updateService:s,zoomManager:a}}=this;if(!i)return;const n=e.translateZooms(i,a.getAxisZooms(),t.deltaX,t.deltaY);for(const[r,{direction:l,zoom:c}]of Object.entries(n))this.updateAxisZoom(r,l,c);o.updateTooltip(Nr),s.update(Vd.PERFORM_LAYOUT,{skipAnimations:!0})}isPanningKeyPressed(t){switch(this.panKey){case"alt":return t.altKey;case"ctrl":return t.ctrlKey;case"shift":return t.shiftKey;case"meta":return t.metaKey}}isScalingX(){return this.axes==="xy"?!0:this.shouldFlipXY?this.axes==="y":this.axes==="x"}isScalingY(){return this.axes==="xy"?!0:this.shouldFlipXY?this.axes==="x":this.axes==="y"}getAnchorPointX(){return this.shouldFlipXY?this.anchorPointY:this.anchorPointX}getAnchorPointY(){return this.shouldFlipXY?this.anchorPointX:this.anchorPointY}isMinZoom(t){return fr(t,this.minRatioX,this.minRatioY)}updateZoom(t){const{minRatioX:e,minRatioY:i,ctx:{zoomManager:o}}=this,s=Nt(t),a=te(t),n=this.getZoom(),r=s<=Nt(n)&&s<e,l=a<=te(n)&&a<i;r&&(t.x=bd(t.x,n.x,e)),l&&(t.y=bd(t.y,n.y,i)),o.updateZoom("zoom",t)}updateAxisZoom(t,e,i){const{enableIndependentAxes:o,minRatioX:s,minRatioY:a,ctx:{zoomManager:n}}=this;if(!i)return;const r=this.getZoom();if(o!==!0){r[e]=i,this.updateZoom(r);return}const l=i.max-i.min,c=r[e].max-r[e].min,h=e===ze.X?s:a;l<=c&&l<h||n.updateAxisZoom("zoom",t,i)}getZoom(){return Ot(this.ctx.zoomManager.getZoom())}getResetZoom(){const t=this.rangeX.getInitialRange()??this.ratioX.getInitialRatio()??$,e=this.rangeY.getInitialRange()??this.ratioY.getInitialRatio()??$;return{x:t,y:e}}getModuleProperties(t){return{anchorPointX:t?.anchorPointX??this.getAnchorPointX(),anchorPointY:t?.anchorPointY??this.getAnchorPointY(),enabled:t?.enabled??this.enabled,independentAxes:t?.independentAxes??this.enableIndependentAxes===!0,isScalingX:t?.isScalingX??this.isScalingX(),isScalingY:t?.isScalingY??this.isScalingY(),minRatioX:t?.minRatioX??this.minRatioX,minRatioY:t?.minRatioY??this.minRatioY,rangeX:t?.rangeX??this.rangeX,scrollingStep:t?.scrollingStep??this.scrollingStep}}};d([zM({newValue(t){this.onEnabledChange(t)}}),yt(si)],Ct.prototype,"enabled",2),d([yt(si)],Ct.prototype,"enableAxisDragging",2),d([yt(si)],Ct.prototype,"enableDoubleClickToReset",2),d([yt(si,{optional:!0})],Ct.prototype,"enableIndependentAxes",2),d([yt(si)],Ct.prototype,"enablePanning",2),d([yt(si)],Ct.prototype,"enableScrolling",2),d([yt(si)],Ct.prototype,"enableSelecting",2),d([yt(Qs(["alt","ctrl","meta","shift"],"a pan key"))],Ct.prototype,"panKey",2),d([yt(Qs(["x","y","xy"],"an axis"))],Ct.prototype,"axes",2),d([yt(zd)],Ct.prototype,"scrollingStep",2),d([yt(Bd.restrict({min:1}))],Ct.prototype,"minVisibleItemsX",2),d([yt(Bd.restrict({min:1}))],Ct.prototype,"minVisibleItemsY",2),d([yt(Ud)],Ct.prototype,"anchorPointX",2),d([yt(Ud)],Ct.prototype,"anchorPointY",2),d([VM("panner.deceleration"),yt(BM(zd,Qs(["off","short","long"],"a deceleration")))],Ct.prototype,"deceleration",2);var UM={enabled:!0,buttons:[{icon:"zoom-out",tooltip:"toolbarZoomZoomOut",value:"zoom-out",section:"scale"},{icon:"zoom-in",tooltip:"toolbarZoomZoomIn",value:"zoom-in",section:"scale"},{icon:"pan-left",tooltip:"toolbarZoomPanLeft",value:"pan-left",section:"pan"},{icon:"pan-right",tooltip:"toolbarZoomPanRight",value:"pan-right",section:"pan"},{icon:"reset",tooltip:"toolbarZoomReset",value:"reset",section:"reset"}]},HM={type:"root",optionsKey:"zoom",packageType:"enterprise",chartTypes:["cartesian","topology"],dependencies:["toolbar"],instanceConstructor:Ct,themeTemplate:{zoom:{anchorPointX:"end",anchorPointY:"middle",axes:"x",buttons:UM,enabled:!1,enableAxisDragging:!0,enableDoubleClickToReset:!0,enablePanning:!0,enableScrolling:!0,enableSelecting:!1,deceleration:"short",minVisibleItemsX:2,minVisibleItemsY:2,panKey:"alt",scrollingStep:.1}}};import{_Theme as Hd}from"ag-charts-community";import{_ModuleSupport as Kd,_Scale as KM,_Scene as GM,_Util as WM}from"ag-charts-community";var{BOOLEAN:Gd,OBJECT:Wd,Layers:jM,POSITION:YM,Validate:ai,POSITIVE_NUMBER:vr,ProxyProperty:Ir}=Kd,{BBox:XM,Group:Ar,Rect:ZM,LinearGradientFill:QM,Triangle:$M}=GM,{createId:qM}=WM,Tr=class{constructor(){this.thickness=16,this.preferredLength=100}};d([ai(vr)],Tr.prototype,"thickness",2),d([ai(vr)],Tr.prototype,"preferredLength",2);var JM=class extends Kd.CartesianAxis{constructor(t){super(t,new KM.LinearScale,{respondsToZoom:!1}),this.colorDomain=[],this.nice=!1,this.line.enabled=!1}calculateDomain(){this.setDomain(this.colorDomain)}getTickSize(){return 0}},qs=class{constructor(t){this.axis=t}};d([ai(Wd),Ir("axis.label")],qs.prototype,"label",2),d([ai(Wd),Ir("axis.interval")],qs.prototype,"interval",2),d([Ir("axis.seriesAreaPadding")],qs.prototype,"padding",2);var co=class{constructor(t){this.ctx=t,this.id=qM(this),this.group=new Ar({name:"legend",layer:!0,zIndex:jM.LEGEND_ZINDEX}),this.gradient=new Tr,this.destroyFns=[],this.enabled=!1,this.position="bottom",this.reverseOrder=void 0,this.pagination=void 0,this.spacing=20,this.data=[],this.listeners={},this.latestGradientBox=void 0,this.layoutService=t.layoutService,this.destroyFns.push(this.layoutService.addListener("start-layout",e=>this.update(e))),this.highlightManager=t.highlightManager,this.destroyFns.push(this.highlightManager.addListener("highlight-change",()=>this.onChartHoverChange())),this.gradientRect=new ZM,this.gradientFill=new QM,this.gradientFill.mask=this.gradientRect,this.group.append(this.gradientFill),this.arrow=new $M,this.group.append(this.arrow),this.axisGridGroup=new Ar({name:"legend-axis-grid-group"}),this.group.append(this.axisGridGroup),this.axisGroup=new Ar({name:"legend-axis-group"}),this.group.append(this.axisGroup),this.axis=new JM(t),this.axis.attachAxis(this.axisGroup,this.axisGridGroup),this.scale=new qs(this.axis),this.destroyFns.push(()=>this.detachLegend())}getOrientation(){switch(this.position){case"right":case"left":return"vertical";case"bottom":case"top":return"horizontal"}}destroy(){this.destroyFns.forEach(t=>t())}attachLegend(t){t.appendChild(this.group)}detachLegend(){this.group.parent?.removeChild(this.group)}update(t){const{shrinkRect:e}=t,i=this.data[0];if(!this.enabled||!i||!i.enabled)return this.group.visible=!1,{...t,shrinkRect:e.clone()};const{colorRange:o}=this.normalizeColorArrays(i),s=this.updateGradientRect(e,o),a=this.updateAxis(i,s),{newShrinkRect:n,translateX:r,translateY:l}=this.getMeasurements(e,s,a);return this.updateArrow(s),this.group.visible=!0,this.group.translationX=r,this.group.translationY=l,this.latestGradientBox=s,{...t,shrinkRect:n}}normalizeColorArrays(t){let e=t.colorDomain.slice();const i=t.colorRange.slice();if(e.length===i.length)return{colorDomain:e,colorRange:i};e.length>i.length&&i.splice(e.length);const o=i.length;return e=i.map((s,a)=>{const[n,r]=e;return a===0?n:a===o-1?r:n+(r-n)*a/(o-1)}),{colorDomain:e,colorRange:i}}updateGradientRect(t,e){const{reverseOrder:i,gradientFill:o,gradientRect:s}=this,{preferredLength:a,thickness:n}=this.gradient,r=new XM(0,0,0,0),l=this.getOrientation()==="vertical";if(l){const c=t.height,h=a;r.x=0,r.y=0,r.width=n,r.height=Math.min(c,h)}else{const c=t.width,h=a;r.x=0,r.y=0,r.width=Math.min(c,h),r.height=n}return o.stops=e,l?o.direction=i?"to-bottom":"to-top":o.direction=i?"to-left":"to-right",s.x=r.x,s.y=r.y,s.width=r.width,s.height=r.height,r}updateAxis(t,e){const{reverseOrder:i,axis:o}=this,s=this.getOrientation()==="vertical",a=i!==s;o.position=s?"right":"bottom",o.colorDomain=a?t.colorDomain.slice().reverse():t.colorDomain,o.calculateDomain(),o.range=s?[0,e.height]:[0,e.width],o.gridLength=0,o.translation.x=e.x+(s?e.width:0),o.translation.y=e.y+(s?0:e.height);const n=o.calculateLayout().bbox;return o.update(),n}updateArrow(t){const{arrow:e,axis:{label:i,scale:o}}=this,s=this.highlightManager.getActiveHighlight(),a=s?.colorValue;if(s==null||a==null){e.visible=!1;return}const n=this.getOrientation()==="vertical",r=i.fontSize??0,l=o.convert(a);let c,h,p;n?(c=t.x-r/2,h=t.y+l,p=Math.PI/2):(c=t.x+l,h=t.y-r/2,p=Math.PI),e.fill=i.color,e.size=r,e.translationX=c,e.translationY=h,e.rotation=p,e.visible=!0}getMeasurements(t,e,i){let o,s;this.getOrientation()==="vertical"?(o=e.width+i.width,s=e.height):(o=e.width,s=e.height+i.height);const{spacing:n}=this,r=t.clone();let l,c;return this.position==="left"?(l=t.x,c=t.y+t.height/2-s/2,r.shrink(o+n,"left")):this.position==="right"?(l=t.x+t.width-o,c=t.y+t.height/2-s/2,r.shrink(o+n,"right")):this.position==="top"?(l=t.x+t.width/2-o/2,c=t.y,r.shrink(s+n,"top")):(l=t.x+t.width/2-o/2,c=t.y+t.height-s,r.shrink(s+n,"bottom")),{translateX:l,translateY:c,gradientBox:e,newShrinkRect:r}}computeBBox(){return this.group.computeBBox()}onChartHoverChange(){this.enabled&&this.latestGradientBox!=null&&this.updateArrow(this.latestGradientBox)}};co.className="GradientLegend",d([ai(Gd)],co.prototype,"enabled",2),d([ai(YM)],co.prototype,"position",2),d([ai(Gd,{optional:!0})],co.prototype,"reverseOrder",2),d([ai(vr)],co.prototype,"spacing",2);var tb={type:"legend",optionsKey:"gradientLegend",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion"],identifier:"gradient",instanceConstructor:co,themeTemplate:{enabled:!1,position:"bottom",spacing:20,scale:{padding:8,label:{color:Hd.DEFAULT_LABEL_COLOUR,fontStyle:void 0,fontWeight:void 0,fontSize:12,fontFamily:Hd.DEFAULT_FONT_FAMILY,formatter:void 0},interval:{minSpacing:1}},gradient:{preferredLength:100,thickness:16},reverseOrder:!1}},eb=class{constructor(){this.ieCompatibility=!1}init(){this.ieCompatibility=this.md5("hello")!="5d41402abc4b2a76b9719d911017c592"}md5cycle(t,e){let i=t[0],o=t[1],s=t[2],a=t[3];i=this.ff(i,o,s,a,e[0],7,-680876936),a=this.ff(a,i,o,s,e[1],12,-389564586),s=this.ff(s,a,i,o,e[2],17,606105819),o=this.ff(o,s,a,i,e[3],22,-1044525330),i=this.ff(i,o,s,a,e[4],7,-176418897),a=this.ff(a,i,o,s,e[5],12,1200080426),s=this.ff(s,a,i,o,e[6],17,-1473231341),o=this.ff(o,s,a,i,e[7],22,-45705983),i=this.ff(i,o,s,a,e[8],7,1770035416),a=this.ff(a,i,o,s,e[9],12,-1958414417),s=this.ff(s,a,i,o,e[10],17,-42063),o=this.ff(o,s,a,i,e[11],22,-1990404162),i=this.ff(i,o,s,a,e[12],7,1804603682),a=this.ff(a,i,o,s,e[13],12,-40341101),s=this.ff(s,a,i,o,e[14],17,-1502002290),o=this.ff(o,s,a,i,e[15],22,1236535329),i=this.gg(i,o,s,a,e[1],5,-165796510),a=this.gg(a,i,o,s,e[6],9,-1069501632),s=this.gg(s,a,i,o,e[11],14,643717713),o=this.gg(o,s,a,i,e[0],20,-373897302),i=this.gg(i,o,s,a,e[5],5,-701558691),a=this.gg(a,i,o,s,e[10],9,38016083),s=this.gg(s,a,i,o,e[15],14,-660478335),o=this.gg(o,s,a,i,e[4],20,-405537848),i=this.gg(i,o,s,a,e[9],5,568446438),a=this.gg(a,i,o,s,e[14],9,-1019803690),s=this.gg(s,a,i,o,e[3],14,-187363961),o=this.gg(o,s,a,i,e[8],20,1163531501),i=this.gg(i,o,s,a,e[13],5,-1444681467),a=this.gg(a,i,o,s,e[2],9,-51403784),s=this.gg(s,a,i,o,e[7],14,1735328473),o=this.gg(o,s,a,i,e[12],20,-1926607734),i=this.hh(i,o,s,a,e[5],4,-378558),a=this.hh(a,i,o,s,e[8],11,-2022574463),s=this.hh(s,a,i,o,e[11],16,1839030562),o=this.hh(o,s,a,i,e[14],23,-35309556),i=this.hh(i,o,s,a,e[1],4,-1530992060),a=this.hh(a,i,o,s,e[4],11,1272893353),s=this.hh(s,a,i,o,e[7],16,-155497632),o=this.hh(o,s,a,i,e[10],23,-1094730640),i=this.hh(i,o,s,a,e[13],4,681279174),a=this.hh(a,i,o,s,e[0],11,-358537222),s=this.hh(s,a,i,o,e[3],16,-722521979),o=this.hh(o,s,a,i,e[6],23,76029189),i=this.hh(i,o,s,a,e[9],4,-640364487),a=this.hh(a,i,o,s,e[12],11,-421815835),s=this.hh(s,a,i,o,e[15],16,530742520),o=this.hh(o,s,a,i,e[2],23,-995338651),i=this.ii(i,o,s,a,e[0],6,-198630844),a=this.ii(a,i,o,s,e[7],10,1126891415),s=this.ii(s,a,i,o,e[14],15,-1416354905),o=this.ii(o,s,a,i,e[5],21,-57434055),i=this.ii(i,o,s,a,e[12],6,1700485571),a=this.ii(a,i,o,s,e[3],10,-1894986606),s=this.ii(s,a,i,o,e[10],15,-1051523),o=this.ii(o,s,a,i,e[1],21,-2054922799),i=this.ii(i,o,s,a,e[8],6,1873313359),a=this.ii(a,i,o,s,e[15],10,-30611744),s=this.ii(s,a,i,o,e[6],15,-1560198380),o=this.ii(o,s,a,i,e[13],21,1309151649),i=this.ii(i,o,s,a,e[4],6,-145523070),a=this.ii(a,i,o,s,e[11],10,-1120210379),s=this.ii(s,a,i,o,e[2],15,718787259),o=this.ii(o,s,a,i,e[9],21,-343485551),t[0]=this.add32(i,t[0]),t[1]=this.add32(o,t[1]),t[2]=this.add32(s,t[2]),t[3]=this.add32(a,t[3])}cmn(t,e,i,o,s,a){return e=this.add32(this.add32(e,t),this.add32(o,a)),this.add32(e<<s|e>>>32-s,i)}ff(t,e,i,o,s,a,n){return this.cmn(e&i|~e&o,t,e,s,a,n)}gg(t,e,i,o,s,a,n){return this.cmn(e&o|i&~o,t,e,s,a,n)}hh(t,e,i,o,s,a,n){return this.cmn(e^i^o,t,e,s,a,n)}ii(t,e,i,o,s,a,n){return this.cmn(i^(e|~o),t,e,s,a,n)}md51(t){const e=t.length,i=[1732584193,-271733879,-1732584194,271733878];let o;for(o=64;o<=t.length;o+=64)this.md5cycle(i,this.md5blk(t.substring(o-64,o)));t=t.substring(o-64);const s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(o=0;o<t.length;o++)s[o>>2]|=t.charCodeAt(o)<<(o%4<<3);if(s[o>>2]|=128<<(o%4<<3),o>55)for(this.md5cycle(i,s),o=0;o<16;o++)s[o]=0;return s[14]=e*8,this.md5cycle(i,s),i}md5blk(t){const e=[];for(let i=0;i<64;i+=4)e[i>>2]=t.charCodeAt(i)+(t.charCodeAt(i+1)<<8)+(t.charCodeAt(i+2)<<16)+(t.charCodeAt(i+3)<<24);return e}rhex(t){const e="0123456789abcdef".split("");let i="",o=0;for(;o<4;o++)i+=e[t>>o*8+4&15]+e[t>>o*8&15];return i}hex(t){for(let e=0;e<t.length;e++)t[e]=this.rhex(t[e]);return t.join("")}md5(t){return this.hex(this.md51(t))}add32(t,e){return this.ieCompatibility?this.add32Compat(t,e):this.add32Std(t,e)}add32Std(t,e){return t+e&4294967295}add32Compat(t,e){const i=(t&65535)+(e&65535);return(t>>16)+(e>>16)+(i>>16)<<16|i&65535}};function kr(t){return t==null||t.length===0}var Js={"01":"GRID","02":"CHARTS","0102":"BOTH"},jd=class re{constructor(e){this.gridContext=!1,this.watermarkMessage=void 0,this.totalMessageLength=124,this.document=e,this.md5=new eb,this.md5.init()}validateLicense(){const e=this.getLicenseDetails(this.licenseKey,this.gridContext),i=`AG ${e.currentLicenseType==="BOTH"?"Grid and ":""}Charts Enterprise`,o=e.suppliedLicenseType===void 0?"":`AG ${e.suppliedLicenseType==="BOTH"?"Grid and AG Charts":e.suppliedLicenseType==="GRID"?"Grid":"Charts"} Enterprise`;if(e.missing)(!this.isWebsiteUrl()||this.isForceWatermark())&&this.outputMissingLicenseKey(i);else if(e.expired){const s=re.getChartsReleaseDate(),a=re.formatDate(s);this.outputExpiredKey(e.expiry,a,o)}else e.valid?e.isTrial&&e.trialExpired&&this.outputExpiredTrialKey(e.expiry,i,o):this.outputInvalidLicenseKey(!!e.incorrectLicenseType,i,o)}static extractExpiry(e){const i=e.substring(e.lastIndexOf("_")+1,e.length);return new Date(parseInt(re.decode(i),10))}static extractLicenseComponents(e){let i=e.replace(/[\u200B-\u200D\uFEFF]/g,"");if(i=i.replace(/\r?\n|\r/g,""),e.length<=32)return{md5:null,license:e,version:null,isTrial:null};const o=i.length-32,s=i.substring(o),a=i.substring(0,o),[n,r,l]=re.extractBracketedInformation(i);return{md5:s,license:a,version:n,isTrial:r,type:l}}getLicenseDetails(e,i=!1){const o="CHARTS";if(kr(e))return{licenseKey:e,valid:!1,missing:!0,currentLicenseType:o};const s=re.getChartsReleaseDate(),{md5:a,license:n,version:r,isTrial:l,type:c}=re.extractLicenseComponents(e);let h=a===this.md5.md5(n)&&e.indexOf("For_Trialing_ag-Grid_Only")===-1,p,u,m=null,g=!1,y;function f(){p=m<new Date,u=void 0}if(h&&(m=re.extractExpiry(n),h=!isNaN(m.getTime()),h))switch(u=s>m,r){case"legacy":case"2":{h=!1;break}case"3":kr(c)?h=!1:(y=c,c!==Js["02"]&&c!==Js["0102"]?(h=!1,g=!0):l&&f())}return h?{licenseKey:e,valid:h,expiry:re.formatDate(m),expired:u,version:r,isTrial:l,trialExpired:p,invalidLicenseTypeForCombo:i?y!=="BOTH":void 0,incorrectLicenseType:g,currentLicenseType:o,suppliedLicenseType:y}:{licenseKey:e,valid:h,incorrectLicenseType:g,currentLicenseType:o,suppliedLicenseType:y}}isDisplayWatermark(){return this.isForceWatermark()||!this.isLocalhost()&&!this.isWebsiteUrl()&&!kr(this.watermarkMessage)}getWatermarkMessage(){return this.watermarkMessage||""}getHostname(){if(!this.document)return"localhost";const e=this.document.defaultView||window;if(!e)return"localhost";const i=e.location,{hostname:o=""}=i;return o}isForceWatermark(){if(!this.document)return!1;const e=this.document?.defaultView??typeof window<"u"?window:void 0;if(!e)return!1;const{pathname:i}=e.location;return i?i.indexOf("forceWatermark")!==-1:!1}isWebsiteUrl(){return this.getHostname().match(/^((?:[\w-]+\.)?ag-grid\.com)$/)!==null}isLocalhost(){return this.getHostname().match(/^(?:127\.0\.0\.1|localhost)$/)!==null}static formatDate(e){const i=["January","February","March","April","May","June","July","August","September","October","November","December"],o=e.getDate(),s=e.getMonth(),a=e.getFullYear();return o+" "+i[s]+" "+a}static getChartsReleaseDate(){return new Date(parseInt(re.decode(re.RELEASE_INFORMATION),10))}static decode(e){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let o="",s,a,n,r,l,c,h,p=0;const u=e.replace(/[^A-Za-z0-9+/=]/g,"");for(;p<u.length;)r=i.indexOf(u.charAt(p++)),l=i.indexOf(u.charAt(p++)),c=i.indexOf(u.charAt(p++)),h=i.indexOf(u.charAt(p++)),s=r<<2|l>>4,a=(l&15)<<4|c>>2,n=(c&3)<<6|h,o=o+String.fromCharCode(s),c!=64&&(o=o+String.fromCharCode(a)),h!=64&&(o=o+String.fromCharCode(n));return o=re.utf8_decode(o),o}static utf8_decode(e){e=e.replace(/rn/g,"n");let i="";for(let o=0;o<e.length;o++){const s=e.charCodeAt(o);s<128?i+=String.fromCharCode(s):s>127&&s<2048?(i+=String.fromCharCode(s>>6|192),i+=String.fromCharCode(s&63|128)):(i+=String.fromCharCode(s>>12|224),i+=String.fromCharCode(s>>6&63|128),i+=String.fromCharCode(s&63|128))}return i}setLicenseKey(e,i=!1){this.gridContext=i,this.licenseKey=e}static extractBracketedInformation(e){if(!e.includes("["))return["legacy",!1,void 0];const i=e.match(/\[(.*?)\]/g).map(r=>r.replace("[","").replace("]",""));if(!i||i.length===0)return["legacy",!1,void 0];const o=i.filter(r=>r==="TRIAL").length===1,s=i.filter(r=>r.indexOf("v")===0)[0],a=s?s.replace("v",""):"legacy",n=Js[i.filter(r=>Js[r])[0]];return[a,o,n]}centerPadAndOutput(e){const i=this.totalMessageLength-e.length;console.error(e.padStart(i/2+e.length,"*").padEnd(this.totalMessageLength,"*"))}padAndOutput(e,i="*",o=""){console.error(e.padEnd(this.totalMessageLength-o.length,i)+o)}outputInvalidLicenseKey(e,i,o){this.gridContext||(e?(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Incompatible License Key "),this.padAndOutput(`* Your license key is for ${o} only and does not cover you for ${i}.`," ","*"),this.padAndOutput("* Please contact info@ag-grid.com to obtain a combined license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")):(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Invalid License Key "),this.padAndOutput("* Your license key is not valid - please contact info@ag-grid.com to obtain a valid license."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""))),this.watermarkMessage="Invalid License"}outputExpiredTrialKey(e,i,o){this.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Trial Period Expired. "),this.padAndOutput(`* Your trial only license for ${o} expired on ${e}.`," ","*"),this.padAndOutput("* Please email info@ag-grid.com to purchase a license."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="Trial Period Expired"}outputMissingLicenseKey(e){this.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${e} License `),this.centerPadAndOutput(" License Key Not Found "),this.padAndOutput(`* All ${e} features are unlocked for trial.`," ","*"),this.padAndOutput("* If you want to hide the watermark please email info@ag-grid.com for a trial license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="For Trial Use Only"}outputExpiredKey(e,i,o){this.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${o} License `),this.centerPadAndOutput(" Incompatible Software Version "),this.padAndOutput(`* Your license key works with versions of ${o} released before ${e}.`," ","*"),this.padAndOutput(`* The version you are trying to use was released on ${i}.`," ","*"),this.padAndOutput("* Please contact info@ag-grid.com to renew your license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="License Expired"}};jd.RELEASE_INFORMATION="MTcyMDAyMjAyNTIyOQ==";var ib=jd;import{_ModuleSupport as ob}from"ag-charts-community";var sb=".ag-watermark{position:absolute;bottom:20px;right:25px;font-weight:bold;font-family:Impact,sans-serif;font-size:19px;opacity:0.7;animation:1s ease-out 3s ag-watermark-fadeout;color:#9b9b9b;pointer-events:none;&::before{content:'';display:block;height:40px;width:170px;background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU4IiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMjU4IDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMjUuNzc5IDI4LjY1N0gxMy4zNTlMMTEuMTczIDM0LjAxMkg1LjY3Mjk3TDE3LjE4MiA3LjA1OTk5SDIxLjk1M0wzMy40NjIgMzQuMDEySDI3Ljk2MkwyNS43NzYgMjguNjU3SDI1Ljc3OVpNMjQuMDY4IDI0LjM5N0wxOS41ODggMTMuNDM0TDE1LjEwNyAyNC4zOTdIMjQuMDY4Wk02Mi4wOTIgMTguODIzSDQ5LjgxN1YyMy4wODZINTYuNzc1QzU2LjU1NSAyNS4yMjIgNTUuNzU1IDI2LjkyNyA1NC4zNzIgMjguMjAyQzUyLjk4OSAyOS40NzYgNTEuMTY2IDMwLjExNSA0OC45MDkgMzAuMTE1QzQ3LjYyMiAzMC4xMTUgNDYuNDUgMjkuODg1IDQ1LjM5MyAyOS40MjNDNDQuMzU4MyAyOC45NzgxIDQzLjQzMjYgMjguMzEzOCA0Mi42OCAyNy40NzZDNDEuOTI3IDI2LjYzOSA0MS4zNDQgMjUuNjMxIDQwLjkzMSAyNC40NTNDNDAuNTE5IDIzLjI3NSA0MC4zMTEgMjEuOTcgNDAuMzExIDIwLjUzN0M0MC4zMTEgMTkuMTA1IDQwLjUxNiAxNy44IDQwLjkzMSAxNi42MjFDNDEuMzQ0IDE1LjQ0MyA0MS45MjcgMTQuNDM2IDQyLjY4IDEzLjU5OEM0My40Mzc2IDEyLjc1NzcgNDQuMzY5NiAxMi4wOTMyIDQ1LjQxMSAxMS42NTFDNDYuNDc4IDExLjE4OSA0Ny42NTYgMTAuOTYgNDguOTQ2IDEwLjk2QzUxLjYxMiAxMC45NiA1My42MzcgMTEuNjAyIDU1LjAyIDEyLjg4NUw1OC4zIDkuNjA0OTlDNTUuODE3IDcuNjY5OTkgNTIuNjc2IDYuNjk5OTkgNDguODcyIDYuNjk5OTlDNDYuNzYgNi42OTk5OSA0NC44NTMgNy4wMzQ5OSA0My4xNTQgNy43MDA5OUM0MS40NTUgOC4zNjc5OSAzOS45OTggOS4zMDM5OSAzOC43ODMgMTAuNTA0QzM3LjU2NyAxMS43MDcgMzYuNjM0IDEzLjE1OCAzNS45NzcgMTQuODU3QzM1LjMxOSAxNi41NTYgMzQuOTk0IDE4LjQ1MSAzNC45OTQgMjAuNTRDMzQuOTk0IDIyLjYzIDM1LjMyOSAyNC40OTQgMzUuOTk1IDI2LjIwNUMzNi42NjIgMjcuOTE2IDM3LjYwNSAyOS4zNzQgMzguODE3IDMwLjU3N0M0MC4wMzIgMzEuNzggNDEuNDg2IDMyLjcxMyA0My4xODggMzMuMzgzQzQ0Ljg4OCAzNC4wNDkgNDYuNzgyIDM0LjM4NCA0OC44NzIgMzQuMzg0QzUwLjk2MSAzNC4zODQgNTIuNzUgMzQuMDQ5IDU0LjM5IDMzLjM4M0M1Ni4wMzEgMzIuNzE2IDU3LjQyNiAzMS43OCA1OC41NzkgMzAuNTc3QzU5LjczMyAyOS4zNzQgNjAuNjE5IDI3LjkxNiA2MS4yMzkgMjYuMjA1QzYxLjg2IDI0LjQ5NCA2Mi4xNyAyMi42MDUgNjIuMTcgMjAuNTRDNjIuMTY5NiAxOS45Njg4IDYyLjE0NDUgMTkuMzk4IDYyLjA5NSAxOC44MjlMNjIuMDkyIDE4LjgyM1pNMTUxLjgxIDE2Ljk4MUMxNTMuNDEgMTQuNjA5IDE1Ny40MTkgMTQuMzU4IDE1OS4wMjIgMTQuMzU4VjE4LjkxQzE1Ni45NTcgMTguOTEgMTU0Ljk4NSAxOC45OTYgMTUzLjc1NyAxOS44OTJDMTUyLjUyOSAyMC43OTIgMTUxLjkxOSAyMS45ODIgMTUxLjkxOSAyMy40NjRWMzMuOTlIMTQ2Ljk2NFYxNC4zNThIMTUxLjczNkwxNTEuODEgMTYuOTgxWk0xNDMuMDExIDE0LjM2MVYzNC4wMzFIMTM4LjI0TDEzOC4xMzEgMzEuMDQ1QzEzNy40NjYgMzIuMDc2IDEzNi41NTEgMzIuOTIxOSAxMzUuNDcxIDMzLjUwNEMxMzQuMzc2IDM0LjA5OSAxMzMuMDY4IDM0LjM5NiAxMzEuNTM2IDM0LjM5NkMxMzAuMiAzNC4zOTYgMTI4Ljk2MyAzNC4xNTIgMTI3LjgyMiAzMy42NjhDMTI2LjcgMzMuMTk2NCAxMjUuNjg5IDMyLjQ5NSAxMjQuODU1IDMxLjYwOUMxMjQuMDE4IDMwLjcyMiAxMjMuMzU0IDI5LjY2MiAxMjIuODcxIDI4LjQyMkMxMjIuMzg0IDI3LjE4NSAxMjIuMTQyIDI1LjgxMSAxMjIuMTQyIDI0LjMwNEMxMjIuMTQyIDIyLjc5OCAxMjIuMzg0IDIxLjM3OCAxMjIuODcxIDIwLjExNkMxMjMuMzU3IDE4Ljg1NCAxMjQuMDE4IDE3Ljc3MiAxMjQuODU1IDE2Ljg3M0MxMjUuNjg4IDE1Ljk3NjQgMTI2LjY5OCAxNS4yNjM2IDEyNy44MjIgMTQuNzhDMTI4Ljk2MyAxNC4yODEgMTMwLjIwMyAxNC4wMzMgMTMxLjUzNiAxNC4wMzNDMTMzLjA0MyAxNC4wMzMgMTM0LjMzIDE0LjMxOCAxMzUuMzk3IDE0Ljg4OEMxMzYuNDYyIDE1LjQ1ODkgMTM3LjM3NSAxNi4yNzggMTM4LjA1NyAxNy4yNzZWMTQuMzYxSDE0My4wMTFaTTEzMi42MzEgMzAuMTMzQzEzNC4yNTYgMzAuMTMzIDEzNS41NjcgMjkuNTk0IDEzNi41NjUgMjguNTEyQzEzNy41NjEgMjcuNDMgMTM4LjA2IDI1Ljk5MSAxMzguMDYgMjQuMTk2QzEzOC4wNiAyMi40MDEgMTM3LjU2MSAyMC45OSAxMzYuNTY1IDE5Ljg5OUMxMzUuNTcgMTguODA3IDEzNC4yNTkgMTguMjU4IDEzMi42MzEgMTguMjU4QzEzMS4wMDMgMTguMjU4IDEyOS43MjkgMTguODA0IDEyOC43MzQgMTkuODk5QzEyNy43MzggMjAuOTkzIDEyNy4yMzkgMjIuNDM4IDEyNy4yMzkgMjQuMjMzQzEyNy4yMzkgMjYuMDI4IDEyNy43MzUgMjcuNDMzIDEyOC43MzQgMjguNTE1QzEyOS43MjkgMjkuNTk0IDEzMS4wMjggMzAuMTM2IDEzMi42MzEgMzAuMTM2VjMwLjEzM1pNOTMuNjk4IDI3Ljg3NkM5My41Nzk1IDI4LjAwMjUgOTMuNDU2NCAyOC4xMjQ2IDkzLjMyOSAyOC4yNDJDOTEuOTQ3IDI5LjUxNiA5MC4xMjMgMzAuMTU1IDg3Ljg2NiAzMC4xNTVDODYuNTggMzAuMTU1IDg1LjQwOCAyOS45MjYgODQuMzUgMjkuNDY0QzgzLjMxNTUgMjkuMDE4OSA4Mi4zODk4IDI4LjM1NDYgODEuNjM3IDI3LjUxN0M4MC44ODQgMjYuNjc5IDgwLjMwMSAyNS42NzIgNzkuODg5IDI0LjQ5NEM3OS40NzYgMjMuMzE1IDc5LjI2OSAyMi4wMSA3OS4yNjkgMjAuNTc4Qzc5LjI2OSAxOS4xNDUgNzkuNDczIDE3Ljg0IDc5Ljg4OSAxNi42NjJDODAuMzAxIDE1LjQ4NCA4MC44ODQgMTQuNDc2IDgxLjYzNyAxMy42MzlDODIuMzk0OSAxMi43OTg3IDgzLjMyNzMgMTIuMTM0MiA4NC4zNjkgMTEuNjkyQzg1LjQzNiAxMS4yMyA4Ni42MTQgMTEgODcuOTAzIDExQzkwLjU3IDExIDkyLjU5NSAxMS42NDIgOTMuOTc3IDEyLjkyNkw5Ny4yNTggOS42NDQ5OUM5NC43NzQgNy43MTA5OSA5MS42MzMgNi43Mzk5OSA4Ny44MjkgNi43Mzk5OUM4NS43MTggNi43Mzk5OSA4My44MTEgNy4wNzQ5OSA4Mi4xMTIgNy43NDE5OUM4MC40MTMgOC40MDc5OSA3OC45NTYgOS4zNDQ5OSA3Ny43NCAxMC41NDVDNzYuNTI1IDExLjc0NyA3NS41OTIgMTMuMTk5IDc0LjkzNCAxNC44OThDNzQuMjc3IDE2LjU5NyA3My45NTEgMTguNDkxIDczLjk1MSAyMC41ODFDNzMuOTUxIDIyLjY3IDc0LjI4NiAyNC41MzQgNzQuOTUzIDI2LjI0NUM3NS42MTkgMjcuOTU3IDc2LjU2MiAyOS40MTQgNzcuNzc0IDMwLjYxN0M3OC45OSAzMS44MiA4MC40NDQgMzIuNzUzIDgyLjE0NiAzMy40MjNDODMuODQ1IDM0LjA5IDg1LjczOSAzNC40MjQgODcuODI5IDM0LjQyNEM4OS45MTkgMzQuNDI0IDkxLjcwOCAzNC4wOSA5My4zNDggMzMuNDIzQzk0LjcxOCAzMi44NjUgOTUuOTE4IDMyLjEyMSA5Ni45NDggMzEuMTkxQzk3LjE0OSAzMS4wMDggOTcuMzQ4IDMwLjgxNSA5Ny41MzcgMzAuNjJMOTMuNzAxIDI3Ljg4NUw5My42OTggMjcuODc2Wk0xMTAuODAyIDE0LjAxNUMxMDkuMTk5IDE0LjAxNSAxMDYuODM2IDE0LjQ3MSAxMDUuNjExIDE2LjE1OEwxMDUuNTM3IDYuMDE1OTlIMTAwLjc2NVYzMy45MzlIMTA1LjcyVjIyLjY0MUMxMDUuNzcxIDIxLjQ2MDcgMTA2LjI4OCAyMC4zNDg4IDEwNy4xNTcgMTkuNTQ4OUMxMDguMDI3IDE4Ljc0OTEgMTA5LjE3OCAxOC4zMjY2IDExMC4zNTggMTguMzc0QzExMy4zOTcgMTguMzc0IDExNC4yNjggMjEuMTU5IDExNC4yNjggMjIuNjQxVjMzLjkzOUgxMTkuMjIzVjIxLjA1OUMxMTkuMjIzIDIxLjA1OSAxMTkuMTQyIDE0LjAxNSAxMTAuODAyIDE0LjAxNVpNMTczLjc2MyAxNC4zNThIMTY5Ljk5OVY4LjcxNDk5SDE2NS4wNDhWMTQuMzU4SDE2MS4yODRWMTguOTE2SDE2NS4wNDhWMzQuMDAzSDE2OS45OTlWMTguOTE2SDE3My43NjNWMTQuMzU4Wk0xOTAuNzg3IDI1LjI2MkMxOTAuMTI5IDI0LjUwMTQgMTg5LjMwNyAyMy44OTk0IDE4OC4zODQgMjMuNTAxQzE4Ny40ODggMjMuMTE3IDE4Ni4zMzEgMjIuNzMyIDE4NC45NDggMjIuMzY0QzE4NC4xNjUgMjIuMTQzOSAxODMuMzkgMjEuODk3OCAxODIuNjIzIDIxLjYyNkMxODIuMTYzIDIxLjQ2MjEgMTgxLjc0MSAyMS4yMDY2IDE4MS4zODMgMjAuODc1QzE4MS4yMzUgMjAuNzQyMSAxODEuMTE4IDIwLjU3ODkgMTgxLjAzOSAyMC4zOTY0QzE4MC45NjEgMjAuMjE0IDE4MC45MjIgMjAuMDE2NiAxODAuOTI3IDE5LjgxOEMxODAuOTI3IDE5LjI3MiAxODEuMTU2IDE4Ljg0NCAxODEuNjI1IDE4LjUxQzE4Mi4xMjEgMTguMTU2IDE4Mi44NjIgMTcuOTc2IDE4My44MjYgMTcuOTc2QzE4NC43OSAxNy45NzYgMTg1LjU4NyAxOC4yMDkgMTg2LjE0OCAxOC42NjhDMTg2LjcwNiAxOS4xMjQgMTg3LjAwNyAxOS43MjUgMTg3LjA3MiAyMC41TDE4Ny4wOTQgMjAuNzgySDE5MS42MzNMMTkxLjYxNyAyMC40NkMxOTEuNTIxIDE4LjQ4NSAxOTAuNzcxIDE2LjkgMTg5LjM4NSAxNS43NUMxODguMDEyIDE0LjYxMiAxODYuMTg1IDE0LjAzMyAxODMuOTYyIDE0LjAzM0MxODIuNDc3IDE0LjAzMyAxODEuMTQxIDE0LjI4NyAxNzkuOTk0IDE0Ljc4NkMxNzguODMxIDE1LjI5MSAxNzcuOTI2IDE1Ljk5NSAxNzcuMjk2IDE2Ljg4MkMxNzYuNjczIDE3Ljc0NTUgMTc2LjMzOCAxOC43ODQgMTc2LjM0MSAxOS44NDlDMTc2LjM0MSAyMS4xNjcgMTc2LjY5OCAyMi4yNDkgMTc3LjM5OSAyMy4wNjRDMTc4LjA2IDIzLjg0MzIgMTc4Ljg5OCAyNC40NTM0IDE3OS44NDIgMjQuODQ0QzE4MC43NDQgMjUuMjE2IDE4MS45MjggMjUuNjA3IDE4My4zNjEgMjZDMTg0LjgwNiAyNi40MSAxODUuODcyIDI2Ljc4NSAxODYuNTMgMjcuMTIzQzE4Ny4xIDI3LjQxNCAxODcuMzc5IDI3Ljg0NSAxODcuMzc5IDI4LjQ0NEMxODcuMzc5IDI5LjA0MiAxODcuMTIyIDI5LjQ2NyAxODYuNTk1IDI5LjgzOUMxODYuMDQzIDMwLjIyNiAxODUuMjM3IDMwLjQyNSAxODQuMjAxIDMwLjQyNUMxODMuMTY2IDMwLjQyNSAxODIuMzk0IDMwLjE3NCAxODEuNzQ5IDI5LjY3NEMxODEuMTEzIDI5LjE4MSAxODAuNzcyIDI4LjU4OSAxODAuNzEgMjcuODY0TDE4MC42ODUgMjcuNTgySDE3Ni4wMTNMMTc2LjAyNSAyNy45MDFDMTc2LjA2NyAyOS4wOTU1IDE3Ni40NzIgMzAuMjQ4NyAxNzcuMTg4IDMxLjIwNkMxNzcuOTA3IDMyLjE4IDE3OC44OTMgMzIuOTU4IDE4MC4xMTggMzMuNTE5QzE4MS4zMzYgMzQuMDc3IDE4Mi43MzIgMzQuMzYyIDE4NC4yNjYgMzQuMzYyQzE4NS44MDEgMzQuMzYyIDE4Ny4xMDkgMzQuMTA4IDE4OC4yMzggMzMuNjA5QzE4OS4zNzYgMzMuMTA0IDE5MC4yNzIgMzIuMzk0IDE5MC45MDEgMzEuNDk0QzE5MS41MzQgMzAuNTkyIDE5MS44NTMgMjkuNTU0IDE5MS44NTMgMjguNDAzQzE5MS44MjggMjcuMTEgMTkxLjQ2NiAyNi4wNTMgMTkwLjc3NyAyNS4yNjJIMTkwLjc4N1oiIGZpbGw9IiM5QjlCOUIiLz4KPHBhdGggZD0iTTI0MS45ODIgMjUuNjU4MlYxNy43MTE3SDIyOC40NDFMMjIwLjQ5NCAyNS42NTgySDI0MS45ODJaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNTcuMjM5IDUuOTUwODFIMjQwLjI2NUwyMzIuMjU1IDEzLjg5NzNIMjU3LjIzOVY1Ljk1MDgxWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjEyLjYxMSAzMy42MDQ4TDIxNi42OCAyOS41MzYxSDIzMC40MTJWMzcuNDgyN0gyMTIuNjExVjMzLjYwNDhaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yMTUuNTk5IDIxLjc4MDNIMjI0LjM3MkwyMzIuMzgyIDEzLjgzMzdIMjE1LjU5OVYyMS43ODAzWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjA2IDMzLjYwNDdIMjEyLjYxMUwyMjAuNDk0IDI1LjY1ODJIMjA2VjMzLjYwNDdaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNDAuMjY1IDUuOTUwODFMMjM2LjE5NyAxMC4wMTk0SDIxMC4yNTlWMi4wNzI4OEgyNDAuMjY1VjUuOTUwODFaIiBmaWxsPSIjOUI5QjlCIi8+Cjwvc3ZnPgo=);background-repeat:no-repeat;background-size:170px 40px}> span{padding-left:0.7rem}}@keyframes ag-watermark-fadeout{from{opacity:0.5}to{opacity:0}}",{createElement:ab}=ob;function nb(t,e){t.addStyles("watermark",sb);const i=t.addChild("canvas-overlay","watermark"),o=ab("span");o.innerText=e,i.addEventListener("animationend",()=>{t.removeChild("canvas-overlay","watermark"),t.removeStyles("watermark")}),i.classList.add("ag-watermark"),i.appendChild(o)}import{_Theme as jo,_Util as rb}from"ag-charts-community";import{_ModuleSupport as ta,_Scale as lb,_Scene as cb,_Util as Or}from"ag-charts-community";function hb(t){return{from:t?{scalingX:1,scalingY:0}:{scalingX:0,scalingY:1},to:{scalingX:1,scalingY:1}}}function db(t){return(e,i)=>t?{scalingCenterY:i.scaledValues.medianValue}:{scalingCenterX:i.scaledValues.medianValue}}import{_ModuleSupport as pb,_Scene as ub,_Util as gb}from"ag-charts-community";var{Group:yb,Rect:ho,Line:Yo,BBox:mb,Selection:Yd}=ub,{Logger:fb}=gb,xb=class extends yb{constructor(){super(),this.append([new ho({tag:0}),new ho({tag:0}),new ho({tag:2}),new ho({tag:1}),new Yo({tag:3}),new Yo({tag:3}),new Yo({tag:4}),new Yo({tag:4})])}updateDatumStyles(t,e,i,o){const{bandwidth:s,scaledValues:{xValue:a,medianValue:n}}=t;let{minValue:r,q1Value:l,q3Value:c,maxValue:h}=t.scaledValues;(i&&!o||!i&&o)&&([h,c,l,r]=[r,l,c,h]);const p=(B,z,V,U)=>i?{y:B,x:z,width:U,height:V}:{x:B,y:z,width:V,height:U},u=(B,z,V)=>i?{y1:B,y2:z,x:V}:{x1:B,x2:z,y:V},m=(B,z,V)=>i?{x1:z,x2:V,y:B}:{x:B,y1:z,y2:V},g=(B,z,V,U)=>({x:B,y:z,width:V,height:U}=p(B,z,V,U),new mb(B,z,V,U)),{fill:y,fillOpacity:f,stroke:M,strokeWidth:b,strokeOpacity:S,lineDash:x,lineDashOffset:N,cornerRadius:v,cap:D,whisker:I}=e,A=Yd.select(this,ho),k=A.selectByTag(0),[L]=A.selectByTag(2),[O]=A.selectByTag(1),T=A.selectByTag(3),E=A.selectByTag(4);I.strokeWidth>s&&(I.strokeWidth=s);const _=p(l,a,c-l,s);L.setProperties(_),k[0].setProperties(_),k[0].setProperties({cornerRadius:v,clipBBox:g(l,a,Math.round(n-l+b/2),s)}),k[1].setProperties(_),k[1].setProperties({cornerRadius:v,clipBBox:g(Math.round(n-b/2),a,Math.floor(c-n+b/2),s)});const R=Math.max(Math.round(n-b/2),l+b),C=Math.min(Math.round(n+b/2),c-b);O.setProperties(_),O.setProperties({visible:R<C,cornerRadius:v,clipBBox:g(R,a+b,C-R,Math.max(0,s-b*2))});const w=Math.floor(a+s*(1-D.lengthRatio)/2),P=Math.ceil(a+s*(1+D.lengthRatio)/2);E[0].setProperties(m(r,w,P)),E[1].setProperties(m(h,w,P)),T[0].setProperties(u(Math.round(r+I.strokeWidth/2),l,Math.floor(a+s/2))),T[1].setProperties(u(c,Math.round(h-I.strokeWidth/2),Math.floor(a+s/2)));for(const B of k)B.setProperties({fill:y,fillOpacity:f,strokeWidth:b*2,strokeOpacity:0});O.setProperties({fill:M,fillOpacity:S,strokeWidth:0});for(const B of[...T,...E])B.setProperties(I);L.setProperties({stroke:M,strokeWidth:b,strokeOpacity:S,lineDash:x,lineDashOffset:N,cornerRadius:v,fillOpacity:0})}distanceSquared(t,e){const i=Yd.selectByClass(this,ho,Yo);return pb.nearestSquared(t,e,i).distanceSquared}get midPoint(){const t=this.datum;return t.midPoint===void 0?(fb.error("BoxPlotGroup.datum.midPoint is undefined"),{x:NaN,y:NaN}):t.midPoint}};import{_ModuleSupport as Sb}from"ag-charts-community";var{BaseProperties:Xd,AbstractBarSeriesProperties:Mb,SeriesTooltip:bb,Validate:X,COLOR_STRING:ea,FUNCTION:Db,LINE_DASH:Zd,OBJECT:Lr,POSITIVE_NUMBER:Xo,RATIO:ia,STRING:Zt,mergeDefaults:Nb}=Sb,Qd=class extends Xd{constructor(){super(...arguments),this.lengthRatio=.5}};d([X(ia)],Qd.prototype,"lengthRatio",2);var po=class extends Xd{};d([X(ea,{optional:!0})],po.prototype,"stroke",2),d([X(Xo)],po.prototype,"strokeWidth",2),d([X(ia)],po.prototype,"strokeOpacity",2),d([X(Zd,{optional:!0})],po.prototype,"lineDash",2),d([X(Xo)],po.prototype,"lineDashOffset",2);var it=class extends Mb{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.cap=new Qd,this.whisker=new po,this.tooltip=new bb,this.backgroundFill="white"}toJson(){const{stroke:t,strokeWidth:e,strokeOpacity:i,lineDash:o,lineDashOffset:s}=this,a=super.toJson();return a.whisker=Nb(a.whisker,{stroke:t,strokeWidth:e,strokeOpacity:i,lineDash:o,lineDashOffset:s}),a}};d([X(Zt)],it.prototype,"xKey",2),d([X(Zt)],it.prototype,"minKey",2),d([X(Zt)],it.prototype,"q1Key",2),d([X(Zt)],it.prototype,"medianKey",2),d([X(Zt)],it.prototype,"q3Key",2),d([X(Zt)],it.prototype,"maxKey",2),d([X(Zt,{optional:!0})],it.prototype,"xName",2),d([X(Zt,{optional:!0})],it.prototype,"yName",2),d([X(Zt,{optional:!0})],it.prototype,"minName",2),d([X(Zt,{optional:!0})],it.prototype,"q1Name",2),d([X(Zt,{optional:!0})],it.prototype,"medianName",2),d([X(Zt,{optional:!0})],it.prototype,"q3Name",2),d([X(Zt,{optional:!0})],it.prototype,"maxName",2),d([X(ea,{optional:!0})],it.prototype,"fill",2),d([X(ia)],it.prototype,"fillOpacity",2),d([X(ea)],it.prototype,"stroke",2),d([X(Xo)],it.prototype,"strokeWidth",2),d([X(ia)],it.prototype,"strokeOpacity",2),d([X(Zd)],it.prototype,"lineDash",2),d([X(Xo)],it.prototype,"lineDashOffset",2),d([X(Xo)],it.prototype,"cornerRadius",2),d([X(Db,{optional:!0})],it.prototype,"itemStyler",2),d([X(Lr)],it.prototype,"cap",2),d([X(Lr)],it.prototype,"whisker",2),d([X(Lr)],it.prototype,"tooltip",2),d([X(ea)],it.prototype,"backgroundFill",2);var{extent:vb,extractDecoratedProperties:$d,fixNumericExtent:qd,keyProperty:Ib,mergeDefaults:Er,SeriesNodePickMode:Jd,SMALLEST_KEY_INTERVAL:Ab,valueProperty:Zo,diff:Tb,animationValidation:kb,convertValuesToScaleByDefs:Ob,isFiniteNumber:Lb,computeBarFocusBounds:Eb}=ta,{motion:tp}=cb,{ContinuousScale:Rb}=lb,{Color:Rr}=Or,_b=class extends ta.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.xKey,this.minKey=o.properties.minKey,this.q1Key=o.properties.q1Key,this.medianKey=o.properties.medianKey,this.q3Key=o.properties.q3Key,this.maxKey=o.properties.maxKey}},_r=class extends ta.AbstractBarSeries{constructor(t){super({moduleCtx:t,pickModes:[Jd.NEAREST_NODE,Jd.EXACT_SHAPE_MATCH],directionKeys:{x:["xKey"],y:["medianKey","q1Key","q3Key","minKey","maxKey"]},directionNames:{x:["xName"],y:["medianName","q1Name","q3Name","minName","maxName"]},pathsPerSeries:1,hasHighlightedLabels:!0}),this.properties=new it,this.NodeEvent=_b}async processData(t){if(!this.properties.isValid()||!this.visible)return;const{xKey:e,minKey:i,q1Key:o,medianKey:s,q3Key:a,maxKey:n}=this.properties,r=!this.ctx.animationManager.isSkipped(),l=this.getCategoryAxis()?.scale,c=this.getValueAxis()?.scale,{isContinuousX:h,xScaleType:p,yScaleType:u}=this.getScaleInformation({xScale:l,yScale:c}),m=[];r&&this.processedData&&m.push(Tb(this.processedData)),r&&m.push(kb());const{processedData:g}=await this.requestDataModel(t,this.data,{props:[Ib(e,p,{id:"xValue"}),Zo(i,u,{id:"minValue"}),Zo(o,u,{id:"q1Value"}),Zo(s,u,{id:"medianValue"}),Zo(a,u,{id:"q3Value"}),Zo(n,u,{id:"maxValue"}),...h?[Ab]:[],...m]});this.smallestDataInterval=g.reduced?.smallestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(t){const{processedData:e,dataModel:i,smallestDataInterval:o}=this;if(!(e&&i))return[];if(t===this.getBarDirection()){const u=i.getDomain(this,"minValue","value",e),m=i.getDomain(this,"maxValue","value",e);return qd([Math.min(...u),Math.max(...m)],this.getValueAxis())}const{index:s,def:a}=i.resolveProcessedDataDefById(this,"xValue"),n=e.domain.keys[s];if(a.type==="key"&&a.valueType==="category")return n;const r=this.getCategoryAxis(),l=vb(n)??[NaN,NaN],c=Lb(o)?o*.5:0,h=l[0]+-c,p=l[1]+c;return qd([h,p],r)}async createNodeData(){const{visible:t,dataModel:e}=this,i=this.getCategoryAxis(),o=this.getValueAxis();if(!(e&&i&&o))return;const{xKey:s,fill:a,fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:p,cap:u,whisker:m}=this.properties,g=[],y=e.resolveProcessedDataDefsByIds(this,["xValue","minValue","q1Value","medianValue","q3Value","maxValue"]),{barWidth:f,groupIndex:M}=this.updateGroupScale(i),b=Rb.is(i.scale)?f*-.5:0,{groupScale:S,processedData:x}=this,N=this.isVertical(),v={itemId:s,nodeData:g,labelData:[],scales:this.calculateScaling(),visible:this.visible};return t&&x?.data.forEach(({datum:D,keys:I,values:A})=>{const{xValue:k,minValue:L,q1Value:O,medianValue:T,q3Value:E,maxValue:_}=e.resolveProcessedDataDefsValues(y,{keys:I,values:A});if([L,O,T,E,_].some(U=>typeof U!="number")||L>O||O>T||T>E||E>_)return;const R=Ob({defs:y,values:{xValue:k,minValue:L,q1Value:O,medianValue:T,q3Value:E,maxValue:_},xAxis:i,yAxis:o});R.xValue+=Math.round(S.convert(String(M)))+b;const C=Math.round(f),w=Math.abs(R.q3Value-R.q1Value),P=R.xValue+C/2,B=Math.min(R.q3Value,R.q1Value)+w/2,z={x:N?P:B,y:N?B:P};let V;N?V={x:z.x-C/2,y:R.minValue,width:C,height:R.maxValue-R.minValue}:V={x:R.minValue,y:z.y-C/2,width:R.maxValue-R.minValue,height:C},g.push({series:this,itemId:k,datum:D,xKey:s,bandwidth:C,scaledValues:R,cap:u,whisker:m,fill:a,fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:p,midPoint:z,focusRect:V})}),v}getLegendData(t){const{id:e,data:i}=this,{xKey:o,yName:s,fill:a,fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:c,showInLegend:h,legendItemName:p,visible:u}=this.properties;return!h||!i?.length||!o||t!=="category"?[]:[{legendType:"category",id:e,itemId:e,seriesId:e,enabled:u,label:{text:p??s??e},symbols:[{marker:{fill:a,fillOpacity:n,stroke:r,strokeOpacity:c,strokeWidth:l}}],legendItemName:p}]}getTooltipHtml(t){const{xKey:e,minKey:i,q1Key:o,medianKey:s,q3Key:a,maxKey:n,xName:r,yName:l,minName:c,q1Name:h,medianName:p,q3Name:u,maxName:m,tooltip:g,fill:y}=this.properties,{datum:f,itemId:M}=t,b=this.getCategoryAxis(),S=this.getValueAxis();if(!b||!S||!this.properties.isValid())return ta.EMPTY_TOOLTIP_CONTENT;const x=Or.sanitizeHtml(l),v=[[e,r,b],[i,c,S],[o,h,S],[s,p,S],[a,u,S],[n,m,S]].map(([I,A,k])=>Or.sanitizeHtml(`${A??I}: ${k.formatDatum(f[I])}`)).join(x?"<br/>":", "),{fill:D}=this.getFormattedStyles(t);return g.toTooltipHtml({title:x,content:v,backgroundColor:y},{seriesId:this.id,itemId:M,datum:f,fill:y,xKey:e,minKey:i,q1Key:o,medianKey:s,q3Key:a,maxKey:n,xName:r,minName:c,q1Name:h,medianName:p,q3Name:u,maxName:m,yName:l,title:x,color:y??D})}animateEmptyUpdateReady({datumSelection:t}){const e=this.isVertical(),{from:i,to:o}=hb(e);tp.resetMotion([t],db(e)),tp.staticFromToMotion(this.id,"datums",this.ctx.animationManager,[t],i,o,{phase:"initial"})}isLabelEnabled(){return!1}async updateDatumSelection(t){const e=t.nodeData??[];return t.datumSelection.update(e)}async updateDatumNodes({datumSelection:t,isHighlight:e}){const i=this.isVertical(),o=this.getValueAxis()?.isReversed();t.each((s,a)=>{let n=this.getFormattedStyles(a,e);e&&(n=Er(this.properties.highlightStyle.item,n));const{stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:p}=n;n.whisker=Er(n.whisker,{stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:p}),s.updateDatumStyles(a,n,i,o)})}async updateLabelNodes(t){}async updateLabelSelection(t){const{labelData:e,labelSelection:i}=t;return i.update(e)}nodeFactory(){return new xb}getFormattedStyles(t,e=!1){const{id:i,ctx:{callbackCache:o},properties:s}=this,{xKey:a,minKey:n,q1Key:r,medianKey:l,q3Key:c,maxKey:h,itemStyler:p,backgroundFill:u,cornerRadius:m}=s,{datum:g,stroke:y,strokeWidth:f,strokeOpacity:M,lineDash:b,lineDashOffset:S,cap:x,whisker:N}=t;let v,D;if(!0)v=t.fill,D=s.fillOpacity;else{try{v=Rr.mix(Rr.fromString(u),Rr.fromString(t.fill),s.fillOpacity).toString()}catch{v=t.fill}D=void 0}const A={fill:v,fillOpacity:D,stroke:y,strokeWidth:f,strokeOpacity:M,lineDash:b,lineDashOffset:S,cornerRadius:m,cap:$d(x),whisker:$d(N)};if(p){const k=o.call(p,{datum:g,seriesId:i,highlighted:e,...A,xKey:a,minKey:n,q1Key:r,medianKey:l,q3Key:c,maxKey:h});if(k)return Er(k,A)}return A}computeFocusBounds({datumIndex:t,seriesRect:e}){return Eb(this.contextNodeData?.nodeData[t].focusRect,this.contentGroup,e)}};_r.className="BoxPlotSeries",_r.type="box-plot";import{_Theme as ep}from"ag-charts-community";var Cb={series:{direction:"vertical",strokeWidth:2},axes:{[ep.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{snap:!1}},[ep.CARTESIAN_AXIS_TYPE.CATEGORY]:{groupPaddingInner:.2,crosshair:{enabled:!1,snap:!1}}}},{Color:Cr}=rb,wb={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"box-plot",instanceConstructor:_r,tooltipDefaults:{range:"exact"},defaultAxes:[{type:jo.CARTESIAN_AXIS_TYPE.NUMBER,position:jo.POSITION.LEFT},{type:jo.CARTESIAN_AXIS_TYPE.CATEGORY,position:jo.POSITION.BOTTOM}],themeTemplate:Cb,groupable:!0,paletteFactory:({takeColors:t,themeTemplateParameters:e})=>{const i=e.get(jo.DEFAULT_BACKGROUND_COLOUR),o=(Array.isArray(i)?i[0]:i)??"white",{fills:[s],strokes:[a]}=t(1);let n;try{n=Cr.mix(Cr.fromString(o),Cr.fromString(s),.3).toString()}catch{n=s}return{fill:n,stroke:a,backgroundFill:o}},swapDefaultAxesCondition:({direction:t})=>t==="horizontal"};import{_Theme as uo}from"ag-charts-community";import{_ModuleSupport as ki,_Scene as Oi,_Util as wr}from"ag-charts-community";import{_ModuleSupport as Pb}from"ag-charts-community";var{AbstractBarSeriesProperties:Bb,BaseProperties:Pr,PropertiesArray:zb,SeriesTooltip:Vb,Validate:et,ARRAY:Fb,COLOR_STRING:go,LINE_DASH:ip,OBJECT:Br,POSITIVE_NUMBER:yo,RATIO:mo,STRING:oa}=Pb,Ve=class extends Pr{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.lengthRatio=.75}};d([et(go)],Ve.prototype,"fill",2),d([et(mo)],Ve.prototype,"fillOpacity",2),d([et(go)],Ve.prototype,"stroke",2),d([et(yo)],Ve.prototype,"strokeWidth",2),d([et(mo)],Ve.prototype,"strokeOpacity",2),d([et(ip)],Ve.prototype,"lineDash",2),d([et(yo)],Ve.prototype,"lineDashOffset",2),d([et(mo)],Ve.prototype,"lengthRatio",2);var op=class extends Pr{};d([et(yo,{optional:!0})],op.prototype,"max",2);var sa=class extends Pr{constructor(){super(...arguments),this.color="lightgrey"}};d([et(go)],sa.prototype,"color",2),d([et(yo,{optional:!0})],sa.prototype,"stop",2);var vt=class extends Bb{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.widthRatio=.5,this.colorRanges=new zb(sa),this.target=new Ve,this.scale=new op,this.tooltip=new Vb,this.backgroundFill="white"}};d([et(oa)],vt.prototype,"valueKey",2),d([et(oa,{optional:!0})],vt.prototype,"valueName",2),d([et(oa,{optional:!0})],vt.prototype,"targetKey",2),d([et(oa,{optional:!0})],vt.prototype,"targetName",2),d([et(go)],vt.prototype,"fill",2),d([et(mo)],vt.prototype,"fillOpacity",2),d([et(go)],vt.prototype,"stroke",2),d([et(yo)],vt.prototype,"strokeWidth",2),d([et(mo)],vt.prototype,"strokeOpacity",2),d([et(ip)],vt.prototype,"lineDash",2),d([et(yo)],vt.prototype,"lineDashOffset",2),d([et(mo)],vt.prototype,"widthRatio",2),d([et(Fb.restrict({minLength:0}))],vt.prototype,"colorRanges",2),d([et(Br)],vt.prototype,"target",2),d([et(Br)],vt.prototype,"scale",2),d([et(Br)],vt.prototype,"tooltip",2),d([et(go)],vt.prototype,"backgroundFill",2);var{animationValidation:Ub,collapsedStartingBarPosition:sp,diff:Hb,keyProperty:Kb,partialAssign:zr,prepareBarAnimationFunctions:ap,resetBarSelectionsFn:Gb,seriesLabelFadeInAnimation:np,valueProperty:rp,createDatumId:Wb,computeBarFocusBounds:jb}=ki,{fromToMotion:lp}=Oi.motion,{sanitizeHtml:cp,Color:Vr}=wr,hp=["fill","fillOpacity","stroke","strokeWidth","strokeOpacity","lineDash","lineDashOffset"],Yb=class extends ki.AbstractBarSeries{constructor(t){super({moduleCtx:t,directionKeys:{y:["targetKey","valueKey"]},directionNames:{y:["targetName","valueName"]},pickModes:[ki.SeriesNodePickMode.NEAREST_NODE,ki.SeriesNodePickMode.EXACT_SHAPE_MATCH],hasHighlightedLabels:!0,animationResetFns:{datum:Gb}}),this.properties=new vt,this.normalizedColorRanges=[],this.colorRangesGroup=new Oi.Group({name:`${this.id}-colorRanges`}),this.colorRangesSelection=Oi.Selection.select(this.colorRangesGroup,Oi.Rect,!1),this.rootGroup.append(this.colorRangesGroup),this.targetLinesSelection=Oi.Selection.select(this.annotationGroup,Oi.Line,!1)}destroy(){this.rootGroup.removeChild(this.colorRangesGroup),super.destroy()}async processData(t){if(!this.properties.isValid()||!this.data||!this.visible)return;const{valueKey:e,targetKey:i}=this.properties,o=this.getCategoryAxis()?.scale,s=this.getValueAxis()?.scale,{xScaleType:a,yScaleType:n}=this.getScaleInformation({xScale:o,yScale:s}),r=[];i!==void 0&&r.push(rp(i,n,{id:"target"})),this.ctx.animationManager.isSkipped()||(this.processedData!==void 0&&r.push(Hb(this.processedData)),r.push(Ub())),await this.requestDataModel(t,this.data.slice(0,1),{props:[Kb(e,a,{id:"xValue"}),rp(e,n,{id:"value"}),...r],groupByKeys:!0}),this.animationState.transition("updateData")}getBandScalePadding(){return{inner:0,outer:0}}getMaxValue(){return Math.max(...this.getValueAxis()?.dataDomain.domain??[0])}getSeriesDomain(t){const{dataModel:e,processedData:i}=this;if(!e||!i)return[];const{valueKey:o,targetKey:s,valueName:a,scale:n}=this.properties;if(t===this.getCategoryDirection())return[a??o];if(t==this.getValueAxis()?.direction){const r=e.getDomain(this,"value","value",i),l=s===void 0?[]:e.getDomain(this,"target","value",i);return[0,n.max??Math.max(...r,...l)]}throw new Error(`unknown direction ${t}`)}getKeys(t){return t===this.getBarDirection()?[this.properties.valueKey]:super.getKeys(t)}async createNodeData(){const{dataModel:t,processedData:e}=this,{valueKey:i,targetKey:o,widthRatio:s,target:{lengthRatio:a}}=this.properties,n=this.getCategoryAxis()?.scale,r=this.getValueAxis()?.scale;if(!i||!t||!e||!n||!r||s===void 0||a===void 0)return;const l=n.bandwidth??NaN,c=this.getMaxValue(),h=t.resolveProcessedDataIndexById(this,"value"),p=o===void 0?NaN:t.resolveProcessedDataIndexById(this,"target"),u={itemId:i,nodeData:[],labelData:[],scales:this.calculateScaling(),visible:this.visible};if(!this.visible)return u;for(const{datum:y,values:f}of e.data){if(!Array.isArray(y)||y.length<1)continue;f[0][h]<0&&wr.Logger.warnOnce("negative values are not supported, clipping to 0.");const M=this.properties.valueName??this.properties.valueKey,b=Math.min(c,Math.max(0,f[0][h])),S=r.convert(b),x=s*l,N=r.convert(0),v=this.getBarDirection()===ki.ChartAxisDirection.X,D={x:l*(1-s)/2,y:Math.min(S,N),width:x,height:Math.abs(N-S)};v&&([D.x,D.y,D.width,D.height]=[D.y,D.x,D.height,D.width]);let I;if(f[0][p]<0&&wr.Logger.warnOnce("negative targets are not supported, ignoring."),this.properties.targetKey&&f[0][p]>=0){const k=a*l,L=Math.min(c,f[0][p]);if(!isNaN(L)&&L!==void 0){const O=r.convert(L);let T=l*(1-a)/2,E=T+k,[_,R]=[O,O];v&&([T,E,_,R]=[_,R,T,E]),I={value:L,x1:T,x2:E,y1:_,y2:R}}}const A={series:this,datum:y[0],xKey:i,xValue:M,yKey:i,yValue:b,cumulativeValue:b,target:I,...D,midPoint:{x:D.x+D.width/2,y:D.y+D.height/2},opacity:1};u.nodeData.push(A)}const m=[...this.getColorRanges()].sort((y,f)=>(y.stop??c)-(f.stop??c));let g=0;return this.normalizedColorRanges=m.map(y=>{const f=Math.min(c,y.stop??1/0),M={color:y.color,start:g,stop:f};return g=f,M}),u}getColorRanges(){const{colorRanges:t,fill:e,backgroundFill:i}=this.properties;if(t!==void 0&&t.length>0)return t;const o=new sa;try{o.color=Vr.mix(Vr.fromString(e),Vr.fromString(i),.7).toString()}catch{o.color=e}return[o]}getLegendData(t){return[]}getTooltipHtml(t){const{valueKey:e,valueName:i,targetKey:o,targetName:s}=this.properties,a=this.getValueAxis(),{yValue:n,target:{value:r}={value:void 0},datum:l,itemId:c}=t;if(e===void 0||n===void 0||a===void 0)return ki.EMPTY_TOOLTIP_CONTENT;const h=(m,g,y)=>{const f=cp(g??m),M=cp(a.formatDatum(y));return`<b>${f}</b>: ${M}`},p=void 0,u=o===void 0||r===void 0?h(e,i,n):`${h(e,i,n)}<br/>${h(o,s,r)}`;return this.properties.tooltip.toTooltipHtml({title:p,content:u,backgroundColor:this.properties.fill},{datum:l,itemId:c,title:p,seriesId:this.id,valueKey:e,valueName:i,targetKey:o,targetName:s,color:void 0})}isLabelEnabled(){return!1}nodeFactory(){return new Oi.Rect}async updateDatumSelection(t){return this.targetLinesSelection.update(t.nodeData,void 0,void 0),t.datumSelection.update(t.nodeData,void 0,void 0)}async updateDatumNodes(t){for(const{node:e}of t.datumSelection){const i=this.properties;zr(hp,e,i)}for(const{node:e,datum:i}of this.targetLinesSelection)if(i.target===void 0)e.visible=!1;else{const o=this.properties.target;zr(["x1","x2","y1","y2"],e,i.target),zr(hp,e,o)}}async updateColorRanges(){const t=this.getValueAxis(),e=this.getCategoryAxis();if(!t||!e)return;const[i,o]=[0,Math.max(...e.scale.range)],s=this.getBarDirection()===ki.ChartAxisDirection.Y?(a,n)=>{a.x=i,a.y=t.scale.convert(n.stop),a.height=t.scale.convert(n.start)-a.y,a.width=o}:(a,n)=>{a.x=t.scale.convert(n.start),a.y=i,a.height=o,a.width=t.scale.convert(n.stop)-a.x};this.colorRangesSelection.update(this.normalizedColorRanges);for(const{node:a,datum:n}of this.colorRangesSelection)s(a,n),a.fill=n.color}async updateNodes(t,e,i){await super.updateNodes(t,e,i),await this.updateColorRanges()}async updateLabelSelection(t){return t.labelSelection}async updateLabelNodes(t){}animateEmptyUpdateReady(t){const{datumSelection:e,annotationSelections:i}=t,o=ap(sp(this.isVertical(),this.axes,"normal"));lp(this.id,"nodes",this.ctx.animationManager,[e],o),np(this,"annotations",this.ctx.animationManager,...i)}animateWaitingUpdateReady(t){const{datumSelection:e,annotationSelections:i}=t;this.ctx.animationManager.stopByAnimationGroupId(this.id);const o=this.processedData?.reduced?.diff,s=ap(sp(this.isVertical(),this.axes,"normal"));lp(this.id,"nodes",this.ctx.animationManager,[e],s,(n,r)=>Wb(r.xValue),o),(o?.changed??!0)&&np(this,"annotations",this.ctx.animationManager,...i)}computeFocusBounds({datumIndex:t,seriesRect:e}){return jb(this.contextNodeData?.nodeData[t],this.contentGroup,e)}};import{_Theme as Xb}from"ag-charts-community";var Zb={series:{direction:"vertical",strokeWidth:0,strokeOpacity:1,fillOpacity:1,widthRatio:.5,target:{strokeWidth:3,strokeOpacity:1,lengthRatio:.75}},axes:{[Xb.CARTESIAN_AXIS_TYPE.NUMBER]:{nice:!1,crosshair:{enabled:!1}}}},Qb={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"bullet",solo:!0,instanceConstructor:Yb,tooltipDefaults:{range:"exact"},defaultAxes:[{type:uo.CARTESIAN_AXIS_TYPE.NUMBER,position:uo.POSITION.LEFT},{type:uo.CARTESIAN_AXIS_TYPE.CATEGORY,position:uo.POSITION.BOTTOM}],themeTemplate:Zb,swapDefaultAxesCondition:t=>t?.direction==="horizontal",paletteFactory:({takeColors:t,colorsCount:e,themeTemplateParameters:i})=>{const{fills:[o],strokes:[s]}=t(e),a=i.get(uo.DEFAULT_BACKGROUND_COLOUR),n=(Array.isArray(a)?a[0]:a)??"white",r=i.get(uo.DEFAULT_CROSS_LINES_COLOUR);return{fill:o,stroke:s,target:{stroke:r},backgroundFill:n}}};import{_Theme as aa}from"ag-charts-community";import{_ModuleSupport as $b}from"ag-charts-community";import{_ModuleSupport as na,_Scale as qb,_Scene as Jb,_Util as tD}from"ag-charts-community";import{_ModuleSupport as eD}from"ag-charts-community";var{computeBarFocusBounds:iD,NODE_UPDATE_STATE_TO_PHASE_MAPPING:oD}=eD;function dp(t,e){return ra(e)}function pp(t){return{toFn:(o,s,a)=>{if(a==="removed"){const{x:n,yLow:r,yHigh:l,width:c}=ra(s),h=s.itemId==="up"?r:l;return{x:n,y:h,yBottom:h,yHigh:h,yLow:h,width:c,height:0}}return ra(s)},fromFn:(o,s,a)=>{const n=t?"initial":oD[a];if(a==="unknown"||a==="added"&&s!=null){const{x:r,y:l,yLow:c,yHigh:h,width:p,height:u}=ra(s);let m=s.itemId==="up"?c:h;return a==="unknown"&&(m=l+u/2),{x:r,y:m,yBottom:m,yHigh:m,yLow:m,width:p,height:0,phase:n}}return{x:o.x,y:o.y,yBottom:o.yBottom,yHigh:o.yHigh,yLow:o.yLow,width:o.width,height:o.height,phase:n}}}}function ra(t){const{bandwidth:e,scaledValues:{xValue:i,openValue:o,closeValue:s,highValue:a,lowValue:n}}=t,r=Math.min(o,s),l=isNaN(o)?s:Math.max(o,s),c=Math.min(a,n),h=Math.max(a,n);return{x:i,y:r,yBottom:l,yHigh:c,yLow:h,width:e,height:Math.max(l-r,.001)}}function up(t,e){const i=t.getNodeData()?.at(e.datumIndex),o=i?{x:i.scaledValues.xValue,y:i.scaledValues.highValue,width:i.bandwidth,height:i.scaledValues.lowValue-i.scaledValues.highValue}:void 0;return iD(o,t.contentGroup,e.seriesRect)}var{motion:gp}=Jb,{extent:sD,fixNumericExtent:yp,keyProperty:aD,SeriesNodePickMode:mp,SMALLEST_KEY_INTERVAL:nD,valueProperty:la,diff:rD,animationValidation:lD,convertValuesToScaleByDefs:cD,isFiniteNumber:hD}=na,{sanitizeHtml:fp,Logger:xp}=tD,{ContinuousScale:dD}=qb,pD=class extends na.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.xKey,this.openKey=o.properties.openKey,this.closeKey=o.properties.closeKey,this.highKey=o.properties.highKey,this.lowKey=o.properties.lowKey}},Sp=class extends na.AbstractBarSeries{constructor(t,e){super({moduleCtx:t,pickModes:[mp.NEAREST_BY_MAIN_AXIS_FIRST,mp.EXACT_SHAPE_MATCH],directionKeys:{x:["xKey"],y:["lowKey","highKey","openKey","closeKey"]},directionNames:{x:["xName"],y:["lowName","highName","openName","closeName"]},pathsPerSeries:1,datumSelectionGarbageCollection:!1,animationAlwaysUpdateSelections:!0,animationResetFns:{datum:e}}),this.NodeEvent=pD}animateEmptyUpdateReady({datumSelection:t}){const e=pp(!0);gp.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],e)}animateWaitingUpdateReady({datumSelection:t}){const{processedData:e}=this,i=e?.reduced?.diff,o=pp(!1);gp.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],o,(s,a)=>String(a.xValue),i)}async processData(t){if(!this.properties.isValid()||!this.visible)return;const{xKey:e,openKey:i,closeKey:o,highKey:s,lowKey:a}=this.properties,n=!this.ctx.animationManager.isSkipped(),r=this.getCategoryAxis()?.scale,l=this.getValueAxis()?.scale,{isContinuousX:c,xScaleType:h,yScaleType:p}=this.getScaleInformation({xScale:r,yScale:l}),u=[];n&&(this.processedData&&u.push(rD(this.processedData)),u.push(lD())),i&&u.push(la(i,p,{id:"openValue",invalidValue:void 0,missingValue:void 0}));const{processedData:m}=await this.requestDataModel(t,this.data,{props:[aD(e,h,{id:"xValue"}),la(o,p,{id:"closeValue"}),la(s,p,{id:"highValue"}),la(a,p,{id:"lowValue"}),...c?[nD]:[],...u]});this.smallestDataInterval=m.reduced?.smallestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(t){const{processedData:e,dataModel:i,smallestDataInterval:o}=this;if(!(e&&i))return[];const{openKey:s}=this.properties;if(t===this.getBarDirection()){const m=i.getDomain(this,"lowValue","value",e),g=i.getDomain(this,"highValue","value",e),y=s?i.getDomain(this,"openValue","value",e):[],f=i.getDomain(this,"closeValue","value",e);return yp([Math.min(...m,...g,...y,...f),Math.max(...g,...m,...y,...f)],this.getValueAxis())}const{index:a,def:n}=i.resolveProcessedDataDefById(this,"xValue"),r=e.domain.keys[a];if(n.type==="key"&&n.valueType==="category")return r;const l=this.getCategoryAxis(),c=sD(r)??[NaN,NaN],h=hD(o)?o:0,p=c[0]+-h,u=c[1]+h;return yp([p,u],l)}createBaseNodeData(){const{visible:t,dataModel:e}=this,i=this.getCategoryAxis(),o=this.getValueAxis();if(!(e&&i&&o))return;const s=[],{xKey:a,highKey:n,lowKey:r}=this.properties,l=e.resolveProcessedDataDefsByIds(this,["xValue","openValue","closeValue","highValue","lowValue"]),{barWidth:c,groupIndex:h}=this.updateGroupScale(i),p=dD.is(i.scale)?c*-.5:0,{groupScale:u,processedData:m}=this,g={itemId:a,nodeData:s,labelData:[],scales:this.calculateScaling(),visible:this.visible};return t&&m?.data.forEach(({datum:y,keys:f,values:M})=>{const{xValue:b,openValue:S,closeValue:x,highValue:N,lowValue:v}=e.resolveProcessedDataDefsValues(l,{keys:f,values:M}),D=v!=null&&v<=S&&v<=x,I=N!=null&&N>=S&&N>=x;if(!D){xp.warnOnce(`invalid low value for key [${r}] in data element, low value cannot be higher than datum open or close values`);return}if(!I){xp.warnOnce(`invalid high value for key [${n}] in data element, high value cannot be lower than datum open or close values.`);return}const A=cD({defs:l,values:{xValue:b,openValue:S,closeValue:x,highValue:N,lowValue:v},xAxis:i,yAxis:o});A.xValue+=Math.round(u.convert(String(h)))+p;const k=x>S,L=this.getSeriesItemType(k),[O,T]=k?[A.openValue,A.closeValue]:[A.closeValue,A.openValue],E=T-O,_={x:A.xValue+Math.round(c)/2,y:O+E/2};s.push({series:this,itemId:L,datum:y,xKey:a,xValue:b,openValue:S,closeValue:x,highValue:N,lowValue:v,bandwidth:c>=1?c:u.rawBandwidth,scaledValues:A,midPoint:_,aggregatedValue:x})}),g}getSeriesItemType(t){return t?"up":"down"}getItemConfig(t){return this.properties.item[t]}getLegendData(t){const{id:e,data:i}=this,{xKey:o,yName:s,item:{up:a,down:n},showInLegend:r,legendItemName:l,visible:c}=this.properties;return!r||!i?.length||!o||t!=="category"?[]:[{legendType:"category",id:e,itemId:e,seriesId:e,enabled:c,label:{text:l??s??e},symbols:[{marker:{fill:a.fill??a.stroke,fillOpacity:a.fillOpacity??1,stroke:a.stroke,strokeWidth:a.strokeWidth??1,strokeOpacity:a.strokeOpacity??1,padding:0}},{marker:{fill:n.fill??n.stroke,fillOpacity:n.fillOpacity??1,stroke:n.stroke,strokeWidth:n.strokeWidth??1,strokeOpacity:n.strokeOpacity??1}}],legendItemName:l}]}getTooltipHtml(t){const{xKey:e,openKey:i,closeKey:o,highKey:s,lowKey:a,xName:n,yName:r,openName:l,closeName:c,highName:h,lowName:p,tooltip:u}=this.properties,{datum:m,itemId:g}=t,y=this.getCategoryAxis(),f=this.getValueAxis();if(!y||!f||!this.properties.isValid())return na.EMPTY_TOOLTIP_CONTENT;const M=v=>v.charAt(0).toUpperCase()+v.substring(1),b=fp(r),x=[[e,n,y],[i,l,f],[s,h,f],[a,p,f],[o,c,f]].map(([v,D,I])=>fp(`${D??M(v)}: ${I.formatDatum(m[v])}`)).join("<br/>"),N=this.getFormattedStyles(t);return u.toTooltipHtml({title:b,content:x,backgroundColor:N.stroke},{seriesId:this.id,highlighted:!1,datum:m,...N,xKey:e,openKey:i,closeKey:o,highKey:s,lowKey:a,xName:n,yName:r,openName:l,closeName:c,highName:h,lowName:p,title:b,color:N.fill,fill:N.fill,itemId:g})}isVertical(){return!0}isLabelEnabled(){return!1}async updateDatumSelection(t){const e=t.nodeData??[];return t.datumSelection.update(e)}async updateDatumNodes({datumSelection:t,isHighlight:e}){t.each((i,o)=>{const s=this.getActiveStyles(o,e);i.updateDatumStyles(o,s)})}async updateLabelNodes(t){}async updateLabelSelection(t){const{labelData:e,labelSelection:i}=t;return i.update(e)}};import{_ModuleSupport as uD,_Scene as ee,_Util as gD}from"ag-charts-community";var{SceneChangeDetection:Li,BBox:yD,RedrawType:Ei}=ee,Fe=class extends ee.Group{constructor(){super(...arguments),this.x=0,this.y=0,this.yBottom=0,this.yHigh=0,this.yLow=0,this.width=0,this.height=0}distanceSquared(t,e){const i=ee.Selection.selectByClass(this,ee.Rect,ee.Line);return uD.nearestSquared(t,e,i).distanceSquared}get midPoint(){const t=this.datum;return t.midPoint===void 0?(gD.Logger.error("CandlestickBaseGroup.datum.midPoint is undefined"),{x:NaN,y:NaN}):t.midPoint}render(t){this.updateCoordinates(),super.render(t)}};d([Li({redraw:Ei.MAJOR})],Fe.prototype,"x",2),d([Li({redraw:Ei.MAJOR})],Fe.prototype,"y",2),d([Li({redraw:Ei.MAJOR})],Fe.prototype,"yBottom",2),d([Li({redraw:Ei.MAJOR})],Fe.prototype,"yHigh",2),d([Li({redraw:Ei.MAJOR})],Fe.prototype,"yLow",2),d([Li({redraw:Ei.MAJOR})],Fe.prototype,"width",2),d([Li({redraw:Ei.MAJOR})],Fe.prototype,"height",2);var mD=class extends Fe{constructor(){super(),this.append([new ee.Rect({tag:0}),new ee.Line({tag:1}),new ee.Line({tag:2})])}updateCoordinates(){const{x:t,y:e,yBottom:i,yHigh:o,yLow:s,width:a,height:n}=this,r=ee.Selection.select(this,ee.Rect),[l]=r.selectByTag(0),[c]=r.selectByTag(1),[h]=r.selectByTag(2);if(a===0||n===0){l.visible=!1,c.visible=!1,h.visible=!1;return}l.visible=!0,c.visible=!0,h.visible=!0,l.setProperties({x:t,y:e,width:a,height:n,crisp:!0,clipBBox:new yD(t,e,a,n)});const p=a/2;c.setProperties({y1:Math.round(s+c.strokeWidth/2),y2:i,x:t+p}),h.setProperties({y1:Math.round(o+h.strokeWidth/2),y2:e,x:t+p})}updateDatumStyles(t,e){const{bandwidth:i}=t,{fill:o,fillOpacity:s,stroke:a,strokeWidth:n,strokeOpacity:r,lineDash:l,lineDashOffset:c,wick:h={},cornerRadius:p}=e;h.strokeWidth??(h.strokeWidth=1);const u=ee.Selection.select(this,ee.Rect),[m]=u.selectByTag(0),[g]=u.selectByTag(1),[y]=u.selectByTag(2);h.strokeWidth>i&&(h.strokeWidth=i),m.setProperties({fill:o,fillOpacity:s,strokeWidth:n,strokeOpacity:r,stroke:a,lineDash:l,lineDashOffset:c,cornerRadius:p}),g.setProperties(h),y.setProperties(h)}};import{_ModuleSupport as fD}from"ag-charts-community";var{BaseProperties:Fr,AbstractBarSeriesProperties:xD,SeriesTooltip:SD,Validate:q,COLOR_STRING:Ur,FUNCTION:MD,LINE_DASH:Mp,OBJECT:Qo,POSITIVE_NUMBER:$o,RATIO:Hr,STRING:pe}=fD,fo=class extends Fr{};d([q(Ur,{optional:!0})],fo.prototype,"stroke",2),d([q($o)],fo.prototype,"strokeWidth",2),d([q(Hr)],fo.prototype,"strokeOpacity",2),d([q(Mp,{optional:!0})],fo.prototype,"lineDash",2),d([q($o)],fo.prototype,"lineDashOffset",2);var ue=class extends Fr{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.wick=new fo}};d([q(Ur,{optional:!0})],ue.prototype,"fill",2),d([q(Hr)],ue.prototype,"fillOpacity",2),d([q(Ur)],ue.prototype,"stroke",2),d([q($o)],ue.prototype,"strokeWidth",2),d([q(Hr)],ue.prototype,"strokeOpacity",2),d([q(Mp)],ue.prototype,"lineDash",2),d([q($o)],ue.prototype,"lineDashOffset",2),d([q($o)],ue.prototype,"cornerRadius",2),d([q(Qo)],ue.prototype,"wick",2);var Kr=class extends Fr{constructor(){super(...arguments),this.up=new ue,this.down=new ue}};d([q(Qo)],Kr.prototype,"up",2),d([q(Qo)],Kr.prototype,"down",2);var wt=class extends xD{constructor(){super(...arguments),this.tooltip=new SD,this.item=new Kr}};d([q(pe)],wt.prototype,"xKey",2),d([q(pe)],wt.prototype,"openKey",2),d([q(pe)],wt.prototype,"closeKey",2),d([q(pe)],wt.prototype,"highKey",2),d([q(pe)],wt.prototype,"lowKey",2),d([q(pe,{optional:!0})],wt.prototype,"xName",2),d([q(pe,{optional:!0})],wt.prototype,"yName",2),d([q(pe,{optional:!0})],wt.prototype,"openName",2),d([q(pe,{optional:!0})],wt.prototype,"closeName",2),d([q(pe,{optional:!0})],wt.prototype,"highName",2),d([q(pe,{optional:!0})],wt.prototype,"lowName",2),d([q(Qo)],wt.prototype,"tooltip",2),d([q(Qo)],wt.prototype,"item",2),d([q(MD,{optional:!0})],wt.prototype,"itemStyler",2);var{extractDecoratedProperties:bD,mergeDefaults:Gr}=$b,Wr=class extends Sp{constructor(t){super(t,dp),this.properties=new wt}async createNodeData(){const t=this.createBaseNodeData();if(!t)return;const e=t.nodeData.map(i=>{const{fill:o,fillOpacity:s,stroke:a,strokeWidth:n,strokeOpacity:r,lineDash:l,lineDashOffset:c,wick:h,cornerRadius:p}=this.getItemConfig(i.itemId);return{...i,fill:o,fillOpacity:s,stroke:a,strokeWidth:n,strokeOpacity:r,lineDash:l,lineDashOffset:c,wick:h,cornerRadius:p}});return{...t,nodeData:e}}getFormattedStyles(t,e=!1){const{id:i,ctx:{callbackCache:o}}=this,{xKey:s,openKey:a,closeKey:n,highKey:r,lowKey:l,itemStyler:c}=this.properties,{fill:h,fillOpacity:p,stroke:u,strokeWidth:m,strokeOpacity:g,lineDash:y,lineDashOffset:f}=this.getItemConfig(t.itemId);if(c){const M=o.call(c,{datum:t.datum,itemId:t.itemId,seriesId:i,highlighted:e,xKey:s,openKey:a,closeKey:n,highKey:r,lowKey:l,fill:h,fillOpacity:p,stroke:u,strokeWidth:m,strokeOpacity:g,lineDash:y,lineDashOffset:f});if(M)return Gr(M,this.getSeriesStyles(t))}return this.getSeriesStyles(t)}nodeFactory(){return new mD}getSeriesStyles(t){const{fill:e,fillOpacity:i,stroke:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,wick:l,cornerRadius:c}=t;return{fill:e,fillOpacity:i,stroke:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,wick:bD(l),cornerRadius:c}}getActiveStyles(t,e){let i=this.getFormattedStyles(t,e);e&&(i=Gr(this.properties.highlightStyle.item,i));const{stroke:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=i;return i.wick=Gr(i.wick,{stroke:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}),i}computeFocusBounds(t){return up(this,t)}};Wr.className="CandleStickSeries",Wr.type="candlestick";import{_Theme as bp}from"ag-charts-community";var DD={series:{highlightStyle:{item:{strokeWidth:3}}},animation:{enabled:!1},axes:{[bp.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{snap:!1}},[bp.CARTESIAN_AXIS_TYPE.ORDINAL_TIME]:{groupPaddingInner:0,crosshair:{enabled:!0}}}},ND={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"candlestick",instanceConstructor:Wr,tooltipDefaults:{range:"nearest"},defaultAxes:[{type:aa.CARTESIAN_AXIS_TYPE.NUMBER,position:aa.POSITION.LEFT},{type:aa.CARTESIAN_AXIS_TYPE.ORDINAL_TIME,position:aa.POSITION.BOTTOM}],themeTemplate:DD,groupable:!1,paletteFactory:({takeColors:t,colorsCount:e,userPalette:i,palette:o})=>{if(i==="user-indexed"){const{fills:s,strokes:a}=t(e);return{item:{up:{fill:"transparent",stroke:a[0]},down:{fill:s[0],stroke:a[0]}}}}return{item:{up:o.up,down:o.down}}}};import{_Theme as vD}from"ag-charts-community";import{_ModuleSupport as ID,_Scene as AD,_Util as TD}from"ag-charts-community";import{_ModuleSupport as kD,_Scene as OD}from"ag-charts-community";import{_Util as LD}from"ag-charts-community";var{Logger:ED}=LD;function Dp(t,e,i){i||(e=RD(e));const o=new Map;for(const a of t)o.set(a.id,{datum:a,linksBefore:[],linksAfter:[],maxPathLengthBefore:-1,maxPathLengthAfter:-1});let s=0;return o.forEach((a,n)=>{s=Math.max(s,jr(o,e,a,n,-1,[])+jr(o,e,a,n,1,[])+1)}),{links:e,nodeGraph:o,maxPathLength:s}}function Np(t,e,i,o){const s=o.indexOf(e);if(s!==-1){for(let n=s;n<o.length;n+=1)i.add(o[n]);return}o.push(e);const{toNode:a}=e;for(const n of t)n.fromNode===a&&Np(t,n,i,o);o.pop()}function RD(t){const e=new Set;for(const i of t)Np(t,i,e,[]);return e.size!==0&&ED.warnOnce("Some links formed circular references. These will be removed from the output."),e.size===0?t:t.filter(i=>!e.has(i))}function jr(t,e,i,o,s,a){if(a.includes(o))return 1/0;let n=s===-1?i.maxPathLengthBefore:i.maxPathLengthAfter;if(n===-1){n=0;const r=s===-1?i.linksBefore:i.linksAfter;for(const l of e){const{fromNode:c,toNode:h}=l,p=s===-1?h.id:c.id,u=s===-1?c.id:h.id,m=o===p?t.get(u):void 0;m!=null&&(r.push({node:m,link:l}),a?.push(o),n=Math.max(n,jr(t,e,m,u,s,a)+1),a?.pop())}s===-1?i.maxPathLengthBefore=n:i.maxPathLengthAfter=n}return n}var{DataModelSeries:_D,DataController:CD,Validate:wD,ARRAY:PD,keyProperty:BD,valueProperty:ca}=kD,{Selection:Ri,Group:xo,Text:zD}=OD,Yr=class extends _D{constructor(){super(...arguments),this._chartNodes=void 0,this.nodeCount=0,this.linkCount=0,this.nodesDataController=new CD("standalone"),this.nodesDataModel=void 0,this.nodesProcessedData=void 0,this.processedNodes=new Map,this.linkGroup=this.contentGroup.appendChild(new xo({name:"linkGroup"})),this.nodeGroup=this.contentGroup.appendChild(new xo({name:"nodeGroup"})),this.focusLinkGroup=this.highlightNode.appendChild(new xo({name:"linkGroup"})),this.focusNodeGroup=this.highlightNode.appendChild(new xo({name:"nodeGroup"})),this.highlightLinkGroup=this.highlightNode.appendChild(new xo({name:"linkGroup"})),this.highlightNodeGroup=this.highlightNode.appendChild(new xo({name:"nodeGroup"})),this.labelSelection=Ri.select(this.labelGroup,zD),this.linkSelection=Ri.select(this.linkGroup,()=>this.linkFactory()),this.nodeSelection=Ri.select(this.nodeGroup,()=>this.nodeFactory()),this.focusLinkSelection=Ri.select(this.focusLinkGroup,()=>this.linkFactory()),this.focusNodeSelection=Ri.select(this.focusNodeGroup,()=>this.nodeFactory()),this.highlightLinkSelection=Ri.select(this.highlightLinkGroup,()=>this.linkFactory()),this.highlightNodeSelection=Ri.select(this.highlightNodeGroup,()=>this.nodeFactory())}get nodes(){return this.properties.nodes??this._chartNodes}setChartNodes(t){this._chartNodes=t,this.nodes===t&&(this.nodeDataRefresh=!0)}getNodeData(){return this.contextNodeData?.nodeData}async processData(t){const{nodesDataController:e,data:i,nodes:o}=this;if(i==null||!this.properties.isValid())return;const{fromKey:s,toKey:a,sizeKey:n,idKey:r,labelKey:l}=this.properties,c=o!=null?e.request(this.id,o,{props:[BD(r,void 0,{id:"idValue",includeProperty:!1}),...l!=null?[ca(l,void 0,{id:"labelValue",includeProperty:!1})]:[]],groupByKeys:!0}):null,h=this.requestDataModel(t,i,{props:[ca(s,void 0,{id:"fromValue",includeProperty:!1}),ca(a,void 0,{id:"toValue",includeProperty:!1}),...n!=null?[ca(n,void 0,{id:"sizeValue",includeProperty:!1,missingValue:0})]:[]],groupByKeys:!1});o!=null&&e.execute();const[p,u]=await Promise.all([c,h]);this.nodesDataModel=p?.dataModel,this.nodesProcessedData=p?.processedData;const{fills:m,strokes:g}=this.properties,y=new Map;if(p==null){const f=u.dataModel.resolveProcessedDataIndexById(this,"fromValue"),M=u.dataModel.resolveProcessedDataIndexById(this,"toValue"),b=S=>{const x=y.size,N=S,v=m[x%m.length],D=g[x%g.length];return{series:this,itemId:void 0,datum:{},type:1,index:x,id:S,label:N,fill:v,stroke:D}};u.processedData.data.forEach(({values:S})=>{const x=S[f],N=S[M];x==null||N==null||(y.has(x)||y.set(x,b(x)),y.has(N)||y.set(N,b(N)))})}else{const f=p.dataModel.resolveProcessedDataIndexById(this,"idValue"),M=l!=null?p.dataModel.resolveProcessedDataIndexById(this,"labelValue"):void 0;p.processedData.data.forEach(({datum:b,keys:S,values:x},N)=>{const v=x[0],D=S[f],I=M!=null?v[M]:void 0,A=m[N%m.length],k=g[N%g.length];y.set(D,{series:this,itemId:void 0,datum:b,type:1,index:N,id:D,label:I,fill:A,stroke:k})})}this.processedNodes=y}getNodeGraph(t,e,{includeCircularReferences:i}){const{dataModel:o,processedData:s}=this;if(o==null||s==null){const{links:g,nodeGraph:y,maxPathLength:f}=Dp(new Map().values(),[],i);return this.nodeCount=0,this.linkCount=0,{nodeGraph:y,links:g,maxPathLength:f}}const{sizeKey:a}=this.properties,n=o.resolveProcessedDataIndexById(this,"fromValue"),r=o.resolveProcessedDataIndexById(this,"toValue"),l=a!=null?o.resolveProcessedDataIndexById(this,"sizeValue"):void 0,c=new Map;this.processedNodes.forEach(g=>{const y=t(g);c.set(g.id,y)});const h=[];s.data.forEach(({datum:g,values:y},f)=>{const M=y[n],b=y[r],S=l!=null?y[l]:1,x=c.get(M),N=c.get(b);if(S<=0||x==null||N==null)return;const v=e({series:this,itemId:void 0,datum:g,type:0,index:f,fromNode:x,toNode:N,size:S});h.push(v)});const{links:p,nodeGraph:u,maxPathLength:m}=Dp(c.values(),h,i);return this.nodeCount=u.size,this.linkCount=p.length,{nodeGraph:u,links:p,maxPathLength:m}}async updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=await this.createNodeData(),this.nodeDataRefresh=!1)}async update(t){const{seriesRect:e}=t,i={seriesRectWidth:e?.width??0,seriesRectHeight:e?.height??0};(this._nodeDataDependencies==null||this._nodeDataDependencies.seriesRectWidth!==i.seriesRectWidth||this._nodeDataDependencies.seriesRectHeight!==i.seriesRectHeight)&&(this._nodeDataDependencies=i),await this.updateSelections();const o=this.contextNodeData?.nodeData??[],s=this.contextNodeData?.labelData??[];let a=this.ctx.highlightManager?.getActiveHighlight();if(a?.series===this&&a.type==null){const{itemId:h}=a;a=h!=null?o.find(p=>p.type===1&&p.id===h):void 0}else a?.series!==this&&(a=void 0);this.contentGroup.visible=this.visible,this.contentGroup.opacity=a!=null?this.properties.highlightStyle.series.dimOpacity??1:1,this.labelSelection=await this.updateLabelSelection({labelData:s,labelSelection:this.labelSelection}),await this.updateLabelNodes({labelSelection:this.labelSelection}),this.linkSelection=await this.updateLinkSelection({nodeData:o.filter(h=>h.type===0),datumSelection:this.linkSelection}),await this.updateLinkNodes({datumSelection:this.linkSelection,isHighlight:!1}),this.nodeSelection=await this.updateNodeSelection({nodeData:o.filter(h=>h.type===1),datumSelection:this.nodeSelection}),await this.updateNodeNodes({datumSelection:this.nodeSelection,isHighlight:!1});let n,r,l,c;a?.type===1?(n=o.filter(h=>h.type===0&&(h.toNode===a||h.fromNode===a)),r=n.map(h=>h.fromNode===a?h.toNode:h.fromNode),r.push(a),l=[],c=[a]):a?.type===0?(n=[a],r=[a.fromNode,a.toNode],l=[a],c=[]):(n=[],r=[],l=[],c=[]),this.focusLinkSelection=await this.updateLinkSelection({nodeData:n,datumSelection:this.focusLinkSelection}),await this.updateLinkNodes({datumSelection:this.focusLinkSelection,isHighlight:!1}),this.focusNodeSelection=await this.updateNodeSelection({nodeData:r,datumSelection:this.focusNodeSelection}),await this.updateNodeNodes({datumSelection:this.focusNodeSelection,isHighlight:!1}),this.highlightLinkSelection=await this.updateLinkSelection({nodeData:l,datumSelection:this.highlightLinkSelection}),await this.updateLinkNodes({datumSelection:this.highlightLinkSelection,isHighlight:!0}),this.highlightNodeSelection=await this.updateNodeSelection({nodeData:c,datumSelection:this.highlightNodeSelection}),await this.updateNodeNodes({datumSelection:this.highlightNodeSelection,isHighlight:!0})}resetAnimation(t){}getSeriesDomain(t){return[]}getLegendData(t){return t!=="category"?[]:Array.from(this.processedNodes.values(),({id:e,label:i,fill:o,stroke:s})=>({legendType:"category",id:this.id,itemId:e,seriesId:this.id,enabled:!0,label:{text:i??e},symbols:[{marker:{fill:o,fillOpacity:1,stroke:s,strokeWidth:0,strokeOpacity:1}}]}))}pickNodeClosestDatum({x:t,y:e}){let i=1/0,o;return this.linkSelection.each((s,a)=>{const n=s.containsPoint(t,e)?0:1/0;n<i&&(i=n,o=a)}),this.nodeSelection.each((s,a)=>{const n=s.distanceSquared(t,e);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:Math.sqrt(i)}:void 0}getDatumAriaText(t,e){if(t.type===0)return this.ctx.localeManager.t("ariaAnnounceFlowProportionLink",{index:t.index+1,count:this.linkCount,from:t.fromNode.id,to:t.toNode.id,size:t.size,sizeName:this.properties.sizeName??this.properties.sizeKey});if(t.type===1)return this.ctx.localeManager.t("ariaAnnounceFlowProportionNode",{index:t.index+1,count:this.nodeCount,description:e})}};d([wD(PD,{optional:!0,property:"nodes"})],Yr.prototype,"_chartNodes",2);import{_Scene as VD}from"ag-charts-community";var{Path:FD,ScenePathChangeDetection:ni}=VD,Ue=class extends FD{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.radius=0,this.startAngle1=0,this.endAngle1=0,this.startAngle2=0,this.endAngle2=0,this.tension=1}tensionedCurveTo(t,e,i,o,s,a,n,r){const{path:l,tension:c}=this,h=1-c;l.cubicCurveTo((i-t)*h+t,(o-e)*h+e,(s-n)*h+n,(a-r)*h+r,n,r)}updatePath(){const{path:t,centerX:e,centerY:i,radius:o}=this;let{startAngle1:s,endAngle1:a,startAngle2:n,endAngle2:r}=this;s>n&&([s,n]=[n,s],[a,r]=[r,a]),t.clear();const l=e+o*Math.cos(s),c=i+o*Math.sin(s);t.moveTo(l,c),this.tensionedCurveTo(l,c,e,i,e,i,e+o*Math.cos(r),i+o*Math.sin(r)),t.arc(e,i,o,r,n,!0),this.tensionedCurveTo(e+o*Math.cos(n),i+o*Math.sin(n),e,i,e,i,e+o*Math.cos(a),i+o*Math.sin(a)),t.arc(e,i,o,a,s,!0),t.closePath()}};d([ni()],Ue.prototype,"centerX",2),d([ni()],Ue.prototype,"centerY",2),d([ni()],Ue.prototype,"radius",2),d([ni()],Ue.prototype,"startAngle1",2),d([ni()],Ue.prototype,"endAngle1",2),d([ni()],Ue.prototype,"startAngle2",2),d([ni()],Ue.prototype,"endAngle2",2),d([ni()],Ue.prototype,"tension",2);import{_ModuleSupport as UD,_Scene as HD}from"ag-charts-community";var{BaseProperties:vp,SeriesTooltip:KD,SeriesProperties:GD,ARRAY:WD,COLOR_STRING:ha,COLOR_STRING_ARRAY:Ip,FUNCTION:Ap,LINE_DASH:Tp,OBJECT:da,POSITIVE_NUMBER:ri,RATIO:qo,STRING:li,Validate:G}=UD,{Label:jD}=HD,Xr=class extends jD{constructor(){super(...arguments),this.spacing=1,this.maxWidth=1}};d([G(ri)],Xr.prototype,"spacing",2),d([G(ri)],Xr.prototype,"maxWidth",2);var Ie=class extends vp{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0,this.tension=0}};d([G(ha,{optional:!0})],Ie.prototype,"fill",2),d([G(qo)],Ie.prototype,"fillOpacity",2),d([G(ha,{optional:!0})],Ie.prototype,"stroke",2),d([G(qo)],Ie.prototype,"strokeOpacity",2),d([G(ri)],Ie.prototype,"strokeWidth",2),d([G(Tp)],Ie.prototype,"lineDash",2),d([G(ri)],Ie.prototype,"lineDashOffset",2),d([G(qo)],Ie.prototype,"tension",2),d([G(Ap,{optional:!0})],Ie.prototype,"itemStyler",2);var ge=class extends vp{constructor(){super(...arguments),this.spacing=1,this.width=1,this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};d([G(ri)],ge.prototype,"spacing",2),d([G(ri)],ge.prototype,"width",2),d([G(ha,{optional:!0})],ge.prototype,"fill",2),d([G(qo)],ge.prototype,"fillOpacity",2),d([G(ha,{optional:!0})],ge.prototype,"stroke",2),d([G(qo)],ge.prototype,"strokeOpacity",2),d([G(ri)],ge.prototype,"strokeWidth",2),d([G(Tp)],ge.prototype,"lineDash",2),d([G(ri)],ge.prototype,"lineDashOffset",2),d([G(Ap,{optional:!0})],ge.prototype,"itemStyler",2);var Pt=class extends GD{constructor(){super(...arguments),this.idKey="",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.sizeKey=void 0,this.sizeName=void 0,this.nodes=void 0,this.fills=[],this.strokes=[],this.label=new Xr,this.link=new Ie,this.node=new ge,this.tooltip=new KD}};d([G(li)],Pt.prototype,"fromKey",2),d([G(li)],Pt.prototype,"toKey",2),d([G(li)],Pt.prototype,"idKey",2),d([G(li,{optional:!0})],Pt.prototype,"idName",2),d([G(li,{optional:!0})],Pt.prototype,"labelKey",2),d([G(li,{optional:!0})],Pt.prototype,"labelName",2),d([G(li,{optional:!0})],Pt.prototype,"sizeKey",2),d([G(li,{optional:!0})],Pt.prototype,"sizeName",2),d([G(WD,{optional:!0})],Pt.prototype,"nodes",2),d([G(Ip)],Pt.prototype,"fills",2),d([G(Ip)],Pt.prototype,"strokes",2),d([G(da)],Pt.prototype,"label",2),d([G(da)],Pt.prototype,"link",2),d([G(da)],Pt.prototype,"node",2),d([G(da)],Pt.prototype,"tooltip",2);var{SeriesNodePickMode:kp,createDatumId:Op,EMPTY_TOOLTIP_CONTENT:YD}=ID,{angleBetween:So,normalizeAngle360:XD,isBetweenAngles:Lp,sanitizeHtml:Ep,Logger:ZD}=TD,{Sector:QD,Text:Zr}=AD,pa=t=>t.startAngle+So(t.startAngle,t.endAngle)/2,Qr=class extends Yr{constructor(t){super({moduleCtx:t,contentGroupVirtual:!1,pickModes:[kp.NEAREST_NODE,kp.EXACT_SHAPE_MATCH]}),this.properties=new Pt}isLabelEnabled(){return(this.properties.labelKey!=null||this.nodes==null)&&this.properties.label.enabled}linkFactory(){return new Ue}nodeFactory(){return new QD}async createNodeData(){const{id:t,_nodeDataDependencies:{seriesRectWidth:e,seriesRectHeight:i}={seriesRectWidth:0,seriesRectHeight:0}}=this,{fromKey:o,toKey:s,sizeKey:a,label:{spacing:n,maxWidth:r,fontSize:l},node:{width:c,spacing:h}}=this.properties,p=e/2,u=i/2;let m=[];const g=T=>String(T),{nodeGraph:y,links:f}=this.getNodeGraph(T=>{const E=this.getLabelText(this.properties.label,{datum:T.datum,value:T.label,fromKey:o,toKey:s,sizeKey:a},g);return{...T,label:E,size:0,centerX:p,centerY:u,innerRadius:NaN,outerRadius:NaN,startAngle:NaN,endAngle:NaN}},T=>({...T,centerX:p,centerY:u,radius:NaN,startAngle1:NaN,endAngle1:NaN,startAngle2:NaN,endAngle2:NaN}),{includeCircularReferences:!0});let M=0;y.forEach(({datum:T,linksBefore:E,linksAfter:_},R)=>{const C=E.reduce((w,{link:P})=>w+P.size,0)+_.reduce((w,{link:P})=>w+P.size,0);C===0?y.delete(R):(T.size=C,M+=T.size)});let b=0;if(this.isLabelEnabled()){const T=this.properties.label.getFont();let E=0;y.forEach(({datum:_})=>{const{id:R,label:C}=_;if(C==null)return;const w=Zr.wrap(C,r,1/0,this.properties.label,"never","ellipsis"),{width:P}=Zr.measureText(w,T,"middle","left");E=Math.max(P,E),m.push({id:R,text:w,centerX:p,centerY:u,angle:NaN,radius:NaN})}),b=E+n}const S=y.size;let x=Math.min(e,i)/2-c-b,N=h/x;if(b!==0&&(S*N>=1.5*Math.PI||x<=0)&&(m=[],x=Math.min(e,i)/2-c,N=h/x),S*N>=2*Math.PI||x<=0)return ZD.warnOnce("There was insufficient space to display the Chord Series."),{itemId:this.id,nodeData:[],labelData:[]};const v=x,D=x+c,I=Math.max((2*Math.PI-S*N)/M,0);let A=0;y.forEach(({datum:T})=>{T.innerRadius=v,T.outerRadius=D,T.startAngle=A,T.endAngle=A+T.size*I,A=T.endAngle+N;const E=(T.innerRadius+T.outerRadius)/2,_=pa(T);T.midPoint={x:T.centerX+E*Math.cos(_),y:T.centerY+E*Math.sin(_)}});const k=[];y.forEach(({datum:T,linksBefore:E,linksAfter:_})=>{const R=pa(T),C=[...E.map(P=>({link:P.link,distance:So(pa(P.node.datum),R),after:!1})),..._.map(P=>({link:P.link,distance:So(pa(P.node.datum),R),after:!0}))];let w=T.startAngle;C.sort((P,B)=>P.distance-B.distance).forEach(({link:P,after:B})=>{const z=P.size*I;B?(P.startAngle1=w,P.endAngle1=w+z):(P.startAngle2=w,P.endAngle2=w+z),w+=P.size*I}),k.push(T)}),f.forEach(T=>{T.radius=x;const E=T.startAngle1+So(T.startAngle1,T.endAngle1)/2,_=T.startAngle2+So(T.startAngle2,T.endAngle2)/2,R=x*Math.cos(E),C=x*Math.sin(E),w=x*Math.cos(_),P=x*Math.sin(_);T.midPoint={x:T.centerX+(R+w)*.125,y:T.centerY+(C+P)*.125},k.push(T)}),m.forEach(T=>{const E=y.get(T.id)?.datum;E!=null&&(T.radius=D+n,T.angle=XD(E.startAngle+So(E.startAngle,E.endAngle)/2))}),m.sort((T,E)=>T.angle-E.angle);let L=1/0,O=-1/0;return m=m.filter(T=>{const E=l*Zr.defaultLineHeightRatio,_=Math.atan2(E/2,T.radius),R=T.angle-_,C=T.angle+_;return Lp(L,R,C)||Lp(O,R,C)?!1:(L=Math.min(R,L),O=Math.max(C,O),!0)}),{itemId:t,nodeData:k,labelData:m}}async updateLabelSelection(t){const e=this.isLabelEnabled()?t.labelData:[];return t.labelSelection.update(e)}async updateLabelNodes(t){const{labelSelection:e}=t,{color:i,fontStyle:o,fontWeight:s,fontSize:a,fontFamily:n}=this.properties.label;e.each((r,{text:l,centerX:c,centerY:h,radius:p,angle:u})=>{r.visible=!0,r.translationX=c+p*Math.cos(u),r.translationY=h+p*Math.sin(u),r.text=l,r.fill=i,r.fontStyle=o,r.fontWeight=s,r.fontSize=a,r.fontFamily=n,r.textBaseline="middle",Math.cos(u)>=0?(r.textAlign="left",r.rotation=u):(r.textAlign="right",r.rotation=u-Math.PI)})}async updateNodeSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>Op([e.type,e.id]))}async updateNodeNodes(t){const{datumSelection:e,isHighlight:i}=t,{id:o,properties:s,ctx:{callbackCache:a}}=this,{fromKey:n,toKey:r,sizeKey:l}=this.properties,{fill:c,fillOpacity:h,stroke:p,strokeOpacity:u,lineDash:m,lineDashOffset:g,itemStyler:y}=s.node,f=i?s.highlightStyle.item:void 0,M=this.getStrokeWidth(s.node.strokeWidth);e.each((b,S)=>{const x=c??S.fill,N=p??S.stroke;let v;if(y!=null){const{label:D,size:I}=S;v=a.call(y,{seriesId:o,datum:S.datum,label:D,size:I,fromKey:n,toKey:r,sizeKey:l,fill:x,fillOpacity:h,strokeOpacity:u,stroke:N,strokeWidth:M,lineDash:m,lineDashOffset:g,highlighted:i})}b.centerX=S.centerX,b.centerY=S.centerY,b.innerRadius=S.innerRadius,b.outerRadius=S.outerRadius,b.startAngle=S.startAngle,b.endAngle=S.endAngle,b.fill=f?.fill??v?.fill??x,b.fillOpacity=f?.fillOpacity??v?.fillOpacity??h,b.stroke=f?.stroke??v?.stroke??N,b.strokeOpacity=f?.strokeOpacity??v?.strokeOpacity??u,b.strokeWidth=f?.strokeWidth??v?.strokeWidth??M,b.lineDash=f?.lineDash??v?.lineDash??m,b.lineDashOffset=f?.lineDashOffset??v?.lineDashOffset??g,b.inset=b.strokeWidth/2})}async updateLinkSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>Op([e.type,e.index,e.fromNode.id,e.toNode.id]))}async updateLinkNodes(t){const{datumSelection:e,isHighlight:i}=t,{id:o,properties:s,ctx:{callbackCache:a}}=this,{fromKey:n,toKey:r,sizeKey:l}=s,{fill:c,fillOpacity:h,stroke:p,strokeOpacity:u,lineDash:m,lineDashOffset:g,tension:y,itemStyler:f}=s.link,M=i?s.highlightStyle.item:void 0,b=this.getStrokeWidth(s.link.strokeWidth);e.each((S,x)=>{const N=c??x.fromNode.fill,v=p??x.fromNode.stroke;let D;f!=null&&(D=a.call(f,{seriesId:o,datum:x.datum,fromKey:n,toKey:r,sizeKey:l,fill:N,fillOpacity:h,strokeOpacity:u,stroke:v,strokeWidth:b,lineDash:m,lineDashOffset:g,tension:y,highlighted:i})),S.centerX=x.centerX,S.centerY=x.centerY,S.radius=x.radius,S.startAngle1=x.startAngle1,S.endAngle1=x.endAngle1,S.startAngle2=x.startAngle2,S.endAngle2=x.endAngle2,S.fill=M?.fill??D?.fill??N,S.fillOpacity=M?.fillOpacity??D?.fillOpacity??h,S.stroke=M?.stroke??D?.stroke??v,S.strokeOpacity=M?.strokeOpacity??D?.strokeOpacity??u,S.strokeWidth=M?.strokeWidth??D?.strokeWidth??b,S.lineDash=M?.lineDash??D?.lineDash??m,S.lineDashOffset=M?.lineDashOffset??D?.lineDashOffset??g,S.tension=D?.tension??y})}resetAnimation(t){}getTooltipHtml(t){const{id:e,processedData:i,ctx:{callbackCache:o},properties:s}=this;if(!i||!s.isValid())return YD;const{fromKey:a,toKey:n,sizeKey:r,sizeName:l,tooltip:c}=s,{datum:h,itemId:p}=t;let u;const m=[];let g;if(t.type===0){const{fillOpacity:M,strokeOpacity:b,strokeWidth:S,lineDash:x,lineDashOffset:N,tension:v,itemStyler:D}=s.link,{fromNode:I,toNode:A,size:k}=t;u=`${I.label??I.id} - ${A.label??A.id}`,r!=null&&m.push(Ep(`${l??r}: `+k)),g=s.link.fill??I.fill;const L=s.link.stroke??I.stroke;let O;D!=null&&(O=o.call(D,{seriesId:e,datum:h.datum,fromKey:a,toKey:n,sizeKey:r,fill:g,fillOpacity:M,strokeOpacity:b,stroke:L,strokeWidth:S,lineDash:x,lineDashOffset:N,tension:v,highlighted:!0})),g=O?.fill??g}else{const{fillOpacity:M,strokeOpacity:b,strokeWidth:S,lineDash:x,lineDashOffset:N,itemStyler:v}=s.node,{id:D,label:I,size:A}=t;u=I??D,r!=null&&m.push(Ep(`${l??r}: `+A)),g=s.link.fill??t.fill;const k=s.link.stroke??t.stroke;let L;v!=null&&(L=o.call(v,{seriesId:e,datum:h.datum,label:I,size:A,fromKey:a,toKey:n,sizeKey:r,fill:g,fillOpacity:M,strokeOpacity:b,stroke:k,strokeWidth:S,lineDash:x,lineDashOffset:N,highlighted:!0})),g=L?.fill??t.fill}const y=m.join("<br>"),f=g;return c.toTooltipHtml({title:u,content:y,backgroundColor:f},{seriesId:e,datum:h,title:u,color:f,itemId:p,fromKey:a,toKey:n,sizeKey:r,sizeName:l,...this.getModuleTooltipParams()})}getLabelData(){return[]}computeFocusBounds({datumIndex:t}){const e=this.contextNodeData?.nodeData[t];if(e?.type===1){for(const i of this.nodeSelection)if(i.datum===e)return i.node;return}else if(e?.type===0){for(const i of this.linkSelection)if(i.datum===e)return i.node;return}}};Qr.className="ChordSeries",Qr.type="chord";var{DEFAULT_FONT_FAMILY:$D,DEFAULT_LABEL_COLOUR:qD}=vD,JD={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["flow-proportion"],solo:!0,identifier:"chord",tooltipDefaults:{range:"exact"},instanceConstructor:Qr,themeTemplate:{series:{highlightStyle:{series:{dimOpacity:.2}},label:{fontFamily:$D,color:qD,spacing:5,maxWidth:100},node:{spacing:8,width:10,strokeWidth:0},link:{fillOpacity:.5,strokeWidth:0,tension:.4}},legend:{enabled:!1,toggleSeries:!1}},paletteFactory({takeColors:t,colorsCount:e}){const{fills:i,strokes:o}=t(e);return{fills:i,strokes:o}}};import{_Theme as Mo}from"ag-charts-community";import{_ModuleSupport as ua,_Scale as tN,_Scene as eN,_Util as iN}from"ag-charts-community";import{_ModuleSupport as oN,_Scene as sN,_Util as aN}from"ag-charts-community";var{Validate:ga,NUMBER:Rp,TEXT_WRAP:nN,OVERFLOW_STRATEGY:rN}=oN,{Logger:lN}=aN,{Text:_i,Label:cN}=sN,Jo=class extends cN{constructor(){super(...arguments),this.wrapping="on-space",this.overflowStrategy="ellipsis"}static lineHeight(t){return Math.ceil(t*_i.defaultLineHeightRatio)}};d([ga(nN)],Jo.prototype,"wrapping",2),d([ga(rN)],Jo.prototype,"overflowStrategy",2),d([ga(Rp,{optional:!0})],Jo.prototype,"minimumFontSize",2);var ie=class extends Jo{constructor(){super(...arguments),this.spacing=0}};d([ga(Rp)],ie.prototype,"spacing",2);var ts=class extends Jo{};function hN(t,e){const{fontSize:i,minimumFontSize:o=i}=t,{fontSize:s,minimumFontSize:a=s}=e,n=i-o,r=s-a;let l=t.fontSize,c=e.fontSize;const h=[{labelFontSize:i,secondaryLabelFontSize:s}];for(;l>o||c>a;){const p=n>0?(l-o)/n:-1,u=r>0?(c-a)/r:-1;p>u?l--:c--,h.push({labelFontSize:l,secondaryLabelFontSize:c})}return h.reverse(),h}function _p(t,e,i){if(t>e)return;let o=t,s=e,a;for(;s>=o;){const n=(s+o)/2|0,r=i(n);r==null?s=n-1:(a=r,o=n+1)}return a}function dN(t,e,i,o,{padding:s},a){const{spacing:n}=e,r=2*s,l=2*s+n,c=(e.minimumFontSize??e.fontSize)+(o.minimumFontSize??o.fontSize);if(c>a(c+l,!1).height-l)return;const h=hN(e,o),p=new _i;p.setFont(e);const u={fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight},m=new _i;m.setFont(o);const g={fontFamily:o.fontFamily,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight};let y,f;return _p(0,h.length-1,M=>{const{labelFontSize:b,secondaryLabelFontSize:S}=h[M],x=M===0,N=ie.lineHeight(b),v=ts.lineHeight(S),D=a(N+v+l,x),I=D.width-r,A=D.height-l;if(N+v>A)return;if(y==null||y.fontSize!==b){u.fontSize=b;const L=_i.wrapLines(t,I,A,u,e.wrapping,x?e.overflowStrategy:"hide");if(L==null)y=void 0;else{const O=L.join(`
`);p.text=O,p.fontSize=b,p.lineHeight=b;const T=p.computeBBox().width,E=L.length*N;y={text:O,fontSize:b,lineHeight:N,width:T,height:E}}}if(y==null||y.width>I||y.height>A)return;if(f==null||f.fontSize!==S){g.fontSize=S;const L=_i.wrapLines(i,I,A,g,o.wrapping,x?o.overflowStrategy:"hide");if(L==null)f=void 0;else{const O=L.join(`
`);m.text=O,m.fontSize=S,m.lineHeight=v;const T=m.computeBBox().width,E=L.length*v;f={text:O,fontSize:S,lineHeight:v,width:T,height:E}}}if(f==null)return;const k=y.height+f.height;if(!(f.width>I||k>A))return{width:Math.max(y.width,f.width),height:k+n,meta:D.meta,label:y,secondaryLabel:f}})}function $r(t,e,{padding:i},o){const s=2*i,a=Math.min(e.minimumFontSize??e.fontSize,e.fontSize),n=new _i;n.setFont(e);const r={fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight};return _p(a,e.fontSize,l=>{const c=ie.lineHeight(l),h=l===a,p=o(c+s,h),u=p.width-s,m=p.height-s;if(c>m)return;r.fontSize=l;const g=_i.wrapLines(t,u,m,r,e.wrapping,h?e.overflowStrategy:"hide");if(g==null)return;const y=g.join(`
`);n.text=y,n.fontSize=l,n.lineHeight=c;const f=n.computeBBox(),M=n.computeBBox().width,b=c*g.length;if(!(f.width>u||b>m))return[{text:y,fontSize:l,lineHeight:c,width:M,height:b},p.meta]})}function Cp(t){return t?.minimumFontSize!=null&&t?.fontSize&&t?.minimumFontSize>t?.fontSize}function qr(t,e,i,o,s,a){const n=e.enabled?t:void 0,r=o.enabled?i:void 0;(Cp(e)||Cp(o))&&lN.warnOnce("minimumFontSize should be set to a value less than or equal to the font size");let l;n!=null&&r!=null&&(l=dN(n,e,r,o,s,a));let c;if(l==null&&n!=null&&(c=$r(n,e,s,a)),c!=null){const[p,u]=c;l={width:p.width,height:p.height,meta:u,label:p,secondaryLabel:void 0}}let h;if(l==null&&n==null&&r!=null&&(h=$r(r,o,s,a)),h!=null){const[p,u]=h;l={width:p.width,height:p.height,meta:u,label:void 0,secondaryLabel:p}}return l}import{_ModuleSupport as pN}from"ag-charts-community";var{CartesianSeriesProperties:uN,SeriesTooltip:gN,Validate:Lt,AND:yN,ARRAY:mN,COLOR_STRING:fN,COLOR_STRING_ARRAY:xN,FUNCTION:SN,OBJECT:wp,POSITIVE_NUMBER:Pp,RATIO:MN,STRING:Ci,TEXT_ALIGN:bN,VERTICAL_ALIGN:DN}=pN,It=class extends uN{constructor(){super(...arguments),this.colorRange=["black","black"],this.stroke="black",this.strokeWidth=0,this.textAlign="center",this.verticalAlign="middle",this.itemPadding=0,this.label=new ie,this.tooltip=new gN}};d([Lt(Ci,{optional:!0})],It.prototype,"title",2),d([Lt(Ci)],It.prototype,"xKey",2),d([Lt(Ci)],It.prototype,"yKey",2),d([Lt(Ci,{optional:!0})],It.prototype,"colorKey",2),d([Lt(Ci,{optional:!0})],It.prototype,"xName",2),d([Lt(Ci,{optional:!0})],It.prototype,"yName",2),d([Lt(Ci,{optional:!0})],It.prototype,"colorName",2),d([Lt(yN(xN,mN.restrict({minLength:1})))],It.prototype,"colorRange",2),d([Lt(fN,{optional:!0})],It.prototype,"stroke",2),d([Lt(MN,{optional:!0})],It.prototype,"strokeOpacity",2),d([Lt(Pp,{optional:!0})],It.prototype,"strokeWidth",2),d([Lt(bN)],It.prototype,"textAlign",2),d([Lt(DN)],It.prototype,"verticalAlign",2),d([Lt(Pp)],It.prototype,"itemPadding",2),d([Lt(SN,{optional:!0})],It.prototype,"itemStyler",2),d([Lt(wp)],It.prototype,"label",2),d([Lt(wp)],It.prototype,"tooltip",2);var{SeriesNodePickMode:Bp,computeBarFocusBounds:NN,getMissCount:vN,valueProperty:Jr,ChartAxisDirection:Ae,DEFAULT_CARTESIAN_DIRECTION_KEYS:IN,DEFAULT_CARTESIAN_DIRECTION_NAMES:AN}=ua,{Rect:TN,PointerEvents:kN}=eN,{ColorScale:ON}=tN,{sanitizeHtml:bo,Logger:LN}=iN,EN=class extends ua.CartesianSeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.colorKey=o.properties.colorKey}},RN={left:-.5,center:0,right:-.5},_N={top:-.5,middle:0,bottom:-.5},tl=class extends ua.CartesianSeries{constructor(t){super({moduleCtx:t,directionKeys:IN,directionNames:AN,pickModes:[Bp.NEAREST_NODE,Bp.EXACT_SHAPE_MATCH],pathsPerSeries:0,hasMarkers:!1,hasHighlightedLabels:!0}),this.properties=new It,this.NodeEvent=EN,this.colorScale=new ON}async processData(t){const e=this.axes[Ae.X],i=this.axes[Ae.Y];if(!e||!i||!this.properties.isValid()||!this.data?.length)return;const{xKey:o,yKey:s,colorRange:a,colorKey:n}=this.properties,r=this.axes[Ae.X]?.scale,l=this.axes[Ae.Y]?.scale,{xScaleType:c,yScaleType:h}=this.getScaleInformation({xScale:r,yScale:l}),p=this.colorScale.type,{dataModel:u,processedData:m}=await this.requestDataModel(t,this.data,{props:[Jr(o,c,{id:"xValue"}),Jr(s,h,{id:"yValue"}),...n?[Jr(n,p,{id:"colorValue"})]:[]]});if(this.isColorScaleValid()){const g=u.resolveProcessedDataIndexById(this,"colorValue");this.colorScale.domain=m.domain.values[g],this.colorScale.range=a,this.colorScale.update()}}isColorScaleValid(){const{colorKey:t}=this.properties;if(!t)return!1;const{dataModel:e,processedData:i}=this;if(!e||!i)return!1;const o=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.data.length,a=vN(this,i.defs.values[o].missing);return!(s===0||s===a)}getSeriesDomain(t){const{dataModel:e,processedData:i}=this;return!e||!i?[]:t===Ae.X?e.getDomain(this,"xValue","value",i):e.getDomain(this,"yValue","value",i)}async createNodeData(){const{data:t,visible:e,axes:i,dataModel:o}=this,s=i[Ae.X],a=i[Ae.Y];if(!(t&&o&&e&&s&&a))return;if(s.type!=="category"||a.type!=="category"){LN.warnOnce(`Heatmap series expected axes to have "category" type, but received "${s.type}" and "${a.type}" instead.`);return}const{xKey:n,xName:r,yKey:l,yName:c,colorKey:h,colorName:p,textAlign:u,verticalAlign:m,itemPadding:g,colorRange:y,label:f}=this.properties,M=o.resolveProcessedDataIndexById(this,"xValue"),b=o.resolveProcessedDataIndexById(this,"yValue"),S=h?o.resolveProcessedDataIndexById(this,"colorValue"):void 0,x=s.scale,N=a.scale,v=(x.bandwidth??0)/2,D=(N.bandwidth??0)/2,I=this.isColorScaleValid(),A=[],k=[],L=x.bandwidth??10,O=N.bandwidth??10,T=(L-2*g)*RN[u],E=(O-2*g)*_N[m],_=()=>({width:L,height:O,meta:null});for(const{values:R,datum:C}of this.processedData?.data??[]){const w=R[M],P=R[b],B=x.convert(w)+v,z=N.convert(P)+D,V=R[S??-1],U=I&&V!=null?this.colorScale.convert(V):y[0],Q=V==null?void 0:this.getLabelText(f,{value:V,datum:C,colorKey:h,colorName:p,xKey:n,yKey:l,xName:r,yName:c}),H=qr(Q,this.properties.label,void 0,this.properties.label,{padding:g},_),K={x:B,y:z,size:0};if(A.push({series:this,itemId:l,yKey:l,xKey:n,xValue:w,yValue:P,colorValue:V,datum:C,point:K,width:L,height:O,fill:U,midPoint:{x:B,y:z},missing:V==null}),H?.label!=null){const{text:j,fontSize:st,lineHeight:Ft,height:rt}=H.label,{fontStyle:Mt,fontFamily:bt,fontWeight:$t,color:Xt}=this.properties.label,Ut=K.x+T*(L-2*g),ot=K.y+E*(O-2*g)-(H.height-rt)*.5;k.push({series:this,itemId:l,datum:C,text:j,fontSize:st,lineHeight:Ft,fontStyle:Mt,fontFamily:bt,fontWeight:$t,color:Xt,textAlign:u,verticalAlign:m,x:Ut,y:ot})}}return{itemId:this.properties.yKey??this.id,nodeData:A,labelData:k,scales:this.calculateScaling(),visible:this.visible}}nodeFactory(){return new TN}async updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t,o=e??[];return i.update(o)}async updateDatumNodes(t){const{isHighlight:e}=t,{id:i,ctx:{callbackCache:o},properties:s}=this,{xKey:a,yKey:n,colorKey:r,itemStyler:l}=s,c=e?s.highlightStyle.item:void 0,h=c?.fillOpacity??1,p=c?.stroke??s.stroke,u=c?.strokeWidth??this.getStrokeWidth(s.strokeWidth),m=c?.strokeOpacity??s.strokeOpacity??1,g=this.axes[Ae.X],[y,f]=g?.visibleRange??[],b=!(y!==0||f!==1);t.datumSelection.each((S,x)=>{const{datum:N,point:v,width:D,height:I}=x,A=c?.fill??x.fill;let k;l&&(k=o.call(l,{datum:N,fill:A,fillOpacity:h,stroke:p,strokeOpacity:m,strokeWidth:u,highlighted:e,xKey:a,yKey:n,colorKey:r,seriesId:i})),S.crisp=b,S.x=Math.floor(v.x-D/2),S.y=Math.floor(v.y-I/2),S.width=Math.ceil(D),S.height=Math.ceil(I),S.fill=k?.fill??A,S.fillOpacity=k?.fillOpacity??h,S.stroke=k?.stroke??p,S.strokeWidth=k?.strokeWidth??u,S.strokeOpacity=k?.strokeOpacity??m})}async updateLabelSelection(t){const{labelData:e,labelSelection:i}=t,{enabled:o}=this.properties.label,s=o?e:[];return i.update(s)}async updateLabelNodes(t){t.labelSelection.each((e,i)=>{e.text=i.text,e.fontSize=i.fontSize,e.lineHeight=i.lineHeight,e.fontStyle=i.fontStyle,e.fontFamily=i.fontFamily,e.fontWeight=i.fontWeight,e.fill=i.color,e.textAlign=i.textAlign,e.textBaseline=i.verticalAlign,e.x=i.x,e.y=i.y,e.pointerEvents=kN.None})}getTooltipHtml(t){const e=this.axes[Ae.X],i=this.axes[Ae.Y];if(!this.properties.isValid()||!e||!i)return ua.EMPTY_TOOLTIP_CONTENT;const{xKey:o,yKey:s,colorKey:a,xName:n,yName:r,colorName:l,stroke:c,strokeWidth:h,strokeOpacity:p=1,colorRange:u,itemStyler:m,tooltip:g}=this.properties,{colorScale:y,id:f,ctx:{callbackCache:M}}=this,{datum:b,xValue:S,yValue:x,colorValue:N,itemId:v}=t,D=this.isColorScaleValid()?y.convert(N):u[0];let I;m&&(I=M.call(m,{datum:b,xKey:o,yKey:s,colorKey:a,fill:D,fillOpacity:1,stroke:c,strokeWidth:h,strokeOpacity:p,highlighted:!1,seriesId:f}));const A=I?.fill??D??"gray",k=this.properties.title??r,L=bo(e.formatDatum(S)),O=bo(i.formatDatum(x));let T=`<b>${bo(n??o)}</b>: ${L}<br><b>${bo(r??s)}</b>: ${O}`;return a&&(T=`<b>${bo(l??a)}</b>: ${bo(N)}<br>`+T),g.toTooltipHtml({title:k,content:T,backgroundColor:A},{seriesId:f,datum:b,xKey:o,yKey:s,xName:n,yName:r,title:k,color:A,colorKey:a,colorName:l,itemId:v})}getLegendData(t){return t!=="gradient"||!this.data?.length||!this.properties.isValid()||!this.isColorScaleValid()||!this.dataModel?[]:[{legendType:"gradient",enabled:this.visible,seriesId:this.id,colorName:this.properties.colorName,colorDomain:this.processedData.domain.values[this.dataModel.resolveProcessedDataIndexById(this,"colorValue")],colorRange:this.properties.colorRange}]}isLabelEnabled(){return this.properties.label.enabled&&!!this.properties.colorKey}getBandScalePadding(){return{inner:0,outer:0}}computeFocusBounds({datumIndex:t,seriesRect:e}){const i=this.contextNodeData?.nodeData[t];if(i===void 0)return;const{width:o,height:s,midPoint:a}=i,n={x:a.x-o/2,y:a.y-s/2,width:o,height:s};return NN(n,this.contentGroup,e)}};tl.className="HeatmapSeries",tl.type="heatmap";import{_Theme as el}from"ag-charts-community";var CN={series:{label:{enabled:!1,color:el.DEFAULT_LABEL_COLOUR,fontSize:el.FONT_SIZE.SMALL,fontFamily:el.DEFAULT_FONT_FAMILY,wrapping:"on-space",overflowStrategy:"ellipsis"},itemPadding:3},gradientLegend:{enabled:!0}},wN={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"heatmap",instanceConstructor:tl,tooltipDefaults:{range:"exact"},defaultAxes:[{type:Mo.CARTESIAN_AXIS_TYPE.CATEGORY,position:Mo.POSITION.LEFT},{type:Mo.CARTESIAN_AXIS_TYPE.CATEGORY,position:Mo.POSITION.BOTTOM}],themeTemplate:CN,paletteFactory:({takeColors:t,colorsCount:e,userPalette:i,themeTemplateParameters:o})=>{const s=o.get(Mo.DEFAULT_DIVERGING_SERIES_COLOUR_RANGE),a=o.get(Mo.DEFAULT_BACKGROUND_COLOUR),n=(Array.isArray(a)?a[0]:a)??"white",{fills:r,strokes:l}=t(e);return{stroke:i==="inbuilt"?n:l[0],colorRange:i==="inbuilt"?s:[r[0],r[1]]}}};import{_Theme as PN}from"ag-charts-community";var es={zoom:{axes:"xy",anchorPointX:"pointer",anchorPointY:"pointer"},legend:{enabled:!1},gradientLegend:{enabled:!1},tooltip:{range:"exact"}};import{_ModuleSupport as zp,_Scene as BN,_Util as zN}from"ag-charts-community";import{_Scene as VN}from"ag-charts-community";var FN=1e-9;function Vp(t,e,i,o){const[s,a]=t,[n,r]=e,l=n-s,c=r-a,h=l*l+c*c;let p,u;if(Math.abs(h)<FN)p=s,u=a;else{let y=((i-s)*l+(o-a)*c)/h;y=Math.max(0,Math.min(1,y)),p=s+y*(n-s),u=a+y*(r-a)}const m=i-p,g=o-u;return m*m+g*g}function Fp(t,e,i){let o=1/0,s=t[t.length-1];for(const a of t)o=Math.min(o,Vp(s,a,e,i)),s=a;return Math.sqrt(o)}function il(t){let[e,i]=t[0],o=0;for(let s=1;s<t.length;s+=1){const[a,n]=t[s],r=Math.hypot(a-e,n-i);o+=r,e=a,i=n}return o}function ya(t){if(t.length===0)return;const e=il(t)/2;let[i,o]=t[0],s=0;for(let a=1;a<t.length;a+=1){const[n,r]=t[a],l=Math.hypot(n-i,r-o),c=s+l;if(c>e){const h=(e-s)/l,p=[i+(n-i)*h,o+(r-o)*h],u=Math.atan2(r-o,n-i);return{point:p,angle:u}}s=c,i=n,o=r}}import{_ModuleSupport as UN}from"ag-charts-community";var{LonLatBBox:HN}=UN;function is(t,e,i,o,s){return t==null?t=new HN(e,i,o,s):(t.lon0=Math.min(t.lon0,e),t.lat0=Math.min(t.lat0,i),t.lon1=Math.max(t.lon1,o),t.lat1=Math.max(t.lat1,s)),t}var KN=(t,e,i)=>{let o=t,s=o;for(const a of e)if(o==null||i(o.value,a)>0)o={value:a,next:o},s=o;else{for(s=s;s.next!=null&&i(s.next.value,a)<=0;)s=s.next;s.next={value:a,next:s.next}}return o};function wi(t,e){return t.forEach(i=>{const[o,s]=i;e=is(e,o,s,o,s)}),e}function GN(t){if(t.length===0)return;let e=0,i=0,o=0,[s,a]=t[t.length-1];for(const[n,r]of t){const l=s*r-n*a;o+=l,e+=(s+n)*l,i+=(a+r)*l,s=n,a=r}return o*=3,[e/o,i/o]}function ma(t,e,i){let o=!1,s=1/0;for(const a of t){let n=a[a.length-1],[r,l]=n;for(const c of a){const[h,p]=c;p>i!=l>i&&e<(r-h)*(i-p)/(l-p)+h&&(o=!o),s=Math.min(s,Vp(n,c,e,i)),n=c,r=h,l=p}}return(o?-1:1)*Math.sqrt(s)}var{Path:WN,ExtendedPath2D:jN,BBox:YN,ScenePathChangeDetection:Up}=VN,Do=class extends WN{constructor(){super(...arguments),this.projectedGeometry=void 0,this.renderMode=3,this.strokePath=new jN}computeBBox(){return(this.dirtyPath||this.isDirtyPath())&&(this.updatePath(),this.dirtyPath=!1),this.bbox?.clone()}updatePath(){const{projectedGeometry:t}=this;this.strokePath.clear(),this.path.clear(),this.bbox=t!=null?this.drawGeometry(t,void 0):void 0}drawPath(t){super.drawPath(t),this.renderStroke(t,this.strokePath.getPath2D())}containsPoint(t,e){const{projectedGeometry:i}=this;return i==null||({x:t,y:e}=this.transformPoint(t,e),!this.getCachedBBox().containsPoint(t,e))?!1:this.geometryDistance(i,t,e)<=0}distanceToPoint(t,e){const{projectedGeometry:i}=this;return{x:t,y:e}=this.transformPoint(t,e),i!=null?this.geometryDistance(i,t,e):1/0}geometryDistance(t,e,i){const{renderMode:o,strokeWidth:s}=this,a=(o&1)!==0,n=(o&2)!==0,r=Math.max(s/2,1)+1;switch(t.type){case"GeometryCollection":return t.geometries.reduce((l,c)=>Math.min(l,this.geometryDistance(c,e,i)),1/0);case"MultiPolygon":return a?t.coordinates.reduce((l,c)=>Math.min(l,Math.max(ma(c,e,i),0)),1/0):1/0;case"Polygon":return a?Math.max(ma(t.coordinates,e,i),0):1/0;case"MultiLineString":return n?t.coordinates.reduce((l,c)=>Math.min(l,Math.max(Fp(c,e,i)-r,0)),1/0):1/0;case"LineString":return n?Math.max(Fp(t.coordinates,e,i)-r,0):1/0;case"MultiPoint":case"Point":default:return 1/0}}drawGeometry(t,e){const{renderMode:i,path:o,strokePath:s}=this,a=(i&1)!==0,n=(i&2)!==0;switch(t.type){case"GeometryCollection":t.geometries.forEach(r=>{e=this.drawGeometry(r,e)});break;case"MultiPolygon":a&&t.coordinates.forEach(r=>{e=this.drawPolygon(o,r,e)});break;case"Polygon":a&&(e=this.drawPolygon(o,t.coordinates,e));break;case"LineString":n&&(e=this.drawLineString(s,t.coordinates,e,!1));break;case"MultiLineString":n&&t.coordinates.forEach(r=>{e=this.drawLineString(s,r,e,!1)});break;case"Point":case"MultiPoint":break}return e}drawPolygon(t,e,i){if(e.length<1)return i;i=this.drawLineString(t,e[0],i,!0);for(let o=1;o<e.length;o+=1){const s=e[o];this.drawLineString(t,s,void 0,!0)}return i}drawLineString(t,e,i,o){if(e.length<2)return i;const s=o?e.length-1:e.length;for(let a=0;a<s;a+=1){const[n,r]=e[a];if(a===0?t.moveTo(n,r):t.lineTo(n,r),i==null)i=new YN(n,r,0,0);else{const{x:l,y:c}=i,h=l+i.width,p=c+i.height;i.x=Math.min(l,n),i.y=Math.min(c,r),i.width=Math.max(h,n)-i.x,i.height=Math.max(p,r)-i.y}}return o&&t.closePath(),i}};d([Up()],Do.prototype,"projectedGeometry",2),d([Up()],Do.prototype,"renderMode",2);function No(t,e){if(t.bbox!=null){const[i,o,s,a]=t.bbox;return e=is(e,i,o,s,a),e}switch(t.type){case"GeometryCollection":t.geometries.forEach(i=>{e=No(i,e)});break;case"MultiPolygon":t.coordinates.forEach(i=>{i.length>0&&(e=wi(i[0],e))});break;case"Polygon":t.coordinates.length>0&&(e=wi(t.coordinates[0],e));break;case"MultiLineString":t.coordinates.forEach(i=>{e=wi(i,e)});break;case"LineString":e=wi(t.coordinates,e);break;case"MultiPoint":t.coordinates.forEach(i=>{const[o,s]=i;e=is(e,o,s,o,s)});break;case"Point":{const[i,o]=t.coordinates;e=is(e,i,o,i,o);break}}return e}function fa(t){switch(t.type){case"GeometryCollection":{let e,i;return t.geometries.map(o=>{const s=fa(o);if(s==null)return;const a=wi(s[0],void 0);if(a==null)return;const n=Math.abs(a.lat1-a.lat0)*Math.abs(a.lon1-a.lon0);(e==null||n>e)&&(e=n,i=s)}),i}case"MultiPolygon":{let e,i;return t.coordinates.forEach(o=>{const s=wi(o[0],void 0);if(s==null)return;const a=Math.abs(s.lat1-s.lat0)*Math.abs(s.lon1-s.lon0);(e==null||a>e)&&(e=a,i=o)}),i}case"Polygon":return t.coordinates;case"MultiLineString":case"LineString":case"MultiPoint":case"Point":return}}function xa(t){switch(t.type){case"GeometryCollection":{let e,i;return t.geometries.map(o=>{const s=xa(o);if(s==null)return;const a=il(s);a!=null&&(e==null||a>e)&&(e=a,i=s)}),i}case"MultiLineString":{let e=0,i;return t.coordinates.forEach(o=>{const s=il(o);s>e&&(e=s,i=o)}),i}case"LineString":return t.coordinates;case"MultiPolygon":case"Polygon":case"MultiPoint":case"Point":return}}function ol(t,e){if(t==null)return!1;switch(t.type){case"GeometryCollection":return t.geometries.some(i=>ol(i,e));case"MultiPolygon":case"Polygon":return(e&1)!==0;case"MultiLineString":case"LineString":return(e&2)!==0;case"MultiPoint":case"Point":return(e&4)!==0}}function ci(t,e){switch(t.type){case"GeometryCollection":return{type:"GeometryCollection",geometries:t.geometries.map(i=>ci(i,e))};case"Polygon":return{type:"Polygon",coordinates:sl(t.coordinates,e)};case"MultiPolygon":return{type:"MultiPolygon",coordinates:XN(t.coordinates,e)};case"MultiLineString":return{type:"MultiLineString",coordinates:sl(t.coordinates,e)};case"LineString":return{type:"LineString",coordinates:al(t.coordinates,e)};case"MultiPoint":return{type:"MultiPoint",coordinates:al(t.coordinates,e)};case"Point":return{type:"Point",coordinates:e.convert(t.coordinates)}}}function XN(t,e){return t.map(i=>sl(i,e))}function sl(t,e){return t.map(i=>al(i,e))}function al(t,e){return t.map(i=>e.convert(i))}import{_ModuleSupport as Hp}from"ag-charts-community";function Kp(t){return Array.isArray(t)&&t.length>=2&&t.every(Hp.isFiniteNumber)}function Sa(t){return Array.isArray(t)&&t.length>=2&&t.every(Kp)}var Gp=.001;function ZN(t){return Math.abs(t[0][0]-t[t.length-1][0])<Gp&&Math.abs(t[0][1]-t[t.length-1][1])<Gp}function Wp(t){return Array.isArray(t)&&t.every(Sa)&&t.every(ZN)}function jp(t){if(t===null)return!0;if(typeof t!="object"||t.type==null)return!1;const{type:e,coordinates:i}=t;switch(e){case"GeometryCollection":return Array.isArray(t.geometries)&&t.geometries.every(jp);case"MultiPolygon":return Array.isArray(i)&&i.every(Wp);case"Polygon":return Wp(i);case"MultiLineString":return Array.isArray(i)&&i.every(Sa);case"LineString":return Sa(i);case"MultiPoint":return Sa(i);case"Point":return Kp(i)}}function QN(t){return t!==null&&typeof t=="object"&&t.type==="Feature"&&jp(t.geometry)}function $N(t){return t!==null&&typeof t=="object"&&t.type==="FeatureCollection"&&Array.isArray(t.features)&&t.features.every(QN)}var Te=Hp.predicateWithMessage($N,"a GeoJSON object");import{_ModuleSupport as qN}from"ag-charts-community";var{COLOR_STRING:JN,LINE_DASH:tv,OBJECT:ev,POSITIVE_NUMBER:Yp,RATIO:iv,Validate:Pi,SeriesProperties:ov,SeriesTooltip:sv}=qN,hi=class extends ov{constructor(){super(...arguments),this.topology=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=new sv}};d([Pi(Te,{optional:!0})],hi.prototype,"topology",2),d([Pi(JN)],hi.prototype,"stroke",2),d([Pi(iv)],hi.prototype,"strokeOpacity",2),d([Pi(Yp)],hi.prototype,"strokeWidth",2),d([Pi(tv)],hi.prototype,"lineDash",2),d([Pi(Yp)],hi.prototype,"lineDashOffset",2),d([Pi(ev)],hi.prototype,"tooltip",2);var{createDatumId:av,DataModelSeries:nv,SeriesNodePickMode:rv,Validate:lv}=zp,{Group:cv,Selection:hv,PointerEvents:dv}=BN,{Logger:pv}=zN,Ma=class extends nv{constructor(t){super({moduleCtx:t,contentGroupVirtual:!1,useLabelLayer:!0,pickModes:[rv.EXACT_SHAPE_MATCH]}),this.properties=new hi,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new cv({name:"itemGroup"})),this.datumSelection=hv.select(this.itemGroup,()=>this.nodeFactory())}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}setOptionsData(){}setChartData(){}get hasData(){return!1}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}nodeFactory(){const t=new Do;return t.renderMode=2,t.lineJoin="round",t.lineCap="round",t.pointerEvents=dv.None,t}async processData(){const{topology:t}=this;this.topologyBounds=t?.features.reduce((e,i)=>{const o=i.geometry;return o==null?e:No(o,e)},void 0),t==null&&pv.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}async createNodeData(){const{id:t,topology:e,scale:i}=this;if(e==null)return;const o=[],s=[];return e.features.forEach((a,n)=>{const{geometry:r}=a,l=r!=null&&i!=null?ci(r,i):void 0;l!=null&&o.push({series:this,itemId:n,datum:a,index:n,projectedGeometry:l})}),{itemId:t,nodeData:o,labelData:s}}async updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=await this.createNodeData(),this.nodeDataRefresh=!1)}async update(){const{datumSelection:t}=this;await this.updateSelections(),this.contentGroup.visible=this.visible;const{nodeData:e=[]}=this.contextNodeData??{};this.datumSelection=await this.updateDatumSelection({nodeData:e,datumSelection:t}),await this.updateDatumNodes({datumSelection:t})}async updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>av(e.index))}async updateDatumNodes(t){const{properties:e}=this,{datumSelection:i}=t,{stroke:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}=e,r=this.getStrokeWidth(e.strokeWidth);i.each((l,c)=>{const{projectedGeometry:h}=c;if(h==null){l.visible=!1,l.projectedGeometry=void 0;return}l.visible=!0,l.projectedGeometry=h,l.stroke=o,l.strokeWidth=r,l.strokeOpacity=s,l.lineDash=a,l.lineDashOffset=n})}resetAnimation(){}getLabelData(){return[]}getSeriesDomain(){return[NaN,NaN]}getLegendData(){return[]}getTooltipHtml(){return zp.EMPTY_TOOLTIP_CONTENT}computeFocusBounds(t){}};Ma.className="MapLineBackgroundSeries",Ma.type="map-line-background",d([lv(Te,{optional:!0,property:"topology"})],Ma.prototype,"_chartTopology",2);var{DEFAULT_HIERARCHY_STROKES:uv}=PN,gv={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-line-background",instanceConstructor:Ma,tooltipDefaults:{range:"exact"},themeTemplate:{...es,series:{strokeWidth:1,lineDash:[0],lineDashOffset:0}},paletteFactory:({themeTemplateParameters:t})=>({stroke:t.get(uv)?.[1]})};import{_Theme as yv}from"ag-charts-community";import{_ModuleSupport as Xp,_Scale as mv,_Scene as fv,_Util as xv}from"ag-charts-community";function Sv(){return{fromFn:(i,o,s)=>s==="removed"?{scalingX:1,scalingY:1}:i.previousDatum==null?{scalingX:0,scalingY:0}:{scalingX:i.scalingX,scalingY:i.scalingY},toFn:(i,o,s)=>s==="removed"?{scalingX:0,scalingY:0}:{scalingX:1,scalingY:1}}}function Zp(t,e){const i=t.contextNodeData?.nodeData[e.datumIndex];if(i!==void 0){for(const o of t.datumSelection.nodes())if(o.datum===i)return o}}import{_ModuleSupport as Mv,_Scene as bv}from"ag-charts-community";var{AND:Dv,ARRAY:Nv,COLOR_STRING:vv,COLOR_STRING_ARRAY:Iv,FUNCTION:Av,LINE_DASH:Tv,NUMBER_ARRAY:kv,OBJECT:Qp,POSITIVE_NUMBER:nl,RATIO:Ov,STRING:ye,Validate:lt,SeriesProperties:Lv,SeriesTooltip:Ev}=Mv,{Label:Rv}=bv,nt=class extends Lv{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.topologyIdKey="name",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.maxStrokeWidth=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.label=new Rv,this.tooltip=new Ev}};d([lt(Te,{optional:!0})],nt.prototype,"topology",2),d([lt(ye,{optional:!0})],nt.prototype,"title",2),d([lt(ye,{optional:!0})],nt.prototype,"legendItemName",2),d([lt(ye)],nt.prototype,"idKey",2),d([lt(ye)],nt.prototype,"topologyIdKey",2),d([lt(ye,{optional:!0})],nt.prototype,"idName",2),d([lt(ye,{optional:!0})],nt.prototype,"labelKey",2),d([lt(ye,{optional:!0})],nt.prototype,"labelName",2),d([lt(ye,{optional:!0})],nt.prototype,"sizeKey",2),d([lt(ye,{optional:!0})],nt.prototype,"sizeName",2),d([lt(ye,{optional:!0})],nt.prototype,"colorKey",2),d([lt(ye,{optional:!0})],nt.prototype,"colorName",2),d([lt(kv,{optional:!0})],nt.prototype,"sizeDomain",2),d([lt(Dv(Iv,Nv.restrict({minLength:1})),{optional:!0})],nt.prototype,"colorRange",2),d([lt(nl,{optional:!0})],nt.prototype,"maxStrokeWidth",2),d([lt(vv)],nt.prototype,"stroke",2),d([lt(Ov)],nt.prototype,"strokeOpacity",2),d([lt(nl)],nt.prototype,"strokeWidth",2),d([lt(Tv)],nt.prototype,"lineDash",2),d([lt(nl)],nt.prototype,"lineDashOffset",2),d([lt(Av,{optional:!0})],nt.prototype,"itemStyler",2),d([lt(Qp)],nt.prototype,"label",2),d([lt(Qp)],nt.prototype,"tooltip",2);var{getMissCount:_v,createDatumId:Cv,DataModelSeries:wv,SeriesNodePickMode:$p,valueProperty:os,Validate:Pv}=Xp,{ColorScale:Bv,LinearScale:zv}=mv,{Selection:rl,Text:qp}=fv,{sanitizeHtml:ss,Logger:Jp}=xv,ba=class extends wv{constructor(t){super({moduleCtx:t,contentGroupVirtual:!1,useLabelLayer:!0,pickModes:[$p.EXACT_SHAPE_MATCH,$p.NEAREST_NODE]}),this.properties=new nt,this._chartTopology=void 0,this.colorScale=new Bv,this.sizeScale=new zv,this.datumSelection=rl.select(this.contentGroup,()=>this.nodeFactory()),this.labelSelection=rl.select(this.labelGroup,qp),this.highlightDatumSelection=rl.select(this.highlightNode,()=>this.nodeFactory()),this._previousDatumMidPoint=void 0}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){return super.hasData&&this.topology!=null}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager.addListener("legend-item-click",t=>{this.onLegendItemClick(t)}),this.ctx.chartEventManager.addListener("legend-item-double-click",t=>{this.onLegendItemDoubleClick(t)}))}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}nodeFactory(){const t=new Do;return t.renderMode=2,t.lineJoin="round",t.lineCap="round",t}async processData(t){if(this.data==null||!this.properties.isValid())return;const{data:e,topology:i,sizeScale:o,colorScale:s}=this,{topologyIdKey:a,idKey:n,sizeKey:r,colorKey:l,labelKey:c,sizeDomain:h,colorRange:p}=this.properties,u=new Map;i?.features.forEach(S=>{const x=S.properties?.[a];x==null||!ol(S.geometry,2)||u.set(x,S)});const m=this.sizeScale.type,g=this.colorScale.type,y=this.scale?.type,{dataModel:f,processedData:M}=await this.requestDataModel(t,e,{props:[os(n,y,{id:"idValue",includeProperty:!1}),os(n,y,{id:"featureValue",includeProperty:!1,processor:()=>S=>u.get(S)}),...c!=null?[os(c,"band",{id:"labelValue"})]:[],...r!=null?[os(r,m,{id:"sizeValue"})]:[],...l!=null?[os(l,g,{id:"colorValue"})]:[]]}),b=f.resolveProcessedDataIndexById(this,"featureValue");if(this.topologyBounds=M.data.reduce((S,{values:x})=>{const v=x[b]?.geometry;return v==null?S:No(v,S)},void 0),r!=null){const S=f.resolveProcessedDataIndexById(this,"sizeValue"),x=M.domain.values[S]??[];o.domain=h??x}if(p!=null&&this.isColorScaleValid()){const S=f.resolveProcessedDataIndexById(this,"colorValue");s.domain=M.domain.values[S],s.range=p,s.update()}i==null&&Jp.warnOnce("no topology was provided for [MapLineSeries]; nothing will be rendered.")}isColorScaleValid(){const{colorKey:t}=this.properties;if(!t)return!1;const{dataModel:e,processedData:i}=this;if(!e||!i)return!1;const o=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.data.length,a=_v(this,i.defs.values[o].missing);return!(s===0||s===a)}getLabelDatum(t,e,i,o){if(e==null||i==null)return;const s=xa(i);if(s==null)return;const{idKey:a,idName:n,sizeKey:r,sizeName:l,colorKey:c,colorName:h,labelKey:p,labelName:u,label:m}=this.properties,g=this.getLabelText(m,{value:e,datum:t,idKey:a,idName:n,sizeKey:r,sizeName:l,colorKey:c,colorName:h,labelKey:p,labelName:u});if(g==null)return;const y=qp.getTextSize(String(g),o),f=ya(s);if(f==null)return;const[M,b]=f.point,{width:S,height:x}=y;return{point:{x:M,y:b,size:0},label:{width:S,height:x,text:g},marker:void 0,placement:void 0}}async createNodeData(){const{id:t,dataModel:e,processedData:i,sizeScale:o,colorScale:s,properties:a,scale:n}=this,{idKey:r,sizeKey:l,colorKey:c,labelKey:h,label:p}=a;if(e==null||i==null)return;const u=this.isColorScaleValid(),m=e.resolveProcessedDataIndexById(this,"idValue"),g=e.resolveProcessedDataIndexById(this,"featureValue"),y=h!=null?e.resolveProcessedDataIndexById(this,"labelValue"):void 0,f=l!=null?e.resolveProcessedDataIndexById(this,"sizeValue"):void 0,M=c!=null?e.resolveProcessedDataIndexById(this,"colorValue"):void 0,b=a.maxStrokeWidth??a.strokeWidth;o.range=[Math.min(a.strokeWidth,b),b];const S=p.getFont(),x=new Map;i.data.forEach(({values:A})=>{const k=A[m],L=A[g]?.geometry,O=L!=null&&n!=null?ci(L,n):void 0;k!=null&&O!=null&&x.set(k,O)});const N=[],v=[],D=[];i.data.forEach(({datum:A,values:k})=>{const L=k[m],O=M!=null?k[M]:void 0,T=f!=null?k[f]:void 0,E=y!=null?k[y]:void 0,_=u&&O!=null?s.convert(O):void 0,R=T!=null?o.convert(T,{clampMode:"clamped"}):void 0,C=x.get(L);C==null&&D.push(L);const w=this.getLabelDatum(A,E,C,S);w!=null&&v.push(w),N.push({series:this,itemId:r,datum:A,stroke:_,strokeWidth:R,idValue:L,labelValue:E,colorValue:O,sizeValue:T,projectedGeometry:C})});const I=10;if(D.length>I){const A=D.length-I;D.length=I,D.push(`(+${A} more)`)}return D.length>0&&Jp.warnOnce("some data items do not have matches in the provided topology",D),{itemId:t,nodeData:N,labelData:v}}async updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=await this.createNodeData(),this.nodeDataRefresh=!1)}async update(){const{datumSelection:t,labelSelection:e,highlightDatumSelection:i}=this;await this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let o=this.ctx.highlightManager?.getActiveHighlight();o!=null&&(o.series!==this||o.datum==null)&&(o=void 0);const s=this.contextNodeData?.nodeData??[];this.datumSelection=await this.updateDatumSelection({nodeData:s,datumSelection:t}),await this.updateDatumNodes({datumSelection:t,isHighlight:!1}),this.labelSelection=await this.updateLabelSelection({labelSelection:e}),await this.updateLabelNodes({labelSelection:e}),this.highlightDatumSelection=await this.updateDatumSelection({nodeData:o!=null?[o]:[],datumSelection:i}),await this.updateDatumNodes({datumSelection:i,isHighlight:!0})}async updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>Cv(e.idValue))}async updateDatumNodes(t){const{id:e,properties:i,ctx:{callbackCache:o}}=this,{datumSelection:s,isHighlight:a}=t,{idKey:n,labelKey:r,sizeKey:l,colorKey:c,stroke:h,strokeOpacity:p,lineDash:u,lineDashOffset:m,itemStyler:g}=i,y=a?i.highlightStyle.item:void 0,f=this.getStrokeWidth(i.strokeWidth);s.each((M,b)=>{const{projectedGeometry:S}=b;if(S==null){M.visible=!1,M.projectedGeometry=void 0;return}let x;g!=null&&(x=o.call(g,{seriesId:e,datum:b.datum,idKey:n,labelKey:r,sizeKey:l,colorKey:c,strokeOpacity:p,stroke:h,strokeWidth:f,lineDash:u,lineDashOffset:m,highlighted:a})),M.visible=!0,M.projectedGeometry=S,M.stroke=y?.stroke??x?.stroke??b.stroke??h,M.strokeWidth=Math.max(y?.strokeWidth??0,x?.strokeWidth??b.strokeWidth??f),M.strokeOpacity=y?.strokeOpacity??x?.strokeOpacity??p,M.lineDash=y?.lineDash??x?.lineDash??u,M.lineDashOffset=y?.lineDashOffset??x?.lineDashOffset??m})}async updateLabelSelection(t){const e=(this.isLabelEnabled()?this.chart?.placeLabels().get(this):void 0)??[];return t.labelSelection.update(e)}async updateLabelNodes(t){const{labelSelection:e}=t,{color:i,fontStyle:o,fontWeight:s,fontSize:a,fontFamily:n}=this.properties.label;e.each((r,{x:l,y:c,width:h,height:p,text:u})=>{r.visible=!0,r.x=l+h/2,r.y=c+p/2,r.text=u,r.fill=i,r.fontStyle=o,r.fontWeight=s,r.fontSize=a,r.fontFamily=n,r.textAlign="center",r.textBaseline="middle"})}onLegendItemClick(t){const{legendItemName:e}=this.properties,{enabled:i,itemId:o,series:s}=t,a=e!=null&&e===t.legendItemName;(s.id===this.id||a)&&this.toggleSeriesItem(o,i)}onLegendItemDoubleClick(t){const{enabled:e,itemId:i,series:o,numVisibleItems:s}=t,{legendItemName:a}=this.properties,n=a!=null&&a===t.legendItemName;o.id===this.id||n?this.toggleSeriesItem(i,!0):e&&s===1?this.toggleSeriesItem(i,!0):this.toggleSeriesItem(i,!1)}resetAnimation(){}getLabelData(){return this.contextNodeData?.labelData??[]}getSeriesDomain(){return[NaN,NaN]}pickNodeClosestDatum({x:t,y:e}){let i=1/0,o;return this.datumSelection.each((s,a)=>{const n=s.distanceToPoint(t,e);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:i}:void 0}datumMidPoint(t){const{_previousDatumMidPoint:e}=this;if(e?.datum===t)return e.point;const i=t.projectedGeometry,o=i!=null?xa(i):void 0,s=o!=null?ya(o)?.point:void 0,a=s!=null?{x:s[0],y:s[1]}:void 0;return this._previousDatumMidPoint={datum:t,point:a},a}getLegendData(t){const{processedData:e,dataModel:i}=this;if(e==null||i==null)return[];const{title:o,legendItemName:s,idKey:a,idName:n,colorKey:r,colorName:l,colorRange:c,stroke:h,strokeWidth:p,strokeOpacity:u,lineDash:m,visible:g}=this.properties;if(t==="gradient"&&r!=null&&c!=null){const y=e.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:g,seriesId:this.id,colorName:l,colorRange:c,colorDomain:y}]}else return t==="category"?[{legendType:"category",id:this.id,itemId:s??o??n??a,seriesId:this.id,enabled:g,label:{text:s??o??n??a},symbols:[{marker:{fill:h,fillOpacity:u,stroke:void 0,strokeWidth:0,strokeOpacity:0,enabled:!1},line:{stroke:h,strokeOpacity:u,strokeWidth:p,lineDash:m}}],legendItemName:s}]:[]}getTooltipHtml(t){const{id:e,processedData:i,properties:o,ctx:{callbackCache:s}}=this;if(!i||!o.isValid())return Xp.EMPTY_TOOLTIP_CONTENT;const{legendItemName:a,idKey:n,idName:r,colorKey:l,colorName:c,sizeKey:h,sizeName:p,labelKey:u,labelName:m,itemStyler:g,tooltip:y,strokeOpacity:f,lineDash:M,lineDashOffset:b}=o,{datum:S,stroke:x,idValue:N,colorValue:v,sizeValue:D,labelValue:I,itemId:A}=t,k=ss(o.title??a)??"",L=[];L.push(ss((r!=null?`${r}: `:"")+N)),v!=null&&L.push(ss((c??l)+": "+v)),D!=null&&L.push(ss((p??h)+": "+D)),I!=null&&u!==n&&L.push(ss((m??u)+": "+I));const O=L.join("<br>");let T;g&&(T=s.call(g,{highlighted:!1,seriesId:e,datum:S,idKey:n,sizeKey:h,colorKey:l,labelKey:u,stroke:x,strokeWidth:this.getStrokeWidth(t.strokeWidth??o.strokeWidth),strokeOpacity:f,lineDash:M,lineDashOffset:b}));const E=T?.stroke??x??o.stroke;return y.toTooltipHtml({title:k,content:O,backgroundColor:E},{seriesId:e,datum:S,idKey:n,title:k,color:E,itemId:A,sizeKey:h,colorKey:l,colorName:c,idName:r,labelKey:u,labelName:m,sizeName:p,...this.getModuleTooltipParams()})}computeFocusBounds(t){return Zp(this,t)?.computeTransformedBBox()}};ba.className="MapLineSeries",ba.type="map-line",d([Pv(Te,{optional:!0,property:"topology"})],ba.prototype,"_chartTopology",2);var{DEFAULT_DIVERGING_SERIES_COLOUR_RANGE:Vv,DEFAULT_FONT_FAMILY:Fv,DEFAULT_LABEL_COLOUR:Uv,singleSeriesPaletteFactory:Hv}=yv,Kv={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-line",instanceConstructor:ba,tooltipDefaults:{range:"exact"},themeTemplate:{...es,series:{strokeWidth:1,maxStrokeWidth:3,lineDash:[0],lineDashOffset:0,label:{enabled:!0,fontStyle:void 0,fontWeight:void 0,fontSize:12,fontFamily:Fv,color:Uv}}},paletteFactory:t=>{const{takeColors:e,colorsCount:i,userPalette:o,themeTemplateParameters:s}=t,{fill:a}=Hv(t),n=s.get(Vv),{fills:r}=e(i);return{colorRange:o==="inbuilt"?n:[r[0],r[1]],stroke:a}}};import{_Theme as Gv}from"ag-charts-community";import{_ModuleSupport as tu,_Scale as Wv,_Scene as jv,_Util as Yv}from"ag-charts-community";function eu(t,e,i){const o=wi(t[0],void 0);if(o==null)return;const s=(o.lon0+o.lon1)/2,a=(o.lat0+o.lat1)/2,n=Math.abs(o.lon1-o.lon0),r=Math.abs(o.lat1-o.lat0),l=GN(t[0]),[c,h]=l,p=-ma(t,c,h);let u;const m=(N,v)=>{const I=Math.max(v-p,0);return N-.5*I},g=(N,v,D)=>{const{distance:I,maxDistance:A}=i(t,N,v,D),k=Math.hypot(c-N,h-v),L=Math.min(Math.max(c,N-D/2),N+D/2),O=Math.min(Math.max(h,v-D/2),v+D/2),T=Math.hypot(c-L,h-O),E=m(I,k),_=m(A,T);return{distance:I,maxDistance:A,value:E,maxValue:_,x:N,y:v,stride:D}},y=(N,v,D,I)=>{const A=g(v,D,I);A.maxDistance>=0&&N.push(A)},f=Math.min(n,r)/2;let M={value:g(s,a,f),next:null};for(;M!=null;){const N=M.value,{distance:v,value:D,maxValue:I,x:A,y:k,stride:L}=N;if(M=M.next,v>0&&(u==null||D>u.value)&&(u=N),u!=null&&I-u.value<=e)continue;const O=L/2,T=[];y(T,A-O,k-O,O),y(T,A+O,k-O,O),y(T,A-O,k+O,O),y(T,A+O,k+O,O),T.sort(iu),M=KN(M,T,iu)}if(u==null)return;const{distance:b,x:S,y:x}=u;return{x:S,y:x,distance:b}}var iu=(t,e)=>e.maxValue-t.maxValue;function ll(t,e){const i=eu(t,e,(a,n,r,l)=>{const c=-ma(a,n,r),h=c+l*Math.SQRT2;return{distance:c,maxDistance:h}});if(i==null)return;const{x:o,y:s}=i;return[o,s]}function ou(t,e){let i;switch(t.type){case"GeometryCollection":return t.geometries.flatMap(o=>ou(o,e));case"MultiPoint":return t.coordinates;case"Point":return[t.coordinates];case"MultiPolygon":{const o=fa(t);i=o!=null?ll(o,e):void 0;break}case"Polygon":{const o=t.coordinates;i=o!=null?ll(o,e):void 0;break}case"MultiLineString":{const o=xa(t);i=o!=null?ya(o)?.point:void 0;break}case"LineString":{const o=t.coordinates;i=ya(o)?.point;break}}return i!=null?[i]:[]}import{_ModuleSupport as Xv,_Scene as Zv,_Util as Qv}from"ag-charts-community";var{AND:$v,ARRAY:qv,COLOR_STRING:su,COLOR_STRING_ARRAY:Jv,FUNCTION:tI,NUMBER_ARRAY:eI,OBJECT:au,POSITIVE_NUMBER:cl,RATIO:nu,STRING:Bt,MARKER_SHAPE:iI,Validate:J,SeriesProperties:oI,SeriesTooltip:sI}=Xv,{Label:aI,Circle:nI}=Zv,{Logger:rI}=Qv,ru=class extends aI{constructor(){super(...arguments),this.placement="bottom"}};d([J(Bt)],ru.prototype,"placement",2);var tt=class extends oI{constructor(){super(...arguments),this.topology=void 0,this.idKey=void 0,this.topologyIdKey="name",this.idName=void 0,this.latitudeKey=void 0,this.latitudeName=void 0,this.longitudeKey=void 0,this.longitudeName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.shape=nI,this.size=6,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.label=new ru,this.tooltip=new sI}isValid(){const t=super.isValid(),e=this.idKey!=null,i=this.latitudeKey!=null&&this.longitudeKey!=null;return!e&&!i?(rI.warnOnce("Either both [topology] and [idKey] or both [latitudeKey] and [longitudeKey] must be set to render a map marker series."),!1):t}};d([J(Te,{optional:!0})],tt.prototype,"topology",2),d([J(Bt,{optional:!0})],tt.prototype,"title",2),d([J(Bt,{optional:!0})],tt.prototype,"legendItemName",2),d([J(Bt,{optional:!0})],tt.prototype,"idKey",2),d([J(Bt)],tt.prototype,"topologyIdKey",2),d([J(Bt,{optional:!0})],tt.prototype,"idName",2),d([J(Bt,{optional:!0})],tt.prototype,"latitudeKey",2),d([J(Bt,{optional:!0})],tt.prototype,"latitudeName",2),d([J(Bt,{optional:!0})],tt.prototype,"longitudeKey",2),d([J(Bt,{optional:!0})],tt.prototype,"longitudeName",2),d([J(Bt,{optional:!0})],tt.prototype,"labelKey",2),d([J(Bt,{optional:!0})],tt.prototype,"labelName",2),d([J(Bt,{optional:!0})],tt.prototype,"sizeKey",2),d([J(Bt,{optional:!0})],tt.prototype,"sizeName",2),d([J(Bt,{optional:!0})],tt.prototype,"colorKey",2),d([J(Bt,{optional:!0})],tt.prototype,"colorName",2),d([J($v(Jv,qv.restrict({minLength:1})),{optional:!0})],tt.prototype,"colorRange",2),d([J(iI)],tt.prototype,"shape",2),d([J(cl)],tt.prototype,"size",2),d([J(cl,{optional:!0})],tt.prototype,"maxSize",2),d([J(eI,{optional:!0})],tt.prototype,"sizeDomain",2),d([J(su,{optional:!0})],tt.prototype,"fill",2),d([J(nu)],tt.prototype,"fillOpacity",2),d([J(su,{optional:!0})],tt.prototype,"stroke",2),d([J(cl)],tt.prototype,"strokeWidth",2),d([J(nu)],tt.prototype,"strokeOpacity",2),d([J(tI,{optional:!0})],tt.prototype,"itemStyler",2),d([J(au)],tt.prototype,"label",2),d([J(au)],tt.prototype,"tooltip",2);var{Validate:lI,fromToMotion:cI,StateMachine:hI,getMissCount:dI,createDatumId:pI,DataModelSeries:uI,SeriesNodePickMode:lu,Layers:gI,valueProperty:Bi,computeMarkerFocusBounds:yI}=tu,{ColorScale:mI,LinearScale:fI}=Wv,{Group:xI,Selection:hl,Text:cu,getMarker:hu}=jv,{sanitizeHtml:vo,Logger:SI}=Yv,Da=class extends uI{constructor(t){super({moduleCtx:t,contentGroupVirtual:!0,useLabelLayer:!0,pickModes:[lu.EXACT_SHAPE_MATCH,lu.NEAREST_NODE]}),this.properties=new tt,this._chartTopology=void 0,this.colorScale=new mI,this.sizeScale=new fI,this.markerGroup=this.contentGroup.appendChild(new xI({name:"markerGroup",layer:!0,isVirtual:!1,zIndex:gI.SERIES_LAYER_ZINDEX,zIndexSubOrder:this.getGroupZIndexSubOrder("marker")})),this.labelSelection=hl.select(this.labelGroup,cu,!1),this.markerSelection=hl.select(this.markerGroup,()=>this.markerFactory(),!1),this.highlightMarkerSelection=hl.select(this.highlightNode,()=>this.markerFactory()),this.animationState=new hI("empty",{empty:{update:{target:"ready",action:()=>this.animateMarkers()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.resetAllAnimation(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateMarkers()},resize:{target:"ready",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){const t=this.properties.latitudeKey!=null&&this.properties.longitudeKey!=null;return super.hasData&&(this.topology!=null||t)}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager.addListener("legend-item-click",t=>{this.onLegendItemClick(t)}),this.ctx.chartEventManager.addListener("legend-item-double-click",t=>{this.onLegendItemDoubleClick(t)}))}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}markerFactory(){const{shape:t}=this.properties,e=hu(t);return new e}async processData(t){if(this.data==null||!this.properties.isValid())return;const{data:e,topology:i,sizeScale:o,colorScale:s}=this,{topologyIdKey:a,idKey:n,latitudeKey:r,longitudeKey:l,sizeKey:c,colorKey:h,labelKey:p,sizeDomain:u,colorRange:m}=this.properties,g=new Map;i?.features.forEach(I=>{const A=I.properties?.[a];A!=null&&g.set(A,I)});const y=this.sizeScale.type,f=this.colorScale.type,M=this.scale?.type,b=r!=null&&l!=null,{dataModel:S,processedData:x}=await this.requestDataModel(t,e,{props:[...n!=null?[Bi(n,M,{id:"idValue",includeProperty:!1}),Bi(n,M,{id:"featureValue",includeProperty:!1,processor:()=>I=>g.get(I)})]:[],...b?[Bi(r,M,{id:"latValue"}),Bi(l,M,{id:"lonValue"})]:[],...p?[Bi(p,"band",{id:"labelValue"})]:[],...c?[Bi(c,y,{id:"sizeValue"})]:[],...h?[Bi(h,f,{id:"colorValue"})]:[]]}),N=n!=null?S.resolveProcessedDataIndexById(this,"featureValue"):void 0,v=b?S.resolveProcessedDataIndexById(this,"latValue"):void 0,D=b?S.resolveProcessedDataIndexById(this,"lonValue"):void 0;if(this.topologyBounds=x.data.reduce((I,{values:A})=>{const L=(N!=null?A[N]:void 0)?.geometry;if(L!=null&&(I=No(L,I)),v!=null&&D!=null){const O=A[D],T=A[v];I=is(I,O,T,O,T)}return I},void 0),c!=null){const I=S.resolveProcessedDataIndexById(this,"sizeValue"),A=x.domain.values[I]??[];o.domain=u??A}if(m!=null&&this.isColorScaleValid()){const I=S.resolveProcessedDataIndexById(this,"colorValue");s.domain=x.domain.values[I],s.range=m,s.update()}this.animationState.transition("updateData")}isColorScaleValid(){const{colorKey:t}=this.properties;if(!t)return!1;const{dataModel:e,processedData:i}=this;if(!e||!i)return!1;const o=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.data.length,a=dI(this,i.defs.values[o].missing);return!(s===0||s===a)}getLabelDatum(t,e,i,o,s,a){if(e==null)return;const{idKey:n,idName:r,latitudeKey:l,latitudeName:c,longitudeKey:h,longitudeName:p,sizeKey:u,sizeName:m,colorKey:g,colorName:y,labelKey:f,labelName:M,label:b}=this.properties,{placement:S}=b,x=this.getLabelText(b,{value:e,datum:t,idKey:n,idName:r,latitudeKey:l,latitudeName:c,longitudeKey:h,longitudeName:p,sizeKey:u,sizeName:m,colorKey:g,colorName:y,labelKey:f,labelName:M});if(x==null)return;const{width:N,height:v}=cu.getTextSize(String(x),a);return{point:{x:i,y:o,size:s},label:{width:N,height:v,text:x},marker:hu(this.properties.shape),placement:S}}async createNodeData(){const{id:t,dataModel:e,processedData:i,colorScale:o,sizeScale:s,properties:a,scale:n}=this,{idKey:r,latitudeKey:l,longitudeKey:c,sizeKey:h,colorKey:p,labelKey:u,label:m}=a;if(e==null||i==null||n==null)return;const g=this.isColorScaleValid(),y=l!=null&&c!=null,f=r!=null?e.resolveProcessedDataIndexById(this,"idValue"):void 0,M=r!=null?e.resolveProcessedDataIndexById(this,"featureValue"):void 0,b=y?e.resolveProcessedDataIndexById(this,"latValue"):void 0,S=y?e.resolveProcessedDataIndexById(this,"lonValue"):void 0,x=u!=null?e.resolveProcessedDataIndexById(this,"labelValue"):void 0,N=h!=null?e.resolveProcessedDataIndexById(this,"sizeValue"):void 0,v=p!=null?e.resolveProcessedDataIndexById(this,"colorValue"):void 0,D=a.maxSize??a.size;s.range=[Math.min(a.size,D),D];const I=m.getFont();let A;f!=null&&M!=null&&(A=new Map,i.data.forEach(({values:E})=>{const _=E[f],R=E[M]?.geometry,C=R!=null&&n!=null?ci(R,n):void 0;_!=null&&C!=null&&A.set(_,C)}));const k=[],L=[],O=[];i.data.forEach(({datum:E,values:_})=>{const R=f!=null?_[f]:void 0,C=S!=null?_[S]:void 0,w=b!=null?_[b]:void 0,P=v!=null?_[v]:void 0,B=N!=null?_[N]:void 0,z=x!=null?_[x]:void 0,V=g&&P!=null?o.convert(P):void 0,U=B!=null?s.convert(B,{clampMode:"clamped"}):a.size,Q=R!=null?A?.get(R):void 0;if(R!=null&&ci==null&&O.push(R),C!=null&&w!=null){const[H,K]=n.convert([C,w]),j=this.getLabelDatum(E,z,H,K,U,I);j&&L.push(j),k.push({series:this,itemId:l,datum:E,index:-1,fill:V,idValue:R,lonValue:C,latValue:w,labelValue:z,sizeValue:B,colorValue:P,point:{x:H,y:K,size:U},midPoint:{x:H,y:K}})}else Q!=null&&ou(Q,1).forEach(([H,K],j)=>{const st=this.getLabelDatum(E,z,H,K,U,I);st&&L.push(st),k.push({series:this,itemId:l,datum:E,index:j,fill:V,idValue:R,lonValue:C,latValue:w,labelValue:z,sizeValue:B,colorValue:P,point:{x:H,y:K,size:U},midPoint:{x:H,y:K}})})});const T=10;if(O.length>T){const E=O.length-T;O.length=T,O.push(`(+${E} more)`)}return O.length>0&&SI.warnOnce("some data items do not have matches in the provided topology",O),{itemId:t,nodeData:k,labelData:L}}async updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=await this.createNodeData(),this.nodeDataRefresh=!1)}checkScaleChange(){return this.previousScale===this.scale?!1:(this.previousScale=this.scale,!0)}async update({seriesRect:t}){const e=this.checkResize(t),i=this.checkScaleChange(),{labelSelection:o,markerSelection:s,highlightMarkerSelection:a}=this;await this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let n=this.ctx.highlightManager?.getActiveHighlight();n!=null&&(n.series!==this||n.datum==null)&&(n=void 0);const r=this.contextNodeData?.nodeData??[];this.labelSelection=await this.updateLabelSelection({labelSelection:o}),await this.updateLabelNodes({labelSelection:o}),this.markerSelection=await this.updateMarkerSelection({markerData:r,markerSelection:s}),await this.updateMarkerNodes({markerSelection:s,isHighlight:!1,highlightedDatum:n}),this.highlightMarkerSelection=await this.updateMarkerSelection({markerData:n!=null?[n]:[],markerSelection:a}),await this.updateMarkerNodes({markerSelection:a,isHighlight:!0,highlightedDatum:n}),(i||e)&&this.animationState.transition("resize"),this.animationState.transition("update")}async updateLabelSelection(t){const e=(this.isLabelEnabled()?this.chart?.placeLabels().get(this):void 0)??[];return t.labelSelection.update(e)}async updateLabelNodes(t){const{labelSelection:e}=t,{color:i,fontStyle:o,fontWeight:s,fontSize:a,fontFamily:n}=this.properties.label;e.each((r,{x:l,y:c,width:h,height:p,text:u})=>{r.visible=!0,r.x=l+h/2,r.y=c+p/2,r.text=u,r.fill=i,r.fontStyle=o,r.fontWeight=s,r.fontSize=a,r.fontFamily=n,r.textAlign="center",r.textBaseline="middle"})}async updateMarkerSelection(t){const{markerData:e,markerSelection:i}=t;return i.update(e,void 0,o=>pI([o.index,o.idValue,o.lonValue,o.latValue]))}async updateMarkerNodes(t){const{properties:e}=this,{markerSelection:i,isHighlight:o,highlightedDatum:s}=t,{fill:a,fillOpacity:n,stroke:r,strokeOpacity:l}=e,c=o?e.highlightStyle.item:void 0,h=this.getStrokeWidth(e.strokeWidth);i.each((p,u)=>{const{datum:m,point:g}=u,y=this.getMapMarkerStyle(u,o);p.size=y?.size??g.size,p.fill=c?.fill??y?.fill??u.fill??a,p.fillOpacity=c?.fillOpacity??y?.fillOpacity??n,p.stroke=c?.stroke??y?.stroke??r,p.strokeWidth=c?.strokeWidth??y?.strokeWidth??h,p.strokeOpacity=c?.strokeOpacity??y?.strokeOpacity??l,p.translationX=g.x,p.translationY=g.y,p.zIndex=!o&&s!=null&&m===s.datum?1:0})}onLegendItemClick(t){const{legendItemName:e}=this.properties,{enabled:i,itemId:o,series:s}=t,a=e!=null&&e===t.legendItemName;(s.id===this.id||a)&&this.toggleSeriesItem(o,i)}onLegendItemDoubleClick(t){const{enabled:e,itemId:i,series:o,numVisibleItems:s}=t,{legendItemName:a}=this.properties,n=a!=null&&a===t.legendItemName;o.id===this.id||n?this.toggleSeriesItem(i,!0):e&&s===1?this.toggleSeriesItem(i,!0):this.toggleSeriesItem(i,!1)}isProcessedDataAnimatable(){return!0}resetAnimation(t){t==="initial"?this.animationState.transition("reset"):t==="ready"&&this.animationState.transition("skip")}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),this.ctx.animationManager.skipCurrentBatch(),this.labelSelection.cleanup(),this.markerSelection.cleanup(),this.highlightMarkerSelection.cleanup()}animateMarkers(){const{animationManager:t}=this.ctx,e=Sv();cI(this.id,"markers",t,[this.markerSelection,this.highlightMarkerSelection],e)}getLabelData(){return this.contextNodeData?.labelData??[]}getSeriesDomain(){return[NaN,NaN]}pickNodeClosestDatum(t){const{x:e,y:i}=this.rootGroup.transformPoint(t.x,t.y);let o=1/0,s;return this.contextNodeData?.nodeData.forEach(a=>{const{x:n,y:r,size:l}=a.point,c=Math.max(Math.abs(n-e)-l,0),h=Math.max(Math.abs(r-i)-l,0),p=c*c+h*h;p<o&&(o=p,s=a)}),s!=null?{datum:s,distance:Math.sqrt(o)}:void 0}getLegendData(t){const{processedData:e,dataModel:i}=this;if(e==null||i==null)return[];const{title:o,legendItemName:s,idName:a,idKey:n,colorKey:r,colorName:l,colorRange:c,visible:h,shape:p,fill:u,stroke:m,fillOpacity:g,strokeOpacity:y,strokeWidth:f}=this.properties;if(t==="gradient"&&r!=null&&c!=null){const M=e.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:h,seriesId:this.id,colorName:l,colorRange:c,colorDomain:M}]}else return t==="category"?[{legendType:"category",id:this.id,itemId:s??o??a??n??this.id,seriesId:this.id,enabled:h,label:{text:s??o??a??n??this.id},symbols:[{marker:{shape:p,fill:u,fillOpacity:g,stroke:m,strokeWidth:f,strokeOpacity:y}}],legendItemName:s}]:[]}getTooltipHtml(t){const{id:e,processedData:i,ctx:{callbackCache:o},properties:s}=this;if(!i||!this.properties.isValid())return tu.EMPTY_TOOLTIP_CONTENT;const{legendItemName:a,idKey:n,idName:r,latitudeKey:l,longitudeKey:c,sizeKey:h,sizeName:p,colorKey:u,colorName:m,labelKey:g,labelName:y,itemStyler:f,tooltip:M,latitudeName:b,longitudeName:S,shape:x,size:N,fillOpacity:v,stroke:D,strokeWidth:I,strokeOpacity:A}=s,{datum:k,fill:L,idValue:O,latValue:T,lonValue:E,sizeValue:_,colorValue:R,labelValue:C,itemId:w}=t,P=vo(s.title??a)??"",B=[];O!=null&&B.push(vo((r!=null?`${r}: `:"")+O)),R!=null&&B.push(vo((m??u)+": "+R)),_!=null&&B.push(vo((p??h)+": "+_)),C!=null&&(n==null||n!==g)&&B.push(vo((y??g)+": "+C)),T!=null&&E!=null&&B.push(vo(`${Math.abs(T).toFixed(4)}\xB0 ${T>=0?"N":"S"}, ${Math.abs(E).toFixed(4)}\xB0 ${T>=0?"W":"E"}`));const z=B.join("<br>");let V;f&&(V=o.call(f,{highlighted:!1,seriesId:e,datum:k,idKey:n,sizeKey:h,colorKey:u,labelKey:g,latitudeKey:l,longitudeKey:c,shape:x,size:N,fill:L,fillOpacity:v,stroke:D,strokeWidth:I,strokeOpacity:A}));const U=V?.fill??L??s.fill;return M.toTooltipHtml({title:P,content:z,backgroundColor:U},{seriesId:e,datum:k,idKey:n,latitudeKey:l,longitudeKey:c,title:P,color:U,colorKey:u,colorName:m,idName:r,itemId:w,labelKey:g,labelName:y,latitudeName:b,longitudeName:S,sizeKey:h,sizeName:p,...this.getModuleTooltipParams()})}getMapMarkerStyle(t,e){const{id:i,properties:o,ctx:{callbackCache:s}}=this,{datum:a,point:n}=t,{idKey:r,latitudeKey:l,longitudeKey:c,labelKey:h,sizeKey:p,colorKey:u,fill:m,fillOpacity:g,stroke:y,strokeOpacity:f,shape:M,itemStyler:b}=o,S=this.getStrokeWidth(o.strokeWidth);if(b!==void 0)return s.call(b,{seriesId:i,datum:a,size:n.size,idKey:r,latitudeKey:l,longitudeKey:c,labelKey:h,sizeKey:p,colorKey:u,fill:m,fillOpacity:g,stroke:y,strokeWidth:S,strokeOpacity:f,shape:M,highlighted:e})}getFormattedMarkerStyle(t){return{size:this.getMapMarkerStyle(t,!0)?.size??t.point.size}}computeFocusBounds(t){return yI(this,t)}};Da.className="MapMarkerSeries",Da.type="map-marker",d([lI(Te,{optional:!0,property:"topology"})],Da.prototype,"_chartTopology",2);var{DEFAULT_LABEL_COLOUR:MI,DEFAULT_DIVERGING_SERIES_COLOUR_RANGE:bI,singleSeriesPaletteFactory:DI}=Gv,NI={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-marker",instanceConstructor:Da,tooltipDefaults:{range:"exact"},themeTemplate:{...es,series:{shape:"circle",maxSize:30,fillOpacity:.5,label:{color:MI}}},paletteFactory:t=>{const{takeColors:e,colorsCount:i,userPalette:o,themeTemplateParameters:s}=t,{fill:a,stroke:n}=DI(t),r=s.get(bI),{fills:l}=e(i);return{fill:a,stroke:n,colorRange:o==="inbuilt"?r:[l[0],l[1]]}}};import{_Theme as vI}from"ag-charts-community";import{_ModuleSupport as du,_Scene as II,_Util as AI}from"ag-charts-community";import{_ModuleSupport as TI}from"ag-charts-community";var{COLOR_STRING:pu,LINE_DASH:kI,OBJECT:OI,POSITIVE_NUMBER:uu,RATIO:gu,Validate:He,SeriesProperties:LI,SeriesTooltip:EI}=TI,ke=class extends LI{constructor(){super(...arguments),this.topology=void 0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=new EI}};d([He(Te,{optional:!0})],ke.prototype,"topology",2),d([He(pu)],ke.prototype,"fill",2),d([He(gu)],ke.prototype,"fillOpacity",2),d([He(pu)],ke.prototype,"stroke",2),d([He(gu)],ke.prototype,"strokeOpacity",2),d([He(uu)],ke.prototype,"strokeWidth",2),d([He(kI)],ke.prototype,"lineDash",2),d([He(uu)],ke.prototype,"lineDashOffset",2),d([He(OI)],ke.prototype,"tooltip",2);var{createDatumId:RI,Series:_I,SeriesNodePickMode:CI,Validate:wI}=du,{Selection:PI,Group:BI,PointerEvents:zI}=II,{Logger:VI}=AI,Na=class extends _I{constructor(t){super({moduleCtx:t,contentGroupVirtual:!1,useLabelLayer:!0,pickModes:[CI.EXACT_SHAPE_MATCH]}),this.properties=new ke,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new BI({name:"itemGroup"})),this.datumSelection=PI.select(this.itemGroup,()=>this.nodeFactory())}get topology(){return this.properties.topology??this._chartTopology}setOptionsData(){}setChartData(){}get hasData(){return!1}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}nodeFactory(){const t=new Do;return t.renderMode=1,t.lineJoin="round",t.pointerEvents=zI.None,t}async processData(){const{topology:t}=this;this.topologyBounds=t?.features.reduce((e,i)=>{const o=i.geometry;return o==null?e:No(o,e)},void 0),t==null&&VI.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}async createNodeData(){const{id:t,topology:e,scale:i}=this;if(e==null)return;const o=[],s=[];return e.features.forEach((a,n)=>{const{geometry:r}=a,l=r!=null&&i!=null?ci(r,i):void 0;l!=null&&o.push({series:this,itemId:n,datum:a,index:n,projectedGeometry:l})}),{itemId:t,nodeData:o,labelData:s}}async updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=await this.createNodeData(),this.nodeDataRefresh=!1)}async update(){const{datumSelection:t}=this;await this.updateSelections(),this.contentGroup.visible=this.visible;const{nodeData:e=[]}=this.contextNodeData??{};this.datumSelection=await this.updateDatumSelection({nodeData:e,datumSelection:t}),await this.updateDatumNodes({datumSelection:t})}async updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>RI(e.index))}async updateDatumNodes(t){const{properties:e}=this,{datumSelection:i}=t,{fill:o,fillOpacity:s,stroke:a,strokeOpacity:n,lineDash:r,lineDashOffset:l}=e,c=this.getStrokeWidth(e.strokeWidth);i.each((h,p)=>{const{projectedGeometry:u}=p;if(u==null){h.visible=!1,h.projectedGeometry=void 0;return}h.visible=!0,h.projectedGeometry=u,h.fill=o,h.fillOpacity=s,h.stroke=a,h.strokeWidth=c,h.strokeOpacity=n,h.lineDash=r,h.lineDashOffset=l})}resetAnimation(){}getLabelData(){return[]}getSeriesDomain(){return[NaN,NaN]}getLegendData(){return[]}getTooltipHtml(){return du.EMPTY_TOOLTIP_CONTENT}pickFocus(t){}};Na.className="MapShapeBackgroundSeries",Na.type="map-shape-background",d([wI(Te,{optional:!0,property:"topology"})],Na.prototype,"_chartTopology",2);var{DEFAULT_BACKGROUND_COLOUR:FI,DEFAULT_HIERARCHY_FILLS:UI}=vI,HI={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-shape-background",instanceConstructor:Na,tooltipDefaults:{range:"exact"},themeTemplate:{...es,series:{stroke:FI,strokeWidth:1}},paletteFactory:({themeTemplateParameters:t})=>({fill:t.get(UI)?.[1]})};import{_Theme as KI}from"ag-charts-community";import{_ModuleSupport as dl,_Scale as GI,_Scene as WI,_Util as jI}from"ag-charts-community";function YI(t,{aspectRatio:e,precision:i}){const o=eu(t,i,(l,c,h,p)=>{const u=ZI(l,c,h,e),m=u+2*p*e,g=u*Math.SQRT2,y=m*Math.SQRT2;return{distance:g,maxDistance:y}});if(o==null)return;const{x:s,y:a,distance:n}=o,r=n/Math.SQRT2;return{x:s,y:a,maxWidth:r}}function XI(t,e,i,o,s){const[a,n]=t,[r,l]=e,c=1/s,h=r-a,p=l-n,[u,m]=n<=l?t:e,[g,y]=a<=r?t:e,[f,M]=n<=l?e:t,[b,S]=a<=r?e:t;let x=1/0;if(h!==0){const k=p/h;for(let L=0;L<=1;L+=1){const O=L===0?c:-c,T=(k*a-n-O*i+o)/(k-O);if(T>=g&&T<=b){const E=Math.abs(i-T)*2;x=Math.min(x,E)}}}else for(let k=0;k<=1;k+=1){const O=(k===0?c:-c)*(a-i)+o;if(O>=m&&O<=M){const E=Math.abs(o-O)*2*s;x=Math.min(x,E)}}const N=s,v=Math.abs((u-i)/(m-o)),D=Math.abs((f-i)/(M-o));if(M<o&&D<N){const L=Math.abs(o-M)*2*s;x=Math.min(x,L)}else if(m>o&&v<N){const L=Math.abs(o-m)*2*s;x=Math.min(x,L)}const I=Math.abs((y-o)/(g-i)),A=Math.abs((S-o)/(b-i));if(b<i&&A<c){const k=Math.abs(i-b)*2;x=Math.min(x,k)}else if(g>i&&I<c){const k=Math.abs(i-g)*2;x=Math.min(x,k)}return x}function ZI(t,e,i,o){let s=!1,a=1/0;for(const n of t){let r=n[n.length-1],[l,c]=r;for(const h of n){const[p,u]=h;u>i!=c>i&&e<(l-p)*(i-u)/(c-u)+p&&(s=!s);const m=XI(r,h,e,i,o);a=Math.min(a,m),r=h,l=p,c=u}}return(s?1:-1)*a}function va(t,e,i){i>=e&&(t.maxX=Math.min(t.maxX,i-e)),i<=e&&(t.minX=Math.max(t.minX,i-e))}function QI(t,e,i,o,s,a){const n=s-a/2,r=s+a/2,[l,c]=e,[h,p]=i,u=h-l,m=p-c,[g,y]=l<=h?e:i,[f,M]=l<=h?i:e;if(u!==0){const b=m/u;for(let S=0;S<=1;S+=1){const N=((S===0?n:r)-c)/b+l;N>=g&&N<=f&&va(t,o,N)}}else Math.max(n,Math.min(c,p))<=Math.min(r,Math.max(c,p))&&va(t,o,l);return f<o&&M>=n&&M<=r?va(t,o,f):g>o&&y>=n&&y<=r&&va(t,o,g),t}function $I(t,e,i,o){const s={minX:-1/0,maxX:1/0};for(const r of t){let l=r[r.length-1];for(const c of r)QI(s,l,c,e,i,o),l=c}const{minX:a,maxX:n}=s;return Number.isFinite(a)&&Number.isFinite(n)?{x:e+(a+n)/2,width:n-a}:{x:e,width:0}}import{_ModuleSupport as qI}from"ag-charts-community";var{AND:JI,ARRAY:tA,COLOR_STRING:yu,COLOR_STRING_ARRAY:eA,FUNCTION:iA,LINE_DASH:oA,OBJECT:mu,POSITIVE_NUMBER:pl,RATIO:fu,STRING:Ke,Validate:ht,SeriesProperties:sA,SeriesTooltip:aA}=qI,ct=class extends sA{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.idName=void 0,this.topologyIdKey="name",this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.padding=0,this.label=new ts,this.tooltip=new aA}};d([ht(Te,{optional:!0})],ct.prototype,"topology",2),d([ht(Ke,{optional:!0})],ct.prototype,"title",2),d([ht(Ke,{optional:!0})],ct.prototype,"legendItemName",2),d([ht(Ke)],ct.prototype,"idKey",2),d([ht(Ke,{optional:!0})],ct.prototype,"idName",2),d([ht(Ke)],ct.prototype,"topologyIdKey",2),d([ht(Ke,{optional:!0})],ct.prototype,"labelKey",2),d([ht(Ke,{optional:!0})],ct.prototype,"labelName",2),d([ht(Ke,{optional:!0})],ct.prototype,"colorKey",2),d([ht(Ke,{optional:!0})],ct.prototype,"colorName",2),d([ht(JI(eA,tA.restrict({minLength:1})),{optional:!0})],ct.prototype,"colorRange",2),d([ht(yu)],ct.prototype,"fill",2),d([ht(fu)],ct.prototype,"fillOpacity",2),d([ht(yu)],ct.prototype,"stroke",2),d([ht(fu)],ct.prototype,"strokeOpacity",2),d([ht(pl)],ct.prototype,"strokeWidth",2),d([ht(oA)],ct.prototype,"lineDash",2),d([ht(pl)],ct.prototype,"lineDashOffset",2),d([ht(pl)],ct.prototype,"padding",2),d([ht(iA,{optional:!0})],ct.prototype,"itemStyler",2),d([ht(mu)],ct.prototype,"label",2),d([ht(mu)],ct.prototype,"tooltip",2);var{getMissCount:nA,createDatumId:rA,DataModelSeries:lA,SeriesNodePickMode:xu,valueProperty:Ia,Validate:cA}=dl,{ColorScale:hA}=GI,{Group:Su,Selection:ul,Text:gl,PointerEvents:dA}=WI,{sanitizeHtml:Aa,Logger:Mu}=jI,bu=dl.MercatorScale.fixedScale(),Ta=class extends lA{constructor(t){super({moduleCtx:t,contentGroupVirtual:!1,useLabelLayer:!0,pickModes:[xu.EXACT_SHAPE_MATCH,xu.NEAREST_NODE]}),this.properties=new ct,this._chartTopology=void 0,this.colorScale=new hA,this.itemGroup=this.contentGroup.appendChild(new Su({name:"itemGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new Su({name:"itemLabelGroup"})),this.datumSelection=ul.select(this.itemGroup,()=>this.nodeFactory()),this.labelSelection=ul.select(this.itemLabelGroup,gl),this.highlightDatumSelection=ul.select(this.highlightNode,()=>this.nodeFactory()),this.previousLabelLayouts=void 0,this._previousDatumMidPoint=void 0,this.itemLabelGroup.pointerEvents=dA.None}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){return super.hasData&&this.topology!=null}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager.addListener("legend-item-click",t=>{this.onLegendItemClick(t)}),this.ctx.chartEventManager.addListener("legend-item-double-click",t=>{this.onLegendItemDoubleClick(t)}))}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}nodeFactory(){const t=new Do;return t.renderMode=1,t.lineJoin="round",t}async processData(t){if(this.data==null||!this.properties.isValid())return;const{data:e,topology:i,colorScale:o}=this,{topologyIdKey:s,idKey:a,colorKey:n,labelKey:r,colorRange:l}=this.properties,c=new Map;i?.features.forEach(y=>{const f=y.properties?.[s];f==null||!ol(y.geometry,1)||c.set(f,y)});const h=this.colorScale.type,p=this.scale?.type,{dataModel:u,processedData:m}=await this.requestDataModel(t,e,{props:[Ia(a,p,{id:"idValue",includeProperty:!1}),Ia(a,p,{id:"featureValue",includeProperty:!1,processor:()=>y=>c.get(y)}),...r?[Ia(r,"band",{id:"labelValue"})]:[],...n?[Ia(n,h,{id:"colorValue"})]:[]]}),g=u.resolveProcessedDataIndexById(this,"featureValue");if(this.topologyBounds=m.data.reduce((y,{values:f})=>{const b=f[g]?.geometry;return b==null?y:No(b,y)},void 0),l!=null&&this.isColorScaleValid()){const y=u.resolveProcessedDataIndexById(this,"colorValue");o.domain=m.domain.values[y],o.range=l,o.update()}i==null&&Mu.warnOnce("no topology was provided for [MapShapeSeries]; nothing will be rendered.")}isColorScaleValid(){const{colorKey:t}=this.properties;if(!t)return!1;const{dataModel:e,processedData:i}=this;if(!e||!i)return!1;const o=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.data.length,a=nA(this,i.defs.values[o].missing);return!(s===0||s===a)}getLabelLayout(t,e,i,o,s){if(e==null||o==null)return;const{idKey:a,idName:n,colorKey:r,colorName:l,labelKey:c,labelName:h,padding:p,label:u}=this.properties,m=this.getLabelText(u,{value:e,datum:t,idKey:a,idName:n,colorKey:r,colorName:l,labelKey:c,labelName:h});if(m==null)return;const g=gl.getTextSize(String(m),i),y=m.split(`
`).length,f=(g.width+2*p)/(y*ie.lineHeight(u.fontSize)+2*p);if(s?.geometry===o&&s?.labelText===m&&s?.aspectRatio===f)return s;const M=ci(o,bu),b=fa(M);if(b==null)return;const S=YI(b,{aspectRatio:f,precision:.001});if(S==null)return;const{x,y:N,maxWidth:v}=S;return{geometry:o,labelText:m,aspectRatio:f,x,y:N,maxWidth:v,fixedPolygon:b}}getLabelDatum(t,e){const{scale:i}=this;if(i==null)return;const{padding:o,label:s}=this.properties,{labelText:a,aspectRatio:n,x:r,y:l,maxWidth:c,fixedPolygon:h}=t,p={width:Math.ceil(c*e),height:Math.ceil(c*e/n),meta:r},u=$r(a,s,{padding:o},(x,N)=>{if(!N)return p;const v=$I(h,r,l,x/e);return{width:v.width*e,height:x,meta:v.x}});if(u==null)return;const[{text:m,fontSize:g,lineHeight:y,width:f},M]=u;if(m===gl.ellipsis)return;const b=f<p.width?r:M,S=this.scale.convert(bu.invert([b,l]));return{x:S[0],y:S[1],text:m,fontSize:g,lineHeight:y}}async createNodeData(){const{id:t,dataModel:e,processedData:i,colorScale:o,properties:s,scale:a,previousLabelLayouts:n}=this,{idKey:r,colorKey:l,labelKey:c,label:h,fill:p}=s;if(e==null||i==null)return;const u=a!=null?(a.range[1][0]-a.range[0][0])/a.bounds.width:NaN,m=this.isColorScaleValid(),g=e.resolveProcessedDataIndexById(this,"idValue"),y=e.resolveProcessedDataIndexById(this,"featureValue"),f=c!=null?e.resolveProcessedDataIndexById(this,"labelValue"):void 0,M=l!=null?e.resolveProcessedDataIndexById(this,"colorValue"):void 0,b=h.getFont(),S=new Map;this.previousLabelLayouts=S;const x=[],N=[],v=[];i.data.forEach(({datum:I,values:A})=>{const k=A[g],L=M!=null?A[M]:void 0,O=f!=null?A[f]:void 0,T=A[y]?.geometry;T==null&&v.push(k);const E=m&&L!=null?o.convert(L):void 0,_=this.getLabelLayout(I,O,b,T,n?.get(k));_!=null&&S.set(k,_);const R=_!=null&&a!=null?this.getLabelDatum(_,u):void 0;R!=null&&N.push(R);const C=T!=null&&a!=null?ci(T,a):void 0;x.push({series:this,itemId:r,datum:I,idValue:k,colorValue:L,labelValue:O,fill:E??p,projectedGeometry:C})});const D=10;if(v.length>D){const I=v.length-D;v.length=D,v.push(`(+${I} more)`)}return v.length>0&&Mu.warnOnce("some data items do not have matches in the provided topology",v),{itemId:t,nodeData:x,labelData:N}}async updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=await this.createNodeData(),this.nodeDataRefresh=!1)}async update(){const{datumSelection:t,labelSelection:e,highlightDatumSelection:i}=this;await this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let o=this.ctx.highlightManager?.getActiveHighlight();o!=null&&(o.series!==this||o.datum==null)&&(o=void 0);const s=this.contextNodeData?.nodeData??[],a=this.contextNodeData?.labelData??[];this.datumSelection=await this.updateDatumSelection({nodeData:s,datumSelection:t}),await this.updateDatumNodes({datumSelection:t,isHighlight:!1}),this.labelSelection=await this.updateLabelSelection({labelData:a,labelSelection:e}),await this.updateLabelNodes({labelSelection:e}),this.highlightDatumSelection=await this.updateDatumSelection({nodeData:o!=null?[o]:[],datumSelection:i}),await this.updateDatumNodes({datumSelection:i,isHighlight:!0})}async updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>rA(e.idValue))}async updateDatumNodes(t){const{id:e,properties:i,ctx:{callbackCache:o}}=this,{datumSelection:s,isHighlight:a}=t,{idKey:n,colorKey:r,labelKey:l,fillOpacity:c,stroke:h,strokeOpacity:p,lineDash:u,lineDashOffset:m,itemStyler:g}=i,y=a?i.highlightStyle.item:void 0,f=this.getStrokeWidth(i.strokeWidth);s.each((M,b)=>{const{projectedGeometry:S}=b;if(S==null){M.visible=!1,M.projectedGeometry=void 0;return}let x;g!=null&&(x=o.call(g,{seriesId:e,datum:b.datum,idKey:n,colorKey:r,labelKey:l,fill:b.fill,fillOpacity:c,strokeOpacity:p,stroke:h,strokeWidth:f,lineDash:u,lineDashOffset:m,highlighted:a})),M.visible=!0,M.projectedGeometry=S,M.fill=y?.fill??x?.fill??b.fill,M.fillOpacity=y?.fillOpacity??x?.fillOpacity??c,M.stroke=y?.stroke??x?.stroke??h,M.strokeWidth=y?.strokeWidth??x?.strokeWidth??f,M.strokeOpacity=y?.strokeOpacity??x?.strokeOpacity??p,M.lineDash=y?.lineDash??x?.lineDash??u,M.lineDashOffset=y?.lineDashOffset??x?.lineDashOffset??m})}async updateLabelSelection(t){const e=this.isLabelEnabled()?t.labelData:[];return t.labelSelection.update(e)}async updateLabelNodes(t){const{labelSelection:e}=t,{color:i,fontStyle:o,fontWeight:s,fontFamily:a}=this.properties.label;e.each((n,{x:r,y:l,text:c,fontSize:h,lineHeight:p})=>{n.visible=!0,n.x=r,n.y=l,n.text=c,n.fill=i,n.fontStyle=o,n.fontWeight=s,n.fontSize=h,n.lineHeight=p,n.fontFamily=a,n.textAlign="center",n.textBaseline="middle"})}onLegendItemClick(t){const{legendItemName:e}=this.properties,{enabled:i,itemId:o,series:s}=t,a=e!=null&&e===t.legendItemName;(s.id===this.id||a)&&this.toggleSeriesItem(o,i)}onLegendItemDoubleClick(t){const{enabled:e,itemId:i,series:o,numVisibleItems:s}=t,{legendItemName:a}=this.properties,n=a!=null&&a===t.legendItemName;o.id===this.id||n?this.toggleSeriesItem(i,!0):e&&s===1?this.toggleSeriesItem(i,!0):this.toggleSeriesItem(i,!1)}resetAnimation(){}getLabelData(){return[]}getSeriesDomain(){return[NaN,NaN]}pickNodeClosestDatum({x:t,y:e}){let i=1/0,o;return this.datumSelection.each((s,a)=>{const n=s.distanceToPoint(t,e);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:i}:void 0}datumMidPoint(t){const{_previousDatumMidPoint:e}=this;if(e?.datum===t)return e.point;const i=t.projectedGeometry,o=i!=null?fa(i):void 0,s=o!=null?ll(o,2):void 0,a=s!=null?{x:s[0],y:s[1]}:void 0;return this._previousDatumMidPoint={datum:t,point:a},a}getLegendData(t){const{processedData:e,dataModel:i}=this;if(e==null||i==null)return[];const{title:o,legendItemName:s,idKey:a,idName:n,fill:r,fillOpacity:l,stroke:c,strokeWidth:h,strokeOpacity:p,colorKey:u,colorName:m,colorRange:g,visible:y}=this.properties;if(t==="gradient"&&u!=null&&g!=null){const f=e.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:y,seriesId:this.id,colorName:m,colorRange:g,colorDomain:f}]}else return t==="category"?[{legendType:"category",id:this.id,itemId:s??o??n??a,seriesId:this.id,enabled:y,label:{text:s??o??n??a},symbols:[{marker:{fill:r,fillOpacity:l,stroke:c,strokeWidth:h,strokeOpacity:p}}],legendItemName:s}]:[]}getTooltipHtml(t){const{id:e,processedData:i,ctx:{callbackCache:o},properties:s}=this;if(!i||!s.isValid())return dl.EMPTY_TOOLTIP_CONTENT;const{legendItemName:a,idKey:n,idName:r,colorKey:l,colorName:c,labelKey:h,labelName:p,stroke:u,strokeWidth:m,strokeOpacity:g,fillOpacity:y,lineDash:f,lineDashOffset:M,itemStyler:b,tooltip:S}=s,{datum:x,fill:N,idValue:v,colorValue:D,labelValue:I,itemId:A}=t,k=Aa(s.title??a)??"",L=[];L.push(Aa((r!=null?`${r}: `:"")+v)),D!=null&&L.push(Aa((c??l)+": "+D)),I!=null&&h!==n&&L.push(Aa((p??h)+": "+I));const O=L.join("<br>");let T;b&&(T=o.call(b,{seriesId:e,datum:x,idKey:n,colorKey:l,labelKey:h,fill:N,stroke:u,strokeWidth:this.getStrokeWidth(m),highlighted:!1,fillOpacity:y,strokeOpacity:g,lineDash:f,lineDashOffset:M}));const E=T?.fill??N;return S.toTooltipHtml({title:k,content:O,backgroundColor:E},{seriesId:e,datum:x,idKey:n,title:k,color:E,colorKey:l,colorName:c,idName:r,itemId:A,labelKey:h,labelName:p,...this.getModuleTooltipParams()})}computeFocusBounds(t){return Zp(this,t)}};Ta.className="MapShapeSeries",Ta.type="map-shape",d([cA(Te,{optional:!0,property:"topology"})],Ta.prototype,"_chartTopology",2);var{DEFAULT_INVERTED_LABEL_COLOUR:pA,DEFAULT_DIVERGING_SERIES_COLOUR_RANGE:uA,DEFAULT_BACKGROUND_COLOUR:gA,singleSeriesPaletteFactory:yA}=KI,mA={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-shape",instanceConstructor:Ta,tooltipDefaults:{range:"exact"},themeTemplate:{...es,series:{fillOpacity:1,strokeWidth:1,lineDash:[0],lineDashOffset:0,padding:2,label:{color:pA,fontWeight:"bold",overflowStrategy:"hide"}}},paletteFactory:t=>{const{takeColors:e,colorsCount:i,userPalette:o,themeTemplateParameters:s}=t,{fill:a}=yA(t),n=s.get(uA),{fills:r}=e(i);return{fill:a,stroke:s.get(gA),colorRange:o==="inbuilt"?n:[r[0],r[1]]}}};import{_Theme as yl}from"ag-charts-community";import{_Scene as fA}from"ag-charts-community";import{_ModuleSupport as ka,_Scale as xA,_Scene as SA,_Util as MA}from"ag-charts-community";var{isDefined:bA,ChartAxisDirection:Oe,PolarAxis:DA,diff:NA,fixNumericExtent:vA,groupAccumulativeValueProperty:Du,keyProperty:IA,mergeDefaults:AA,normaliseGroupTo:TA,resetLabelFn:kA,seriesLabelFadeInAnimation:OA,seriesLabelFadeOutAnimation:LA,valueProperty:EA,animationValidation:RA,isFiniteNumber:_A,SeriesNodePickMode:Nu}=ka,{BandScale:CA}=xA,{motion:vu}=SA,{isNumber:wA,normalizeAngle360:Iu,sanitizeHtml:Au}=MA,PA=class extends ka.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},Tu=class extends ka.PolarSeries{constructor(t,{animationResetFns:e}){super({moduleCtx:t,useLabelLayer:!0,canHaveAxes:!0,pickModes:[Nu.NEAREST_NODE,Nu.EXACT_SHAPE_MATCH],animationResetFns:{...e,label:kA}}),this.NodeEvent=PA,this.groupScale=new CA,this.circleCache={r:0,cx:0,cy:0}}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager?.addListener("legend-item-click",t=>this.onLegendItemClick(t)),this.ctx.chartEventManager?.addListener("legend-item-double-click",t=>this.onLegendItemDoubleClick(t)))}getSeriesDomain(t){const{axes:e,dataModel:i,processedData:o}=this;if(!o||!i)return[];if(t===Oe.X)return i.getDomain(this,"angleValue","key",o);{const s=e[Oe.Y],a=i.getDomain(this,"radiusValue-end","value",o),n=[a[0]>0?0:a[0],a[1]<0?0:a[1]];return vA(n,s)}}async processData(t){const{angleKey:e,radiusKey:i,normalizedTo:o,visible:s}=this.properties,a=!this.ctx.animationManager.isSkipped();if(!this.properties.isValid()||!(s||a))return;const n=this.getStackId(),r=`${n}-trailing`,l=[];bA(o)&&l.push(TA([n,r],Math.abs(o),"range")),a&&this.processedData&&l.push(NA(this.processedData)),a&&l.push(RA());const c=s||!a?{}:{forceValue:0},h=this.axes[Oe.Y]?.scale.type,p=this.axes[Oe.X]?.scale.type;await this.requestDataModel(t,this.data,{props:[IA(e,p,{id:"angleValue"}),EA(i,h,{id:"radiusValue-raw",invalidValue:null,...c}),...Du(i,"normal","current",{id:"radiusValue-end",rangeId:"radiusValue-range",invalidValue:null,groupId:n,separateNegative:!0,...c},h),...Du(i,"trailing","current",{id:"radiusValue-start",invalidValue:null,groupId:r,separateNegative:!0,...c},h),...l]}),this.animationState.transition("updateData")}didCircleChange(){const t=this.radius,e=this.centerX,i=this.centerY,o=this.circleCache;return t===o.r&&e===o.cx&&i===o.cy?!1:(this.circleCache={r:t,cx:e,cy:i},!0)}isRadiusAxisReversed(){return this.axes[Oe.Y]?.isReversed()}async maybeRefreshNodeData(){if(!this.didCircleChange()&&!this.nodeDataRefresh)return;const{nodeData:e=[]}=await this.createNodeData()??{};this.nodeData=e,this.nodeDataRefresh=!1}getAxisInnerRadius(){const t=this.axes[Oe.Y];return t instanceof DA?this.radius*t.innerRadiusRatio:0}async createNodeData(){const{processedData:t,dataModel:e,groupScale:i}=this;if(!t||!e||!this.properties.isValid())return;const o=this.axes[Oe.X],s=this.axes[Oe.Y],a=o?.scale,n=s?.scale;if(!a||!n)return;const r=e.resolveProcessedDataIndexById(this,"radiusValue-start"),l=e.resolveProcessedDataIndexById(this,"radiusValue-end"),c=e.resolveProcessedDataIndexById(this,"radiusValue-range"),h=e.resolveProcessedDataIndexById(this,"radiusValue-raw");let p=0,u=0;o instanceof xi&&(p=o.groupPaddingInner,u=o.paddingInner);const g=(a.bandwidth??0)*(1-u),{index:y,visibleGroupCount:f}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);i.domain=Array.from({length:f}).map((T,E)=>String(E)),i.range=[-g/2,g/2],i.paddingInner=f>1?p:0;const M=this.isRadiusAxisReversed(),b=M?this.radius:this.getAxisInnerRadius(),S=M?this.getAxisInnerRadius():this.radius,x=S+b,{angleKey:N,radiusKey:v,angleName:D,radiusName:I,label:A}=this.properties,k=(T,E,_,R)=>{const C=this.getLabelText(A,{value:E,datum:T,angleKey:N,radiusKey:v,angleName:D,radiusName:I},w=>_A(w)?w.toFixed(2):String(w));if(C)return{x:_,y:R,text:C,textAlign:"center",textBaseline:"middle"}},L=[],O={itemId:v,nodeData:L,labelData:L};return this.visible?(t.data.forEach((T,E,_)=>{const{datum:R,keys:C,values:w,aggValues:P}=T,B=C[0],z=w[h],V=z>=0&&!Object.is(z,-0),U=w[r],Q=w[l],H=P?.[c][V?1:0]??0,K=V===M;if(U===void 0||Q===void 0)return;let j,st;if(_.length===1)j=-.5*Math.PI,st=1.5*Math.PI;else{let Xe=a.convert(B);f===1&&(Xe-=i.bandwidth/2),j=Iu(Xe+i.convert(String(y))),st=Iu(j+i.bandwidth)}const Ft=j+i.bandwidth/2,rt=x-n.convert(U),Mt=x-n.convert(Q),bt=(rt+Mt)/2,$t=x-n.convert(0),Xt=x-n.convert(H),Ut=Math.cos(Ft)*bt,ot=Math.sin(Ft)*bt,qt=this.properties.label.enabled?k(R,z,Ut,ot):void 0,fe=this.getColumnWidth(j,st);L.push({series:this,datum:R,point:{x:Ut,y:ot,size:0},midPoint:{x:Ut,y:ot},label:qt,angleValue:B,radiusValue:z,negative:K,innerRadius:rt,outerRadius:Mt,stackInnerRadius:$t,stackOuterRadius:Xt,startAngle:j,endAngle:st,axisInnerRadius:b,axisOuterRadius:S,columnWidth:fe,index:E})}),{itemId:v,nodeData:L,labelData:L}):O}getColumnWidth(t,e){return NaN}async update({seriesRect:t}){const e=this.checkResize(t);await this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updateSectorSelection(this.itemSelection,!1),this.updateSectorSelection(this.highlightSelection,!0),this.updateLabels(),e&&this.animationState.transition("resize"),this.animationState.transition("update")}updateSectorSelection(t,e){let i=[];if(e){const g=this.ctx.highlightManager?.getActiveHighlight();g?.datum&&g.series===this&&(i=[g])}else i=this.nodeData;const{fill:o,fillOpacity:s,stroke:a,strokeOpacity:n,strokeWidth:r,lineDash:l,lineDashOffset:c,cornerRadius:h,angleKey:p,radiusKey:u}=AA(e?this.properties.highlightStyle.item:null,this.properties),m=g=>g.angleValue;t.update(i,void 0,m).each((g,y)=>{const f=this.properties.itemStyler?this.ctx.callbackCache.call(this.properties.itemStyler,{datum:y.datum,fill:o,fillOpacity:s,stroke:a,strokeWidth:r,strokeOpacity:n,lineDash:l,lineDashOffset:c,cornerRadius:h,highlighted:e,angleKey:p,radiusKey:u,seriesId:this.id}):void 0;this.updateItemPath(g,y,e,f),g.fill=f?.fill??o,g.fillOpacity=f?.fillOpacity??s,g.stroke=f?.stroke??a,g.strokeWidth=f?.strokeWidth??r,g.strokeOpacity=f?.strokeOpacity??n,g.lineDash=f?.lineDash??l,g.lineDashOffset=f?.lineDashOffset??c,g.cornerRadius=f?.cornerRadius??h,g.lineJoin="round"})}updateLabels(){const{label:t}=this.properties;this.labelSelection.update(this.nodeData).each((e,i)=>{t.enabled&&i.label?(e.x=i.label.x,e.y=i.label.y,e.fill=t.color,e.fontFamily=t.fontFamily,e.fontSize=t.fontSize,e.fontStyle=t.fontStyle,e.fontWeight=t.fontWeight,e.text=i.label.text,e.textAlign=i.label.textAlign,e.textBaseline=i.label.textBaseline,e.visible=!0):e.visible=!1})}animateEmptyUpdateReady(){const{labelSelection:t}=this,e=this.getColumnTransitionFunctions();vu.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],e),OA(this,"labels",this.ctx.animationManager,t)}animateClearingUpdateEmpty(){const{itemSelection:t}=this,{animationManager:e}=this.ctx,i=this.getColumnTransitionFunctions();vu.fromToMotion(this.id,"datums",e,[t],i),LA(this,"labels",e,this.labelSelection)}getTooltipHtml(t){const{id:e,axes:i,dataModel:o}=this,{angleKey:s,radiusKey:a,angleName:n,radiusName:r,fill:l,fillOpacity:c,stroke:h,strokeWidth:p,strokeOpacity:u,lineDash:m,lineDashOffset:g,cornerRadius:y,itemStyler:f,tooltip:M}=this.properties,{angleValue:b,radiusValue:S,datum:x,itemId:N}=t,v=i[Oe.X],D=i[Oe.Y];if(!this.properties.isValid()||!(v&&D&&wA(S))||!o)return ka.EMPTY_TOOLTIP_CONTENT;const I=v.formatDatum(b),A=D.formatDatum(S),k=Au(r),L=Au(`${I}: ${A}`),{fill:O}=(f&&this.ctx.callbackCache.call(f,{highlighted:!1,seriesId:e,datum:x,angleKey:s,radiusKey:a,fill:l,fillOpacity:c,stroke:h,strokeWidth:p,strokeOpacity:u,lineDash:m,lineDashOffset:g,cornerRadius:y}))??{fill:l};return M.toTooltipHtml({title:k,backgroundColor:l,content:L},{seriesId:e,datum:x,color:O,title:k,angleKey:s,radiusKey:a,angleName:n,radiusName:r,angleValue:b,itemId:N,radiusValue:S})}pickNodeClosestDatum(t){return this.pickNodeNearestDistantObject(t,this.itemSelection.nodes())}getLegendData(t){if(!this.data?.length||!this.properties.isValid()||t!=="category")return[];const{radiusKey:e,radiusName:i,fill:o,stroke:s,fillOpacity:a,strokeOpacity:n,strokeWidth:r,visible:l}=this.properties;return[{legendType:"category",id:this.id,itemId:e,seriesId:this.id,enabled:l,label:{text:i??e},symbols:[{marker:{fill:o??"rgba(0, 0, 0, 0)",stroke:s??"rgba(0, 0, 0, 0)",fillOpacity:a??1,strokeOpacity:n??1,strokeWidth:r}}]}]}onLegendItemClick(t){const{enabled:e,itemId:i,series:o}=t;o.id===this.id&&this.toggleSeriesItem(i,e)}onLegendItemDoubleClick(t){const{enabled:e,itemId:i,series:o,numVisibleItems:s}=t,n=o.id===this.id||e&&s===1;this.toggleSeriesItem(i,n)}computeLabelsBBox(){return null}};import{_ModuleSupport as BA,_Scene as zA}from"ag-charts-community";var{Label:VA}=zA,{SeriesProperties:FA,SeriesTooltip:UA,Validate:At,COLOR_STRING:ku,DEGREE:HA,FUNCTION:KA,LINE_DASH:GA,NUMBER:WA,OBJECT:Ou,POSITIVE_NUMBER:ml,RATIO:Lu,STRING:as}=BA,mt=class extends FA{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new VA,this.tooltip=new UA}};d([At(as)],mt.prototype,"angleKey",2),d([At(as,{optional:!0})],mt.prototype,"angleName",2),d([At(as)],mt.prototype,"radiusKey",2),d([At(as,{optional:!0})],mt.prototype,"radiusName",2),d([At(ku)],mt.prototype,"fill",2),d([At(Lu)],mt.prototype,"fillOpacity",2),d([At(ku)],mt.prototype,"stroke",2),d([At(ml)],mt.prototype,"strokeWidth",2),d([At(Lu)],mt.prototype,"strokeOpacity",2),d([At(GA)],mt.prototype,"lineDash",2),d([At(ml)],mt.prototype,"lineDashOffset",2),d([At(ml)],mt.prototype,"cornerRadius",2),d([At(KA,{optional:!0})],mt.prototype,"itemStyler",2),d([At(HA)],mt.prototype,"rotation",2),d([At(as,{optional:!0})],mt.prototype,"stackGroup",2),d([At(WA,{optional:!0})],mt.prototype,"normalizedTo",2),d([At(Ou)],mt.prototype,"label",2),d([At(Ou)],mt.prototype,"tooltip",2);import{_Scene as jA}from"ag-charts-community";import{_Scene as YA}from"ag-charts-community";var{motion:XA}=YA;function Eu(){const t={startAngle:new Map,endAngle:new Map},e=["startAngle","endAngle"],i=(n,r,l)=>{e.forEach(c=>{const h=t[c];let p=(l==="removed"||l==="updated"?n:r)[c],u=(l==="removed"?n:r)[c];isNaN(u)&&(u=n.previousDatum?.[c]??NaN);const m=p-u;Math.abs(m)>Math.PI&&(p-=Math.sign(m)*2*Math.PI),h.set(r,{from:p,to:u})})},o=(n,r)=>({startAngle:t.startAngle.get(n)[r],endAngle:t.endAngle.get(n)[r]});return{calculate:i,from:n=>o(n,"from"),to:n=>o(n,"to")}}function Ru(t,e,i){if(i==="updated"){if(t.previousDatum==null||isNaN(t.previousDatum.startAngle)||isNaN(t.previousDatum.endAngle))return"added";if(isNaN(e.startAngle)||isNaN(e.endAngle))return"removed"}return i==="added"&&t.previousDatum!=null?"updated":i}function ZA(t){const e=Eu();return{toFn:(s,a,n)=>{const{startAngle:r,endAngle:l}=e.to(a);let c,h,p,u,m;return n==="removed"?(c=s.innerRadius,h=s.innerRadius,p=s.columnWidth,u=s.axisInnerRadius,m=s.axisOuterRadius):(c=isNaN(a.innerRadius)?t:a.innerRadius,h=isNaN(a.outerRadius)?t:a.outerRadius,p=isNaN(a.columnWidth)?s.columnWidth:a.columnWidth,u=a.axisInnerRadius,m=a.axisOuterRadius),{innerRadius:c,outerRadius:h,columnWidth:p,axisInnerRadius:u,axisOuterRadius:m,startAngle:r,endAngle:l}},fromFn:(s,a,n)=>{n=Ru(s,a,n),e.calculate(s,a,n);const{startAngle:r,endAngle:l}=e.from(a);let c,h,p,u,m;n==="removed"||n==="updated"?(c=s.innerRadius,h=s.outerRadius,p=s.columnWidth,u=s.axisInnerRadius,m=s.axisOuterRadius):(c=t,h=t,p=a.columnWidth,u=a.axisInnerRadius,m=a.axisOuterRadius);const g=XA.NODE_UPDATE_STATE_TO_PHASE_MAPPING[n];return{innerRadius:c,outerRadius:h,columnWidth:p,axisInnerRadius:u,axisOuterRadius:m,startAngle:r,endAngle:l,phase:g}}}}function QA(t,{innerRadius:e,outerRadius:i,columnWidth:o,axisInnerRadius:s,axisOuterRadius:a,startAngle:n,endAngle:r}){return{innerRadius:e,outerRadius:i,columnWidth:o,axisInnerRadius:s,axisOuterRadius:a,startAngle:n,endAngle:r}}var{SectorBox:Oa,motion:$A}=jA;function fl(t){const{negative:e,innerRadius:i,outerRadius:o,stackInnerRadius:s,stackOuterRadius:a}=t;return{innerRadius:e?a:s,outerRadius:e?s:a,clipInnerRadius:e?o:i,clipOuterRadius:e?i:o}}function qA(t){const e=Eu();return{toFn:(s,a,n)=>{const{startAngle:r,endAngle:l}=e.to(a);let c,h,p;if(n==="removed")c=t,h=t,p=new Oa(r,l,c,h);else{let u,m;({innerRadius:c,outerRadius:h,clipInnerRadius:u,clipOuterRadius:m}=fl(a)),isNaN(c)&&(c=t),isNaN(h)&&(h=t),isNaN(u)&&(u=t),isNaN(m)&&(m=t),p=new Oa(r,l,u,m)}return{innerRadius:c,outerRadius:h,startAngle:r,endAngle:l,clipSector:p}},fromFn:(s,a,n)=>{n=Ru(s,a,n),e.calculate(s,a,n);const{startAngle:r,endAngle:l}=e.from(a);let c,h,p;n==="removed"||n==="updated"?(c=s.innerRadius,h=s.outerRadius,p=s.clipSector):(c=t,h=t),p??(p=new Oa(r,l,c,h));const u=$A.NODE_UPDATE_STATE_TO_PHASE_MAPPING[n];return{innerRadius:c,outerRadius:h,startAngle:r,endAngle:l,clipSector:p,phase:u}}}}function JA(t,e){const{startAngle:i,endAngle:o}=e,{innerRadius:s,outerRadius:a,clipInnerRadius:n,clipOuterRadius:r}=fl(e),l=new Oa(i,o,n,r);return{innerRadius:s,outerRadius:a,startAngle:i,endAngle:o,clipSector:l}}var{Sector:t0,SectorBox:e0}=fA,xl=class extends Tu{constructor(t){super(t,{animationResetFns:{item:JA}}),this.properties=new mt}getStackId(){return`nightingale-stack-${this.seriesGrouping?.groupIndex??this.id}-yValues`}nodeFactory(){return new t0}updateItemPath(t,e,i,o){const{negative:s}=e;if(t.centerX=0,t.centerY=0,t.startOuterCornerRadius=s?0:this.properties.cornerRadius,t.endOuterCornerRadius=s?0:this.properties.cornerRadius,t.startInnerCornerRadius=s?this.properties.cornerRadius:0,t.endInnerCornerRadius=s?this.properties.cornerRadius:0,i){const{startAngle:a,endAngle:n}=e,{innerRadius:r,outerRadius:l,clipInnerRadius:c,clipOuterRadius:h}=fl(e);t.innerRadius=r,t.outerRadius=l,t.startAngle=a,t.endAngle=n,t.clipSector=new e0(a,n,c,h)}}getColumnTransitionFunctions(){const t=this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius();return qA(t)}};xl.className="NightingaleSeries",xl.type="nightingale";import{_Theme as Io}from"ag-charts-community";var i0={series:{strokeWidth:1,label:{enabled:!1,fontSize:12,fontFamily:Io.DEFAULT_FONT_FAMILY,color:Io.DEFAULT_LABEL_COLOUR}},axes:{[Io.POLAR_AXIS_TYPE.ANGLE_CATEGORY]:{shape:Io.POLAR_AXIS_SHAPE.CIRCLE,groupPaddingInner:0,paddingInner:0,label:{padding:10}},[Io.POLAR_AXIS_TYPE.RADIUS_NUMBER]:{shape:Io.POLAR_AXIS_SHAPE.CIRCLE}}},o0={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"nightingale",instanceConstructor:xl,tooltipDefaults:{range:"exact"},defaultAxes:[{type:yl.POLAR_AXIS_TYPE.ANGLE_CATEGORY},{type:yl.POLAR_AXIS_TYPE.RADIUS_NUMBER}],themeTemplate:i0,paletteFactory({takeColors:t,userPalette:e}){const{fills:[i],strokes:[o]}=t(1);return{fill:i,stroke:e!=="inbuilt"?o:yl.DEFAULT_POLAR_SERIES_STROKE}},stackable:!0,groupable:!0,stackedByDefault:!0};import{_Theme as Ao}from"ag-charts-community";import{_ModuleSupport as s0}from"ag-charts-community";import{_Scene as zi}from"ag-charts-community";var a0=class extends Fe{constructor(){super(),this.append([new zi.Line({tag:0}),new zi.Line({tag:1}),new zi.Line({tag:2})])}updateCoordinates(){const{x:t,y:e,yBottom:i,yHigh:o,yLow:s,width:a,height:n,datum:{itemId:r}}=this,l=zi.Selection.select(this,zi.Rect),[c]=l.selectByTag(0),[h]=l.selectByTag(1),[p]=l.selectByTag(2);if(a===0||n===0){c.visible=!1,h.visible=!1,p.visible=!1;return}c.visible=!0,h.visible=!0,p.visible=!0;const u=a/2;c.setProperties({x1:Math.floor(t+u),x2:Math.floor(t+u),y1:o,y2:s});const m=r==="up",g=m?i:e,y=m?e:i;h.setProperties({x1:Math.floor(t),x2:Math.floor(t+u),y:Math.round(g)}),p.setProperties({x1:Math.floor(t+u),x2:Math.floor(t+a),y:Math.round(y)})}updateDatumStyles(t,e){const i=zi.Selection.select(this,zi.Rect),[o]=i.selectByTag(0),[s]=i.selectByTag(1),[a]=i.selectByTag(2);o.setProperties(e),s.setProperties(e),a.setProperties(e)}};import{_ModuleSupport as n0}from"ag-charts-community";var{BaseProperties:_u,Validate:Le,COLOR_STRING:r0,FUNCTION:Cu,LINE_DASH:l0,OBJECT:Sl,POSITIVE_NUMBER:wu,RATIO:c0}=n0,di=class extends _u{constructor(){super(...arguments),this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};d([Le(r0)],di.prototype,"stroke",2),d([Le(wu)],di.prototype,"strokeWidth",2),d([Le(c0)],di.prototype,"strokeOpacity",2),d([Le(l0)],di.prototype,"lineDash",2),d([Le(wu)],di.prototype,"lineDashOffset",2),d([Le(Cu,{optional:!0})],di.prototype,"itemStyler",2);var Ml=class extends _u{constructor(){super(...arguments),this.up=new di,this.down=new di}};d([Le(Sl)],Ml.prototype,"up",2),d([Le(Sl)],Ml.prototype,"down",2);var bl=class extends wt{constructor(){super(...arguments),this.item=new Ml}};d([Le(Sl)],bl.prototype,"item",2),d([Le(Cu,{optional:!0})],bl.prototype,"itemStyler",2);var{mergeDefaults:Pu}=s0,Dl=class extends Sp{constructor(t){super(t,dp),this.properties=new bl}async createNodeData(){const t=this.createBaseNodeData();if(!t)return;const e=t.nodeData.map(i=>{const{stroke:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=this.getItemConfig(i.itemId);return{...i,stroke:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}});return{...t,nodeData:e}}getFormattedStyles(t,e=!1){const{id:i,ctx:{callbackCache:o}}=this,{xKey:s,openKey:a,closeKey:n,highKey:r,lowKey:l,itemStyler:c}=this.properties,{stroke:h,strokeWidth:p,strokeOpacity:u,lineDash:m,lineDashOffset:g}=this.getItemConfig(t.itemId);if(c){const y=o.call(c,{datum:t.datum,itemId:t.itemId,seriesId:i,highlighted:e,xKey:s,openKey:a,closeKey:n,highKey:r,lowKey:l,stroke:h,strokeWidth:p,strokeOpacity:u,lineDash:m,lineDashOffset:g});if(y)return Pu(y,this.getSeriesStyles(t))}return this.getSeriesStyles(t)}nodeFactory(){return new a0}getSeriesStyles(t){const{stroke:e,strokeWidth:i,strokeOpacity:o,lineDash:s,lineDashOffset:a}=t;return{stroke:e,strokeWidth:i,strokeOpacity:o,lineDash:s,lineDashOffset:a}}getActiveStyles(t,e){const i=this.getFormattedStyles(t,e);return e?Pu(this.properties.highlightStyle.item,i):i}computeFocusBounds(t){return up(this,t)}};Dl.className="ohlc",Dl.type="ohlc";var h0={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"ohlc",instanceConstructor:Dl,tooltipDefaults:{range:"nearest"},defaultAxes:[{type:Ao.CARTESIAN_AXIS_TYPE.NUMBER,position:Ao.POSITION.LEFT},{type:Ao.CARTESIAN_AXIS_TYPE.ORDINAL_TIME,position:Ao.POSITION.BOTTOM}],themeTemplate:{animation:{enabled:!1},axes:{[Ao.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{snap:!1}},[Ao.CARTESIAN_AXIS_TYPE.ORDINAL_TIME]:{groupPaddingInner:0,crosshair:{enabled:!0}}}},groupable:!1,paletteFactory:({takeColors:t,colorsCount:e,userPalette:i,palette:o})=>{if(i==="user-indexed"){const{strokes:[s]}=t(e);return{item:{up:{stroke:s},down:{stroke:s}}}}return{item:{up:{stroke:o.up.stroke},down:{stroke:o.down.stroke}}}}};import{_ModuleSupport as d0,_Theme as Bu}from"ag-charts-community";import{_ModuleSupport as zu,_Theme as Nl}from"ag-charts-community";var Vu={series:{label:{enabled:!1,fontSize:12,fontFamily:Nl.DEFAULT_FONT_FAMILY,color:Nl.DEFAULT_LABEL_COLOUR},marker:{enabled:!0,fillOpacity:1,shape:"circle",size:6,strokeOpacity:1,strokeWidth:0}},axes:{[Nl.POLAR_AXIS_TYPE.ANGLE_CATEGORY]:{label:{padding:10}}}},p0=zu.mergeDefaults({series:{strokeWidth:2}},Vu),u0=zu.mergeDefaults({series:{fillOpacity:.8,strokeWidth:2,marker:{enabled:!1}}},Vu);import{_ModuleSupport as Fu,_Scene as g0}from"ag-charts-community";import{_ModuleSupport as La,_Scene as y0,_Util as vl}from"ag-charts-community";import{_ModuleSupport as m0,_Scene as f0}from"ag-charts-community";var{Label:x0}=f0,{SeriesMarker:S0,SeriesProperties:M0,SeriesTooltip:b0,Validate:Kt,BOOLEAN:D0,COLOR_STRING:N0,DEGREE:v0,FUNCTION:I0,LINE_DASH:A0,OBJECT:Il,POSITIVE_NUMBER:Uu,RATIO:T0,STRING:Ea}=m0,Et=class extends M0{constructor(){super(...arguments),this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.rotation=0,this.marker=new S0,this.label=new x0,this.tooltip=new b0,this.connectMissingData=!1}};d([Kt(Ea)],Et.prototype,"angleKey",2),d([Kt(Ea)],Et.prototype,"radiusKey",2),d([Kt(Ea,{optional:!0})],Et.prototype,"angleName",2),d([Kt(Ea,{optional:!0})],Et.prototype,"radiusName",2),d([Kt(N0)],Et.prototype,"stroke",2),d([Kt(Uu)],Et.prototype,"strokeWidth",2),d([Kt(T0)],Et.prototype,"strokeOpacity",2),d([Kt(A0)],Et.prototype,"lineDash",2),d([Kt(Uu)],Et.prototype,"lineDashOffset",2),d([Kt(I0,{optional:!0})],Et.prototype,"itemStyler",2),d([Kt(v0)],Et.prototype,"rotation",2),d([Kt(Il)],Et.prototype,"marker",2),d([Kt(Il)],Et.prototype,"label",2),d([Kt(Il)],Et.prototype,"tooltip",2),d([Kt(D0)],Et.prototype,"connectMissingData",2);var{ChartAxisDirection:Ge,PolarAxis:k0,SeriesNodePickMode:Hu,valueProperty:Ku,fixNumericExtent:O0,seriesLabelFadeInAnimation:L0,markerFadeInAnimation:E0,resetMarkerFn:R0,animationValidation:_0,isFiniteNumber:C0,computeMarkerFocusBounds:w0}=La,{BBox:P0,Group:B0,Path:z0,PointerEvents:V0,Selection:Gu,Text:F0,getMarker:U0}=y0,{extent:H0,isNumberEqual:Wu,sanitizeHtml:ju,toFixed:Yu}=vl,K0=class extends La.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},Al=class extends La.PolarSeries{constructor(t){super({moduleCtx:t,useLabelLayer:!0,pickModes:[Hu.NEAREST_NODE,Hu.EXACT_SHAPE_MATCH],canHaveAxes:!0,animationResetFns:{item:R0}}),this.properties=new Et,this.NodeEvent=K0,this.resetInvalidToZero=!1,this.circleCache={r:0,cx:0,cy:0};const e=new B0;this.contentGroup.append(e),this.lineSelection=Gu.select(e,z0),e.zIndexSubOrder=[()=>this._declarationOrder,1]}nodeFactory(){const{shape:t}=this.properties.marker,e=U0(t);return new e}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager?.addListener("legend-item-click",t=>this.onLegendItemClick(t)),this.ctx.chartEventManager?.addListener("legend-item-double-click",t=>this.onLegendItemDoubleClick(t)))}getSeriesDomain(t){const{dataModel:e,processedData:i}=this;if(!i||!e)return[];if(t===Ge.X)return e.getDomain(this,"angleValue","value",i);{const o=e.getDomain(this,"radiusValue","value",i),s=H0(o.length===0?o:[0].concat(o));return O0(s)}}async processData(t){if(!this.properties.isValid())return;const{angleKey:e,radiusKey:i}=this.properties,o=[];this.ctx.animationManager.isSkipped()||o.push(_0());const s=this.axes[Ge.Y]?.scale.type,a=this.axes[Ge.X]?.scale.type;await this.requestDataModel(t,this.data,{props:[Ku(e,a,{id:"angleValue"}),Ku(i,s,{id:"radiusValue",invalidValue:void 0}),...o]}),this.animationState.transition("updateData")}didCircleChange(){const t=this.radius,e=this.centerX,i=this.centerY,o=this.circleCache;return t===o.r&&e===o.cx&&i===o.cy?!1:(this.circleCache={r:t,cx:e,cy:i},!0)}getAxisInnerRadius(){const t=this.axes[Ge.Y];return t instanceof k0?this.radius*t.innerRadiusRatio:0}async maybeRefreshNodeData(){if(!this.didCircleChange()&&!this.nodeDataRefresh)return;const{nodeData:e=[]}=await this.createNodeData()??{};this.nodeData=e,this.nodeDataRefresh=!1}async createNodeData(){const{processedData:t,dataModel:e}=this;if(!t||!e||!this.properties.isValid())return;const{angleKey:i,radiusKey:o,angleName:s,radiusName:a,marker:n,label:r}=this.properties,l=this.axes[Ge.X]?.scale,c=this.axes[Ge.Y]?.scale;if(!l||!c)return;const h=e.resolveProcessedDataIndexById(this,"angleValue"),p=e.resolveProcessedDataIndexById(this,"radiusValue"),u=this.getAxisInnerRadius(),m=t.data.map(g=>{const{datum:y,values:f}=g,M=f[h],b=f[p],S=l.convert(M),x=this.radius+u-c.convert(b),N=Math.cos(S),v=Math.sin(S),D=N*x,I=v*x;let A;if(r.enabled){const k=this.getLabelText(r,{value:b,datum:y,angleKey:i,radiusKey:o,angleName:s,radiusName:a},L=>C0(L)?L.toFixed(2):String(L));if(k){let L="right";Wu(N,0)?L="center":N>0&&(L="left");let O="bottom";Wu(v,0)?O="middle":v>0&&(O="top"),A={x:D+N*n.size,y:I+v*n.size,text:k,textAlign:L,textBaseline:O}}}return{series:this,datum:y,point:{x:D,y:I,size:n.size},midPoint:{x:D,y:I},label:A,angleValue:M,radiusValue:b,missing:!vl.isNumber(S)||!vl.isNumber(x)}});return{itemId:o,nodeData:m,labelData:m}}async update({seriesRect:t}){const e=this.checkResize(t),i=!this.ctx.animationManager.isSkipped(),{series:o}=this.ctx.highlightManager?.getActiveHighlight()??{};this.highlightGroup.visible=(i||this.visible)&&o===this,await this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updatePathSelections(),this.updateMarkerSelection(),this.updateMarkers(this.itemSelection,!1),this.updateMarkers(this.highlightSelection,!0),this.updateLabels(),e&&this.animationState.transition("resize"),this.animationState.transition("update")}updatePathSelections(){const t=this.visible?[!0]:[];this.lineSelection.update(t)}updateMarkerSelection(){this.properties.marker.isDirty()&&(this.itemSelection.clear(),this.itemSelection.cleanup(),this.itemSelection=Gu.select(this.itemGroup,()=>this.nodeFactory(),!1)),this.itemSelection.update(this.properties.marker.enabled?this.nodeData:[])}getMarkerFill(t){return t?.fill??this.properties.marker.fill}updateMarkers(t,e){const{angleKey:i,radiusKey:o,marker:s,visible:a}=this.properties;let n=[];if(a&&s.shape&&s.enabled)if(e){const l=this.ctx.highlightManager?.getActiveHighlight();l?.datum&&(n=[l])}else n=this.nodeData;const r=e?this.properties.highlightStyle.item:void 0;t.update(n).each((l,c)=>{const h=this.getMarkerFill(r),p=r?.fillOpacity??this.properties.marker.fillOpacity,u=r?.stroke??s.stroke??this.properties.stroke,m=r?.strokeWidth??s.strokeWidth??this.properties.strokeWidth??1,g=r?.strokeOpacity??this.properties.marker.strokeOpacity,y=s.itemStyler?this.ctx.callbackCache.call(s.itemStyler,{datum:c.datum,angleKey:i,radiusKey:o,fill:h,fillOpacity:p,stroke:u,strokeWidth:m,strokeOpacity:g,shape:s.shape,size:s.size,highlighted:e,seriesId:this.id}):void 0;l.fill=y?.fill??h,l.stroke=y?.stroke??u,l.strokeWidth=y?.strokeWidth??m,l.fillOpacity=r?.fillOpacity??s.fillOpacity??1,l.strokeOpacity=s.strokeOpacity??this.properties.strokeOpacity??1,l.size=y?.size??s.size;const{x:f,y:M}=c.point;l.translationX=f,l.translationY=M,l.visible=a&&l.size>0&&!isNaN(f)&&!isNaN(M)})}updateLabels(){const{label:t}=this.properties;this.labelSelection.update(this.nodeData).each((e,i)=>{t.enabled&&i.label?(e.x=i.label.x,e.y=i.label.y,e.fill=t.color,e.fontFamily=t.fontFamily,e.fontSize=t.fontSize,e.fontStyle=t.fontStyle,e.fontWeight=t.fontWeight,e.text=i.label.text,e.textAlign=i.label.textAlign,e.textBaseline=i.label.textBaseline,e.visible=!0):e.visible=!1})}getTooltipHtml(t){if(!this.properties.isValid())return La.EMPTY_TOOLTIP_CONTENT;const{id:e}=this,{angleKey:i,radiusKey:o,angleName:s,radiusName:a,marker:n,tooltip:r}=this.properties,{datum:l,angleValue:c,radiusValue:h,itemId:p}=t,u=typeof c=="number"?Yu(c):String(c),m=typeof h=="number"?Yu(h):String(h),g=ju(a),y=ju(`${u}: ${m}`),{itemStyler:f,fill:M,fillOpacity:b,stroke:S,strokeWidth:x=this.properties.strokeWidth,strokeOpacity:N,shape:v,size:D}=n,{fill:I}=(f&&this.ctx.callbackCache.call(f,{datum:l,angleKey:i,radiusKey:o,fill:M,fillOpacity:b,stroke:S,strokeWidth:x,strokeOpacity:N,shape:v,size:D,highlighted:!1,seriesId:e}))??{fill:M};return r.toTooltipHtml({title:g,content:y,backgroundColor:I},{datum:l,angleKey:i,angleName:s,radiusKey:o,radiusName:a,title:g,color:I,seriesId:e,itemId:p})}getLegendData(t){if(!this.data?.length||!this.properties.isValid()||t!=="category")return[];const{radiusKey:e,radiusName:i,stroke:o,strokeWidth:s,strokeOpacity:a,lineDash:n,visible:r,marker:l}=this.properties;return[{legendType:"category",id:this.id,itemId:e,seriesId:this.id,enabled:r,label:{text:i??e},symbols:[{marker:{shape:l.shape,fill:this.getMarkerFill()??l.stroke??o??"rgba(0, 0, 0, 0)",stroke:l.stroke??o??"rgba(0, 0, 0, 0)",fillOpacity:l.fillOpacity??1,strokeOpacity:l.strokeOpacity??a??1,strokeWidth:l.strokeWidth??0,enabled:l.enabled||s<=0},line:{stroke:o,strokeOpacity:a,strokeWidth:s,lineDash:n}}]}]}onLegendItemClick(t){const{enabled:e,itemId:i,series:o}=t;o.id===this.id&&this.toggleSeriesItem(i,e)}onLegendItemDoubleClick(t){const{enabled:e,itemId:i,series:o,numVisibleItems:s}=t,n=o.id===this.id||e&&s===1;this.toggleSeriesItem(i,n)}pickNodeClosestDatum(t){const{x:e,y:i}=t,{rootGroup:o,nodeData:s,centerX:a,centerY:n}=this,r=o.transformPoint(e,i),l=this.radius;if(Math.sqrt((e-a)**2+(i-n)**2)>l+this.properties.marker.size)return;let h=1/0,p;for(const u of s){const{point:{x:m=NaN,y:g=NaN}={}}=u;if(isNaN(m)||isNaN(g))continue;const y=Math.sqrt((r.x-m-a)**2+(r.y-g-n)**2);y<h&&(h=y,p=u)}if(p){const u=Math.max(h-(p.point?.size??0),0);return{datum:p,distance:u}}}async computeLabelsBBox(){const{label:t}=this.properties;await this.maybeRefreshNodeData();const e=[],i=new F0;return this.nodeData.forEach(o=>{if(!t.enabled||!o.label)return;i.text=o.label.text,i.x=o.label.x,i.y=o.label.y,i.setFont(t),i.setAlign(o.label);const s=i.computeBBox();e.push(s)}),e.length===0?null:P0.merge(e)}getLineNode(){return this.lineSelection.nodes()[0]}beforePathAnimation(){const t=this.getLineNode();t.fill=void 0,t.lineJoin="round",t.lineCap="round",t.pointerEvents=V0.None,t.stroke=this.properties.stroke,t.strokeWidth=this.getStrokeWidth(this.properties.strokeWidth),t.strokeOpacity=this.properties.strokeOpacity,t.lineDash=this.properties.lineDash,t.lineDashOffset=this.properties.lineDashOffset}getLinePoints(){const{nodeData:t,resetInvalidToZero:e}=this,{connectMissingData:i}=this.properties;if(t.length===0)return[];const o=this.axes[Ge.Y],a=this.axes[Ge.X]?.isReversed(),r=o?.isReversed()&&!a?[...t].reverse():t,l=[];let c=!1,h;return r.forEach((p,u)=>{let{x:m,y:g}=p.point;const y=isNaN(m)||isNaN(g);y||(h??(h=p)),y&&!i&&(m=0,g=0);const f=u===0||!e&&!i&&(y||c);l.push({x:m,y:g,moveTo:f}),c=y}),h!==void 0&&l.push({x:h.point.x,y:h.point.y,moveTo:!1}),l}animateSinglePath(t,e,i){const{path:o}=t;o.clear(!0);const s=this.getAxisInnerRadius(),a=this.axes[Ge.Y],r=a?.isReversed()?this.radius+s-a?.scale.convert(0):s;e.forEach(l=>{const{x:c,y:h,arc:p,radius:u=0,startAngle:m=0,endAngle:g=0,moveTo:y}=l,f=Math.atan2(h,c),M=r*Math.cos(f),b=r*Math.sin(f),S=i,x=M*(1-S)+c*S,N=b*(1-S)+h*S;p?o.arc(c,h,u,m,g):y?o.moveTo(x,N):o.lineTo(x,N)}),t.checkPathDirty()}animatePaths(t){const e=this.getLinePoints();this.animateSinglePath(this.getLineNode(),e,t)}animateEmptyUpdateReady(){const{itemSelection:t,labelSelection:e}=this,{animationManager:i}=this.ctx;this.beforePathAnimation(),i.animate({id:`${this.id}_'path`,groupId:this.id,from:0,to:1,phase:"initial",collapsable:!1,onUpdate:o=>this.animatePaths(o),onStop:()=>this.animatePaths(1)}),E0(this,i,"added",t),L0(this,"labels",i,e)}animateWaitingUpdateReady(t){super.animateWaitingUpdateReady(t),this.resetPaths()}animateReadyResize(t){super.animateReadyResize(t),this.resetPaths()}resetPaths(){const t=this.getLineNode();if(t){const{path:e}=t,i=this.getLinePoints();t.fill=void 0,t.stroke=this.properties.stroke,t.strokeWidth=this.getStrokeWidth(this.properties.strokeWidth),t.strokeOpacity=this.properties.strokeOpacity,t.lineDash=this.properties.lineDash,t.lineDashOffset=this.properties.lineDashOffset,e.clear(!0),i.forEach(({x:o,y:s,moveTo:a})=>{a?e.moveTo(o,s):e.lineTo(o,s)}),t.checkPathDirty()}}getFormattedMarkerStyle(t){const{angleKey:e,radiusKey:i}=this.properties;return this.getMarkerStyle(this.properties.marker,{datum:t,angleKey:e,radiusKey:i,highlighted:!0})}computeFocusBounds(t){return w0(this,t)}};Al.className="RadarSeries";import{_ModuleSupport as G0}from"ag-charts-community";var{RATIO:W0,COLOR_STRING:j0,Validate:Xu}=G0,Tl=class extends Et{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1}};d([Xu(j0)],Tl.prototype,"fill",2),d([Xu(W0)],Tl.prototype,"fillOpacity",2);var{Group:Y0,Path:X0,PointerEvents:Z0,Selection:Q0}=g0,{ChartAxisDirection:Zu}=Fu,kl=class extends Al{constructor(t){super(t),this.properties=new Tl,this.resetInvalidToZero=!0;const e=new Y0;e.zIndexSubOrder=[()=>this._declarationOrder,0],this.contentGroup.append(e),this.areaSelection=Q0.select(e,X0)}updatePathSelections(){const t=this.visible?[!0]:[];this.areaSelection.update(t),super.updatePathSelections()}getAreaNode(){return this.areaSelection.nodes()[0]}getMarkerFill(t){return t?.fill??this.properties.marker.fill??this.properties.fill}beforePathAnimation(){super.beforePathAnimation();const t=this.getAreaNode();t.fill=this.properties.fill,t.fillOpacity=this.properties.fillOpacity,t.pointerEvents=Z0.None,t.stroke=void 0}animatePaths(t){super.animatePaths(t),this.animateSinglePath(this.getAreaNode(),this.getAreaPoints(),t)}getAreaPoints(){const t=this.getLinePoints(),e=n=>{const r=this.axes[n];return r instanceof Fu.PolarAxis?r:void 0},i=e(Zu.Y),o=e(Zu.X);if(!i?.isReversed())return t;const{points:a=[]}=o?.getAxisLinePoints?.()??{};return t.concat(...a)}resetPaths(){super.resetPaths();const t=this.getAreaNode();if(t){const{path:e}=t,i=this.getAreaPoints();t.fill=this.properties.fill,t.fillOpacity=this.properties.fillOpacity,t.stroke=void 0,t.lineDash=this.properties.lineDash,t.lineDashOffset=this.properties.lineDashOffset,t.lineJoin=t.lineCap="round",e.clear(!0),i.forEach(({x:o,y:s,moveTo:a,arc:n,radius:r=0,startAngle:l=0,endAngle:c=0})=>{n?e.arc(o,s,r,l,c):a?e.moveTo(o,s):e.lineTo(o,s)}),e.closePath(),t.checkPathDirty()}}};kl.className="RadarAreaSeries",kl.type="radar-area";var{markerPaletteFactory:$0}=d0,q0={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radar-area",instanceConstructor:kl,tooltipDefaults:{range:"nearest"},defaultAxes:[{type:Bu.POLAR_AXIS_TYPE.ANGLE_CATEGORY},{type:Bu.POLAR_AXIS_TYPE.RADIUS_NUMBER}],themeTemplate:u0,paletteFactory:t=>{const{marker:e}=$0(t);return{stroke:e.stroke,fill:e.fill,marker:e}}};import{_Theme as Qu}from"ag-charts-community";var Ol=class extends Al{updatePathSelections(){this.lineSelection.update(this.visible?[!0]:[])}};Ol.className="RadarLineSeries",Ol.type="radar-line";var J0={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radar-line",instanceConstructor:Ol,tooltipDefaults:{range:"nearest"},defaultAxes:[{type:Qu.POLAR_AXIS_TYPE.ANGLE_CATEGORY},{type:Qu.POLAR_AXIS_TYPE.RADIUS_NUMBER}],themeTemplate:p0,paletteFactory:({takeColors:t})=>{const{fills:[e],strokes:[i]}=t(1);return{stroke:e,marker:{fill:e,stroke:i}}}};import{_Theme as $u}from"ag-charts-community";import{_ModuleSupport as Ra,_Scale as tT,_Scene as eT,_Util as iT}from"ag-charts-community";import{_ModuleSupport as oT,_Scene as sT}from"ag-charts-community";var{Label:aT}=sT,{SeriesProperties:nT,SeriesTooltip:rT,Validate:Tt,COLOR_STRING:qu,DEGREE:lT,FUNCTION:cT,LINE_DASH:hT,NUMBER:dT,OBJECT:Ju,POSITIVE_NUMBER:Ll,RATIO:tg,STRING:ns}=oT,St=class extends nT{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new aT,this.tooltip=new rT}};d([Tt(ns)],St.prototype,"angleKey",2),d([Tt(ns)],St.prototype,"radiusKey",2),d([Tt(ns,{optional:!0})],St.prototype,"angleName",2),d([Tt(ns,{optional:!0})],St.prototype,"radiusName",2),d([Tt(qu)],St.prototype,"fill",2),d([Tt(tg)],St.prototype,"fillOpacity",2),d([Tt(qu)],St.prototype,"stroke",2),d([Tt(Ll)],St.prototype,"strokeWidth",2),d([Tt(tg)],St.prototype,"strokeOpacity",2),d([Tt(hT)],St.prototype,"lineDash",2),d([Tt(Ll)],St.prototype,"lineDashOffset",2),d([Tt(Ll)],St.prototype,"cornerRadius",2),d([Tt(cT,{optional:!0})],St.prototype,"itemStyler",2),d([Tt(lT)],St.prototype,"rotation",2),d([Tt(ns,{optional:!0})],St.prototype,"stackGroup",2),d([Tt(dT,{optional:!0})],St.prototype,"normalizedTo",2),d([Tt(Ju)],St.prototype,"label",2),d([Tt(Ju)],St.prototype,"tooltip",2);import{_Scene as pT}from"ag-charts-community";var{SectorBox:eg,motion:uT}=pT;function gT(t,e,i){if(i==="updated"){if(t.previousDatum==null||isNaN(t.previousDatum.innerRadius)||isNaN(t.previousDatum.outerRadius))return"added";if(isNaN(e.innerRadius)||isNaN(e.outerRadius))return"removed"}return i==="added"&&t.previousDatum!=null?"updated":i}function ig(t){return{toFn:(o,s,a)=>{let n,r,l,c,h;return a==="removed"?(n=t,r=t,l=s.innerRadius,c=s.outerRadius,h=new eg(n,r,l,c)):(n=s.startAngle,r=s.endAngle,l=isNaN(s.innerRadius)?o.innerRadius:s.innerRadius,c=isNaN(s.outerRadius)?o.outerRadius:s.outerRadius,h=s.clipSector),{startAngle:n,endAngle:r,innerRadius:l,outerRadius:c,clipSector:h}},fromFn:(o,s,a)=>{a=gT(o,s,a);let n,r,l,c,h;a==="removed"||a==="updated"?(n=o.startAngle,r=o.endAngle,l=o.innerRadius,c=o.outerRadius,h=o.clipSector):(n=t,r=t,l=s.innerRadius,c=s.outerRadius),h??(h=new eg(n,r,l,c));const p=uT.NODE_UPDATE_STATE_TO_PHASE_MAPPING[a];return{startAngle:n,endAngle:r,innerRadius:l,outerRadius:c,clipSector:h,phase:p}}}}function yT(t,e){return{centerX:0,centerY:0,innerRadius:e.innerRadius,outerRadius:e.outerRadius,startAngle:e.startAngle,endAngle:e.endAngle,clipSector:e.clipSector}}var{ChartAxisDirection:Ee,PolarAxis:mT,diff:fT,isDefined:xT,groupAccumulativeValueProperty:og,keyProperty:ST,mergeDefaults:MT,normaliseGroupTo:bT,valueProperty:DT,fixNumericExtent:NT,resetLabelFn:vT,seriesLabelFadeInAnimation:IT,seriesLabelFadeOutAnimation:AT,animationValidation:TT,isFiniteNumber:kT}=Ra,{BandScale:OT}=tT,{Sector:LT,SectorBox:ET,motion:sg}=eT,{angleBetween:RT,isNumber:_T,sanitizeHtml:ag}=iT,CT=class extends Ra.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},El=class extends Ra.PolarSeries{constructor(t){super({moduleCtx:t,useLabelLayer:!0,canHaveAxes:!0,animationResetFns:{item:yT,label:vT}}),this.properties=new St,this.NodeEvent=CT,this.groupScale=new OT,this.circleCache={r:0,cx:0,cy:0}}nodeFactory(){return new LT}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager?.addListener("legend-item-click",t=>this.onLegendItemClick(t)),this.ctx.chartEventManager?.addListener("legend-item-double-click",t=>this.onLegendItemDoubleClick(t)))}getSeriesDomain(t){const{axes:e,dataModel:i,processedData:o}=this;if(!o||!i)return[];if(t===Ee.X){const s=e[Ee.X],a=i.getDomain(this,"angleValue-end","value",o),n=[a[0]>0?0:a[0],a[1]<0?0:a[1]];return NT(n,s)}else return i.getDomain(this,"radiusValue","key",o)}async processData(t){const{angleKey:e,radiusKey:i,normalizedTo:o,visible:s}=this.properties,a=!this.ctx.animationManager.isSkipped();if(!this.properties.isValid()||!(s||a))return;const n=this.getStackId(),r=`${n}-trailing`,l=[];xT(o)&&l.push(bT([n,r],Math.abs(o),"range")),a&&(this.processedData&&l.push(fT(this.processedData)),l.push(TT()));const c=this.visible||!a?{}:{forceValue:0},h=this.axes[Ee.Y]?.scale.type,p=this.axes[Ee.X]?.scale.type;await this.requestDataModel(t,this.data,{props:[ST(i,h,{id:"radiusValue"}),DT(e,p,{id:"angleValue-raw",invalidValue:null,...c}),...og(e,"normal","current",{id:"angleValue-end",rangeId:"angleValue-range",invalidValue:null,groupId:n,separateNegative:!0,...c},p),...og(e,"trailing","current",{id:"angleValue-start",invalidValue:null,groupId:r,separateNegative:!0,...c},p),...l]}),this.animationState.transition("updateData")}didCircleChange(){const t=this.radius,e=this.centerX,i=this.centerY,o=this.circleCache;return t===o.r&&e===o.cx&&i===o.cy?!1:(this.circleCache={r:t,cx:e,cy:i},!0)}async maybeRefreshNodeData(){if(!this.didCircleChange()&&!this.nodeDataRefresh)return;const{nodeData:e=[]}=await this.createNodeData()??{};this.nodeData=e,this.nodeDataRefresh=!1}getAxisInnerRadius(){const t=this.axes[Ee.Y];return t instanceof mT?this.radius*t.innerRadiusRatio:0}async createNodeData(){const{processedData:t,dataModel:e}=this;if(!t||!e||!this.properties.isValid())return;const i=this.axes[Ee.X],o=this.axes[Ee.Y],s=i?.scale,a=o?.scale;if(!s||!a)return;const n=e.resolveProcessedDataIndexById(this,"angleValue-start"),r=e.resolveProcessedDataIndexById(this,"angleValue-end"),l=e.resolveProcessedDataIndexById(this,"angleValue-range"),c=e.resolveProcessedDataIndexById(this,"angleValue-raw");let h=0;o instanceof Si&&(h=o.groupPaddingInner);const{groupScale:p}=this,{index:u,visibleGroupCount:m}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);p.domain=Array.from({length:m}).map((O,T)=>String(T)),p.range=[0,Math.abs(a.bandwidth??0)],p.paddingInner=m>1?h:0;const g=p.bandwidth>=1?p.bandwidth:p.rawBandwidth,y=i.isReversed(),f=o.isReversed(),M=f?this.radius:this.getAxisInnerRadius(),S=(f?this.getAxisInnerRadius():this.radius)+M,{angleKey:x,radiusKey:N,angleName:v,radiusName:D,label:I}=this.properties,A=(O,T,E,_)=>{const R=this.getLabelText(I,{value:T,datum:O,angleKey:x,radiusKey:N,angleName:v,radiusName:D},C=>kT(C)?C.toFixed(2):String(C));if(R)return{x:E,y:_,text:R,textAlign:"center",textBaseline:"middle"}},k=[],L={itemId:N,nodeData:k,labelData:k};return this.visible&&t.data.forEach((O,T)=>{const{datum:E,keys:_,values:R,aggValues:C}=O,w=_[0],P=R[c],B=P>=0&&!Object.is(P,-0),z=R[n],V=R[r],U=C?.[l][B?1:0]??0,Q=B===y;let H=s.convert(z,{clampMode:"clamped"}),K=s.convert(V,{clampMode:"clamped"}),j=s.convert(0,{clampMode:"clamped"}),st=s.convert(U,{clampMode:"clamped"});Q&&([j,st]=[st,j],[H,K]=[K,H]);const rt=S-a.convert(w)+p.convert(String(u)),Mt=rt+g,bt=(rt+Mt)/2,$t=H+RT(H,K)/2,Xt=Math.cos($t)*bt,Ut=Math.sin($t)*bt,ot=this.properties.label.enabled?A(E,P,Xt,Ut):void 0,qt=new ET(H,K,rt,Mt);k.push({series:this,datum:E,point:{x:Xt,y:Ut,size:0},midPoint:{x:Xt,y:Ut},label:ot,angleValue:P,radiusValue:w,innerRadius:rt,outerRadius:Mt,startAngle:j,endAngle:st,clipSector:qt,reversed:Q,index:T})}),L}async update({seriesRect:t}){const e=this.checkResize(t);await this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updateSectorSelection(this.itemSelection,!1),this.updateSectorSelection(this.highlightSelection,!0),this.updateLabels(),e&&this.animationState.transition("resize"),this.animationState.transition("update")}updateSectorSelection(t,e){let i=[];if(e){const g=this.ctx.highlightManager?.getActiveHighlight();g?.datum&&g.series===this&&(i=[g])}else i=this.nodeData;const{fill:o,fillOpacity:s,stroke:a,strokeOpacity:n,strokeWidth:r,lineDash:l,lineDashOffset:c,cornerRadius:h,angleKey:p,radiusKey:u}=MT(e?this.properties.highlightStyle.item:null,this.properties),m=g=>g.radiusValue;t.update(i,void 0,m).each((g,y)=>{const f=this.properties.itemStyler?this.ctx.callbackCache.call(this.properties.itemStyler,{seriesId:this.id,datum:y.datum,highlighted:e,angleKey:p,radiusKey:u,fill:o,fillOpacity:s,stroke:a,strokeWidth:r,strokeOpacity:n,lineDash:l,lineDashOffset:c,cornerRadius:h}):void 0;g.fill=f?.fill??o,g.fillOpacity=f?.fillOpacity??s,g.stroke=f?.stroke??a,g.strokeWidth=f?.strokeWidth??r,g.strokeOpacity=f?.strokeOpacity??n,g.lineDash=f?.lineDash??l,g.lineDashOffset=f?.lineDashOffset??c,g.lineJoin="round",g.inset=a!=null?(f?.strokeWidth??r)/2:0,g.startInnerCornerRadius=y.reversed?f?.cornerRadius??h:0,g.startOuterCornerRadius=y.reversed?f?.cornerRadius??h:0,g.endInnerCornerRadius=y.reversed?0:f?.cornerRadius??h,g.endOuterCornerRadius=y.reversed?0:f?.cornerRadius??h,e&&(g.startAngle=y.startAngle,g.endAngle=y.endAngle,g.clipSector=y.clipSector,g.innerRadius=y.innerRadius,g.outerRadius=y.outerRadius)})}updateLabels(){const{label:t}=this.properties;this.labelSelection.update(this.nodeData).each((e,i)=>{t.enabled&&i.label?(e.x=i.label.x,e.y=i.label.y,e.fill=t.color,e.fontFamily=t.fontFamily,e.fontSize=t.fontSize,e.fontStyle=t.fontStyle,e.fontWeight=t.fontWeight,e.text=i.label.text,e.textAlign=i.label.textAlign,e.textBaseline=i.label.textBaseline,e.visible=!0):e.visible=!1})}getBarTransitionFunctions(){const t=this.axes[Ee.X]?.scale;let e=0;if(!t)return ig(e);const i=Math.min(t.domain[0],t.domain[1]),o=Math.max(t.domain[0],t.domain[1]);return i<=0&&o>=0&&(e=t.convert(0)),ig(e)}animateEmptyUpdateReady(){const{labelSelection:t}=this,e=this.getBarTransitionFunctions();sg.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],e),IT(this,"labels",this.ctx.animationManager,t)}animateClearingUpdateEmpty(){const{itemSelection:t}=this,{animationManager:e}=this.ctx,i=this.getBarTransitionFunctions();sg.fromToMotion(this.id,"datums",e,[t],i),AT(this,"labels",e,this.labelSelection)}getTooltipHtml(t){const{id:e,axes:i,dataModel:o}=this,{angleKey:s,angleName:a,radiusKey:n,radiusName:r,fill:l,fillOpacity:c,stroke:h,strokeWidth:p,strokeOpacity:u,lineDash:m,lineDashOffset:g,cornerRadius:y,itemStyler:f,tooltip:M}=this.properties,{angleValue:b,radiusValue:S,datum:x,itemId:N}=t,v=i[Ee.X],D=i[Ee.Y];if(!this.properties.isValid()||!(v&&D&&_T(b))||!o)return Ra.EMPTY_TOOLTIP_CONTENT;const I=v.formatDatum(b),A=D.formatDatum(S),k=ag(a),L=ag(`${A}: ${I}`),{fill:O}=(f&&this.ctx.callbackCache.call(f,{highlighted:!1,seriesId:e,datum:x,angleKey:s,radiusKey:n,fill:l,fillOpacity:c,stroke:h,strokeWidth:p,strokeOpacity:u,lineDash:m,lineDashOffset:g,cornerRadius:y}))??{fill:l};return M.toTooltipHtml({title:k,backgroundColor:l,content:L},{seriesId:e,datum:x,color:O,title:k,angleKey:s,radiusKey:n,angleName:a,radiusName:r,angleValue:b,itemId:N,radiusValue:S})}pickNodeClosestDatum(t){return this.pickNodeNearestDistantObject(t,this.itemSelection.nodes())}getLegendData(t){if(!this.data?.length||!this.properties.isValid()||t!=="category")return[];const{angleKey:e,angleName:i,fill:o,stroke:s,fillOpacity:a,strokeOpacity:n,strokeWidth:r,visible:l}=this.properties;return[{legendType:"category",id:this.id,itemId:e,seriesId:this.id,enabled:l,label:{text:i??e},symbols:[{marker:{fill:o??"rgba(0, 0, 0, 0)",stroke:s??"rgba(0, 0, 0, 0)",fillOpacity:a??1,strokeOpacity:n??1,strokeWidth:r}}]}]}onLegendItemClick(t){const{enabled:e,itemId:i,series:o}=t;o.id===this.id&&this.toggleSeriesItem(i,e)}onLegendItemDoubleClick(t){const{enabled:e,itemId:i,series:o,numVisibleItems:s}=t,n=o.id===this.id||e&&s===1;this.toggleSeriesItem(i,n)}computeLabelsBBox(){return null}getStackId(){return`radialBar-stack-${this.seriesGrouping?.groupIndex??this.id}-xValues`}};El.className="RadialBarSeries",El.type="radial-bar";import{_Theme as Rl}from"ag-charts-community";var wT={series:{strokeWidth:0,label:{enabled:!1,fontSize:12,fontFamily:Rl.DEFAULT_FONT_FAMILY,color:Rl.DEFAULT_INVERTED_LABEL_COLOUR}},axes:{[Rl.POLAR_AXIS_TYPE.RADIUS_CATEGORY]:{innerRadiusRatio:.2,groupPaddingInner:.2,paddingInner:.2,paddingOuter:.1}}},PT={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radial-bar",instanceConstructor:El,tooltipDefaults:{range:"exact"},defaultAxes:[{type:$u.POLAR_AXIS_TYPE.ANGLE_NUMBER},{type:$u.POLAR_AXIS_TYPE.RADIUS_CATEGORY}],themeTemplate:wT,paletteFactory:({takeColors:t})=>{const{fills:[e],strokes:[i]}=t(1);return{fill:e,stroke:i}},stackable:!0,groupable:!0};import{_Theme as ng}from"ag-charts-community";import{_ModuleSupport as BT,_Scene as zT}from"ag-charts-community";import{_ModuleSupport as VT}from"ag-charts-community";var{Validate:rg,RATIO:lg}=VT,_l=class extends mt{};d([rg(lg,{optional:!0})],_l.prototype,"columnWidthRatio",2),d([rg(lg,{optional:!0})],_l.prototype,"maxColumnWidthRatio",2);var{ChartAxisDirection:FT,PolarAxis:UT}=BT,{RadialColumnShape:HT,getRadialColumnWidth:KT}=zT,Cl=class extends Tu{constructor(t){super(t,{animationResetFns:{item:QA}}),this.properties=new _l}getStackId(){return`radarColumn-stack-${this.seriesGrouping?.groupIndex??this.id}-yValues`}nodeFactory(){return new HT}getColumnTransitionFunctions(){const t=this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius();return ZA(t)}isRadiusAxisCircle(){const t=this.axes[FT.Y];return t instanceof UT?t.shape==="circle":!1}updateItemPath(t,e,i){t.isBeveled=this.isRadiusAxisCircle(),t.isRadiusAxisReversed=this.isRadiusAxisReversed(),i&&(t.innerRadius=e.innerRadius,t.outerRadius=e.outerRadius,t.startAngle=e.startAngle,t.endAngle=e.endAngle,t.columnWidth=e.columnWidth,t.axisInnerRadius=e.axisInnerRadius,t.axisOuterRadius=e.axisOuterRadius)}getColumnWidth(t,e){const{columnWidthRatio:i=.5,maxColumnWidthRatio:o=.5}=this.properties;return KT(t,e,this.radius,i,o)}};Cl.className="RadialColumnSeries",Cl.type="radial-column";import{_Theme as To}from"ag-charts-community";var GT={series:{columnWidthRatio:.5,maxColumnWidthRatio:.5,strokeWidth:0,label:{enabled:!1,fontSize:12,fontFamily:To.DEFAULT_FONT_FAMILY,color:To.DEFAULT_LABEL_COLOUR}},axes:{[To.POLAR_AXIS_TYPE.ANGLE_CATEGORY]:{shape:To.POLAR_AXIS_SHAPE.CIRCLE,groupPaddingInner:0,paddingInner:0,label:{padding:10}},[To.POLAR_AXIS_TYPE.RADIUS_NUMBER]:{shape:To.POLAR_AXIS_SHAPE.CIRCLE,innerRadiusRatio:.5}}},WT={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radial-column",instanceConstructor:Cl,tooltipDefaults:{range:"exact"},defaultAxes:[{type:ng.POLAR_AXIS_TYPE.ANGLE_CATEGORY},{type:ng.POLAR_AXIS_TYPE.RADIUS_NUMBER}],themeTemplate:GT,paletteFactory:({takeColors:t})=>{const{fills:[e],strokes:[i]}=t(1);return{fill:e,stroke:i}},stackable:!0,groupable:!0};import{_ModuleSupport as jT,_Theme as _a}from"ag-charts-community";import{_ModuleSupport as Ca,_Scene as wl,_Util as YT}from"ag-charts-community";import{_ModuleSupport as XT,_Scene as ZT}from"ag-charts-community";var{DropShadow:QT,Label:$T}=ZT,{CartesianSeriesProperties:qT,InterpolationProperties:JT,SeriesMarker:tk,SeriesTooltip:ek,Validate:dt,BOOLEAN:ik,COLOR_STRING:cg,LINE_DASH:ok,OBJECT:rs,PLACEMENT:sk,POSITIVE_NUMBER:Pl,RATIO:hg,STRING:Vi}=XT,Bl=class extends $T{constructor(){super(...arguments),this.placement="outside",this.padding=6}};d([dt(sk)],Bl.prototype,"placement",2),d([dt(Pl)],Bl.prototype,"padding",2);var pt=class extends qT{constructor(){super(...arguments),this.fill="#99CCFF",this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new JT,this.shadow=new QT().set({enabled:!1}),this.marker=new tk,this.label=new Bl,this.tooltip=new ek,this.connectMissingData=!1}};d([dt(Vi)],pt.prototype,"xKey",2),d([dt(Vi)],pt.prototype,"yLowKey",2),d([dt(Vi)],pt.prototype,"yHighKey",2),d([dt(Vi,{optional:!0})],pt.prototype,"xName",2),d([dt(Vi,{optional:!0})],pt.prototype,"yName",2),d([dt(Vi,{optional:!0})],pt.prototype,"yLowName",2),d([dt(Vi,{optional:!0})],pt.prototype,"yHighName",2),d([dt(cg)],pt.prototype,"fill",2),d([dt(hg)],pt.prototype,"fillOpacity",2),d([dt(cg)],pt.prototype,"stroke",2),d([dt(Pl)],pt.prototype,"strokeWidth",2),d([dt(hg)],pt.prototype,"strokeOpacity",2),d([dt(ok)],pt.prototype,"lineDash",2),d([dt(Pl)],pt.prototype,"lineDashOffset",2),d([dt(rs)],pt.prototype,"interpolation",2),d([dt(rs)],pt.prototype,"shadow",2),d([dt(rs)],pt.prototype,"marker",2),d([dt(rs)],pt.prototype,"label",2),d([dt(rs)],pt.prototype,"tooltip",2),d([dt(ik)],pt.prototype,"connectMissingData",2);var{valueProperty:dg,keyProperty:ak,ChartAxisDirection:oe,mergeDefaults:nk,updateLabelNode:rk,fixNumericExtent:pg,AreaSeriesTag:zl,buildResetPathFn:lk,resetLabelFn:ck,resetMarkerFn:hk,resetMarkerPositionFn:ug,pathSwipeInAnimation:dk,resetMotion:pk,markerSwipeScaleInAnimation:uk,seriesLabelFadeInAnimation:gk,animationValidation:yk,diff:mk,updateClipPath:gg,isFiniteNumber:fk,computeMarkerFocusBounds:yg,plotPath:wa,pathRanges:mg,pathRangePoints:Vl,pathRangePointsReverse:xk}=Ca,{getMarker:Sk,PointerEvents:Fl}=wl,{sanitizeHtml:Fi,extent:Mk}=YT,bk=class extends Ca.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.xKey,this.yLowKey=o.properties.yLowKey,this.yHighKey=o.properties.yHighKey}},Ul=class extends Ca.CartesianSeries{constructor(t){super({moduleCtx:t,hasMarkers:!0,pathsPerSeries:2,directionKeys:{[oe.X]:["xKey"],[oe.Y]:["yLowKey","yHighKey"]},directionNames:{[oe.X]:["xName"],[oe.Y]:["yLowName","yHighName","yName"]},animationResetFns:{path:lk({getOpacity:()=>this.getOpacity()}),label:ck,marker:(e,i)=>({...hk(e),...ug(e,i)})}}),this.properties=new pt,this.NodeEvent=bk}async processData(t){if(!this.properties.isValid()||!this.visible)return;const{xKey:e,yLowKey:i,yHighKey:o}=this.properties,s=this.axes[oe.X]?.scale,a=this.axes[oe.Y]?.scale,{xScaleType:n,yScaleType:r}=this.getScaleInformation({xScale:s,yScale:a}),l=[],c=!this.ctx.animationManager.isSkipped();!this.ctx.animationManager.isSkipped()&&this.processedData&&l.push(mk(this.processedData)),c&&l.push(yk()),await this.requestDataModel(t,this.data,{props:[ak(e,n,{id:"xValue"}),dg(i,r,{id:"yLowValue",invalidValue:void 0}),dg(o,r,{id:"yHighValue",invalidValue:void 0}),...l]}),this.animationState.transition("updateData")}getSeriesDomain(t){const{processedData:e,dataModel:i,axes:o}=this;if(!(e&&i))return[];const{domain:{keys:[s],values:a}}=e;if(t===oe.X){const n=i.resolveProcessedDataDefById(this,"xValue"),r=o[oe.X];return n?.def.type==="key"&&n.def.valueType==="category"?s:pg(Mk(s),r)}else{const n=i.resolveProcessedDataIndexById(this,"yLowValue"),r=a[n],l=i.resolveProcessedDataIndexById(this,"yHighValue"),c=a[l],h=[r[0]>c[0]?c[0]:r[0],c[1]<r[1]?r[1]:c[1]];return pg(h)}}async createNodeData(){const{data:t,dataModel:e,axes:i,visible:o}=this,s=i[oe.X],a=i[oe.Y];if(!(t&&o&&s&&a&&e))return;const n=s.scale,r=a.scale,{xKey:l,yLowKey:c,yHighKey:h,connectMissingData:p,marker:u}=this.properties,m=`${c}-${h}`,g=(n.bandwidth??0)/2,y=e.resolveProcessedDataDefsByIds(this,["xValue","yHighValue","yLowValue"]),f=(L,O,T,E)=>{const _=n.convert(L)+g,R=r.convert(O),C=r.convert(T),{size:w}=u;return[{point:{x:_,y:R,moveTo:E},size:w,itemId:"high",yValue:O,xValue:L,enabled:!0},{point:{x:_,y:C,moveTo:E},size:w,itemId:"low",yValue:T,xValue:L,enabled:!1}]},M=[],b=[],S={itemId:m,highPoints:[],lowPoints:[]},x={itemId:m,highPoints:[],lowPoints:[]},N={itemId:m,labelData:M,nodeData:b,fillData:x,strokeData:S,scales:this.calculateScaling(),visible:this.visible};if(!this.visible)return N;const v=x.highPoints,D=x.lowPoints,I=S.highPoints,A=S.lowPoints;let k=!0;return this.processedData?.data.forEach(({keys:L,datum:O,values:T},E)=>{const _=e.resolveProcessedDataDefsValues(y,{keys:L,values:T}),{xValue:R,yHighValue:C,yLowValue:w}=_,B=C==null||w==null?[]:f(R,C,w,!1),z=w>C;B.forEach(({point:{x:K,y:j},enabled:st,size:Ft,itemId:rt="",yValue:Mt})=>{b.push({index:E,series:this,itemId:rt,datum:O,midPoint:{x:K,y:j},yHighValue:C,yLowValue:w,xValue:R,xKey:l,yLowKey:c,yHighKey:h,point:{x:K,y:j,size:Ft},enabled:st});const bt=this.createLabelData({point:{x:K,y:j},value:Mt,yLowValue:w,yHighValue:C,itemId:rt,inverted:z,datum:O,series:this});M.push(bt)});const V=R!=null,U=C!=null&&w!=null,[Q,H]=f(R,C??0,w??0,k);V&&U?(v.push(Q),D.push(H),I.push(Q),A.push(H),k=!1):p||(k=!0)}),N}createLabelData({point:t,value:e,itemId:i,inverted:o,datum:s,series:a}){const{xKey:n,yLowKey:r,yHighKey:l,xName:c,yName:h,yLowName:p,yHighName:u,label:m}=this.properties,{placement:g,padding:y=10}=m;let f=i;o&&(f=i==="low"?"high":"low");const M=g==="outside"&&f==="high"||g==="inside"&&f==="low"?-1:1;return{x:t.x,y:t.y+y*M,series:a,itemId:i,datum:s,text:this.getLabelText(m,{value:e,datum:s,itemId:i,xKey:n,yLowKey:r,yHighKey:l,xName:c,yLowName:p,yHighName:u,yName:h},b=>fk(b)?b.toFixed(2):String(b)),textAlign:"center",textBaseline:M===-1?"bottom":"top"}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}markerFactory(){const{shape:t}=this.properties.marker,e=Sk(t);return new e}async updatePathNodes(t){const{opacity:e,visible:i}=t,[o,s]=t.paths,a=this.getStrokeWidth(this.properties.strokeWidth);s.setProperties({tag:zl.Stroke,fill:void 0,lineJoin:s.lineCap="round",pointerEvents:Fl.None,stroke:this.properties.stroke,strokeWidth:a,strokeOpacity:this.properties.strokeOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,opacity:e,visible:i}),o.setProperties({tag:zl.Fill,stroke:void 0,lineJoin:"round",pointerEvents:Fl.None,fill:this.properties.fill,fillOpacity:this.properties.fillOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,strokeOpacity:this.properties.strokeOpacity,fillShadow:this.properties.shadow,strokeWidth:a,opacity:e,visible:i}),gg(this,s),gg(this,o)}async updatePaths(t){this.updateAreaPaths(t.paths,t.contextData)}updateAreaPaths(t,e){this.updateFillPath(t,e),this.updateStrokePath(t,e)}updateFillPath(t,e){const{interpolation:i}=this.properties,{fillData:o}=e,[s]=t;s.path.clear();for(const a of mg(o.highPoints))wa(Vl(o.highPoints,a),s,i),wa(xk(o.lowPoints,a),s,i,!0),s.path.closePath();s.checkPathDirty()}updateStrokePath(t,e){const{interpolation:i}=this.properties,{strokeData:o}=e,[,s]=t;s.path.clear(!0);for(const a of mg(o.highPoints))wa(Vl(o.highPoints,a),s,i),wa(Vl(o.lowPoints,a),s,i);s.checkPathDirty()}async updateMarkerSelection(t){const{nodeData:e,markerSelection:i}=t;return this.properties.marker.isDirty()&&(i.clear(),i.cleanup()),i.update(this.properties.marker.enabled?e:[])}async updateMarkerNodes(t){const{markerSelection:e,isHighlight:i}=t,{xKey:o,yLowKey:s,yHighKey:a,marker:n,fill:r,stroke:l,strokeWidth:c,fillOpacity:h,strokeOpacity:p}=this.properties,u=nk(i&&this.properties.highlightStyle.item,n.getStyle(),{fill:r,fillOpacity:h,stroke:l,strokeWidth:c,strokeOpacity:p});e.each((m,g)=>{this.updateMarkerStyle(m,n,{datum:g,highlighted:i,xKey:o,yHighKey:a,yLowKey:s},u)}),i||this.properties.marker.markClean()}async updateLabelSelection(t){const{labelData:e,labelSelection:i}=t;return i.update(e,o=>{o.tag=zl.Label,o.pointerEvents=Fl.None})}async updateLabelNodes(t){t.labelSelection.each((e,i)=>{rk(e,this.properties.label,i)})}getHighlightLabelData(t,e){const i=t.filter(o=>o.datum===e.datum);return i.length>0?i:void 0}getHighlightData(t,e){const i=t.filter(o=>o.datum===e.datum);return i.length>0?i:void 0}getTooltipHtml(t){const e=this.axes[oe.X],i=this.axes[oe.Y];if(!this.properties.isValid()||!e||!i)return Ca.EMPTY_TOOLTIP_CONTENT;const{id:o}=this,{xKey:s,yLowKey:a,yHighKey:n,xName:r,yName:l,yLowName:c,yHighName:h,fill:p,tooltip:u}=this.properties,{datum:m,itemId:g,xValue:y,yLowValue:f,yHighValue:M}=t,b=p??"gray",S=Fi(e.formatDatum(y)),x=Fi(i.formatDatum(f)),N=Fi(i.formatDatum(M)),v=r??s,D=c??a,I=h??n,A=Fi(l),k=l?`<b>${Fi(v)}</b>: ${S}<br><b>${Fi(D)}</b>: ${x}<br><b>${Fi(I)}</b>: ${N}<br>`:`${S}: ${x} - ${N}`;return u.toTooltipHtml({title:A,content:k,backgroundColor:b},{seriesId:o,itemId:g,datum:m,xKey:s,yLowKey:a,yHighKey:n,xName:r,yLowName:c,yHighName:h,yName:l,color:b,title:A,yHighValue:M,yLowValue:f})}getLegendData(t){if(t!=="category")return[];const{yLowKey:e,yHighKey:i,yName:o,yLowName:s,yHighName:a,fill:n,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,visible:p,marker:u}=this.properties,m=o??`${s??e} - ${a??i}`;return[{legendType:"category",id:this.id,itemId:`${e}-${i}`,seriesId:this.id,enabled:p,label:{text:`${m}`},symbols:[{marker:{shape:u.shape,fill:u.fill??n,stroke:u.stroke??r,fillOpacity:u.fillOpacity,strokeOpacity:u.strokeOpacity,strokeWidth:u.strokeWidth},line:{stroke:r,strokeOpacity:c,strokeWidth:l,lineDash:h}}]}]}isLabelEnabled(){return this.properties.label.enabled}onDataChange(){}nodeFactory(){return new wl.Group}animateEmptyUpdateReady(t){const{markerSelection:e,labelSelection:i,contextData:o,paths:s}=t,{animationManager:a}=this.ctx;this.updateAreaPaths(s,o),dk(this,a,...s),pk([e],ug),uk(this,a,e),gk(this,"labels",a,i)}animateReadyResize(t){const{contextData:e,paths:i}=t;this.updateAreaPaths(i,e),super.animateReadyResize(t)}animateWaitingUpdateReady(t){const{contextData:e,paths:i}=t;super.animateWaitingUpdateReady(t),this.updateAreaPaths(i,e)}getFormattedMarkerStyle(t){const{xKey:e,yLowKey:i,yHighKey:o}=this.properties;return this.getMarkerStyle(this.properties.marker,{datum:t,xKey:e,yLowKey:i,yHighKey:o,highlighted:!0})}computeFocusBounds(t){const e=yg(this,t),i=yg(this,{...t,datumIndex:t.datumIndex+1});if(e&&i)return wl.BBox.merge([e,i])}};Ul.className="RangeAreaSeries",Ul.type="range-area";import{_Theme as Hl}from"ag-charts-community";var Dk={series:{fillOpacity:.7,nodeClickRange:"nearest",marker:{enabled:!1,size:6,strokeWidth:2},label:{enabled:!1,placement:"outside",padding:10,fontSize:12,fontFamily:Hl.DEFAULT_FONT_FAMILY,color:Hl.DEFAULT_LABEL_COLOUR},interpolation:{type:"linear",tension:1,position:"end"}},axes:{[Hl.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{enabled:!0}}}},{markerPaletteFactory:Nk}=jT,vk={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"range-area",instanceConstructor:Ul,tooltipDefaults:{range:"nearest"},defaultAxes:[{type:_a.CARTESIAN_AXIS_TYPE.NUMBER,position:_a.POSITION.LEFT},{type:_a.CARTESIAN_AXIS_TYPE.CATEGORY,position:_a.POSITION.BOTTOM}],themeTemplate:Dk,paletteFactory:t=>{const{marker:e}=Nk(t);return{fill:e.fill,stroke:e.stroke,marker:e}}};import{_Theme as Pa}from"ag-charts-community";import{_ModuleSupport as Ba,_Scale as Ik,_Scene as Ak,_Util as Kl}from"ag-charts-community";import{_ModuleSupport as Tk,_Scene as kk}from"ag-charts-community";var{DropShadow:Ok,Label:Lk}=kk,{AbstractBarSeriesProperties:Ek,SeriesTooltip:Rk,Validate:ut,COLOR_STRING:fg,FUNCTION:_k,LINE_DASH:Ck,OBJECT:Gl,PLACEMENT:wk,POSITIVE_NUMBER:za,RATIO:xg,STRING:Ui}=Tk,Wl=class extends Lk{constructor(){super(...arguments),this.placement="inside",this.padding=6}};d([ut(wk)],Wl.prototype,"placement",2),d([ut(za)],Wl.prototype,"padding",2);var ft=class extends Ek{constructor(){super(...arguments),this.fill="#99CCFF",this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.shadow=new Ok().set({enabled:!1}),this.label=new Wl,this.tooltip=new Rk}};d([ut(Ui)],ft.prototype,"xKey",2),d([ut(Ui)],ft.prototype,"yLowKey",2),d([ut(Ui)],ft.prototype,"yHighKey",2),d([ut(Ui,{optional:!0})],ft.prototype,"xName",2),d([ut(Ui,{optional:!0})],ft.prototype,"yName",2),d([ut(Ui,{optional:!0})],ft.prototype,"yLowName",2),d([ut(Ui,{optional:!0})],ft.prototype,"yHighName",2),d([ut(fg)],ft.prototype,"fill",2),d([ut(xg)],ft.prototype,"fillOpacity",2),d([ut(fg)],ft.prototype,"stroke",2),d([ut(za)],ft.prototype,"strokeWidth",2),d([ut(xg)],ft.prototype,"strokeOpacity",2),d([ut(Ck)],ft.prototype,"lineDash",2),d([ut(za)],ft.prototype,"lineDashOffset",2),d([ut(za)],ft.prototype,"cornerRadius",2),d([ut(_k,{optional:!0})],ft.prototype,"itemStyler",2),d([ut(Gl)],ft.prototype,"shadow",2),d([ut(Gl)],ft.prototype,"label",2),d([ut(Gl)],ft.prototype,"tooltip",2);var{SeriesNodePickMode:Sg,valueProperty:Mg,keyProperty:Pk,ChartAxisDirection:jl,getRectConfig:Bk,updateRect:zk,checkCrisp:Vk,updateLabelNode:Fk,SMALLEST_KEY_INTERVAL:Uk,LARGEST_KEY_INTERVAL:Hk,diff:Kk,prepareBarAnimationFunctions:bg,midpointStartingBarPosition:Dg,resetBarSelectionsFn:Gk,fixNumericExtent:Ng,seriesLabelFadeInAnimation:vg,resetLabelFn:Wk,animationValidation:jk,createDatumId:Yk,isFiniteNumber:Ig,computeBarFocusBounds:Xk}=Ba,{Rect:Zk,PointerEvents:Qk,motion:Ag}=Ak,{sanitizeHtml:Hi,isNumber:$k,extent:qk}=Kl,{ContinuousScale:Jk}=Ik,tO=class extends Ba.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.xKey,this.yLowKey=o.properties.yLowKey,this.yHighKey=o.properties.yHighKey}},Yl=class extends Ba.AbstractBarSeries{constructor(t){super({moduleCtx:t,pickModes:[Sg.NEAREST_NODE,Sg.EXACT_SHAPE_MATCH],hasHighlightedLabels:!0,directionKeys:{x:["xKey"],y:["yLowKey","yHighKey"]},directionNames:{x:["xName"],y:["yLowName","yHighName","yName"]},datumSelectionGarbageCollection:!1,animationResetFns:{datum:Gk,label:Wk}}),this.properties=new ft,this.NodeEvent=tO}async processData(t){if(!this.properties.isValid())return;const{xKey:e,yLowKey:i,yHighKey:o}=this.properties,s=this.getCategoryAxis()?.scale,a=this.getValueAxis()?.scale,{isContinuousX:n,xScaleType:r,yScaleType:l}=this.getScaleInformation({xScale:s,yScale:a}),c=[];this.ctx.animationManager.isSkipped()||(this.processedData&&c.push(Kk(this.processedData)),c.push(jk()));const h=this.visible?{}:{forceValue:0},{processedData:p}=await this.requestDataModel(t,this.data,{props:[Pk(e,r,{id:"xValue"}),Mg(i,l,{id:"yLowValue",...h}),Mg(o,l,{id:"yHighValue",...h}),...n?[Uk,Hk]:[],...c],groupByKeys:!0});this.smallestDataInterval=p.reduced?.smallestKeyInterval,this.largestDataInterval=p.reduced?.largestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(t){const{processedData:e,dataModel:i,smallestDataInterval:o}=this;if(!(e&&i))return[];const{domain:{keys:[s],values:a}}=e;if(t===this.getCategoryDirection()){const n=i.resolveProcessedDataDefById(this,"xValue");if(n?.def.type==="key"&&n?.def.valueType==="category")return s;const r=Ig(o)?o:0,l=qk(s)??[NaN,NaN],c=this.getCategoryAxis(),h=l[0]+-r,p=l[1]+r;return Ng([h,p],c)}else{const n=i.resolveProcessedDataIndexById(this,"yLowValue"),r=a[n],l=i.resolveProcessedDataIndexById(this,"yHighValue"),c=a[l],h=[r[0]>c[0]?c[0]:r[0],c[1]<r[1]?r[1]:c[1]];return Ng(h)}}async createNodeData(){const{data:t,dataModel:e,groupScale:i,processedData:o,properties:{visible:s}}=this,a=this.getCategoryAxis(),n=this.getValueAxis();if(!(t&&a&&n&&e))return;const r=a.scale,l=n.scale,c=this.getBarDirection()===jl.X,{xKey:h,yLowKey:p,yHighKey:u,fill:m,stroke:g,strokeWidth:y}=this.properties,f=`${p}-${u}`,M={itemId:f,nodeData:[],labelData:[],scales:this.calculateScaling(),visible:this.visible};if(!s)return M;const b=e.resolveProcessedDataIndexById(this,"yLowValue"),S=e.resolveProcessedDataIndexById(this,"yHighValue"),x=e.resolveProcessedDataIndexById(this,"xValue"),{barWidth:N,groupIndex:v}=this.updateGroupScale(a),D=Jk.is(r)?N*-.5:0;return o?.data.forEach(({keys:I,datum:A,values:k},L)=>{k.forEach((O,T)=>{const E=I[x],_=Math.round(r.convert(E))+i.convert(String(v))+D,R=O[b],C=O[S];if(!Kl.isNumber(C)||!Kl.isNumber(R))return;const w=Math.min(R,C),P=Math.max(R,C),B=Math.round(l.convert(w)),V=Math.round(l.convert(P)),U=B,Q=Math.max(y,Math.abs(U-V)),H={x:c?Math.min(V,U):_,y:c?_:Math.min(V,U),width:c?Q:N,height:c?N:Q},K={x:H.x+H.width/2,y:H.y+H.height/2},j=this.createLabelData({rect:H,barAlongX:c,yLowValue:w,yHighValue:P,datum:A[T],series:this}),st={index:L,valueIndex:T,series:this,itemId:f,datum:A[T],xValue:E,yLowValue:R,yHighValue:C,yLowKey:p,yHighKey:u,xKey:h,x:H.x,y:H.y,width:H.width,height:H.height,midPoint:K,fill:m,stroke:g,strokeWidth:y,opacity:1,labels:j};M.nodeData.push(st),M.labelData.push(...j)})}),M}createLabelData({rect:t,barAlongX:e,yLowValue:i,yHighValue:o,datum:s,series:a}){const{xKey:n,yLowKey:r,yHighKey:l,xName:c,yLowName:h,yHighName:p,yName:u,label:m}=this.properties,g={datum:s,xKey:n,yLowKey:r,yHighKey:l,xName:c,yLowName:h,yHighName:p,yName:u},{placement:y,padding:f}=m,b=f*(y==="outside"?1:-1),S={x:t.x+(e?-b:t.width/2),y:t.y+(e?t.height/2:t.height+b),textAlign:e?"left":"center",textBaseline:e?"middle":"bottom",text:this.getLabelText(m,{itemId:"low",value:i,...g},N=>Ig(N)?N.toFixed(2):String(N)),itemId:"low",datum:s,series:a},x={x:t.x+(e?t.width+b:t.width/2),y:t.y+(e?t.height/2:-b),textAlign:e?"right":"center",textBaseline:e?"middle":"top",text:this.getLabelText(m,{itemId:"high",value:o,...g},N=>$k(N)?N.toFixed(2):""),itemId:"high",datum:s,series:a};return y==="outside"&&(S.textAlign=e?"right":"center",S.textBaseline=e?"middle":"top",x.textAlign=e?"left":"center",x.textBaseline=e?"middle":"bottom"),[S,x]}nodeFactory(){return new Zk}async updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t,o=e??[];return i.update(o,void 0,s=>this.getDatumId(s))}async updateDatumNodes(t){const{datumSelection:e,isHighlight:i}=t,{id:o,ctx:s}=this,{yLowKey:a,yHighKey:n,highlightStyle:{item:r}}=this.properties,l=this.axes[jl.X],c=Vk(l?.scale,l?.visibleRange,this.smallestDataInterval,this.largestDataInterval),h=this.getCategoryDirection()===jl.X;e.each((p,u)=>{const{fillOpacity:m,strokeOpacity:g,strokeWidth:y,lineDash:f,lineDashOffset:M,itemStyler:b,shadow:S}=this.properties,x={fill:u.fill,stroke:u.stroke,fillOpacity:m,strokeOpacity:g,lineDash:f,lineDashOffset:M,fillShadow:S,strokeWidth:this.getStrokeWidth(y),cornerRadius:this.properties.cornerRadius},N=h?u.width>0:u.height>0,v=Bk({datum:u,isHighlighted:i,style:x,highlightStyle:r,itemStyler:b,seriesId:o,ctx:s,yLowKey:a,yHighKey:n});v.crisp=c,v.visible=N,zk({rect:p,config:v})})}getHighlightLabelData(t,e){const i=t.filter(o=>o.datum===e.datum);return i.length>0?i:void 0}async updateLabelSelection(t){const e=this.properties.label.enabled?t.labelData:[];return t.labelSelection.update(e,i=>{i.pointerEvents=Qk.None})}async updateLabelNodes(t){t.labelSelection.each((e,i)=>{Fk(e,this.properties.label,i)})}getTooltipHtml(t){const{id:e,ctx:{callbackCache:i}}=this,o=this.getCategoryAxis(),s=this.getValueAxis();if(!this.properties.isValid()||!o||!s)return Ba.EMPTY_TOOLTIP_CONTENT;const{xKey:a,yLowKey:n,yHighKey:r,xName:l,yLowName:c,yHighName:h,yName:p,fill:u,strokeWidth:m,itemStyler:g,tooltip:y,fillOpacity:f,stroke:M,strokeOpacity:b,lineDash:S,lineDashOffset:x,cornerRadius:N}=this.properties,{datum:v,xValue:D,yLowValue:I,yHighValue:A}=t;let k;g&&(k=i.call(g,{highlighted:!1,seriesId:e,datum:v,xKey:a,yLowKey:n,yHighKey:r,fill:u,fillOpacity:f,stroke:M,strokeWidth:m,strokeOpacity:b,lineDash:S,lineDashOffset:x,cornerRadius:N}));const L=k?.fill??u??"gray",O=Hi(o.formatDatum(D)),T=Hi(s.formatDatum(I)),E=Hi(s.formatDatum(A)),_=l??a,R=c??n,C=h??r,w=Hi(p),P=p?`<b>${Hi(_)}</b>: ${O}<br><b>${Hi(R)}</b>: ${T}<br><b>${Hi(C)}</b>: ${E}<br>`:`${O}: ${T} - ${E}`,B={title:w,content:P,backgroundColor:L};return y.toTooltipHtml(B,{itemId:void 0,datum:v,xKey:a,xName:l,yLowKey:n,yLowName:c,yHighKey:r,yHighName:h,yName:p,color:L,seriesId:e,title:w})}getLegendData(t){const{id:e,visible:i}=this;if(t!=="category")return[];const{fill:o,stroke:s,strokeWidth:a,fillOpacity:n,strokeOpacity:r,yName:l,yLowName:c,yHighName:h,yLowKey:p,yHighKey:u}=this.properties,m=l??`${c??p} - ${h??u}`;return[{legendType:"category",id:e,itemId:`${p}-${u}`,seriesId:e,enabled:i,label:{text:`${m}`},symbols:[{marker:{fill:o,stroke:s,fillOpacity:n,strokeOpacity:r,strokeWidth:a}}]}]}animateEmptyUpdateReady({datumSelection:t,labelSelection:e}){const i=bg(Dg(this.isVertical(),"normal"));Ag.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],i),vg(this,"labels",this.ctx.animationManager,e)}animateWaitingUpdateReady(t){const{datumSelection:e,labelSelection:i}=t,{processedData:o}=this,s=o?.reduced?.diff;this.ctx.animationManager.stopByAnimationGroupId(this.id);const a=bg(Dg(this.isVertical(),"fade"));Ag.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],a,(n,r)=>Yk(r.xValue,r.valueIndex),s),vg(this,"labels",this.ctx.animationManager,i)}getDatumId(t){return`${t.xValue}-${t.valueIndex}`}isLabelEnabled(){return this.properties.label.enabled}onDataChange(){}computeFocusBounds({datumIndex:t,seriesRect:e}){return Xk(this.contextNodeData?.nodeData[t],this.contentGroup,e)}};Yl.className="RangeBarSeries",Yl.type="range-bar";import{_Theme as Xl}from"ag-charts-community";var eO={series:{direction:"vertical",strokeWidth:0,label:{enabled:!1,fontSize:12,fontFamily:Xl.DEFAULT_FONT_FAMILY,color:Xl.DEFAULT_INSIDE_SERIES_LABEL_COLOUR,placement:"inside"}},axes:{[Xl.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{enabled:!0}}}},iO={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"range-bar",instanceConstructor:Yl,tooltipDefaults:{range:"exact"},defaultAxes:[{type:Pa.CARTESIAN_AXIS_TYPE.CATEGORY,position:Pa.POSITION.BOTTOM},{type:Pa.CARTESIAN_AXIS_TYPE.NUMBER,position:Pa.POSITION.LEFT}],themeTemplate:eO,paletteFactory:({takeColors:t})=>{const{fills:[e],strokes:[i]}=t(1);return{fill:e,stroke:i}},groupable:!0,swapDefaultAxesCondition:({direction:t})=>t==="horizontal"};import{_Theme as oO}from"ag-charts-community";import{_ModuleSupport as sO,_Scene as aO,_Util as nO}from"ag-charts-community";function Tg(t){t.nodes.sort((e,i)=>Math.round((e.datum.y-i.datum.y)*100)/100||-(e.datum.size-i.datum.size))}function rO({nodes:t,size:e},{seriesRectHeight:i,nodeSpacing:o,sizeScale:s}){const a=i*e*s;let r=(i-(a+o*(t.length-1)))/2;t.forEach(({datum:l})=>{const c=i*l.size*s;l.y=r,l.height=c,r+=c+o})}function lO(t,e){const{nodes:i}=t,{seriesRectHeight:o,nodeSpacing:s}=e;Tg(t);let a=0,n=0;for(let c=0;c<i.length;c+=1){const{datum:h}=i[c],p=Math.max(n-h.y,0);h.y+=p,a+=p,n=h.y+h.height+s}if(n-s<o)return a>0;let l=o;for(let c=i.length-1;c>=0;c-=1){const{datum:h}=i[c],p=h.y+h.height,u=Math.min(l-p,0);h.y+=u,a+=u,l=h.y-s}return!0}function Zl(t,e,i,o,s,a,n,r){const l=(i-t)/(o-e),c=(n-s)/(r-a),h=((a-e)*(l*c)+t*c-s*l)/(c-l);return t<i?h>t&&h<Math.min(i,n):h<t&&h>Math.max(i,n)}function kg(t,e){let i=!1;const o=t.nodes.filter(a=>e(a).length===1);let s=!0;for(let a=0;s&&a<o.length;a+=1){s=!1;for(let n=0;n<o.length-1;n+=1){const{datum:r}=o[n],l=e(o[n])[0].node.datum,{datum:c}=o[n+1],h=e(o[n+1])[0].node.datum;if(!(Zl(r.x,r.y,l.x,l.y,c.x,c.y,h.x,h.y)||Zl(r.x,r.y+r.height/2,l.x,l.y+l.height/2,c.x,c.y+c.height/2,h.x,h.y+h.height/2)||Zl(r.x,r.y+r.height,l.x,l.y+l.height,c.x,c.y+c.height,h.x,h.y+h.height)))continue;const u=o[n];o[n]=o[n+1],o[n+1]=u;const m=r.y;r.y=c.y+c.height-r.height,c.y=m,i=!0,s=!0}}return i}function cO(t){let e=!1;return Tg(t),e=kg(t,i=>i.linksBefore)||e,e=kg(t,i=>i.linksAfter)||e,e}function hO(t){if(t.length===0)return;let e=0,i=0;for(const{node:{datum:o}}of t)e+=o.y*o.size,i+=o.size;return e/i}function Og(t,e,i,o){return t.nodes.forEach(({datum:s,linksBefore:a,linksAfter:n})=>{const r=o===1?a:n,l=o===1?n:a,c=hO(r);if(c!=null){const h=l.length!==0?i:1;s.y=s.y+(c-s.y)*h}}),lO(t,e)}function Lg(t,e,i){let o=!1;for(let s=0;s<t.length;s+=1)o=Og(t[s],e,i,1)||o;return o}function dO(t,e,i){let o=!1;for(let s=t.length-1;s>=0;s-=1)o=Og(t[s],e,i,-1)||o;return o}function Eg(t){let e=!1;for(let i=t.length-1;i>=0;i-=1)e=cO(t[i])||e;return e}function pO(t,e){t.forEach(o=>{rO(o,e)});let i=!1;for(let o=0;o<6;o+=1){const s=Lg(t,e,1);i=dO(t,e,.5);const a=Eg(t);if(!s&&!i&&!a)break}i&&(Lg(t,e,1),Eg(t))}import{_Scene as uO}from"ag-charts-community";var{BBox:gO,Path:yO,ScenePathChangeDetection:ko}=uO;function Va(t,e,i,o,s,a,n,r,l,c){let h,p;if(s!==i&&l!==n){const v=-(o-e)/(s-i),D=-(r-a)/(l-n);h=(n-i+v*e-D*a)/(v-D),p=v*(h-e)+i}else if(s===i&&l!==n)h=e,p=-(r-a)/(l-n)*(h-r)+l;else if(s!==i&&l===n)h=r,p=-(o-e)/(s-i)*(h-e)+i;else throw new Error("Offsetting flat bezier curve");const u=Math.hypot(i-p,e-h),m=(u+c)/u,g=Math.hypot(l-p,r-h),y=(g+c)/g,f=h+(o-h)*m,M=p+(s-p)*m,b=h+(a-h)*y,S=p+(n-p)*y,x=h+(r-h)*y,N=p+(l-p)*y;t.cubicCurveTo(f,M,b,S,x,N)}var Ki=class extends yO{constructor(){super(...arguments),this.x1=0,this.x2=0,this.y1=0,this.y2=0,this.height=0,this.inset=0}computeBBox(){const t=Math.min(this.x1,this.x2),e=Math.max(this.x1,this.x2)-t,i=Math.min(this.y1,this.y2),o=Math.max(this.y1,this.y2)-i+this.height;return new gO(t,i,e,o)}updatePath(){const{path:t,inset:e}=this;t.clear();const i=this.x1+e,o=this.x2-e,s=this.y1+e,a=this.y2+e,n=this.height-2*e;if(n<0||i>o)return;const r=i,l=s+n/2,c=(i+o)/2,h=s+n/2,p=(i+o)/2,u=a+n/2,m=o,g=a+n/2;if(t.moveTo(r,l-n/2),Math.abs(this.y2-this.y1)<1||this.x2-this.x1<this.height*Math.SQRT2)t.cubicCurveTo(c,h-n/2,p,u-n/2,m,g-n/2),t.lineTo(m,g+n/2),t.cubicCurveTo(p,u+n/2,c,h+n/2,r,l+n/2);else{const y=.5*r+.5*c,f=.5*l+.5*h,M=.5*c+.5*p,b=.5*h+.5*u,S=.5*p+.5*m,x=.5*u+.5*g,N=.5*y+.5*M,v=.5*f+.5*b,D=.5*M+.5*S,I=.5*b+.5*x,A=.5*N+.5*D,k=.5*v+.5*I,L=r,O=l,T=y,E=f,_=N,R=v,C=A,w=k,P=A,B=k,z=D,V=I,U=S,Q=x,H=m,K=g,j=(a>s?1:-1)*n/2;Va(t,L,O,T,E,_,R,C,w,j),Va(t,P,B,z,V,U,Q,H,K,-j),t.lineTo(m,g+n/2),Va(t,H,K,U,Q,z,V,P,B,j),Va(t,C,w,_,R,T,E,L,O,-j)}t.closePath()}};d([ko()],Ki.prototype,"x1",2),d([ko()],Ki.prototype,"x2",2),d([ko()],Ki.prototype,"y1",2),d([ko()],Ki.prototype,"y2",2),d([ko()],Ki.prototype,"height",2),d([ko()],Ki.prototype,"inset",2);import{_ModuleSupport as mO,_Scene as fO}from"ag-charts-community";var{BaseProperties:Rg,SeriesTooltip:xO,SeriesProperties:SO,ARRAY:MO,COLOR_STRING:Fa,COLOR_STRING_ARRAY:_g,FUNCTION:Cg,LINE_DASH:wg,OBJECT:Ua,POSITIVE_NUMBER:Gi,RATIO:Ha,STRING:pi,UNION:bO,Validate:Y}=mO,{Label:DO}=fO,NO=bO(["left","right","center","justify"],"a justification value"),Pg=class extends DO{constructor(){super(...arguments),this.spacing=1}};d([Y(Gi)],Pg.prototype,"spacing",2);var We=class extends Rg{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};d([Y(Fa,{optional:!0})],We.prototype,"fill",2),d([Y(Ha)],We.prototype,"fillOpacity",2),d([Y(Fa,{optional:!0})],We.prototype,"stroke",2),d([Y(Ha)],We.prototype,"strokeOpacity",2),d([Y(Gi)],We.prototype,"strokeWidth",2),d([Y(wg)],We.prototype,"lineDash",2),d([Y(Gi)],We.prototype,"lineDashOffset",2),d([Y(Cg,{optional:!0})],We.prototype,"itemStyler",2);var se=class extends Rg{constructor(){super(...arguments),this.spacing=1,this.width=1,this.alignment="justify",this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};d([Y(Gi)],se.prototype,"spacing",2),d([Y(Gi)],se.prototype,"width",2),d([Y(NO)],se.prototype,"alignment",2),d([Y(Fa,{optional:!0})],se.prototype,"fill",2),d([Y(Ha)],se.prototype,"fillOpacity",2),d([Y(Fa,{optional:!0})],se.prototype,"stroke",2),d([Y(Ha)],se.prototype,"strokeOpacity",2),d([Y(Gi)],se.prototype,"strokeWidth",2),d([Y(wg)],se.prototype,"lineDash",2),d([Y(Gi)],se.prototype,"lineDashOffset",2),d([Y(Cg,{optional:!0})],se.prototype,"itemStyler",2);var zt=class extends SO{constructor(){super(...arguments),this.nodes=void 0,this.idKey="",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.sizeKey=void 0,this.sizeName=void 0,this.fills=[],this.strokes=[],this.label=new Pg,this.link=new We,this.node=new se,this.tooltip=new xO}};d([Y(MO,{optional:!0})],zt.prototype,"nodes",2),d([Y(pi)],zt.prototype,"fromKey",2),d([Y(pi)],zt.prototype,"toKey",2),d([Y(pi)],zt.prototype,"idKey",2),d([Y(pi,{optional:!0})],zt.prototype,"idName",2),d([Y(pi,{optional:!0})],zt.prototype,"labelKey",2),d([Y(pi,{optional:!0})],zt.prototype,"labelName",2),d([Y(pi,{optional:!0})],zt.prototype,"sizeKey",2),d([Y(pi,{optional:!0})],zt.prototype,"sizeName",2),d([Y(_g)],zt.prototype,"fills",2),d([Y(_g)],zt.prototype,"strokes",2),d([Y(Ua)],zt.prototype,"label",2),d([Y(Ua)],zt.prototype,"link",2),d([Y(Ua)],zt.prototype,"node",2),d([Y(Ua)],zt.prototype,"tooltip",2);var{SeriesNodePickMode:Bg,createDatumId:zg,EMPTY_TOOLTIP_CONTENT:vO}=sO,{sanitizeHtml:Vg}=nO,{Rect:IO,Text:ls,BBox:AO}=aO,Ql=class extends Yr{constructor(t){super({moduleCtx:t,contentGroupVirtual:!1,pickModes:[Bg.NEAREST_NODE,Bg.EXACT_SHAPE_MATCH]}),this.properties=new zt}isLabelEnabled(){return(this.properties.labelKey!=null||this.nodes==null)&&this.properties.label.enabled}linkFactory(){return new Ki}nodeFactory(){return new IO}async createNodeData(){const{id:t,_nodeDataDependencies:{seriesRectWidth:e,seriesRectHeight:i}={seriesRectWidth:0,seriesRectHeight:0}}=this,{fromKey:o,toKey:s,sizeKey:a,label:{spacing:n},node:{spacing:r,width:l,alignment:c}}=this.properties,h=D=>String(D),{nodeGraph:p,links:u,maxPathLength:m}=this.getNodeGraph(D=>{const I=this.getLabelText(this.properties.label,{datum:D.datum,value:D.label,fromKey:o,toKey:s,sizeKey:a},h);return{...D,label:I,size:0,x:NaN,y:NaN,width:l,height:NaN}},D=>({...D,x1:NaN,x2:NaN,y1:NaN,y2:NaN,height:NaN}),{includeCircularReferences:!1}),g=p,y=this.isLabelEnabled()?(e-l)*(1-m/(m+1)):0,f=(e-l-2*y)/(m-1),M=[];for(let D=0;D<m;D+=1){const I=y+D*f;M.push({index:D,size:0,nodes:[],x:I})}g.forEach(D=>{const{datum:I,linksBefore:A,linksAfter:k,maxPathLengthBefore:L,maxPathLengthAfter:O}=D,T=Math.max(A.reduce((_,{link:R})=>_+R.size,0),k.reduce((_,{link:R})=>_+R.size,0));if(A.length===0&&k.length===0||T===0){D.columnIndex=-1;return}let E;switch(c){case"left":E=M[L];break;case"right":E=M[m-1-O];break;case"center":{if(A.length!==0)E=M[L];else if(k.length!==0){const _=k.reduce((R,C)=>Math.min(R,C.node.maxPathLengthBefore),m)-1;E=M[_]}else E=M[0];break}case"justify":{E=k.length===0?M[m-1]:M[L];break}}I.x=E.x,I.size=T,E.nodes.push(D),E.size+=T,D.columnIndex=E.index}),g.forEach(D=>{let I=1/0,A=0;D.linksAfter.forEach(k=>{const L=k.node,{columnIndex:O}=L;O<I?(I=O,A=L.datum.size):O===I&&(A=Math.max(A,L.datum.size))}),D.closestColumnIndex=I,D.maxSizeOfClosestNodesAfter=A});const b=M.reduce((D,{size:I,nodes:A})=>{const k=(1-(A.length-1)*(r/i))/I;return Math.min(D,k)},1/0);for(let D=M.length-1;D>=0;D-=1)M[D].nodes.sort((A,k)=>A.closestColumnIndex-k.closestColumnIndex||A.maxSizeOfClosestNodesAfter-k.maxSizeOfClosestNodesAfter||A.datum.size-k.datum.size);pO(M,{seriesRectHeight:i,nodeSpacing:r,sizeScale:b}),g.forEach(({datum:D,linksBefore:I,linksAfter:A})=>{const k=D.y+D.height,L=E=>E.sort((_,R)=>{const C=_.node.datum,w=R.node.datum,P=C.y+C.height,B=w.y+w.height,z=Math.atan2(C.y-D.y,Math.abs(C.x-D.x))-Math.atan2(w.y-D.y,Math.abs(w.x-D.x)),V=Math.atan2(P-k,Math.abs(C.x-D.x))-Math.atan2(B-k,Math.abs(w.x-D.x));return z+V});let O=D.y;L(I).forEach(({link:E})=>{E.y2=O,O+=E.size*i*b});let T=D.y;L(A).forEach(({link:E})=>{E.y1=T,T+=E.size*i*b})});const S=[],x=[],{fontSize:N}=this.properties.label,v=this.properties.label.getFont();return M.forEach((D,I)=>{const A=I===0,k=I===M.length-1;let L=-1/0;D.nodes.sort((O,T)=>O.datum.y-T.datum.y),D.nodes.forEach(({datum:O})=>{if(O.midPoint={x:O.x+O.width/2,y:O.y+O.height/2},S.push(O),O.label==null)return;const T=A?O.x-n:O.x+O.width+n,E=O.y+O.height/2;let _;if(!A&&!k){const P=E-N*ls.defaultLineHeightRatio,B=E+N*ls.defaultLineHeightRatio;let z=e;g.forEach(({datum:U})=>{U.x>O.x&&Math.max(U.y,P)<=Math.min(U.y+U.height,B)&&(z=Math.min(z,U.x-n))});const V=z-O.x-2*n;_=ls.wrap(O.label,V,O.height,this.properties.label,"never","hide")}if(_==null||_===""){const P=A||k?n:n*2;_=ls.wrap(O.label,f-P,O.height,this.properties.label,"never")}if(_==="")return;const{height:R}=ls.measureText(_,v,"middle","left"),C=E-R/2,w=E+R/2;C>=L&&(x.push({x:T,y:E,leading:A,text:_}),L=w)})}),u.forEach(D=>{const{fromNode:I,toNode:A,size:k}=D;D.height=i*k*b,D.x1=I.x+l,D.x2=A.x,D.midPoint={x:(D.x1+D.x2)/2,y:(D.y1+D.y2)/2+D.height/2},S.push(D)}),{itemId:t,nodeData:S,labelData:x}}async updateLabelSelection(t){const e=this.isLabelEnabled()?t.labelData:[];return t.labelSelection.update(e)}async updateLabelNodes(t){const{labelSelection:e}=t,{color:i,fontStyle:o,fontWeight:s,fontSize:a,fontFamily:n}=this.properties.label;e.each((r,{x:l,y:c,leading:h,text:p})=>{r.visible=!0,r.x=l,r.y=c,r.text=p,r.fill=i,r.fontStyle=o,r.fontWeight=s,r.fontSize=a,r.fontFamily=n,r.textAlign=h?"right":"left",r.textBaseline="middle"})}async updateNodeSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>zg([e.type,e.id]))}async updateNodeNodes(t){const{datumSelection:e,isHighlight:i}=t,{id:o,properties:s,ctx:{callbackCache:a}}=this,{fromKey:n,toKey:r,sizeKey:l}=this.properties,{fill:c,fillOpacity:h,stroke:p,strokeOpacity:u,lineDash:m,lineDashOffset:g,itemStyler:y}=this.properties.node,f=i?s.highlightStyle.item:void 0,M=this.getStrokeWidth(s.node.strokeWidth);e.each((b,S)=>{const x=c??S.fill,N=p??S.stroke;let v;if(y!=null){const{label:D,size:I}=S;v=a.call(y,{seriesId:o,datum:S.datum,label:D,size:I,fromKey:n,toKey:r,sizeKey:l,fill:x,fillOpacity:h,strokeOpacity:u,stroke:N,strokeWidth:M,lineDash:m,lineDashOffset:g,highlighted:i})}b.x=S.x,b.y=S.y,b.width=S.width,b.height=S.height,b.fill=f?.fill??v?.fill??x,b.fillOpacity=f?.fillOpacity??v?.fillOpacity??h,b.stroke=f?.stroke??v?.stroke??N,b.strokeOpacity=f?.strokeOpacity??v?.strokeOpacity??u,b.strokeWidth=f?.strokeWidth??v?.strokeWidth??M,b.lineDash=f?.lineDash??v?.lineDash??m,b.lineDashOffset=f?.lineDashOffset??v?.lineDashOffset??g})}async updateLinkSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>zg([e.type,e.index,e.fromNode.id,e.toNode.id]))}async updateLinkNodes(t){const{datumSelection:e,isHighlight:i}=t,{id:o,properties:s,ctx:{callbackCache:a}}=this,{fromKey:n,toKey:r,sizeKey:l}=s,{fill:c,fillOpacity:h,stroke:p,strokeOpacity:u,lineDash:m,lineDashOffset:g,itemStyler:y}=s.link,f=i?s.highlightStyle.item:void 0,M=this.getStrokeWidth(s.link.strokeWidth);e.each((b,S)=>{const x=c??S.fromNode.fill,N=p??S.fromNode.stroke;let v;y!=null&&(v=a.call(y,{seriesId:o,datum:S.datum,fromKey:n,toKey:r,sizeKey:l,fill:x,fillOpacity:h,strokeOpacity:u,stroke:N,strokeWidth:M,lineDash:m,lineDashOffset:g,highlighted:i})),b.x1=S.x1,b.y1=S.y1,b.x2=S.x2,b.y2=S.y2,b.height=S.height,b.fill=f?.fill??v?.fill??x,b.fillOpacity=f?.fillOpacity??v?.fillOpacity??h,b.stroke=f?.stroke??v?.stroke??N,b.strokeOpacity=f?.strokeOpacity??v?.strokeOpacity??u,b.strokeWidth=Math.min(f?.strokeWidth??v?.strokeWidth??M,S.height/2),b.lineDash=f?.lineDash??v?.lineDash??m,b.lineDashOffset=f?.lineDashOffset??v?.lineDashOffset??g,b.inset=b.strokeWidth/2})}getTooltipHtml(t){const{id:e,processedData:i,ctx:{callbackCache:o},properties:s}=this;if(!i||!s.isValid())return vO;const{fromKey:a,toKey:n,sizeKey:r,sizeName:l,tooltip:c}=s,{datum:h,itemId:p}=t;let u;const m=[];let g;if(t.type===0){const{fillOpacity:M,strokeOpacity:b,strokeWidth:S,lineDash:x,lineDashOffset:N,itemStyler:v}=s.link,{fromNode:D,toNode:I,size:A}=t;u=`${D.label??D.id} - ${I.label??I.id}`,r!=null&&m.push(Vg(`${l??r}: `+A)),g=s.link.fill??D.fill;const k=s.link.stroke??D.stroke;let L;v!=null&&(L=o.call(v,{seriesId:e,datum:h.datum,fromKey:a,toKey:n,sizeKey:r,fill:g,fillOpacity:M,strokeOpacity:b,stroke:k,strokeWidth:S,lineDash:x,lineDashOffset:N,highlighted:!0})),g=L?.fill??g}else{const{fillOpacity:M,strokeOpacity:b,strokeWidth:S,lineDash:x,lineDashOffset:N,itemStyler:v}=s.node,{id:D,label:I,size:A}=t;u=I??D,r!=null&&m.push(Vg(`${l??r}: `+A)),g=s.link.fill??h.fill;const k=s.link.stroke??h.stroke;let L;v!=null&&(L=o.call(v,{seriesId:e,datum:h.datum,label:I,size:A,fromKey:a,toKey:n,sizeKey:r,fill:g,fillOpacity:M,strokeOpacity:b,stroke:k,strokeWidth:S,lineDash:x,lineDashOffset:N,highlighted:!0})),g=L?.fill??g}const y=m.join("<br>"),f=g;return c.toTooltipHtml({title:u,content:y,backgroundColor:f},{seriesId:e,datum:h,title:u,color:f,itemId:p,fromKey:a,toKey:n,sizeKey:r,sizeName:l,...this.getModuleTooltipParams()})}getLabelData(){return[]}computeFocusBounds({datumIndex:t,seriesRect:e}){const i=this.contextNodeData?.nodeData[t];if(i?.type===1){const{x:o,y:s,width:a,height:n}=i,r=new AO(o,s,a,n);return this.contentGroup.inverseTransformBBox(r).clip(e)}else if(i?.type===0){for(const o of this.linkSelection)if(o.datum===i)return o.node;return}}};Ql.className="SankeySeries",Ql.type="sankey";var{DEFAULT_FONT_FAMILY:TO,DEFAULT_LABEL_COLOUR:kO}=oO,OO={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["flow-proportion"],solo:!0,identifier:"sankey",instanceConstructor:Ql,tooltipDefaults:{range:"exact"},themeTemplate:{seriesArea:{padding:{top:10,bottom:10}},series:{highlightStyle:{series:{dimOpacity:.2}},label:{fontFamily:TO,color:kO,fontSize:12,spacing:10},node:{spacing:20,width:10,strokeWidth:0},link:{fillOpacity:.5,strokeWidth:0}},legend:{enabled:!1,toggleSeries:!1}},paletteFactory({takeColors:t,colorsCount:e}){return t(e)}};import{_Theme as Fg}from"ag-charts-community";import{_ModuleSupport as Ka,_Scene as $l,_Util as Ug}from"ag-charts-community";import{_ModuleSupport as LO}from"ag-charts-community";var{HierarchySeriesProperties:EO,HighlightStyle:RO,SeriesTooltip:_O,Validate:gt,COLOR_STRING:CO,FUNCTION:wO,NUMBER:Hg,OBJECT:Oo,POSITIVE_NUMBER:ql,RATIO:Ga,STRING:Wa}=LO,ui=class extends RO{constructor(){super(...arguments),this.label=new ie,this.secondaryLabel=new ie}};d([gt(Wa,{optional:!0})],ui.prototype,"fill",2),d([gt(Ga,{optional:!0})],ui.prototype,"fillOpacity",2),d([gt(CO,{optional:!0})],ui.prototype,"stroke",2),d([gt(ql,{optional:!0})],ui.prototype,"strokeWidth",2),d([gt(Ga,{optional:!0})],ui.prototype,"strokeOpacity",2),d([gt(Oo)],ui.prototype,"label",2),d([gt(Oo)],ui.prototype,"secondaryLabel",2);var Gt=class extends EO{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=0,this.strokeOpacity=1,this.cornerRadius=0,this.highlightStyle=new ui,this.label=new ie,this.secondaryLabel=new ts,this.tooltip=new _O}};d([gt(Wa,{optional:!0})],Gt.prototype,"sizeName",2),d([gt(Wa,{optional:!0})],Gt.prototype,"labelKey",2),d([gt(Wa,{optional:!0})],Gt.prototype,"secondaryLabelKey",2),d([gt(Ga)],Gt.prototype,"fillOpacity",2),d([gt(ql)],Gt.prototype,"strokeWidth",2),d([gt(Ga)],Gt.prototype,"strokeOpacity",2),d([gt(ql)],Gt.prototype,"cornerRadius",2),d([gt(Hg,{optional:!0})],Gt.prototype,"sectorSpacing",2),d([gt(Hg,{optional:!0})],Gt.prototype,"padding",2),d([gt(wO,{optional:!0})],Gt.prototype,"itemStyler",2),d([gt(Oo)],Gt.prototype,"highlightStyle",2),d([gt(Oo)],Gt.prototype,"label",2),d([gt(Oo)],Gt.prototype,"secondaryLabel",2),d([gt(Oo)],Gt.prototype,"tooltip",2);var{fromToMotion:PO}=Ka,{Sector:ja,Group:Kg,Selection:Gg,Text:cs}=$l,{sanitizeHtml:Jl}=Ug,Wg=(t,e=0,i=2*Math.PI/t.sumSize,o=Array.from(t,()=>{}))=>{let s=e;for(const a of t.children){const n=s,r=s+a.sumSize*i;o[a.index]={start:n,end:r},Wg(a,n,i,o),s=r}return o},tc=class extends Ka.HierarchySeries{constructor(){super(...arguments),this.properties=new Gt,this.groupSelection=Gg.select(this.contentGroup,Kg),this.highlightSelection=Gg.select(this.highlightGroup,Kg),this.angleData=[]}async processData(){const{childrenKey:t,colorKey:e,colorName:i,labelKey:o,secondaryLabelKey:s,sizeKey:a,sizeName:n}=this.properties;await super.processData(),this.angleData=Wg(this.rootNode);const r=l=>typeof l=="number"?l.toFixed(2):typeof l=="string"?l:"";this.labelData=Array.from(this.rootNode,({datum:l,depth:c})=>{let h;if(l!=null&&c!=null&&o!=null){const u=l[o];h=this.getLabelText(this.properties.label,{depth:c,datum:l,childrenKey:t,colorKey:e,colorName:i,labelKey:o,secondaryLabelKey:s,sizeKey:a,sizeName:n,value:u},r)}h===""&&(h=void 0);let p;if(l!=null&&c!=null&&s!=null){const u=l[s];p=this.getLabelText(this.properties.secondaryLabel,{depth:c,datum:l,childrenKey:t,colorKey:e,colorName:i,labelKey:o,secondaryLabelKey:s,sizeKey:a,sizeName:n,value:u},r)}return p===""&&(p=void 0),h!=null||p!=null?{label:h,secondaryLabel:p}:void 0})}async updateSelections(){if(!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;const{chart:t}=this;if(t==null||t.seriesRect==null)return;const i=Array.from(this.rootNode),o=s=>{s.append([new ja,new cs({tag:0}),new cs({tag:1})])};this.groupSelection.update(i,o,s=>this.getDatumId(s)),this.highlightSelection.update(i,o,s=>this.getDatumId(s))}async updateNodes(){const{chart:t,data:e,maxDepth:i,labelData:o}=this;if(t==null||e==null||o==null)return;const{width:s,height:a}=t.seriesRect,{sectorSpacing:n=0,padding:r=0,cornerRadius:l,highlightStyle:c}=this.properties;this.contentGroup.translationX=s/2,this.contentGroup.translationY=a/2,this.highlightGroup.translationX=s/2,this.highlightGroup.translationY=a/2;const h=n*.5,u=Math.min(s,a)/2/(i+1),m=-Math.PI/2,g=this.ctx.highlightManager?.getActiveHighlight();new cs().setFont(this.properties.label),this.rootNode.walk(S=>{const x=this.angleData[S.index];if(S.depth!=null&&x!=null){const N=x.end-x.start,v=(S.depth+.5)*u;S.midPoint.x=Math.cos(N)*v,S.midPoint.y=Math.sin(N)*v}});const f=(S,x,N)=>{const{depth:v}=S,D=this.angleData[S.index];if(v==null||D==null){x.visible=!1;return}x.visible=!0;let I,A,k,L,O;N&&(I=c.fill,A=c.fillOpacity,k=c.stroke,L=c.strokeWidth,O=c.strokeOpacity);const T=this.getSectorFormat(S,N),E=T?.fill??I??S.fill,_=T?.fillOpacity??A??this.properties.fillOpacity,R=T?.stroke??k??S.stroke,C=T?.strokeWidth??L??this.properties.strokeWidth,w=T?.strokeOpacity??O??this.properties.strokeOpacity;x.fill=E,x.fillOpacity=_,x.stroke=R,x.strokeWidth=C,x.strokeOpacity=w,x.centerX=0,x.centerY=0,x.innerRadius=v*u,x.outerRadius=(v+1)*u,x.startAngle=D.start+m,x.endAngle=D.end+m,x.inset=h+C*.5,x.cornerRadius=l};this.groupSelection.selectByClass(ja).forEach(S=>{f(S.datum,S,!1)}),this.highlightSelection.selectByClass(ja).forEach(S=>{const x=S.datum,N=g===x;S.visible=N,S.visible&&f(S.datum,S,N)});const M=Array.from(this.rootNode,(S,x)=>{const{depth:N}=S,v=o[x],D=this.angleData[x];if(N==null||D==null)return;const I=N*u+h,A=(N+1)*u-h,k=I>h?h/I:h,L=A>h?h/A:h,O=D.start+k,E=D.end+k-O,_=D.start+L,C=D.end+L-_,w=rt=>{if(N===0&&S.parent?.sumSize===S.sumSize)return{width:2*Math.sqrt(A**2-(rt*.5)**2),height:rt,meta:0};const bt=rt,$t=2*Math.sqrt(A**2-(I+bt)**2),Xt=E<Math.PI?2*I*Math.tan(E*.5):1/0,Ut=Math.min($t,Xt),ot=Math.PI/4;let qt,fe;return N===0?(qt=rt,fe=Math.sqrt(A**2-(qt/2)**2)-rt/(2*Math.tan(C*.5))):Ug.normalizeAngle360(E)<ot?(qt=2*I*Math.tan(E*.5),fe=Math.sqrt(A**2-(qt/2)**2)-I):(fe=0,qt=0),Ut>=fe?{width:Ut,height:bt,meta:1}:{width:fe,height:qt,meta:2}},P=qr(v?.label,this.properties.label,v?.secondaryLabel,this.properties.secondaryLabel,{padding:r},w);if(P==null)return;const{width:B,height:z,meta:V,label:U,secondaryLabel:Q}=P,H=m+(D.start+D.end)/2,K=Math.sin(H)>=0,j=Math.cos(H)>=0,st=(K?3:12)&(j?6:9);let Ft;switch(V){case 0:Ft=0;break;case 1:{const Mt=A-(u-z)*.58,bt=Math.sqrt((A-r)**2-(B/2)**2);Ft=Math.min(Mt,bt);break}case 2:if(N===0){const rt=z/(2*Math.tan(E*.5))+B*.5,Mt=Math.sqrt(A**2-(z*.5)**2)-B*.5;Ft=(rt+Mt)*.5}else Ft=(I+A)*.5;break}return{width:B,height:z,labelPlacement:V,circleQuarter:st,radius:Ft,theta:H,label:U,secondaryLabel:Q}}),b=(S,x,N,v)=>{const{index:D,depth:I}=S,A=M?.[D],k=N===0?this.properties.label:this.properties.secondaryLabel,L=N===0?A?.label:A?.secondaryLabel;if(I==null||A==null||L==null){x.visible=!1;return}const{height:O,labelPlacement:T,circleQuarter:E,radius:_,theta:R}=A;let C;switch(v&&(C=(N===0?this.properties.highlightStyle.label:this.properties.highlightStyle.secondaryLabel).color),x.text=L.text,x.fontSize=L.fontSize,x.lineHeight=L.lineHeight,x.fontStyle=k.fontStyle,x.fontFamily=k.fontFamily,x.fontWeight=k.fontWeight,x.fill=C??k.color,T){case 0:x.textAlign="center",x.textBaseline="top",x.translationX=0,x.translationY=(N===0?0:O-L.height)-O*.5,x.rotation=0;break;case 1:{const w=(E&3)!==0,P=N===0==!w?_:_-(O-L.height);x.textAlign="center",x.textBaseline=w?"bottom":"top",x.translationX=Math.cos(R)*P,x.translationY=Math.sin(R)*P,x.rotation=w?R-Math.PI*.5:R+Math.PI*.5;break}case 2:{const w=(E&6)!==0,P=N===0==!w?(O-L.height)*.5:(L.height-O)*.5;x.textAlign="center",x.textBaseline="middle",x.translationX=Math.cos(R)*_+Math.cos(R+Math.PI/2)*P,x.translationY=Math.sin(R)*_+Math.sin(R+Math.PI/2)*P,x.rotation=w?R:R+Math.PI;break}}x.visible=!0};this.groupSelection.selectByClass(cs).forEach(S=>{b(S.datum,S,S.tag,!1)}),this.highlightSelection.selectByClass(cs).forEach(S=>{const x=S.datum,N=g===x;S.visible=N,S.visible&&b(S.datum,S,S.tag,N)})}getSectorFormat(t,e){const{datum:i,fill:o,stroke:s,depth:a}=t,{ctx:{callbackCache:n},properties:{itemStyler:r}}=this;if(!r||i==null||a==null)return{};const{colorKey:l,childrenKey:c,labelKey:h,secondaryLabelKey:p,sizeKey:u,strokeWidth:m,fillOpacity:g,strokeOpacity:y}=this.properties;return n.call(r,{seriesId:this.id,highlighted:e,datum:i,depth:a,colorKey:l,childrenKey:c,labelKey:h,secondaryLabelKey:p,sizeKey:u,fill:o,fillOpacity:g,stroke:s,strokeWidth:m,strokeOpacity:y})}getTooltipHtml(t){const{id:e}=this,{tooltip:i,colorKey:o,colorName:s=o,labelKey:a,secondaryLabelKey:n,sizeKey:r,sizeName:l=r,childrenKey:c}=this.properties,{datum:h,depth:p}=t;if(h==null||p==null)return Ka.EMPTY_TOOLTIP_CONTENT;const u=a!=null?h[a]:void 0,g=this.getSectorFormat(t,!1)?.fill??t.fill;if(!i.renderer&&!u)return Ka.EMPTY_TOOLTIP_CONTENT;const y=[],f=n!=null?h[n]:void 0;f!=null&&n!==o&&n!==r&&y.push(Jl(f));const M=r!=null?h[r]:void 0;M!=null&&y.push(`${l}: ${Jl(M)}`);const b=o!=null?h[o]:void 0;b!=null&&y.push(`${s}: ${Jl(b)}`);const S=y.join("<br>"),x={title:u,color:this.properties.label.color,backgroundColor:g,content:S};return i.toTooltipHtml(x,{depth:p,datum:h,colorKey:o,labelKey:a,secondaryLabelKey:n,sizeKey:r,title:u,color:g,seriesId:e,childrenKey:c,colorName:s,itemId:void 0,sizeName:l})}async createNodeData(){}pickNodeClosestDatum(t){return this.pickNodeNearestDistantObject(t,this.groupSelection.selectByClass(ja))}animateEmptyUpdateReady({datumSelections:t}){PO(this.id,"nodes",this.ctx.animationManager,t,{toFn(e,i,o){return{scalingX:1,scalingY:1}},fromFn(e,i,o){return o==="unknown"&&i!=null&&e.previousDatum==null?{scalingX:0,scalingY:0}:{scalingX:1,scalingY:1}}})}computeFocusBounds(t){let e;for(const{node:i,datum:o}of this.groupSelection)o===t&&(e=$l.Selection.selectByClass(i,$l.Sector)[0]);return e}};tc.className="SunburstSeries",tc.type="sunburst";var{DEFAULT_INSIDE_SERIES_LABEL_COLOUR:Ya}=Fg,BO={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["hierarchy"],identifier:"sunburst",instanceConstructor:tc,tooltipDefaults:{range:"exact"},solo:!0,themeTemplate:{series:{label:{fontSize:14,minimumFontSize:9,color:Ya,overflowStrategy:"ellipsis",wrapping:"never",spacing:2},secondaryLabel:{fontSize:8,minimumFontSize:7,color:Ya,overflowStrategy:"ellipsis",wrapping:"never"},sectorSpacing:2,padding:3,highlightStyle:{label:{color:Ya},secondaryLabel:{color:Ya},stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2}},gradientLegend:{enabled:!0}},paletteFactory:({takeColors:t,colorsCount:e,themeTemplateParameters:i})=>{const{fills:o,strokes:s}=t(e),a=i.get(Fg.DEFAULT_DIVERGING_SERIES_COLOUR_RANGE);return{fills:o,strokes:s,colorRange:a}}};import{_Theme as zO}from"ag-charts-community";import{_ModuleSupport as ec,_Scene as jg,_Util as VO}from"ag-charts-community";import{_ModuleSupport as FO,_Scene as UO}from"ag-charts-community";var{Label:HO}=UO,{BaseProperties:Xa,HierarchySeriesProperties:KO,HighlightStyle:GO,SeriesTooltip:WO,Validate:F,BOOLEAN:jO,COLOR_STRING:Za,FUNCTION:YO,NUMBER:XO,OBJECT:ae,POSITIVE_NUMBER:Re,RATIO:gi,STRING:Wi,STRING_ARRAY:Yg,TEXT_ALIGN:Xg,VERTICAL_ALIGN:ZO}=FO,Zg=class extends HO{constructor(){super(...arguments),this.spacing=0}};d([F(XO)],Zg.prototype,"spacing",2);var ne=class extends Xa{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.gap=0,this.padding=0,this.interactive=!0,this.label=new Zg}};d([F(Wi,{optional:!0})],ne.prototype,"fill",2),d([F(gi)],ne.prototype,"fillOpacity",2),d([F(Za,{optional:!0})],ne.prototype,"stroke",2),d([F(Re)],ne.prototype,"strokeWidth",2),d([F(gi)],ne.prototype,"strokeOpacity",2),d([F(Re)],ne.prototype,"cornerRadius",2),d([F(Xg)],ne.prototype,"textAlign",2),d([F(Re)],ne.prototype,"gap",2),d([F(Re)],ne.prototype,"padding",2),d([F(jO)],ne.prototype,"interactive",2),d([F(ae)],ne.prototype,"label",2);var Qt=class extends Xa{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.verticalAlign="middle",this.gap=0,this.padding=0,this.label=new ie,this.secondaryLabel=new ts}};d([F(Wi,{optional:!0})],Qt.prototype,"fill",2),d([F(gi)],Qt.prototype,"fillOpacity",2),d([F(Za,{optional:!0})],Qt.prototype,"stroke",2),d([F(Re,{optional:!0})],Qt.prototype,"strokeWidth",2),d([F(gi)],Qt.prototype,"strokeOpacity",2),d([F(Re)],Qt.prototype,"cornerRadius",2),d([F(Xg)],Qt.prototype,"textAlign",2),d([F(ZO)],Qt.prototype,"verticalAlign",2),d([F(Re)],Qt.prototype,"gap",2),d([F(Re)],Qt.prototype,"padding",2),d([F(ae)],Qt.prototype,"label",2),d([F(ae)],Qt.prototype,"secondaryLabel",2);var ji=class extends Xa{constructor(){super(...arguments),this.label=new ie}};d([F(Wi,{optional:!0})],ji.prototype,"fill",2),d([F(gi,{optional:!0})],ji.prototype,"fillOpacity",2),d([F(Za,{optional:!0})],ji.prototype,"stroke",2),d([F(Re,{optional:!0})],ji.prototype,"strokeWidth",2),d([F(gi,{optional:!0})],ji.prototype,"strokeOpacity",2),d([F(ae)],ji.prototype,"label",2);var yi=class extends Xa{constructor(){super(...arguments),this.label=new ie,this.secondaryLabel=new ts}};d([F(Wi,{optional:!0})],yi.prototype,"fill",2),d([F(gi,{optional:!0})],yi.prototype,"fillOpacity",2),d([F(Za,{optional:!0})],yi.prototype,"stroke",2),d([F(Re,{optional:!0})],yi.prototype,"strokeWidth",2),d([F(gi,{optional:!0})],yi.prototype,"strokeOpacity",2),d([F(ae)],yi.prototype,"label",2),d([F(ae)],yi.prototype,"secondaryLabel",2);var ic=class extends GO{constructor(){super(...arguments),this.group=new ji,this.tile=new yi}};d([F(ae)],ic.prototype,"group",2),d([F(ae)],ic.prototype,"tile",2);var me=class extends KO{constructor(){super(...arguments),this.highlightStyle=new ic,this.tooltip=new WO,this.group=new ne,this.tile=new Qt,this.undocumentedGroupFills=[],this.undocumentedGroupStrokes=[]}};d([F(Wi,{optional:!0})],me.prototype,"sizeName",2),d([F(Wi,{optional:!0})],me.prototype,"labelKey",2),d([F(Wi,{optional:!0})],me.prototype,"secondaryLabelKey",2),d([F(YO,{optional:!0})],me.prototype,"itemStyler",2),d([F(ae)],me.prototype,"highlightStyle",2),d([F(ae)],me.prototype,"tooltip",2),d([F(ae)],me.prototype,"group",2),d([F(ae)],me.prototype,"tile",2),d([F(Yg)],me.prototype,"undocumentedGroupFills",2),d([F(Yg)],me.prototype,"undocumentedGroupStrokes",2);var{Rect:Qa,Group:QO,BBox:$a,Selection:Qg,Text:Lo}=jg,{Color:$O,Logger:qO,clamp:JO,isEqual:tL,sanitizeHtml:oc}=VO,$g=new Lo;function eL(t,e){const{fontStyle:i,fontWeight:o,fontSize:s,fontFamily:a}=e;$g.setProperties({text:t,fontStyle:i,fontWeight:o,fontSize:s,fontFamily:a,textAlign:"left",textBaseline:"top"});const{width:n,height:r}=$g.computeBBox();return{width:n,height:r}}function qg(t){if(typeof t=="string"&&!$O.validColorString(t)){const e="black";return qO.warnOnce(`invalid Treemap tile colour string "${t}". Affected treemap tiles will be coloured ${e}.`),e}return t}function mi(t){return t.children.length>0?t.sumSize-t.size:t.size}var Jg={left:0,center:.5,right:1},iL={top:0,middle:.5,bottom:1},oL=class extends jg.Group{distanceSquared(t,e){return this.computeBBox().distanceSquared(t,e)}},sc=class extends ec.HierarchySeries{constructor(){super(...arguments),this.properties=new me,this.groupSelection=Qg.select(this.contentGroup,oL),this.highlightSelection=Qg.select(this.highlightGroup,QO)}groupTitleHeight(t,e){const i=this.labelData?.[t.index]?.label,{label:o}=this.properties.group,s=3;if(i!=null){if(o.fontSize>e.width/s||o.fontSize>e.height/s)return;{const{height:a}=eL(i,o);return Math.max(a,o.fontSize)}}}getNodePadding(t,e){if(t.index===0)return{top:0,right:0,bottom:0,left:0};if(t.children.length===0){const{padding:n}=this.properties.tile;return{top:n,right:n,bottom:n,left:n}}const{label:{spacing:i},padding:o}=this.properties.group,s=this.groupTitleHeight(t,e),a=s!=null?s+i:0;return{top:o+a,right:o,bottom:o,left:o}}async processData(){await super.processData();const{childrenKey:t,colorKey:e,colorName:i,labelKey:o,secondaryLabelKey:s,sizeKey:a,sizeName:n,tile:r,group:l}=this.properties;if(!this.data?.length){this.labelData=void 0;return}const c=h=>typeof h=="number"?h.toFixed(2):typeof h=="string"?h:"";this.labelData=Array.from(this.rootNode,({datum:h,depth:p,children:u})=>{const m=u.length===0,g=m?r.label:l.label;let y;if(h!=null&&p!=null&&o!=null){const M=h[o];y=this.getLabelText(g,{depth:p,datum:h,childrenKey:t,colorKey:e,colorName:i,labelKey:o,secondaryLabelKey:s,sizeKey:a,sizeName:n,value:M},c)}y===""&&(y=void 0);let f;if(m&&h!=null&&p!=null&&s!=null){const M=h[s];f=this.getLabelText(r.secondaryLabel,{depth:p,datum:h,childrenKey:t,colorKey:e,colorName:i,labelKey:o,secondaryLabelKey:s,sizeKey:a,sizeName:n,value:M},c)}return f===""&&(f=void 0),y!=null||f!=null?{label:y,secondaryLabel:f}:void 0})}sortChildren({children:t}){const e=Array.from(t,(o,s)=>s).filter(o=>mi(t[o])>0).sort((o,s)=>mi(t[s])-mi(t[o]));return{sortedChildrenIndices:e,childAt:o=>{const s=e[o];return t[s]}}}squarify(t,e,i,o){const{index:s,datum:a,children:n}=t;if(e.width<=0||e.height<=0){i[s]=void 0,o[s]=void 0;return}const r=a!=null?this.getNodePadding(t,e):{top:0,right:0,bottom:0,left:0};i[s]=s===0?void 0:e,o[s]=s===0?void 0:r;const{sortedChildrenIndices:l,childAt:c}=this.sortChildren(t),h=l.every(I=>n[I].children.length===0),p=1,u=e.width-r.left-r.right,m=e.height-r.top-r.bottom;if(u<=0||m<=0)return;const g=l.length;let y=0,f=0,M=1/0,b=l.reduce((I,A)=>I+mi(n[A]),0);const S=new $a(e.x+r.left,e.y+r.top,u,m),x=S.clone();let N=0;for(;N<g;){const I=mi(c(N)),A=mi(c(f)),k=x.width<x.height;y+=I;const L=k?x.height:x.width,O=k?x.width:x.height,T=O*A/y;let E=L*y/b;const _=Math.max(T,E)/Math.min(T,E),R=Math.abs(p-_);if(R<M){M=R,N++;continue}y-=I,E=L*y/b;let C=k?x.x:x.y;for(let w=f;w<N;w++){const P=c(w),B=mi(P),z=k?C:x.x,V=k?x.y:C,U=O*B/y,Q=k?U:E,H=k?E:U,K=new $a(z,V,Q,H);this.applyGap(S,K,h),this.squarify(P,K,i,o),b-=B,C+=U}k?(x.y+=E,x.height-=E):(x.x+=E,x.width-=E),f=N,y=0,M=1/0}const v=x.width<x.height;let D=v?x.x:x.y;for(let I=f;I<g;I++){const A=c(I),k=v?D:x.x,L=v?x.y:D,O=mi(A)/b,T=x.width*(v?O:1),E=x.height*(v?1:O),_=new $a(k,L,T,E);this.applyGap(S,_,h),this.squarify(A,_,i,o),D+=v?T:E}}applyGap(t,e,i){const o=i?this.properties.tile.gap*.5:this.properties.group.gap*.5,s=l=>({left:l.x,top:l.y,right:l.x+l.width,bottom:l.y+l.height}),a=s(t),n=s(e);["top","right","bottom","left"].forEach(l=>{tL(a[l],n[l])||e.shrink(o,l)})}async createNodeData(){}async updateSelections(){if(!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;const{seriesRect:t}=this.chart??{};if(!t)return;const e=Array.from(this.rootNode),i=o=>{o.append([new Qa,new Lo({tag:0}),new Lo({tag:1})])};this.groupSelection.update(e,i,o=>this.getDatumId(o)),this.highlightSelection.update(e,i,o=>this.getDatumId(o))}getTileFormat(t,e){const{datum:i,depth:o,children:s}=t,{colorKey:a,childrenKey:n,labelKey:r,secondaryLabelKey:l,sizeKey:c,tile:h,group:p,itemStyler:u}=this.properties;if(!u||i==null||o==null)return{};const m=s.length===0,g=this.getNodeFill(t),y=this.getNodeStroke(t),f=m?h.strokeWidth:p.strokeWidth;return this.ctx.callbackCache.call(u,{seriesId:this.id,highlighted:e,datum:i,depth:o,colorKey:a,childrenKey:n,labelKey:r,secondaryLabelKey:l,sizeKey:c,fill:g,fillOpacity:1,stroke:y,strokeWidth:f,strokeOpacity:1})}getNodeFill(t){if(t.children.length===0)return this.properties.tile.fill??t.fill;const{undocumentedGroupFills:i}=this.properties,o=i[Math.min(t.depth??0,i.length)];return this.properties.group.fill??o}getNodeStroke(t){if(t.children.length===0)return this.properties.tile.stroke??t.stroke;const{undocumentedGroupStrokes:i}=this.properties,o=i[Math.min(t.depth??0,i.length)];return this.properties.group.stroke??o}async updateNodes(){const{rootNode:t,data:e}=this,{highlightStyle:i,tile:o,group:s}=this.properties,{seriesRect:a}=this.chart??{};if(!a||!e)return;const{width:n,height:r}=a,l=Array.from(this.rootNode,()=>{}),c=Array.from(this.rootNode,()=>{});this.squarify(t,new $a(0,0,n,r),l,c);let h=this.ctx.highlightManager?.getActiveHighlight();h!=null&&!this.properties.group.interactive&&h.children.length!==0&&(h=void 0),this.updateNodeMidPoint(l);const p=(g,y,f)=>{const M=l[g.index];if(M==null){y.visible=!1;return}const b=g.children.length===0;let S,x,N,v,D;if(f){const{tile:C,group:w}=i;S=b?C.fill:w.fill,x=b?C.fillOpacity:w.fillOpacity,N=b?C.stroke:w.stroke,v=b?C.strokeWidth:w.strokeWidth,D=b?C.strokeOpacity:w.strokeOpacity}const I=this.getTileFormat(g,f),A=I?.fill??S??this.getNodeFill(g),k=I?.fillOpacity??x??(b?o.fillOpacity:s.fillOpacity),L=I?.stroke??N??this.getNodeStroke(g),O=I?.strokeWidth??v??(b?o.strokeWidth:s.strokeWidth),T=I?.strokeOpacity??D??(b?o.strokeOpacity:s.strokeOpacity);y.crisp=!0,y.fill=qg(A),y.fillOpacity=k,y.stroke=qg(L),y.strokeWidth=O,y.strokeOpacity=T,y.cornerRadius=b?o.cornerRadius:s.cornerRadius;const E=g.parent?.children.every(C=>C.children.length===0),_=g.parent!=null?l[g.parent.index]:void 0,R=g.parent!=null?c[g.parent.index]:void 0;E===!0&&_!=null&&R!=null?(y.clipBBox=M,y.x=_.x+R.left,y.y=_.y+R.top,y.width=_.width-(R.left+R.right),y.height=_.height-(R.top+R.bottom)):(y.clipBBox=void 0,y.x=M.x,y.y=M.y,y.width=M.width,y.height=M.height),y.visible=!0};this.groupSelection.selectByClass(Qa).forEach(g=>p(g.datum,g,!1)),this.highlightSelection.selectByClass(Qa).forEach(g=>{const y=g.datum===h;g.visible=y||(h?.contains(g.datum)??!1),g.visible&&p(g.datum,g,y)});const u=Array.from(this.rootNode,g=>{const{index:y,children:f}=g,M=l[y],b=this.labelData?.[y];if(!(M==null||b==null))if(f.length===0){const S={width:M.width,height:M.height,meta:null},x=qr(b.label,this.properties.tile.label,b.secondaryLabel,this.properties.tile.secondaryLabel,{padding:o.padding},()=>S);if(x==null)return;const{height:N,label:v,secondaryLabel:D}=x,{textAlign:I,verticalAlign:A,padding:k}=o,L=Jg[I]??.5,O=M.x+k+(M.width-2*k)*L,T=iL[A]??.5,E=M.y+k+N*.5+(M.height-2*k-N)*T;return{label:v!=null?{text:v.text,fontSize:v.fontSize,lineHeight:v.lineHeight,style:this.properties.tile.label,x:O,y:E-(N-v.height)*.5}:void 0,secondaryLabel:D!=null?{text:D.text,fontSize:D.fontSize,lineHeight:D.fontSize,style:this.properties.tile.secondaryLabel,x:O,y:E+(N-D.height)*.5}:void 0,verticalAlign:"middle",textAlign:I}}else{if(b?.label==null)return;{const{padding:S,textAlign:x}=s,N=this.groupTitleHeight(g,M);if(N==null)return;const v=M.width-2*S,D=Lo.wrap(b.label,M.width-2*S,1/0,s.label,"never"),I=Jg[x]??.5;return{label:{text:D,fontSize:s.label.fontSize,lineHeight:ie.lineHeight(s.label.fontSize),style:this.properties.group.label,x:M.x+S+v*I,y:M.y+S+N*.5},secondaryLabel:void 0,verticalAlign:"middle",textAlign:x}}}}),m=(g,y,f,M)=>{const b=g.children.length===0,S=u[g.index],x=f===0?S?.label:S?.secondaryLabel;if(S==null||x==null){y.visible=!1;return}let N;if(M){const{tile:v,group:D}=i;N=v.secondaryLabel.color,b?f===0&&(N=v.label.color):N=D.label.color}y.text=x.text,y.fontSize=x.fontSize,y.lineHeight=x.lineHeight,y.fontStyle=x.style.fontStyle,y.fontFamily=x.style.fontFamily,y.fontWeight=x.style.fontWeight,y.fill=N??x.style.color,y.textAlign=S.textAlign,y.textBaseline=S.verticalAlign,y.x=x.x,y.y=x.y,y.visible=!0};this.groupSelection.selectByClass(Lo).forEach(g=>{m(g.datum,g,g.tag,!1)}),this.highlightSelection.selectByClass(Lo).forEach(g=>{const y=g.datum===h;g.visible=y||(h?.contains(g.datum)??!1),g.visible&&m(g.datum,g,g.tag,y)})}updateNodeMidPoint(t){this.rootNode.walk(e=>{const i=t[e.index];i!=null&&(e.midPoint.x=i.x+i.width/2,e.midPoint.y=i.y)})}pickNodeClosestDatum(t){const e=this.pickNodeExactShape(t);return e!==void 0?e:this.pickNodeNearestDistantObject(t,this.groupSelection.nodes())}getTooltipHtml(t){const{datum:e,depth:i}=t,{id:o}=this,{tooltip:s,colorKey:a,colorName:n=a,labelKey:r,secondaryLabelKey:l,sizeKey:c,sizeName:h=c,childrenKey:p}=this.properties,u=t.children.length===0,m=u||this.properties.group.interactive;if(e==null||i==null||!m)return ec.EMPTY_TOOLTIP_CONTENT;const g=r!=null?e[r]:void 0,f=this.getTileFormat(t,!1)?.fill??this.getNodeFill(t);if(!s.renderer&&!g)return ec.EMPTY_TOOLTIP_CONTENT;const M=[],b=l!=null?e[l]:void 0;b!=null&&l!==a&&l!==c&&M.push(oc(b));const S=c!=null?e[c]:void 0;S!=null&&M.push(`${h}: ${oc(S)}`);const x=a!=null?e[a]:void 0;x!=null&&M.push(`${n}: ${oc(x)}`);const N=M.join("<br>"),v={title:g,color:u?this.properties.tile.label.color:this.properties.group.label.color,backgroundColor:f,content:N};return s.toTooltipHtml(v,{depth:i,datum:e,colorKey:a,labelKey:r,secondaryLabelKey:l,sizeKey:c,title:g,color:f,seriesId:o,childrenKey:p,colorName:n,itemId:void 0,sizeName:h})}pickFocus(t){const{focusPath:e}=this;(e.length<2||this.focusSorted==null)&&(e.length=1,this.focusSorted=this.sortChildren(e[0].nodeDatum),e.push({nodeDatum:this.focusSorted.childAt(0),childIndex:0}));const{datumIndexDelta:i,otherIndexDelta:o}=t,s=e[e.length-1];if(o===1){if(s.nodeDatum.children.length>0){this.focusSorted=this.sortChildren(s.nodeDatum);const n={nodeDatum:this.focusSorted.childAt(0),childIndex:0};return e.push(n),this.computeFocusOutputs(n)}}else if(i!==0){const n=s.childIndex+i,r=(s.nodeDatum.parent?.children.length??1)-1;return s.childIndex=JO(0,n,r),s.nodeDatum=this.focusSorted.childAt(s.childIndex),this.computeFocusOutputs(s)}const a=super.pickFocus(t);return o<0&&(this.focusSorted=this.sortChildren(e[e.length-1].nodeDatum.parent)),a}computeFocusBounds(t){return this.groupSelection.selectByClass(Qa)[t.index]?.computeTransformedBBox()}};sc.className="TreemapSeries",sc.type="treemap";var{DEFAULT_DIVERGING_SERIES_COLOUR_RANGE:sL,DEFAULT_FONT_FAMILY:ac,DEFAULT_HIERARCHY_FILLS:aL,DEFAULT_HIERARCHY_STROKES:nL,DEFAULT_INSIDE_SERIES_LABEL_COLOUR:qa,DEFAULT_LABEL_COLOUR:ty,FONT_WEIGHT:ey}=zO,rL={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["hierarchy"],identifier:"treemap",instanceConstructor:sc,tooltipDefaults:{range:"exact"},solo:!0,themeTemplate:{series:{group:{label:{enabled:!0,color:ty,fontStyle:void 0,fontWeight:ey.NORMAL,fontSize:12,fontFamily:ac,spacing:4},fill:void 0,stroke:void 0,strokeWidth:1,padding:4,gap:2,textAlign:"left"},tile:{label:{enabled:!0,color:qa,fontStyle:void 0,fontWeight:ey.NORMAL,fontSize:18,minimumFontSize:10,fontFamily:ac,wrapping:"on-space",overflowStrategy:"ellipsis",spacing:2},secondaryLabel:{enabled:!0,color:qa,fontStyle:void 0,fontWeight:void 0,fontSize:12,minimumFontSize:10,fontFamily:ac,wrapping:"never",overflowStrategy:"ellipsis"},fill:void 0,stroke:void 0,strokeWidth:0,padding:3,gap:1},highlightStyle:{group:{label:{color:ty},fill:void 0,stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2},tile:{label:{color:qa},secondaryLabel:{color:qa},fill:void 0,stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2}}},gradientLegend:{enabled:!0}},paletteFactory:({takeColors:t,colorsCount:e,themeTemplateParameters:i})=>{const{fills:o,strokes:s}=t(e),a=i.get(sL),n=i.get(aL),r=i.get(nL);return{fills:o,strokes:s,colorRange:a,undocumentedGroupFills:n,undocumentedGroupStrokes:r}}};import{_Theme as Yi}from"ag-charts-community";import{_ModuleSupport as fi,_Scale as lL,_Scene as iy,_Util as cL}from"ag-charts-community";import{_ModuleSupport as hL,_Scene as dL}from"ag-charts-community";var{DropShadow:pL,Label:uL}=dL,{AbstractBarSeriesProperties:gL,BaseProperties:hs,PropertiesArray:yL,SeriesTooltip:mL,Validate:W,BOOLEAN:fL,COLOR_STRING:nc,FUNCTION:oy,LINE_DASH:sy,NUMBER:xL,OBJECT:je,OBJECT_ARRAY:SL,POSITIVE_NUMBER:Eo,RATIO:rc,STRING:Ro,UNION:ay}=hL,Ja=class extends hs{};d([W(ay(["subtotal","total"],"a total type"))],Ja.prototype,"totalType",2),d([W(xL)],Ja.prototype,"index",2),d([W(Ro)],Ja.prototype,"axisLabel",2);var ny=class extends hs{};d([W(oy,{optional:!0})],ny.prototype,"renderer",2);var lc=class extends uL{constructor(){super(...arguments),this.placement="end",this.padding=6}};d([W(ay(["start","end","inside"],"a placement"))],lc.prototype,"placement",2),d([W(Eo)],lc.prototype,"padding",2);var Vt=class extends hs{constructor(){super(...arguments),this.fill="#c16068",this.stroke="#c16068",this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=1,this.cornerRadius=0,this.shadow=new pL().set({enabled:!1}),this.label=new lc,this.tooltip=new ny}};d([W(Ro,{optional:!0})],Vt.prototype,"name",2),d([W(nc)],Vt.prototype,"fill",2),d([W(nc)],Vt.prototype,"stroke",2),d([W(rc)],Vt.prototype,"fillOpacity",2),d([W(rc)],Vt.prototype,"strokeOpacity",2),d([W(sy)],Vt.prototype,"lineDash",2),d([W(Eo)],Vt.prototype,"lineDashOffset",2),d([W(Eo)],Vt.prototype,"strokeWidth",2),d([W(Eo)],Vt.prototype,"cornerRadius",2),d([W(oy,{optional:!0})],Vt.prototype,"itemStyler",2),d([W(je)],Vt.prototype,"shadow",2),d([W(je)],Vt.prototype,"label",2),d([W(je)],Vt.prototype,"tooltip",2);var Xi=class extends hs{constructor(){super(...arguments),this.enabled=!0,this.stroke="black",this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=2}};d([W(fL)],Xi.prototype,"enabled",2),d([W(nc)],Xi.prototype,"stroke",2),d([W(rc)],Xi.prototype,"strokeOpacity",2),d([W(sy)],Xi.prototype,"lineDash",2),d([W(Eo)],Xi.prototype,"lineDashOffset",2),d([W(Eo)],Xi.prototype,"strokeWidth",2);var tn=class extends hs{constructor(){super(...arguments),this.positive=new Vt,this.negative=new Vt,this.total=new Vt}};d([W(je)],tn.prototype,"positive",2),d([W(je)],tn.prototype,"negative",2),d([W(je)],tn.prototype,"total",2);var Ye=class extends gL{constructor(){super(...arguments),this.item=new tn,this.totals=new yL(Ja),this.line=new Xi,this.tooltip=new mL}};d([W(Ro)],Ye.prototype,"xKey",2),d([W(Ro)],Ye.prototype,"yKey",2),d([W(Ro,{optional:!0})],Ye.prototype,"xName",2),d([W(Ro,{optional:!0})],Ye.prototype,"yName",2),d([W(je)],Ye.prototype,"item",2),d([W(SL)],Ye.prototype,"totals",2),d([W(je)],Ye.prototype,"line",2),d([W(je)],Ye.prototype,"tooltip",2);var{adjustLabelPlacement:ML,SeriesNodePickMode:ry,fixNumericExtent:ly,valueProperty:cy,keyProperty:bL,accumulativeValueProperty:en,trailingAccumulatedValueProperty:DL,ChartAxisDirection:cc,getRectConfig:NL,updateRect:vL,checkCrisp:IL,updateLabelNode:AL,prepareBarAnimationFunctions:TL,collapsedStartingBarPosition:kL,resetBarSelectionsFn:OL,seriesLabelFadeInAnimation:LL,resetLabelFn:EL,animationValidation:RL,DEFAULT_CARTESIAN_DIRECTION_KEYS:_L,DEFAULT_CARTESIAN_DIRECTION_NAMES:CL,isFiniteNumber:hy,computeBarFocusBounds:wL}=fi,{Rect:PL,motion:BL}=iy,{sanitizeHtml:ds,isContinuous:dy}=cL,{ContinuousScale:zL}=lL,hc=class extends fi.AbstractBarSeries{constructor(t){super({moduleCtx:t,directionKeys:_L,directionNames:CL,pickModes:[ry.NEAREST_NODE,ry.EXACT_SHAPE_MATCH],pathsPerSeries:1,hasHighlightedLabels:!0,pathsZIndexSubOrderOffset:[-1,-1],animationResetFns:{datum:OL,label:EL}}),this.properties=new Ye,this.seriesItemTypes=new Set(["positive","negative","total"])}async processData(t){const{xKey:e,yKey:i,totals:o}=this.properties,{data:s=[]}=this;if(!this.properties.isValid()||!this.visible)return;const a=b=>dy(b)&&Number(b)>=0,n=b=>dy(b)&&Number(b)<0,r=b=>b==="total"||b==="subtotal",l={missingValue:void 0,invalidValue:void 0},c=[],h=o.reduce((b,S)=>{const x=b.get(S.index);return x?x.push(S):b.set(S.index,[S]),b},new Map);s.forEach((b,S)=>{c.push(b),h.get(S)?.forEach(x=>c.push({...x.toJson(),[e]:x.axisLabel}))});const p=[];this.ctx.animationManager.isSkipped()||p.push(RL());const u=this.getCategoryAxis()?.scale,m=this.getValueAxis()?.scale,{isContinuousX:g,xScaleType:y,yScaleType:f}=this.getScaleInformation({xScale:u,yScale:m}),{processedData:M}=await this.requestDataModel(t,c,{props:[bL(e,y,{id:"xValue"}),en(i,f,{...l,id:"yCurrent"}),en(i,f,{...l,missingValue:0,id:"yCurrentTotal"}),en(i,f,{...l,id:"yCurrentPositive",validation:a}),en(i,f,{...l,id:"yCurrentNegative",validation:n}),DL(i,f,{...l,id:"yPrevious"}),cy(i,f,{id:"yRaw"}),cy("totalType","band",{id:"totalTypeValue",missingValue:void 0,validation:r}),...g?[fi.SMALLEST_KEY_INTERVAL,fi.LARGEST_KEY_INTERVAL]:[],...p]});this.smallestDataInterval=M.reduced?.smallestKeyInterval,this.largestDataInterval=M.reduced?.largestKeyInterval,this.updateSeriesItemTypes(),this.animationState.transition("updateData")}getSeriesDomain(t){const{processedData:e,dataModel:i,smallestDataInterval:o}=this;if(!e||!i)return[];const{keys:[s],values:a}=e.domain,n=i.resolveProcessedDataDefById(this,"xValue");if(t===this.getCategoryDirection()){if(n?.def.type==="key"&&n?.def.valueType==="category")return s;const r=hy(o)?o:0,l=fi.extent(s)??[NaN,NaN],c=this.getCategoryAxis(),h=!!c?.isReversed(),p=t===cc.Y,u=h===p?0:-r,m=h===p?r:0,g=l[0]+u,y=l[1]+m;return ly([g,y],c)}else{const r=i.resolveProcessedDataIndexById(this,"yCurrent"),l=a[r],c=[Math.min(0,l[0]),Math.max(0,l[1])];return ly(c)}}async createNodeData(){const{data:t,dataModel:e,smallestDataInterval:i}=this,{line:o}=this.properties,s=this.getCategoryAxis(),a=this.getValueAxis();if(!(t&&s&&a&&e))return;const n=s.scale,r=a.scale,l=s.isReversed(),c=this.getBarDirection()===cc.X,h=(zL.is(n)?n.calcBandwidth(i):n.bandwidth)??10;if(this.processedData?.type!=="ungrouped")return;const p={itemId:this.properties.yKey,nodeData:[],labelData:[],pointData:[],scales:this.calculateScaling(),visible:this.visible};if(!this.visible)return p;const u=e.resolveProcessedDataIndexById(this,"yRaw"),m=e.resolveProcessedDataIndexById(this,"xValue"),g=e.resolveProcessedDataIndexById(this,"totalTypeValue"),y=[],f=e.resolveProcessedDataIndexById(this,"yCurrent"),M=e.resolveProcessedDataIndexById(this,"yPrevious"),b=e.resolveProcessedDataIndexById(this,"yCurrentTotal");function S(L,O,T){return L||O?{cumulativeValue:T[b],trailingValue:O?N:0}:{cumulativeValue:T[f],trailingValue:T[M]}}function x(L,O,T,E,_){return L?E:O?(E??0)-(_??0):T}let N=0;const{xKey:v,yKey:D,xName:I,yName:A}=this.properties;this.processedData?.data.forEach(({keys:L,datum:O,values:T},E)=>{const _=T[g],R=this.isSubtotal(_),C=this.isTotal(_),w=C||R,P=L[m],B=Math.round(n.convert(P)),z=T[u],{cumulativeValue:V,trailingValue:U}=S(C,R,T);w&&(N=V??0);const Q=Math.round(r.convert(V)),H=Math.round(r.convert(U)),K=x(C,R,z,V,U),j=(K??0)>=0,st=this.getSeriesItemType(j,_),{fill:Ft,stroke:rt,strokeWidth:Mt,label:bt}=this.getItemConfig(st),$t=j?Q:H,Xt=j?H:Q,Ut=Math.max(Mt,Math.abs(Xt-$t)),ot={x:c?Math.min($t,Xt):B,y:c?B:Math.min($t,Xt),width:c?Ut:h,height:c?h:Ut},qt={x:ot.x+ot.width/2,y:ot.y+ot.height/2},fe=w?Q:H,Xe=Math.floor(o.strokeWidth)%2/2,gc=l?Q:fe,yc=l?fe:Q;let Zi,Qi;c?(Zi={x:gc+Xe,y:ot.y},Qi={x:yc+Xe,y:ot.y+ot.height}):(Zi={x:ot.x,y:gc+Xe},Qi={x:ot.x+ot.width,y:yc+Xe});const gy={x:l?Qi.x:Zi.x,y:l?Qi.y:Zi.y,x2:l?Zi.x:Qi.x,y2:l?Zi.y:Qi.y,size:0};y.push(gy);const yy=this.getLabelText(bt,{itemId:st==="subtotal"?"total":st,value:K,datum:O,xKey:v,yKey:D,xName:I,yName:A},an=>hy(an)?an.toFixed(2):String(an)),mc={index:E,series:this,itemId:st,datum:O,cumulativeValue:V??0,xValue:P,yValue:K,yKey:D,xKey:v,x:ot.x,y:ot.y,width:ot.width,height:ot.height,midPoint:qt,fill:Ft,stroke:rt,strokeWidth:Mt,opacity:1,label:{text:yy,...ML({isPositive:(K??-1)>=0,isVertical:!c,placement:bt.placement,padding:bt.padding,rect:ot})}};p.nodeData.push(mc),p.labelData.push(mc)});const k=this.properties.line.enabled;return f!==void 0&&k&&(p.pointData=y),p}updateSeriesItemTypes(){const{dataModel:t,seriesItemTypes:e,processedData:i}=this;if(!t||!i)return;e.clear();const o=t.resolveProcessedDataIndexById(this,"yCurrentPositive"),s=t.resolveProcessedDataIndexById(this,"yCurrentNegative"),a=t.resolveProcessedDataIndexById(this,"totalTypeValue"),n=i.domain.values[o]??[],r=i.domain.values[s]??[];n.length>0&&e.add("positive"),r.length>0&&e.add("negative");const l=i?.domain.values[a];l&&l.forEach(c=>{(c==="total"||c==="subtotal")&&e.add("total")})}isSubtotal(t){return t==="subtotal"}isTotal(t){return t==="total"}nodeFactory(){return new PL}getSeriesItemType(t,e){return e??(t?"positive":"negative")}getItemConfig(t){switch(t){case"positive":return this.properties.item.positive;case"negative":return this.properties.item.negative;case"subtotal":case"total":return this.properties.item.total}}async updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t,o=e??[];return i.update(o)}async updateDatumNodes(t){const{datumSelection:e,isHighlight:i}=t,{id:o,ctx:s}=this,{yKey:a,highlightStyle:{item:n}}=this.properties,r=this.getCategoryAxis(),l=IL(r?.scale,r?.visibleRange,this.smallestDataInterval,this.largestDataInterval),c=this.getCategoryDirection()===cc.X;e.each((h,p)=>{const u=p.itemId,{fillOpacity:m,strokeOpacity:g,strokeWidth:y,lineDash:f,lineDashOffset:M,cornerRadius:b,itemStyler:S,shadow:x}=this.getItemConfig(u),N={fill:p.fill,stroke:p.stroke,fillOpacity:m,strokeOpacity:g,lineDash:f,lineDashOffset:M,fillShadow:x,strokeWidth:this.getStrokeWidth(y),cornerRadius:b},v=c?p.width>0:p.height>0,D=NL({datum:p,isHighlighted:i,style:N,highlightStyle:n,itemStyler:S,seriesId:o,itemId:p.itemId,ctx:s,value:p.yValue,yKey:a});D.crisp=l,D.visible=v,vL({rect:h,config:D})})}async updateLabelSelection(t){const{labelData:e,labelSelection:i}=t;if(e.length===0)return i.update([]);const o=e[0].itemId,{label:s}=this.getItemConfig(o),a=s.enabled?e:[];return i.update(a)}async updateLabelNodes(t){t.labelSelection.each((e,i)=>{AL(e,this.getItemConfig(i.itemId).label,i.label)})}getTooltipHtml(t){const e=this.getCategoryAxis(),i=this.getValueAxis();if(!this.properties.isValid()||!e||!i)return fi.EMPTY_TOOLTIP_CONTENT;const{id:o}=this,{xKey:s,yKey:a,xName:n,yName:r,tooltip:l}=this.properties,{datum:c,itemId:h,xValue:p,yValue:u}=t,{fill:m,fillOpacity:g,stroke:y,strokeWidth:f,strokeOpacity:M,lineDash:b=[],lineDashOffset:S,cornerRadius:x,name:N,itemStyler:v}=this.getItemConfig(h);let D;v&&(D=this.ctx.callbackCache.call(v,{datum:c,xKey:s,yKey:a,fill:m,fillOpacity:g,stroke:y,strokeWidth:f,strokeOpacity:M,lineDash:b,lineDashOffset:S,cornerRadius:x,highlighted:!1,seriesId:o,itemId:t.itemId}));const I=D?.fill??m??"gray",A=ds(e.formatDatum(p)),k=ds(i.formatDatum(u)),L=this.isTotal(h),O=this.isSubtotal(h);let T;L?T="Total":O?T="Subtotal":T=N??r??a;const E=ds(r),_=`<b>${ds(n??s)}</b>: ${A}<br/><b>${ds(T)}</b>: ${k}`;return l.toTooltipHtml({title:E,content:_,backgroundColor:I},{seriesId:o,itemId:h,datum:c,xKey:s,yKey:a,xName:n,yName:r,color:I,title:E})}getLegendData(t){if(t!=="category")return[];const{id:e,seriesItemTypes:i}=this,o=[],s=a=>a.charAt(0).toUpperCase()+a.substring(1);return i.forEach(a=>{const{fill:n,stroke:r,fillOpacity:l,strokeOpacity:c,strokeWidth:h,name:p}=this.getItemConfig(a);o.push({legendType:"category",id:e,itemId:a,seriesId:e,enabled:!0,label:{text:p??s(a)},symbols:[{marker:{fill:n,stroke:r,fillOpacity:l,strokeOpacity:c,strokeWidth:h}}]})}),o}toggleSeriesItem(){}animateEmptyUpdateReady({datumSelection:t,labelSelection:e,contextData:i,paths:o}){const s=TL(kL(this.isVertical(),this.axes,"normal"));BL.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],s),LL(this,"labels",this.ctx.animationManager,e);const{pointData:a}=i;if(!a)return;const[n]=o;this.isVertical()?this.animateConnectorLinesVertical(n,a):this.animateConnectorLinesHorizontal(n,a)}animateConnectorLinesHorizontal(t,e){const{path:i}=t;this.updateLineNode(t);const o=this.getValueAxis(),s=o?.isReversed(),a=s?(c,h)=>c<h:(c,h)=>c>h,n=o?.scale.convert(0),r=e.reduce((c,h)=>(a(h.x,c)&&(c=h.x),c),s?1/0:0),l=(c,h,p,u,m)=>(c-h)/(p-h)*(m-u)+u;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:n,to:r,ease:fi.Motion.easeOut,collapsable:!1,onUpdate(c){i.clear(!0),e.forEach((h,p)=>{const u=l(c,n,r,n,h.x),m=l(c,n,r,n,h.x2);p!==0&&i.lineTo(u,h.y),i.moveTo(m,h.y2)}),t.checkPathDirty()}})}animateConnectorLinesVertical(t,e){const{path:i}=t;this.updateLineNode(t);const o=this.getValueAxis(),s=o?.isReversed(),a=s?(c,h)=>c>h:(c,h)=>c<h,n=o?.scale.convert(0),r=e.reduce((c,h)=>(a(h.y,c)&&(c=h.y),c),s?0:1/0),l=(c,h,p,u,m)=>(c-h)/(p-h)*(m-u)+u;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:n,to:r,ease:fi.Motion.easeOut,collapsable:!1,onUpdate(c){i.clear(!0),e.forEach((h,p)=>{const u=l(c,n,r,n,h.y),m=l(c,n,r,n,h.y2);p!==0&&i.lineTo(h.x,u),i.moveTo(h.x2,m)}),t.checkPathDirty()}})}animateReadyResize(t){super.animateReadyResize(t),this.resetConnectorLinesPath(t)}async updatePaths(t){this.resetConnectorLinesPath({contextData:t.contextData,paths:t.paths})}resetConnectorLinesPath({contextData:t,paths:e}){if(e.length===0)return;const[i]=e;this.updateLineNode(i);const{path:o}=i;o.clear(!0);const{pointData:s}=t;s&&(s.forEach((a,n)=>{n!==0&&o.lineTo(a.x,a.y),o.moveTo(a.x2,a.y2)}),i.checkPathDirty())}updateLineNode(t){const{stroke:e,strokeWidth:i,strokeOpacity:o,lineDash:s,lineDashOffset:a}=this.properties.line;t.setProperties({fill:void 0,stroke:e,strokeWidth:this.getStrokeWidth(i),strokeOpacity:o,lineDash:s,lineDashOffset:a,lineJoin:"round",pointerEvents:iy.PointerEvents.None})}isLabelEnabled(){const{positive:t,negative:e,total:i}=this.properties.item;return t.label.enabled||e.label.enabled||i.label.enabled}onDataChange(){}computeFocusBounds({datumIndex:t,seriesRect:e}){return wL(this.contextNodeData?.nodeData[t],this.contentGroup,e)}};hc.className="WaterfallSeries",hc.type="waterfall";import{_Theme as on}from"ag-charts-community";var dc={strokeWidth:0,label:{enabled:!1,fontStyle:void 0,fontWeight:on.FONT_WEIGHT.NORMAL,fontSize:12,fontFamily:on.DEFAULT_FONT_FAMILY,color:on.DEFAULT_LABEL_COLOUR,formatter:void 0,placement:"end"}},VL={series:{item:{positive:dc,negative:dc,total:dc},line:{stroke:on.PALETTE_NEUTRAL_STROKE,strokeOpacity:1,lineDash:[0],lineDashOffset:0,strokeWidth:2}},legend:{enabled:!0,toggleSeries:!1}},FL={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"waterfall",solo:!0,instanceConstructor:hc,tooltipDefaults:{range:"exact"},defaultAxes:[{type:Yi.CARTESIAN_AXIS_TYPE.CATEGORY,position:Yi.POSITION.BOTTOM},{type:Yi.CARTESIAN_AXIS_TYPE.NUMBER,position:Yi.POSITION.LEFT}],themeTemplate:VL,swapDefaultAxesCondition:({direction:t})=>t==="horizontal",paletteFactory:({takeColors:t,colorsCount:e,userPalette:i,palette:o})=>{if(i==="user-indexed"){const{fills:s,strokes:a}=t(e);return{line:{stroke:o.neutral.stroke},item:{positive:{fill:s[0],stroke:a[0]},negative:{fill:s[1],stroke:a[1]},total:{fill:s[2],stroke:a[2]}}}}return{line:{stroke:o.neutral.stroke},item:{positive:{fill:o.up.fill,stroke:o.up.stroke,label:{color:Yi.DEFAULT_LABEL_COLOUR}},negative:{fill:o.down.fill,stroke:o.down.stroke,label:{color:Yi.DEFAULT_LABEL_COLOUR}},total:{fill:o.neutral.fill,stroke:o.neutral.stroke,label:{color:Yi.DEFAULT_LABEL_COLOUR}}}}}};function UL(){gs.moduleRegistry.register(am,Sm,lf,wx,Xx,wb,ND,JD,h0,Qb,eS,yS,xS,VS,Kv,gv,NI,mA,HI,XS,tM,tb,wN,o0,Dm,q0,J0,PT,WT,Qm,af,iO,vk,OO,BO,hM,rL,FL,HM),gs.enterpriseModule.isEnterprise=!0,gs.enterpriseModule.licenseManager=t=>new ib(t.container?.ownerDocument??(typeof document>"u"?void 0:document)),gs.enterpriseModule.injectWatermark=nb}export*from"ag-charts-community";UL();export{xy as AgCharts,Sy as time};
